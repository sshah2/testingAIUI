       IDENTIFICATION DIVISION. 
       PROGRAM-ID    . ATE01D.  
       AUTHOR        . SATYA ARYA        MASTECH.   
       DATE-WRITTEN  . START 10/23/89    END 11/17/89.  
       DATE-COMPILED .  
       REMARKS. 
      ************************************************************* 
      *** THE PURPOSE OF ATE01D IS TO EXTRACT RECORDS FROM THE  *** 
      *** CIS DATA BASE AND CREATE OUTPUT FLAT SEQUENTIAL       *** 
      *** FILES.                                                *** 
      ***                                                       *** 
      *** THESE FILES ARE TO BE USED AS INPUT TO SUBSEQUENT     *** 
      *** PROGRAMS WHICH WILL CREATE WELFARE CHECKS AND MEDICAL *** 
      *** ASSISTANCE ID CARDS.                                  *** 
      ***                                                       *** 
CC43  ***  TEST1 AND TEST ARE USED TO TEST THIS PROGRAM AS IT IS*** 
CC43  ***  TOO BIG TO PUT IN MONITOR.                           *** 
      *** MAJOR PROCESSES PERFORMED DURING THE RUN ARE :        *** 
      ***       . FUTURE BUDGET ACTIVITY.                       *** 
      ***       . CHECK  ISSUANCE.                              *** 
      ***       . MAID ISSUANCE.                                *** 
      ***       . HISTORY UPDATING.                             *** 
      ***                                                       *** 
      *** THIS PROGRAM MAY BE RUN ON JUST-1-TEST-CASE-ONLY      *** 
      *** ALSO FOR CHECKING OUT PROBLEM CONDITIONS.             *** 
      *** TO PERFORM THIS, PLEASE REMOVE COMMENT * FROM         *** 
      *** 2000-TEST-ONLY PARA, AND GIVE YR TEST-CASE-NUMBER     *** 
      *** IT IS SET UP TO RUN ONLY FOR THAT CASE.               *** 
      ***                                                       *** 
      *** NOTE : PLEASE DO NOT REMOVE THE 'MCFLAG' SET/RESET    *** 
      ***        STATEMENTS. THEY HV BEEN PLACED STRATEGICALLY  *** 
      ***        TO PROVIDE OPTIMUM MONITOR INFORMATION.        *** 

      *** ANALYST     : SUSAN WOMELSDORF                        *** 
      *** PROGRAMMER  : SATYA ARYA                              *** 
      ************************************************************* 
      * 
R069  ***  ATE01D01    ABC20D, ABC22D, ATE41D   ISSUANCE       ***  
R069  ***  ATE01D02    ATE05D       DISCONTINUED               ***  
R069  ***  ATE01D04    AHM010              TRANS HISTORY       ***  
R069  ***  ATE01D05    ATE42D              CLOSES              ***  
R069  ***  ATE01D06    ATE50D       DISCONTINUED               ***  
R069  ***  ATE01D07                 DISCONTINUED               ***  
R069  ***  ATE01D08    ATE72D              APPLY CLOSES R653   ***  
R069  ***  ATE01D09    ATE77D              TSA PURGE           ***  
R069  ***  ATE01D10    CCM04D              ALERTS              ***  
R069  ***  ATE01D11    ATE03E              NOTICES             ***  
R069  ***  ATE01D12    AMR11D              CLOCKS              ***  
R069  ***  ATE01D13    CISMOE RETURN DATA                      ***  
R069  ***  ATE01D14    ATU45D              SUSPENDS/REINSTATES ***  
R069  ***  ATE01D15    ARD246              REPORTING           ***  
R069  ***  ATE01D16    ATU15D              TSA UPDATE          ***  
R069  ***  ATE01D17    CSH10E              OPEN TCA BUDGETS    ***  
R069  ***  ATE01D18    IV-B                                    ***  
R069  ***  ATE01D19    ADD01D              REPORTING           ***  
R070  ***  ATE01D20    ASBRCE RETURN DATA BUFFER               ***  
R075A ***  ATE01D21    REAPP FILE COUNT                        ***  
R071  ************************************************************* 
      ***            REVISION HISTORY IS AS FOLLOWS:            *** 
R000  *** REV#000  -  DESCRIPTION   -  NAME  -  DATE            *** 
      ***                                                       *** 
      ************************************************************* 
R001  *** R001 - CORRECT PROGRAM TO ACCESS OPEN CASE LEVEL      *** 
R001  ***         RECORDS.                                      *** 
R001  ***                     RON HANNA 10/28/91                *** 
      ***                                                       *** 
R002  *** R002 - ECL CHANGE.                                    *** 
R002  ***                    CINDY WARREN 11/01/91              *** 
      ***                                                       *** 
R003  *** R003 - PARA 2200-CLOSING. INCLUDE SUSPENDED BUDGETS   *** 
R003  ***        ALSO TO BE TESTED FOR FUTURE CLOSES.           *** 
R003  ***                                                       *** 
R003  ***      - PARA 7900. SET SW-23 IN PLACE OF SW-24 FOR     *** 
R003  ***        A MISSING MANDATORY RECORD.                    *** 
R003  ***                      SATYA ARYA 11/05/91              *** 
      ***                                                       *** 
R004  *** R004 - CORRECT DOUBLE PAYDAY LOGIC                    *** 
R004  ***                 SUSAN WOMELSDORF 11/14/91             *** 
      ***                                                       *** 
R005  *** R005 - ADD LOGIC FOR DOUBLE PAYDAY TO CHECK WHICH     *** 
R005  ***        PAYDAY IS RUNNING AND SET ATE20D01 ACCORDINGLY.*** 
R005  ***           MARY JEAN M DEIMLER   NOVEMBER  1991        *** 
      ***                                                       *** 
R006  *** R006 - PARA 8738. FORMAT R253-ALTERNATE-PAYMENT       *** 
R006  ***        RECORD AS PER R248-CASE-NAME RECORD            *** 
R006  ***        BEFORE WRITING IT TO OUTPUT FILES.             *** 
R006  ***                                                       *** 
R006  ***                      SATYA ARYA 11/21/91              *** 
      ***                                                       *** 
R007  *** R007 - PARA 7226. WHEN 2'ND OCCURRENCE OF R672-DTE-   *** 
R007  ***        BGN-EFFV = FIRST OCCURRENCE OF SAME,USE THE    *** 
R007  ***        SAVED DATABASE KEY TO FETCH THE FIRST OCCURENCE*** 
R007  ***                                                       *** 
R007  ***        ANALYST: SATYA ARYA 11/26/91                   *** 
R007  ***        PROGRAMMER: JOHN BARTOLONE                     *** 
      ***                                                       *** 
R008  *** R008 - PARA 7412. ACTIVE HMO RECORD IS THE ONE THAT   *** 
R008  ***        HAS BEGIN-EFF-DATE LESS-THAN-EQUAL-TO          *** 
R008  ***        SECOND-PAYMENT-DATE-MINUS-1.                   *** 
R008  ***                                                       *** 
R008  ***                      SATYA ARYA 12/30/91              *** 
      ***                                                       *** 
R009  *** R009 - PARA 2454-2. BUILD DATE-TIME STAMP FIELD ON    *** 
R009  ***        R289 FROM CYCLE DATE & SYSTEM TIME.            *** 
R009  ***                                                       *** 
R009  ***      - COMPARE/BUILD VENDOR NUMBER ON HISTORY WITH    *** 
R009  ***        LAST 4 DIGITS OF VENDOR NUMBER.                *** 
R009  ***                                                       *** 
R009  ***                      SATYA ARYA 03/30/92              *** 
      ***                                                       *** 
R010  *** R010 - CORRECT TIME ON AGRZER TRANSACTIONS            *** 
R010  ***               SUSAN WOMELSDORF 04/08/92               *** 
      ***                                                       *** 
R011  *** R011 - ECL CHANGE                                     *** 
R011  ***               MARY JEAN DEIMLER 04/27/92              *** 
      ***                                                       *** 
R012  *** R012 - R289 DATE NOT > CHECK DATE                     *** 
R012  ***               SUSAN WOMELSDORF  04/27/92              *** 
      ***                                                       *** 
R013  *** R013 - DON'T EXTRACT CASH FOR QUARTERLY'S OR MONTHLY'S*** 
R013  ***        ON SECOND HALF OF MONTH                        *** 
R013  ***               SUSAN WOMELSDORF  05/14/92              *** 
      ***                                                       *** 
R014  *** R014 - IF BUDGET STATUS DO NOT MATCH ON R249/R634,    *** 
R014  ***        BYPASS IT.                                     *** 
R014  ***               SATYA ARYA        06/25/92              *** 
      ***                                                       *** 
R015  *** R015 - ELIMINATE OVERRIDE RECORD PROCESSING.          *** 
R015  ***               SATYA ARYA        07/30/92              *** 
      ***                                                       *** 
R016  *** R016 - UPDATE BUDGET STATUS AS CLOSED IN MAID         *** 
R016  ***        ISSUANCE FILE FOR FUTURE CLOSES.               *** 
R016  ***               SATYA ARYA        08/20/92              *** 
      ***                                                       *** 
R017  *** R017 - DO NOT PUT INDIVIDUALS GETTING DELETED INTO    *** 
R017  ***        MAID INDIV EXTRACT FILE ATE01D03.              *** 
R017  ***               SATYA ARYA        09/22/92              *** 
      ***                                                       *** 
R018  *** R018 - No information available on tracking system.   *** 
      ***                                                       *** 
R019  *** R019 - Write the current system date instead of cycle *** 
R019  ***        date into COM-DATE-TIME-ENTERED field.         *** 
R019  ***               Ramesh Parmar     09/29/92              *** 
      ***                                                       *** 
R020  *** R020     Write history for suspended budgets also     *** 
R020  *** 10/26/92 (R635-CDE-STUS-BDGT = 'S').                  *** 
R020  ***          If R634-CDE-STUS-BDGT is not equal to        *** 
R020  ***          R289-CDE-SATTUS-BUDGET set the history write *** 
R020  ***          flag on and skip the remaining validation.   *** 
R020  ***               Ramesh Parmar.                          *** 
      ***                                                       *** 
R021  *** R021     DROP BDGTS WITH R634-CTL-ISSNC-MAID FROM     *** 
R021  ***          MEDICAL PATH                                 *** 
R021  ***                Susan Womelsdorf    12/21/92           *** 
      ***                                                       *** 
R022  *** R022 - MOVE THE CPF-PAYDAY-NBR TO THE CONTROL TOTALS  *** 
R022  ***        REPORT HEADER ON ALL SUPPLEMENTAL PAYDAYS.     *** 
R022  ***          MARY JEAN M DEIMLER   APRIL   1993           *** 
      ***                                                       *** 
R023  *** R023 - DELETE THE SECOND ADD TO THE CHECKPOINT NUMBER *** 
R023  ***          MARY JEAN M DEIMLER    JULY   1993           *** 
      ***                                                       *** 
M235  *** M235 - PROGRAM CHANGES FOR PAAC PROJECT. ADDED NEW    *** 
M235  ***        R666 FIELD TO B672 RECORD.                     *** 
M235  *** PROGRAMMER : DAVE WINSTON       07/15/93              *** 
M235  *** ANALYST    : SATYA ARYA                               *** 
      ***                                                       *** 
R024  *** R024 - WROTE CPF CYCLE DATE TO B964-DTE-ACTN-LAST     *** 
R024  ***        INSTEAD OF WRITING ZEROES.                     *** 
R024  *** PROGRAMMER : DAVE WINSTON       08/12/93              *** 
R024  *** ANALYST    : SATYA ARYA                               *** 
      ************************************************************* 
R025  *** R025 - DATA BASE CHANGE # 16 . REVISE PROGRAM TO CATER*** 
R025  ***        TO CHANGE 16 SPECS                             *** 
R025  *** PROGRAMMER : SRINIVAS MURTHY    10/04/93              *** 
R025  *** ANALYST    : SATYA ARYA                               *** 
      ***                                                       *** 
R026  *** R026 - DATA BASE CHANGE 17. ADD NEW FIELDS FOR THE    *** 
R026  ***        R634 AND R954 DATA RECORDS. CHANGE R672 FIELDS *** 
R026  ***        TO R666 FIELDS.                                *** 
R026  ***          SATYA ARYA    4/7/94                         *** 
      ***                                                       *** 
R027  *** R027 - REVERT BACK TO CLOSING SUSPENDED BUDGETS FROM  *** 
R027  ***        SUSPEND DATE MINUS ONE, TO THE DAY BEFORE THE  *** 
R027  ***        NEXT PAYMENT DATE.                             *** 
R027  ***          SATYA ARYA      6/16/94                      *** 
      ***                                                       *** 
R028  *** R028 - REDUCE THE NUMBER OF RECORDS BETWEEN CKPTS TO  *** 
R028  ***        7000.  ADD CODE TO ASSURE THAT PD # FOR 2ND RUN ** 
R028  ***        OF DOUBLE = 1ST RUN PD + 1.                    *** 
R028  ***            MARY JEAN M DEIMLER    JULY  1994          *** 
      ***                                                       *** 
R029  *** R029 - SET END-OF-SET CONDITION TO TRUE FOR SETS CORR *** 
R029  ***        ESPONDING TO EACH OF THE FOLLOWING RECORDS     *** 
R029  ***        R247/R248/R254/R634/R252/R253/R255/R269/R268   *** 
R029  ***            RANJIT BASAK       JAN 1995                *** 
      ***                                                       *** 
R030  *** R030 - PURPOSE : - End date HMO records.              *** 
R030  *** Analyst    : Satya Arya                               *** 
R030  *** Programmer : Susheela Prakashan     04/12/95          *** 
R030  ***                                                       *** 
      ***                                                       *** 
R031  *** R031 - PURPOSE : - Grant not to exceed 1500 dollars   *** 
R031  *** Analyst    : Satya Arya                               *** 
R031  *** Programmer : Susheela Prakashan     06/16/95          *** 
      ***                                                       *** 
R032  *** R032 - PURPOSE : -  Allow for under $10 cheque on     *** 
R032  ***                     daycare provider benefit          *** 
R032  ***                                                       *** 
R032  *** Analyst    : Satya Arya                               *** 
R032  *** Programmer : Susheela Prakashan     06/23/95          *** 
      ***                                                       *** 
R033  *** R033 - CHANGES FOR B954-CDE-REFL-HIPP                 *** 
R033  *** Analyst    : SUSAN WOMELSDORF       07/14/95          *** 
      ***                                                       *** 
R034  *** R034 - DATABASE CHANGE 19                             *** 
R034  *** Analyst    : SUSAN WOMELSDORF       08/18/95          *** 
      ***                                                       *** 
R035  *** R035 - PURPOSE : - Positive Qualaty Control Sampling  ****
R035  *** Analyst        : Satya Arya                           *** 
R035  *** Programmer     : Susheela Prakashan    12/27/95       *** 
      ***                                                       *** 
R036  *** R036 - DATABASE CHANGE 20                             *** 
R036  *** Analyst    : SUSAN WOMELSDORF       04/02/96          *** 
      ***                                                       *** 
R037  *** R037 - CORRECT MQC PROCESS BY INCLUDING ALL MEDICAL   *** 
R037  *** Analyst    : SUSAN WOMELSDORF       10/30/96          *** 
      ***                                                       *** 
R038  *** R038 - ATTEMPT TO EXTRACT ADDITIONAL R268'S           *** 
R038  *** Analyst    : SUSAN WOMELSDORF       11/01/96          *** 
      ***                                                       *** 
R039  *** R039 - ATTEMPT TO EXTRACT ADDITIONAL R268'S           *** 
R039  *** Analyst    : SUSAN WOMELSDORF       11/05/96          *** 
      ***                                                       *** 
R040  *** R040 - DATABASE CHANGE 21                             *** 
R040  *** Analyst    : SUSAN WOMELSDORF       09/04/96          *** 
      ***                                                       *** 
R041  *** R041 - DATABASE CHANGE 22                             *** 
R041  *** Analyst    : SUSAN WOMELSDORF       06/10/97          *** 
      ***                                                       *** 
R042  *** R042 - CORRECT R253 RECIPIENT NBR MOVES               *** 
R042  *** Analyst    : SUSAN WOMELSDORF       10/31/97          *** 
      ***                                                       *** 
M307  *** M307 - UPDATE DATE FIELDS FOR MILLENNIUM              *** 
M307  *** Programmer : BRYAN WARREN           12/16/97          *** 
      ***                                                       *** 
M313  *** M313 - CHANGES FOR DBCH24.                            *** 
M313  *** Analyst    : SUSAN WOMELSDORF       04/09/98          *** 
      ***                                                       *** 
R043  *** R043 - CHANGES FOR DIRECT DELIVERY BANK TABLE SIZE    *** 
R043  *** Analyst    : SUSAN WOMELSDORF       07/28/98          *** 
      ***                                                       *** 
R044  *** R044 - CHANGES FOR NEW FIELSD                         *** 
R044  *** Analyst    : SUSAN WOMELSDORF       10/29/98          *** 
      ***                                                       *** 
M322  *** M322 - DATABASE CHANGE 26 AND BATCH SUBROUTINE CHANGES  ***   
M322  ***               MARY JEAN M DEIMLER    APRIL 1999         ***   
      ***                                                       *** 
R045  *** R045 - CORRECT PRORATED DAYS CALCULATION              *** 
R045  *** Analyst    : SUSAN WOMELSDORF       01/19/2000        *** 
      ***                                                       *** 
R046  *** R046 - DBACHG 29.                                     *** 
R046  *** Analyst    : DOUGLAS L. MCHENRY     10/23/2000        *** 
      ***                                                       *** 
R047  *** R047  - CHECK R396 AGAINST R268 WHEN NO CHANGES IN    *** 
R047  ***         R289 ARE REQUIRED .                           *** 
R047  *** Analyst    : SUSAN WOMELSDORF       01/08/2001        *** 
R047  *** PROGRAMMER : MARIO E. CORDERO       01/08/2001        *** 
      ***                                                       *** 
R048  *** R048  - Eliminate R255 as mandatory record for SC     *** 
R048  *** Analyst    : SUSAN WOMELSDORF       03/21/2001        *** 
      ***                                                       *** 
MD01  *** MD01  - ADD AREA A86X TO PROGRAM.                     *** 
MD01  *** ANALYST    : DOUGLAS MCHENRY        02/11/2002        *** 
MD01  *** PROGRAMMER : DAVID C. ERTWINE       02/11/2002        *** 
MD01  ***                                                       *** 
MD01  ***      -  ADDED MOVES FOR NEW DATABASE FIELDS TO PROC   *** 
MD01  ***         FIELDS.                                       *** 
MD01  ***                     JIM SHELTON          07/29/2002   *** 
      ***                                                       *** 
R049  *** R049 - PROD FIX, MOVE R246 AREA CALC TO AFTER CKPT    *** 
R049  ***               D MCHENRY     09/04/2002                *** 
      ***                                                       *** 
R050  *** R050 - DPSR 18379, TA/TJ 68 CLOSINGS LOGIC.           *** 
R050  ***               D MCHENRY     12/12/2002                *** 
      ***                                                       *** 
R051  *** R051 - DO NOT WRITE HISTORY FOR RECURRING CC PAYMENTS *** 
R051  ***               S WOMELSDORF  12/18/2002                *** 
      ***                                                       *** 
R052  *** R052 - CORRECT 'T' TO 'H'                             *** 
R052  ***               S WOMELSDORF  12/27/2002                *** 
      ***                                                       *** 
CHG33 *** CHG33 - DATA BASE CHANGE 33                           *** 
CHG33 ***               S WOMELSDORF  04/29/2003                *** 
      ***                                                       *** 
MD02  *** MD02  - ADD TCAT TABLE AND CSR40MTCAT FILE FOR USE    *** 
MD02  ***       IN LIMITING THE CREATING OF BENEFIT HISTORY     *** 
MD02  ***       FOR ONLY NON-MEDICAL BUDGETS.                   *** 
MD02  ***           WILLIAM CLAGUE    11/25/2003                *** 
      ***                                                       *** 
MD02  *** MD02  - ADD CODE TO COUNT SSI CATEGORIES A,J,M FOR    *** 
MD02  ***       CASH AND MEDICAL TYPE.  CASH CATEGORIES WILL NOT  * 
MD02  ***       BE PROCESSED MEDICAL BUDGETS, WILL BE CLOSED    *** 
MD02  ***       AND BENEFIT HISTORY WILL BE CREATED.            *** 
MD02  ***           WILLIAM CLAGUE    06/10/2004                *** 
      ***                                                       *** 
CHG35 *** CHG35 - INCREASE THE CATEGORY/PROGRAM STATUS TABLE    *** 
CHG35 ***         TO HOLD NEW SSI CASH CHECK CAT/PS DATA.       *** 
CHG35 ***             MARY JEAN M DEIMLER    OCTOBER  2004      *** 
      ***                                                       *** 
CC37  *** CC37  - Program was changed to move the R247-ADR-EMAIL*** 
      ***         and R672-IND-EXPLOR-SLMB-QI1 to the procs for *** 
      ***         the output files.  Also changed the occurances*** 
      ***         on all category tables to 100 or 600.         *** 
      ***         This database change is to go into production *** 
      ***         June 2006.                                    *** 
      ***                                                       *** 
      ***             Sally Huff             February 2006      *** 
      ***                                                       *** 
R053  *** R053  - DPSR# 018803                                  *** 
      ***         ADD CIS014 SUBROUTINE FOR CLOCKS              *** 
      ***         ADD FILES ATE01D10 (ALERT FILE)               *** 
      ***                   ATE01D11 (CLIENT NOTICE FILE)       *** 
      ***                   ATE01D12 (PD CLOCK DV AND DA FILE)  *** 
      ***                                                       *** 
      ***             MELISSA E. WEBBER      MARCH    2006      *** 
      ***                                                       *** 
R054  *** R054  - Correct clock logic/R13.1                     *** 
      ***                                                       *** 
      ***             MELISSA E. WEBBER      MARCH    2006      *** 
      ***                                                       *** 
R055  *** R055  - Correct clock logic                           *** 
      ***                                                       *** 
      ***             MELISSA E. WEBBER      JANUARY  2007      *** 
      ***                                                       *** 
CC39  *** CC39  - ADDED PRINT CONTROL FOR THE R99 REPORT.  THIS *** 
CC39  ***       WILL PUT THE REPORT OUT ON DOCUSHARE.           *** 
      ***                                                       *** 
CC39  ***             MICHAEL TESSIER          APRIL  2007      *** 
      ***                                                       *** 
R056  *** R056  - PCR# 11589                                    *** 
      ***                                                       *** 
      ***             MELISSA E. WEBBER      JANUARY  2007      *** 
      ************************************************************* 
R057  *** R057  - PCR# 12203                                    *** 
R057  ***       - ADD CODE TO HANDLE PROGRAM STATUS 59.         *** 
      ***                                                       *** 
      ***             MELISSA E. WEBBER      NOVEMBER 2007      *** 
      ************************************************************* 
R058  *** R058  - PCR# 12440                                    *** 
R058  ***       - ADD CODE TO REESTABLISH CURRENCY ON THE R666  *** 
R058  ***       - ON RETURN OF CALL TO CIS014.                  *** 
R058  ***                                                       *** 
R058  ***             JIM COLLINS            12/05/2007         *** 
      ************************************************************* 
R059  *** R059  - PCR# 12481                                    *** 
R059  ***       - PUT IN MOVE OF R666 AREA ON RETURN FROM       *** 
R059  ***       - CIS014.                                       *** 
R059  ***             JIM COLLINS            12/18/2007         *** 
      ************************************************************* 
R060  *** R060  - PCR# 12781                                    *** 
R060  ***       - PUT IN CODE TO BYPASS R666 IF NOT NUMERIC.    *** 
R060  ***       - DISPLAY R666-NBR-CASE IF GENERAL DB ERROR.    *** 
R060  ***             JIM COLLINS            02/20/2008         *** 
R060  ************************************************************* 
R061  *** R061  - PCR# 12729                                    *** 
R061  ***       - LOAD PAYDATE INTO CALL PARAMS FOR CISMOE.     *** 
R061  ***       - CHANGE RECORD LAYOUT FOR ATE01D13 FILE.       *** 
R061  ***             JIM COLLINS            03/12/2008         *** 
R061  ************************************************************* 
R062  *** R062  - PCR# 13149                                    *** 
R062  ***       - PUT IN CODE FOR DEV AND PRL TO FIX THE R634   *** 
R062  ***       - PROGRAM STATUS TO BE 00 IF THERE IS NO MATCH  *** 
R062  ***       - TO THE TCAT TABLE.                            *** 
R062  ***             JIM COLLINS            07/15/2008         *** 
R062  *** R062  - PCR# 12999                                    *** 
R062  ***       - PUT IN CODE TO OUTPUT A FROM DATE IN THE D11  *** 
R062  ***       - FILE WHEN THE WSS-DA-DV-SW IS SET TO 'Y'.     *** 
R062  ***             JIM COLLINS            08/13/2008         *** 
R062  ************************************************************* 
R063  *** R063  - PCR# 13908                                    *** 
R063  ***       - PUT IN CODE TO EXTEND CM CLOSE DATE TO NPD-1  *** 
R063  ***             JIM COLLINS            12/01/2008         *** 
R063  ************************************************************* 
R064  ***       PCR: 14145/14207/13908                          *** 
R064  ***       - PUT IN CODE TO SUPPORT THE WER PROJECT.       *** 
R064  ***       - PUT IN CODE TO NOT PROCESS PROGRAM STATUS     *** 
R064  ***       - 71 OR 72 WHICH ARE TCA PROGRAM STATUS CODES.  *** 
R064  ***             JIM COLLINS            01/20/2009         *** 
R064  ************************************************************* 
CC40  *** CC40  - DATABASE CHANGE 40 DATA                       *** 
CC40  ***                                                       *** 
CC40  ***             DAVID SCHREFFLER         APRIL  2009      *** 
      ************************************************************* 
R065  *** R065  - MAKE CODE CHANGES REQUIRED FOR IV-B PROJECT.  *** 
R065  ***         PCR: 14922                                    *** 
R065  ***       - CHANGE CODE TO ONLY BYPASS Z CODE OVERRIDE IF *** 
R065  ***       - REASON CODE 900 903 OR 906.                   *** 
R065  ***         PCR: 15541                                    *** 
R065  ***         PROGRAMMER: JIM COLLINS  DATE:  08/24/2009    *** 
      ************************************************************* 
R066  *** R066  - ADD CODE TO FETCH THE R637,R653, AND R654     *** 
R066  ***       - RECORDS TO CHECK THE OVERRIDE CODES.          *** 
R066  ***         PCR: 15541                                    *** 
R066  ***         PROGRAMMER: JIM COLLINS  DATE:  12/02/2009    *** 
      ***                                                       *** 
CC41  *** CC41  - PCR 16687 - CHANGE CODE FOR DB CHANGE 41.     *** 
CC41  ***         PCR 16702 - ADDED LOGIC CHANGES TO PROGRAM    *** 
CC41  ***          THE CHANGES ARE REFLECTED BY "TFP".          *** 
CC41  ***            KEITH WINFIELD 05/14/2010                  *** 
CC41B *** CC41B - PCR       - CHANGES FOR 4B RECS WRITE TO D18. *** 
CC41B ***            SUE WOMELSDORF  04/03/3010                 *** 
      ***                                                       *** 
      ************************************************************* 
R067  *** R067  - ADD CODE TO END DATE PRIOR R653 WHEN A FUTURE *** 
R067  ***       - R653 BECOMES CURRENT.                         *** 
R067  ***       - PUT IN CODE TO NOT LOAD CATEGORY AND PROGRAM  *** 
R067  ***       - STATUS INTO CAT PROG STAT TABLE IF THE END    *** 
R067  ***       - DATE IN THE ATE10M01 IS = OR < PAYDATE.       *** 
R067  ***       - ADD A REPORT OF ALL CASES THAT DO NOT MATCH   *** 
R067  ***       - THE CATEGORY PROGRAM STATUS TABLE.            *** 
R067  ***       - CHANGE CHECKPOINT COUNT FROM 7000 TO 2000.    *** 
R067  ***         PCR: 17556/17691                              *** 
R067  ***         PROGRAMMER: JIM COLLINS  DATE:  04/13/2011    *** 
R067  ************************************************************* 
R068  *** R068  - ADD CODE TO STOP FETCHING R653 WHEN END DATE  *** 
R068  ***       - GREATER THAN ZERO.                            *** 
R068  ***         PCR: 17556                                    *** 
R068  ***         PROGRAMMER: JIM COLLINS  DATE:  07/15/2011    *** 
R068  ************************************************************* 
R069  *** R069  - ADD CODE TO SELECT BASED ON R246 INSTEAD OF   *** 
R069  ***       - R666.  REMOVE ALL HISTORY RECORD CREATION.    *** 
R069  ***       - ALL R666 SET RECORDS FOR UPDATE WRITE TO D08  *** 
R069  ***       - FILE.  REMOVE THE DD BANK CHANGE LOGIC.       *** 
R069  ***       - CREATE ATE01D19 FILE TO SAVE THE R99 REPORT   *** 
R069  ***       - TOTALS.  THIS WILL BE INPUT TO ADD01D.        *** 
R069  ***         PCR: 17805                                    *** 
R069  ***         PROGRAMMER: JIM COLLINS  DATE:  08/15/2011    *** 
R069  ************************************************************* 
R070  *** R070  - PUT IN CODE TO SUPPORT THE AUTOMATED DISCONT. *** 
R070  ***       - THIS INVOLVED CREATING SOME NEW NOTICE RECORDS*** 
R070  ***       - ALSO HAD TO SUSPEND AND CLOSE SOME R634       *** 
R070  ***       - RECORDS.  CREATED NEW ALERT RECORDS. PUT IN   *** 
R070  ***       - ATE01D20 FILE TO WRITE RETURN FROM ASBRCE.    *** 
R070  ***       - ADD TDTE-FILE TO DETERMINE THE START OF THE   *** 
R070  ***       - AUTOMATED DISCONTINUANCE PROCESS.             *** 
R070  ***       - IF END DATE = 0 AND BUDGET CLOSE DATE > 0     *** 
R070  ***       - DO NOT PROCESS FOR AUTOMATED DISCONTINUANCE.  *** 
R070  ***       - DO NOT CREATE R291 RECORD IF AMOUNT > 1500.00.*** 
R070  ***         PCR: 18063/18116/18119/18170/18232           ***  
R070  ***         PROGRAMMER: JIM COLLINS  DATE:  12/16/2011    *** 
      ************************************************************* 
R071  ***  ADD CODE TO BYPASS CLOCKS ON FIRST PASS OF PD 477   ***  
R071  ***  CASES.  FROM ONE TIME GA DISCONTINUANCE CONVERSION.,***  
R071  ***  PCR: 25719      JIM COLLINS    DATE: 05/16/2012     ***  
      ************************************************************  
CC43  ***  ADD CODE TO SUPPORT DATA BASE CHANGE 43.            ***  
R072  ***  CHANGE LOCATION OF THE CHECKPOINT LOGIC,            ***  
R072  ***  TASK: 70835     JIM COLLINS    DATE: 04/30/2013     ***  
      ************************************************************  
CC44  ***  ADD CODE TO SUPPORT DATA BASE CHANGE 44.            ***  
CC44  ***  TASK: 647967    JIM COLLINS    DATE: 06/10/2013     ***  
      ************************************************************  
R073  ***  CHANGE MESSAGE CAT FROM 'F' TO 'W' ON MESSAGES THAT ***  
R073  ***  WERE INCORRECTLY INDICATING FATAL AND SHOULD BE     ***  
R073  ***  WARNING.                                            ***  
R073  ***                  CATHY HUTCHINS DATE: 01/23/2014     ***  
      ************************************************************  
CC45  ***  CHANGE TO SUPPORT DB CHANGE 45.                     ***  
CC45  ***  TASK: 889902    JIM COLLINS    DATE: 06/16/2014     ***  
      ************************************************************  
R074  ***  R074 - MAKE CHANGES FOR SAR/LIN CLOSES.             ***  
R074  ***  TASK: 1092360   JIM COLLINS    DATE: 05/20/2015     ***  
      ************************************************************  
CC46  *** CC46 - MOVE R672-IND-CASE-ABAWD TO B-RECORD.         ***  
CC46  ***          MARY JEAN M DEIMLER       MAY  2016         ***  
      ************************************************************  
R075A *** R075 - MA Recidivism                                 ***  
R075A ***          Deepak Singh       Dec  2016                ***  
R075B *** R075B  ADD CODE TO PICKUP THE 6 NEW FIELDS ADDED TO  ***  
R075B *** R075B  CISMOE.  FIELDS IN THE ATE01D13 FILE.         ***  
R075B *** R075B  PROGRAMMER:  JIM COLLINS   DATE: 02/24/2017   ***  
      ************************************************************  
CC47  *** CC47 - CHANGE TO OPEN 40 AREAS FOR R15 RECORDS.      ***  
CC47  ***        PROGRAMMER:  JIM COLLINS   DATE: 08/18/2017   ***  
CC47  ***        TASK 1661022           RELEASE: 22.00         ***  
CC47
CC47A ************************************************************  
CC47A *** CC47 - WO-1027 MA Recidivism Phase 3                 ***  
CC47A ***        Deepak Singh       Sept  2017                 ***  
CC47A *** Evaluate the Auto closure based upon any chnages in  ***  
CC47A *** the reapplication due date                           ***  
CC47A ************************************************************  
R076  *** BUG# 1857068                                         ***  
R076  *** Analyst   :       Deepak Singh       NOV  2018       ***  
R076  *** Developer :       Leandro Fina       NOV  2018       ***  
R076  *** Fix the auto extension for MG/99 budget              ***  
R076  ************************************************************  
R077  *** TASK# 2025265                                        ***  
R077  *** Analyst   :       Deepak Singh       FEB  2019       ***  
R077  *** CHANGES FOR GA CONVERSION NOTICE 474 SPLIT AND CLOSURE *  
R077  ************************************************************  
R078  ***  ASB04B CALL  - SEND STORED OR MODIFIED RECORD INFO  ***  
R078  ***  FOR INCREMENTAL RENEWAL VI-B PROCESS.               ***  
R078  ***  PROGRAMMER/ANALYST  - ALOK DEORANI                  ***  
R078  ***  DATE                - 08/01/2019                    ***  
R078  ***  RELEASE             - ????????????                  ***  
R078  ************************************************************  
R079  ***  CORRECT R634 CHANGE TIME                            ***  
R079  ***  TASK # 2229414 : Stop MG/99 Auto Closure            ***  
R079  ***  FOR INCREMENTAL RENEWAL VI-B PROCESS.               ***  
R079  ***  PROGRAMMER/ANALYST  - DEEPAK SINGH                  ***  
R079  ***  DATE                - 05/01/2020                    ***  
R079  ************************************************************  
R080  ***  TASK# 2249738 - CHANGES TO STOP WER PAYMENTS        ***  
R080  ***  PROGRAMMER/ANALYST  - JEETH YESUDAS                 ***  
R080  ***  DATE                - 06/05/2020                    ***  
R080  ***  RELEASE             - SEP 2020                      ***  
R080  ************************************************************  
R081  ***  TASK# 2678471 - CHANGE TO CREATE NOTICE 976 AND     ***  
R081  ***                - WRITE TO ATE01D11 FILE WHEN CATEGORY***  
R081  ***                - = D AND PROG STATUS = 02 AND        ***  
R081  ***                - DATE-CLOSED-BUDGET > NEXT PAY AND   ***  
R081  ***                - DATE-CLOSED-BUDGET < 2ND PAYDAY.    ***  
R081  ***  PROGRAMMER/ANALYST  - JIM COLLINS                   ***  
R081  ***  DATE                - 08/15/2023                    ***  
R081  ************************************************************  
R082  ***  Bug# 2933416  - Fix issue with 2nd Payday and 3rd   ***  
R082  ***                - Payday dates being incorrectly set  ***  
R082  ***                - to the deadline dates               ***  
R082  ***  PROGRAMMER/ANALYST  - Rowdy Farrell                 ***  
R082  ***  DATE                - 11/21/2023                    ***  
R082  ************************************************************  
      ***                                                 ***   
      *******************************************************   
      ***    ITEMS TO BE CHANGED PRIOR TO PRODUCTION:     ***   
      ***                                                 ***   
      ***     'TEST'    'DESCRIPTION'    'PRODUCTION'     ***   
      ***    1. COMMENT ALL LABELS WITH TEST1 *           ***   
      ***                                                 ***   
      ***                                                 ***   
      *******************************************************   
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.   
       SOURCE-COMPUTER. UNIVAC-1100-80. 
       OBJECT-COMPUTER. UNIVAC-1100-80 MEMORY SIZE 3 MODULES.   
       SPECIAL-NAMES.   
            SWITCH-23 IS SW-ERROR-AFTER-GOOD-DEPART 
                            ON IS SW-ERROR-AFTER-GOOD-DEPART-ON 
            SWITCH-24 IS SW-FATAL-ERROR-FLAG
                            ON IS SW-FATAL-ERROR-ON.

       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT ATE10M01  ASSIGN     TO DISC      ATE10M01
                  ORGANIZATION IS INDEXED   
                  ACCESS MODE IS SEQUENTIAL 
                  RECORD KEY IS ATEKEY. 
R070       SELECT ATE01DCD1  ASSIGN    TO DISC      ATE01DCD1.  
           SELECT ATE20D01  ASSIGN     TO DISC      ATE20D01.   
           SELECT ARM60001  ASSIGN     TO DISC      ARM60001.   
R053       SELECT ARM61001  ASSIGN     TO DISC      ARM61001.   
           SELECT ATE01D01  ASSIGN     TO DISC      ATE01D01.   
R069A *    SELECT ATE01D02  ASSIGN     TO DISC      ATE01D02.   
           SELECT ATE01D04  ASSIGN     TO DISC      ATE01D04.   
           SELECT ATE01D05  ASSIGN     TO DISC      ATE01D05.   
R069A *    SELECT ATE01D06  ASSIGN     TO DISC      ATE01D06.   
R069A *    SELECT ATE01D07  ASSIGN     TO DISC      ATE01D07.   
           SELECT ATE01D08  ASSIGN     TO DISC      ATE01D08.   
           SELECT ATE01D09  ASSIGN     TO DISC      ATE01D09.   
R053       SELECT ATE01D10  ASSIGN     TO DISC      ATE01D10.   
R053       SELECT ATE01D11  ASSIGN     TO DISC      ATE01D11.   
R053       SELECT ATE01D12  ASSIGN     TO DISC      ATE01D12.   
R056       SELECT ATE01D13  ASSIGN     TO DISC      ATE01D13.   
R056       SELECT ATE01D14  ASSIGN     TO DISC      ATE01D14.   
R056       SELECT ATE01D15  ASSIGN     TO DISC      ATE01D15.   
R056       SELECT ATE01D16  ASSIGN     TO DISC      ATE01D16.   
R064       SELECT ATE01D17  ASSIGN     TO DISC      ATE01D17.   
CC41B      SELECT ATE01D18  ASSIGN     TO DISC      ATE01D18.   
R069       SELECT ATE01D19  ASSIGN     TO DISC      ATE01D19.   
R070       SELECT ATE01D20  ASSIGN     TO DISC      ATE01D20.   
R075A      SELECT ATE01D21  ASSIGN     TO DISC      ATE01D21.   
R070       SELECT ATE01DR01 ASSIGN     TO PRINTER   ATE01DR01.  
           SELECT ATE01DR99 ASSIGN     TO PRINTER   ATE01DR99.  
           SELECT ATE01DCKPT ASSIGN    TO DISC      ATE01DCKPT. 
MD02       SELECT TCAT-FILE   ASSIGN TO DISC      CSR40MTCAT.   
R053       SELECT TCLK-FILE   ASSIGN TO DISC      CSR40MTCLK.   
R070       SELECT TARB-FILE   ASSIGN TO DISC      CSR40MTARB.   
R070       SELECT TDTE-FILE   ASSIGN TO DISC      CSR40MTDTE.   

       I-O-CONTROL. 
           RERUN  ON DISC   EVERY       1  RECORDS OF ATE01DCKPT.   


       DATA DIVISION.   
      *** DATA BASE SECTION.
R053       COPY APD003P REPLACING S20MRGPRDM70 BY S20MRGPRDM85. 

      *** FILE SECTION. 
       FILE SECTION.

       FD  ATE01DCKPT   
           LABEL RECORDS ARE STANDARD   
           BLOCK CONTAINS  496  RECORDS 
           RECORD CONTAINS 9 CHARACTERS 
           DATA RECORD IS ATE01DCKPT-RECORD.

       01  ATE01DCKPT-RECORD.   
           05 FILLER                             PIC 9(09). 

      ***  APB093P AND APB403P APPLIES TO FILE ATE10M01 
           COPY APB093P.

           COPY APB403P.
M307  ***  APB161P AND EDR499P APPLIES TO FILE ATE20D01 
           COPY APB161P.

M307       COPY EDR499P.

      ***  APB011P AND APB313P APPLIES TO FILE ARM60001 
           COPY APB011P.

           COPY APB313P.

R070   FD  ATE01DCD1
R070       LABEL  RECORDS  ARE  STANDARD.   
R070   01  ATE01DCD1-REC.   
R070       05  ATE01DCD1-TOT-PCT       PIC 9(02).   
R070       05  ATE01DCD1-CLS-PCT       PIC 9(02).   
R070       05  ATE01DCD1-SUS-PCT       PIC 9(02).   
      ***  EDF016P AND EDR012P APPLIES TO FILE ATE01D01 
           COPY EDF016P.

           COPY EDR012P.

R069A ***  EDF017P AND EDR013P APPLIES TO FILE ATE01D02.      * 
R069A *    COPY EDF017P.
R069A * 
R069A *    COPY EDR013P.
R069A * 
      ***  EDF019P AND EDR015P APPLIES TO FILE ATE01D04.
           COPY EDF019P.

           COPY EDR015P.

      ***  EDF021P AND EDR016P APPLIES TO FILE ATE01D05.
           COPY EDF021P.

           COPY EDR016P.

R069A ***  EDF022P AND EDR017P APPLIES TO FILE ATE01D06.      * 
R069A *    COPY EDF022P.
R069A * 
R069A *    COPY EDR017P.
R069A * 
R069A ***  EDF023P AND EDR018P APPLIES TO FILE ATE01D07.      * 
R069A *    COPY EDF023P.
R069A * 
R069A *    COPY EDR018P.
R069A * 
      ***  EDF073P AND EDR073P APPLIES TO FILE ATE01D08.
           COPY EDF073P.

           COPY EDR073P.

      ***  EDF121P AND EDR121P APPLIES TO FILE ATE01D09.
           COPY EDF121P.

           COPY EDR121P.

R053  ***  FILE ATE01D10.   
R053   COPY CCM015P REPLACING  CCM02D01 BY ATE01D10.
R053   COPY CCM016P REPLACING ALERT-REC BY ATE01D10-RECORD. 
R053
R053  ***  FILE ATE01D11.   
R053   FD  ATE01D11 
R053       LABEL RECORDS STANDARD   
R053       DATA RECORD IS ATE01D11-RECORD.  
R053
R053   01  ATE01D11-RECORD. 
R053       05 D11-NBR-CASE. 
R053          10 D11-CDE-COUNTY        PIC 9(002).  
R053          10 D11-NBR-RECORD        PIC 9(007).  
R053       05 D11-CDE-CATEGORY         PIC X(003).  
R053       05 D11-NBR-GG               PIC X(001).  
R053       05 D11-CDE-TYPE-NOTICE      PIC X(001).  
R053       05 D11-CDE-RSN-NOTICE       PIC 9(003).  
R053       05 D11-CDE-OPTION-NOTICE    PIC X(001).  
R062       05 D11-FROM-DATE            PIC 9(008).  
R070       05 D11-TO-DATE              PIC 9(008).  
R081       05  SDX-AMOUNT              PIC 9(04)V99.
R081       05  FROM-AMOUNT             PIC 9(04)V99.
R081       05  TO-AMOUNT               PIC 9(04)V99.
R081       05  660-3-RCPT              PIC 9(09).   
R081       05  POP-BUCKET              PIC X(01).   
R081       05  MNGD-CARE-PLAN-CDE      PIC X(02).   
R053
R053  ***  FILE ATE01D12.   
R053   FD  ATE01D12 
R053       LABEL RECORDS STANDARD   
R053       DATA RECORD IS ATE01D12-RECORD.  
R053
R053   COPY EDR223P REPLACING BNFT-RECORD BY ATE01D12-RECORD.   
R053
R056   FD  ATE01D13 
R056       LABEL RECORDS STANDARD   
R056       DATA RECORD IS ATE01D13-RECORD.  
R056
R056   01  ATE01D13-RECORD. 
R056       05  D13-CISMOE-ERR          PIC 9(04).   
R056       05  D13-CISMOE-WPR-STATUS   PIC X(01).   
R056       05  D13-CISMOE-CASE         PIC 9(09).   
R056       05  D13-CISMOE-CAT          PIC X(03).   
R056       05  D13-CISMOE-GG           PIC X(01).   
R056       05  D13-CISMOE-PROG-STAT    PIC 9(02).   
R056       05  D13-CISMOE-NEW-PROG-STAT PIC 9(02).  
R061       05  D13-CISMOE-PAY-DATE      PIC 9(07).  
R061       05  D13-CISMOE-CHILD-COMMON  PIC X(01).  
R056       05  D13-CISMOE-CNT          PIC 9(02).   
R056       05  D13-CISMOE-RCPT         PIC 9(09).   
R056       05  D13-CISMOE-AGE          PIC 9(03).   
R056       05  D13-CISMOE-PARENT       PIC X(01).   
R056       05  D13-CISMOE-ELIG         PIC X(02).   
R056       05  D13-CISMOE-ETP          PIC 9(02).   
R061       05  D13-CISMOE-GOOD-CAUSE   PIC 9(02).   
R056       05  D13-CISMOE-PROJ         PIC X(01).   
R056       05  D13-CISMOE-WK-HRS       PIC 9(04).   
R056       05  D13-CISMOE-SELF-EMPL    PIC 9(04).   
R061       05  D13-CISMOE-PROJ-CORE-HRS  PIC 9(04). 
R061       05  D13-CISMOE-PROJ-NON-HRS   PIC 9(04). 
R056       05  D13-CISMOE-LINE-NO      PIC 9(02).   
R061       05  D13-CISMOE-PARENT-LINE-1  PIC 9(02). 
R061       05  D13-CISMOE-PARENT-LINE-2  PIC 9(02). 
R056       05  D13-CISMOE-PROJ-B       PIC X(01).   
R061       05  D13-CISMOE-SSI-FLAG     PIC X(01).   
R061       05  D13-CISMOE-SCHOOL-FLAG  PIC X(01).   
R061       05  D13-CISMOE-SSI-PAR-1    PIC X(01).   
R061       05  D13-CISMOE-SSI-PAR-2    PIC X(01).   
R061       05  D13-CISMOE-WPR-RCPT     PIC X(01).   
R075B      05  D13-CISMOE-CITIZEN-CDE  PIC 9(01).   
R075B      05  D13-CISMOE-HAVE-EA-JAM  PIC X(01).   
R075B      05  D13-CISMOE-HAVE-ETP-22  PIC X(01).   
R075B      05  D13-CISMOE-HAVE-ETP-54  PIC X(01).   
R075B      05  D13-CISMOE-HAVE-ELG-SSI-PAR  PIC X(01).  
R075B      05  D13-CISMOE-HAVE-PAR-54       PIC X(01).  
R056
R056   FD  ATE01D14 
R056       LABEL RECORDS STANDARD   
R056       DATA RECORD IS ATE01D14-RECORD.  
R056
R056   COPY EDR505P REPLACING ATE02D05-RECORD BY ATE01D14-RECORD.   
R056
R056   FD  ATE01D15 
R056       LABEL RECORDS STANDARD   
R056       DATA RECORD IS ATE01D15-RECORD.  
R056
R056   01  ATE01D15-RECORD. 
R056       05  D15-CISMOE-CASE         PIC 9(09).   
R056       05  D15-CISMOE-CAT          PIC X(03).   
R056       05  D15-CISMOE-GG           PIC X(01).   
R056       05  D15-CISMOE-PREV-STAT    PIC 9(02).   
R056       05  D15-CISMOE-PROG-STAT    PIC 9(02).   
R056       05  D15-CISMOE-CO           PIC 9(02).   
R056       05  D15-CISMOE-DIST         PIC X(01).   
R056       05  D15-CISMOE-CSLD         PIC 9(04).   
R056       05  D15-CISMOE-PMT-NAME     PIC X(26).   
R056
R056   COPY EDF507P REPLACING ATE02D07 BY ATE01D16. 
R056   COPY EDR507P REPLACING   
R056                      ATE02D07-REC BY ATE01D16-RECORD   
R056                ATE02D07-RECIPIENT BY ATE01D16-RECIPIENT
R056                 ATE02D07-NBR-CASE BY ATE01D16-NBR-CASE 
R056                  ATE02D07-CDE-CAT BY ATE01D16-CDE-CAT  
R056                   ATE02D07-NBR-GG BY ATE01D16-NBR-GG   
R056                ATE02D07-CTL-DIGIT BY ATE01D16-CTL-DIGIT
R056                ATE02D07-NBR-TRANS BY ATE01D16-NBR-TRANS
R056             ATE02D07-DTE-BGN-EFFV BY ATE01D16-DTE-BGN-EFFV 
R056             ATE02D07-DTE-END-EFFV BY ATE01D16-DTE-END-EFFV 
R056                 ATE02D07-DTE-CHNG BY ATE01D16-DTE-CHNG 
R056                ATE02D07-TIME-ACTN BY ATE01D16-TIME-ACTN.   
R056
R064  ***    PROCS FOR ATE01D17          ***
R064       COPY  IEVS72P REPLACING  DXS33701 BY ATE01D17
R064                  DXS33701-REC  BY  ATE01D17-RECORD.

CC41B  FD  ATE01D18 
CC41B      LABEL RECORDS STANDARD   
CC41B      DATA RECORD IS ATE01D18-RECORD.  

CC41B  01  ATE01D18-RECORD. 
CC41B      05  D18-KEY                 PIC 9(09).   
CC41B      05  D18-TYPE                PIC X(01).   
CC41B      05  D18-EXIST               PIC X(01).   
CC41B      05  D18-PROG-ID             PIC X(08).   
R078       05  D18-EXP-DIRUPD-FLAG     PIC X(01).   
CC41B      05  D18-REC-CDE             PIC X(04).   
R067   FD  ATE01DR01
R067       LABEL  RECORDS  ARE  STANDARD.   
R067   01  ATE01DR01-REC               PIC X(132).  
R069  **  COPY PROCS FOR ATE01D19 FILE  **  
R069       COPY  EDF299P.   
R069       COPY  EDR299P.   

R070   FD  ATE01D20 
R070       LABEL  RECORDS  ARE  STANDARD.   
R070   01  ATE01D20-RECORD. 
R070       05  ATE01D20-CASE           PIC 9(09).   
R070       05  ATE01D20-CAT            PIC X(03).   
R070       05  ATE01D20-GG             PIC X(01).   
R070       05  ATE01D20-CYCLE-DATE     PIC 9(07).   
R070       05  ATE01D20-TYPE           PIC X(03).   
R070       05  ATE01D20-EXCEPT         PIC X(01).   
R075A ** MA RECIDIVISM NEW LOG FILE FOR EXTENDED BUDGETS
R075A  FD  ATE01D21 
R075A      LABEL  RECORDS  ARE  STANDARD.   
R075A  01  ATE01D21-RECORD. 
R075A      05  ATE01D21-CASE           PIC X(09).   
R075A      05  ATE01D21-CAT            PIC X(03).   
R075A      05  ATE01D21-GG             PIC X(01).   
R075A      05  ATE01D21-PS             PIC X(02).   
R075A      05  ATE01D21-REAPP-OLD      PIC X(07).   
R075A      05  ATE01D21-REAPP-NEW      PIC X(07).   
R075A **
       FD  ATE01DR99
           LABEL RECORDS STANDARD   
           DATA RECORD IS ATE01DR99-RECORD. 

       01  ATE01DR99-RECORD.
           05 FILLER                             PIC X(132).

MD02  *** COPY PROCS FOR CSR40MTCAT 
MD02       COPY TBF010P.
MD02       COPY TBL010P.
MD02
R053  *** COPY PROCS FOR CSR40MTCLK 
R053   FD  TCLK-FILE
R053       LABEL RECORDS STANDARD   
R053       BLOCK CONTAINS 1 RECORDS 
R053       DATA RECORD IS CSR40MTCLK-REC.   
R053
R053       COPY TBL237P.
R070  ********* COPY PROCS FOR CSR40MTARB   *****   
R070       COPY  TBF290P.   
R070       COPY  TBL290P.   
R070   FD  TDTE-FILE
R070       LABEL  RECORDS  ARE  STANDARD
R070       BLOCK  CONTAINS  20  RECORDS.
R070       COPY  TBL238P.   
R053  *    FD  -  ARM61001  *   
R053   COPY  APB077P.   
R053  *    01 LEVEL  -  ARM61001  RECORD  DESCRIPTION  *
R053   COPY  APB383P.   
R053
       WORKING-STORAGE SECTION. 

MD02   01  WSS-JAM-CASH-FLAG           PIC X(01).   
MD02       88  JAM-CASH-CATE           VALUE 'Y'.   
MD02   01  WSS-JAM-MEDI-FLAG           PIC X(01).   
MD02       88  JAM-MEDI-CATE           VALUE 'Y'.   
MD02   01  WSA-JAM-CASH-CNT           PIC 9(06) VALUE ZERO. 
MD02   01  WSA-JAM-MEDI-CNT           PIC 9(06) VALUE ZERO. 
      ********************************************  
      *** DATABASE NAMES                       ***  
      ********************************************  
       77  WSH-AREA-A80X               USAGE AREA-NAME  .   
       77  WSH-AREA-A81X               USAGE AREA-NAME  .   
       77  WSH-AREA-A84X               USAGE AREA-NAME  .   
MD01   77  WSH-AREA-A86X               USAGE AREA-NAME  .   
CC43   77  WSH-AREA-A94X               USAGE AREA-NAME  .   

      **************************************************
      ***  RECORD NAMES.                             ***
      **************************************************
       77  WSH-RECORD-NAME             USAGE RECORD-NAME.   
R027   77  WSH-SET-NAME                USAGE SET-NAME.  

       77  WSH-R666-NAME               USAGE RECORD-NAME VALUE  
                                          'R666-AE-CASE'.   
       77  WSH-R672-NAME               USAGE RECORD-NAME VALUE  
                                          'R672-CASE-ATTRIBS'.  
       77  WSH-R247-NAME               USAGE RECORD-NAME VALUE  
                                          'R247-CASE-ADDRESS'.  
       77  WSH-R248-NAME               USAGE RECORD-NAME VALUE  
                                          'R248-CASE-NAME'. 
       77  WSH-R254-NAME               USAGE RECORD-NAME VALUE  
                                          'R254-SECOND-CASE-NAME'.  

       77  WSH-R246-NAME               USAGE RECORD-NAME VALUE  
                                          'R246-CM-CASE'.   
       77  WSH-R249-NAME               USAGE RECORD-NAME VALUE  
                                          'R249-CASH-MEDICAL-BUDGET'.   
       77  WSH-R634-NAME               USAGE RECORD-NAME VALUE  
                                          'R634-CM-BUDGET-INFO'.
       77  WSH-R252-NAME               USAGE RECORD-NAME VALUE  
                                          'R252-ALTERNATE-ADDRESS'. 
       77  WSH-R253-NAME               USAGE RECORD-NAME VALUE  
                                          'R253-ALTERNATE-PAYEE'.   
       77  WSH-R255-NAME               USAGE RECORD-NAME VALUE  
                                          'R255-CASH-GRANT'.
       77  WSH-R269-NAME               USAGE RECORD-NAME VALUE  
                                          'R269-ALT-PAYEE-NAME2'.   
       77  WSH-R260-NAME               USAGE RECORD-NAME VALUE  
                                          'R260-BULK-MAILING'.  
       77  WSH-R268-NAME               USAGE RECORD-NAME VALUE  
                                          'R268-BUDGET-MEMBER-RELATION'.

       77  WSH-R251-NAME               USAGE RECORD-NAME VALUE  
                                          'R251-SUSPENSION'.
       77  WSH-R256-NAME               USAGE RECORD-NAME VALUE  
                                          'R256-SPECIAL-ALLOWANCE'. 
       77  WSH-R257-NAME               USAGE RECORD-NAME VALUE  
                                          'R257-NET-INCOME'.
       77  WSH-R258-NAME               USAGE RECORD-NAME VALUE  
                                          'R258-RECOUPMENT-REFERRAL'.   
       77  WSH-R259-NAME               USAGE RECORD-NAME VALUE  
                                          'R259-VENDOR-PAYMENT'.

       77  WSH-R637-NAME               USAGE RECORD-NAME VALUE  
                                          'R637-CMBDGT-EP'. 
       77  WSH-R653-NAME               USAGE RECORD-NAME VALUE  
                                          'R653-CM-RESULT'. 
       77  WSH-R654-NAME               USAGE RECORD-NAME VALUE  
                                          'R654-CM-OVRD'.   

R027   77  WSH-S105-NAME               USAGE SET-NAME VALUE 
R027                                      'S105-CM-BDGT-INFO'.  
CC43       COPY  DBW020P.   
MD01  ********************************************  
MD01  *** WS FOR R246 AREA CALCULATION.        ***  
MD01  ********************************************  
MD01   COPY CLW246P.

      ********************************************  
      *** WS FOR DMS ERROR DISPLAY.            ***  
      ********************************************  
       COPY APD303P.

      ********************************************  
      *** WS FOR CYCLE DATE SUB ASB001.        ***  
      ********************************************  
       COPY  AE0024P.   

      ********************************************  
      *** WS FOR BATCH CONTROL FILE SUB ASB002 ***  
      ********************************************  
       COPY  APB303P.   

      ********************************************  
      *** WS FOR SYSTEM MSG DISPLAY SUB ASB003.***  
      ********************************************  
       COPY  APB301P.   

      ********************************************  
      *** WS FOR DATE CONVERSIONS.             ***  
      ********************************************  
M307   COPY  MIL001P.   

      ********************************************  
      *** WS FOR DATE ARITHMETIC               ***  
      ********************************************  
M307   COPY  MIL011P.   

      ********************************************  
      *** WS FOR PROJECT NOTE 29. BNFT HST AREA***  
      ********************************************  
       COPY  APD304P.   

      ********************************************  
      *** WS FOR NALOAD/NAUNLD PROCESS.        ***  
      ********************************************  
       COPY APD307P.

      ********************************************  
      *** WS FOR PRORATION PROCESS .           ***  
      ********************************************  
       COPY APR308P.
R070  ********************************************  
R070  *** PROC FOR ASBRCE SUBROUTINE.          ***  
R070  ********************************************  
R070   COPY APBRCEP.
R053   COPY CIS014P.
R056   COPY CISMOEP.
R067   01  WSH-HOLD-PS         PIC 9(02).   
R069   01  WSH-RUN-FLAG        PIC X(03).   
R069   01  WSS-R246-EOA        PIC X(01).   
R069   01  WSI-CO              PIC 9(02).   
R069   01  WSI-CAT             PIC 9(03).   
R069   01  WSH-RUN-NAME        PIC X(06)  VALUE 'ATE01D'.   

TEST  *01  WS-DISP-PAGE        PIC 9(08).   
      ******************************************************************
      *  REQUIRED FOR THE ASB004 PROCEDURE.  THIS WILL ASSIGN, USE AND *
      *  FREE THE REPORTS.                                             *
      ******************************************************************
CC39   COPY APB300P.

R066   01  WSS-R654-FOUND              PIC X(01).   
CC39   01  WS-FILE-NAME.
CC39       05  FILLER                   PIC X(07) VALUE 
CC39           'ATE01DR'.   
CC39       05  WS-FILE-REPORT-NO        PIC X(02) VALUE '99'.   
CC39       05  WS-FILE-EXT              PIC X(03) VALUE 'XST'.  
R069   01  WSF-FILE-NAME.   
R069       05  FILLER                   PIC X(07) VALUE 
R069           'ATE01DR'.   
R069       05  WSF-FILE-REPORT-NO        PIC X(02) VALUE '99'.  
R069       05  WSF-FILE-EXT              PIC X(03) VALUE 'FST'. 

MD02   01  WSS-TCAT-FOUND-SW           PIC X(01).   
MD02       88  TCAT-FOUND                       VALUE 'Y'.  
MD02       88  TCAT-NOT-FOUND                   VALUE 'N'.  
R053   01  WSS-DA-DV-SW                PIC X(01).   
R053       88  NO-DA-DV                         VALUE 'N'.  
R053       88  YES-DA-DV                        VALUE 'Y'.  
R053   01  WSS-TCLK-FOUND-SW           PIC X(01).   
R053       88  TCLK-FOUND                       VALUE 'Y'.  
R053       88  TCLK-NOT-FOUND                   VALUE 'N'.  
R053   01  WSS-ARM-FOUND-SW            PIC X(01).   
R053       88  ARM-FOUND                        VALUE 'Y'.  
R053       88  ARM-NOT-FOUND                    VALUE 'N'.  
R053   01  TCLK-SUB                    PIC 9(05) COMP.  
R056   01  TANIF-WS-SUB                PIC 9(02) COMP.  
R056   01  TANIF-NEW-STUS-PROG         PIC 9(02).   
R056   01  TANIF-BGN-R634              PIC 9(07).   
R079   01  WS-SUB-EXTN                 PIC 9(03) VALUE ZEROES.  
R079   01  WS-SUB-EXTN-TOT             PIC 9(03) VALUE ZEROES.  
R053   01  ARM-MM-SUB                  PIC 9(02) COMP.  
R053   01  ARM-PAY-SUB                 PIC 9(02) COMP.  
R053   01  TCLK-OCCURS-COUNT           PIC 9(05) COMP.  
R053   01  TCLK-TABLE-MAX              PIC 9(05) COMP VALUE 5.  
R056   01  WS-TANIF-WS-REC             PIC X(01).   
R056       88  WS-YES-TANIF-WS                   VALUE 'Y'. 
R056       88  WS-NO-TANIF-WS                    VALUE 'N'. 
R053   01  WS-SWT-MORE-TCLK-RECS       PIC X(01).   
R053       88  WS-CND-NO-MORE-TCLK-RECS           VALUE 'N'.
R053   01  WS-SWT-TCLK-FOUND           PIC X(01).   
R053       88  WS-CND-TCLK-FOUND                  VALUE 'Y'.
R053   01  WSS-CLOCK-INDIV-SW          PIC X(01).   
R053       88  YES-CLOCK-INDIV                    VALUE 'Y'.
R053       88  NO-CLOCK-INDIV                     VALUE 'N'.
R053   01  WSS-ALERT-NOTICE-SW         PIC X(01).   
R053       88  YES-ALERT-NOTICE                  VALUE 'Y'. 
R053       88  NO-ALERT-NOTICE                   VALUE 'N'. 
R053   01  WSS-CLOSE-CLOCK-SW          PIC X(01).   
R053       88  YES-CLOSE-CLOCK                   VALUE 'Y'. 
R053       88  NO-CLOSE-CLOCK                    VALUE 'N'. 
R077   01  WSS-CLOSE-CLOCK-SW-D        PIC X(01).   
R077       88  YES-CLOSE-CLOCK-D                 VALUE 'Y'. 
R077       88  NO-CLOSE-CLOCK-D                  VALUE 'N'. 
R077   01  WSS-CLOSE-CLOCK-SW-PD       PIC X(01).   
R077       88  YES-CLOSE-CLOCK-PD                VALUE 'Y'. 
R077       88  NO-CLOSE-CLOCK-PD                 VALUE 'N'. 
R077   01  WSS-ALERT-NOTICE-SW-D       PIC X(01).   
R077       88  YES-ALERT-NOTICE-D                VALUE 'Y'. 
R077       88  NO-ALERT-NOTICE-D                 VALUE 'N'. 
R077   01  WSS-ALERT-NOTICE-SW-PD      PIC X(01).   
R077       88  YES-ALERT-NOTICE-PD               VALUE 'Y'. 
R077       88  NO-ALERT-NOTICE-PD                VALUE 'N'. 
R053   01  HOLD-CALC-JUL.   
R053       05  CALC-JUL-YY             PIC 9(04).   
R053       05  CALC-JUL-DD             PIC 9(03).   
R053   01  HOLD-CALC-JUL-R   REDEFINES HOLD-CALC-JUL PIC 9(07). 
R053   01  HOLD-CALC-CURR-JUL.  
R053       05  CALC-CURR-JUL-YY        PIC 9(04).   
R053       05  CALC-CURR-JUL-DD        PIC 9(03).   
R053   01  HOLD-CALC-CURR-JUL-R  REDEFINES HOLD-CALC-CURR-JUL PIC 9(07).
R053   01  HOLD-CALC-P2-JUL.
R053       05  CALC-P2-JUL-YY          PIC 9(04).   
R053       05  CALC-P2-JUL-DD          PIC 9(03).   
R053   01  HOLD-CALC-P2-JUL-R     REDEFINES HOLD-CALC-P2-JUL PIC 9(07). 
R053   01  HOLD-OVER-DAYS              PIC 9(03).   
R053   01  HOLD-NEXT-JUL.   
R053       05  NEXT-JUL-YY             PIC 9(04).   
R053       05  NEXT-JUL-DD             PIC 9(03).   
R053   01  HOLD-NEXT-JUL-R   REDEFINES HOLD-NEXT-JUL PIC 9(07). 
R053   01  HOLD-TBL-KEY                PIC X(06).   
R053   01  HOLD-GA-DAYS                PIC 9(04).   
R053   01  HOLD-GA-DAYS-LEFT           PIC 9(04).   
CC47A  01  WS-OPEN-REAPP-GAP           PIC 9(04).   
R075A  01  HOLD-INCARC-DAYS            PIC 9(04).   
R075A  01  WS-NO-OF-AUTO-EXTNS         PIC S9(01) VALUE 0.  
R075A  01  WS-MG99-AUTO-RENEW          PIC 9(04) VALUE ZEROES.  
R075A  01  WS-MG99-CLOSURE             PIC 9(04) VALUE ZEROES.  
R053   01  HOLD-PAYDAY-DIFF            PIC 9(04).   
R053   01  HOLD-GA-EXP-DATE            PIC 9(07).   
R053   01  HOLD-ALERT-DATE             PIC 9(07).   
MD02   01  MC-IDX                      PIC 9(03) VALUE ZEROES.  
MD02   01  WS-CATE                     PIC X(03).   
MD02   01  WS-TCAT-PGM                 PIC X(01).   
MD02
R064   01  WSH-R268-FIRST-RCPT      PIC 9(09).  
R062   01  WSH-GA-EXP-DATE             PIC 9(07).   
R062   01  WSH-GA-EXP-GREG. 
R062       05  WSH-GA-EXP-MM           PIC 9(02).   
R062       05  WSH-GA-EXP-DD           PIC 9(02).   
R062       05  WSH-GA-EXP-YY           PIC 9(04).   
R062   01  WSH-GA-EXP-GREG-N  REDEFINES  WSH-GA-EXP-GREG  PIC 9(08).
R070   01  WSH-TDTE-BEG-DTE            PIC 9(08).   
R070   01  WSH-CDE-REASON-STUS         PIC 9(03).   
R070   01  WSS-AUTO-FOUND              PIC X(01).   
R070   01  WSS-AUTO-MAX                PIC 9(03) VALUE 200. 
R070   01  WSS-AUTO-SS                 PIC 9(03).   
R070   01  WSS-AUTO-LOAD               PIC 9(03).   
R070   01  WST-AUTO-DISC-TOTALS.
R070       05  WST-AUTO-DISC-ITEM  OCCURS  200  TIMES.  
R070           10  WST-AUTO-CNTY               PIC 9(02).   
R070           10  WST-AUTO-DIST               PIC X(01).   
R070           10  WST-AUTO-CASES              PIC 9(08).   
R070           10  WST-AUTO-REDET              PIC 9(08).   
R070           10  WST-AUTO-BYPASS             PIC 9(08).   
R070           10  WST-AUTO-EXCEPT             PIC 9(08).   
R070           10  WST-AUTO-NO-ACTN            PIC 9(08).   
R070           10  WST-AUTO-CASH-NO            PIC 9(08).   
R070           10  WST-AUTO-CASH-EX            PIC 9(08).   
R070           10  WST-AUTO-MA-NO              PIC 9(08).   
R070           10  WST-AUTO-MA-EX              PIC 9(08).   
R070           10  WST-AUTO-EXEMPT             PIC 9(08).   
R070           10  WST-AUTO-CLOSED             PIC 9(08).   
R070           10  WST-AUTO-SUSPEND            PIC 9(08).   
MD02   01  WSS-TCAT-FILE-SW            PIC X(01).   
MD02       88  END-OF-TCAT-FILE                  VALUE 'Y'. 
MD02       88  NOT-END-OF-TCAT-FILE              VALUE 'N'. 
MD02   01  TCAT-OCCURS-COUNT                  PIC 9(10) COMP.   
MD02   01  TCAT-TABLE-MAX                     PIC 9(10) COMP VALUE 100. 
MD02
MD02   01  TCAT-TABLE.  
MD02       05 TCAT-LEVEL OCCURS 1 TO 100 TIMES  
MD02                     DEPENDING ON TCAT-OCCURS-COUNT 
MD02                     ASCENDING KEY IS TCAT-CDE-CATEGORY 
MD02                     INDEXED BY TCAT-IDX.   
MD02
MD02          10 TCAT-CDE-CATEGORY            PIC X(03).
MD02          10 TCAT-TXT-DESCRIPTION         PIC X(50).
MD02          10 TCAT-SHORT-DESC              PIC X(11).
MD02          10 TCAT-TCAT-PGM                PIC X(01).
R053
R053   01  TCLK-TABLE.  
R075A *    05 TCLK-LEVEL OCCURS 2 TIMES 
R075A      05 TCLK-LEVEL OCCURS 3 TIMES 
R053                     ASCENDING KEY IS TCLK-TBL-KEY  
R053                     INDEXED BY TCLK-IDX.   
R053          10 TCLK-TBL-KEY                 PIC X(06).
R053          10 TCLK-TBL-DESCRIPTION         PIC X(60).
R053          10 TCLK-TBL-PERIOD              PIC X(04).
R053
R071   01  WSH-PRIOR-MO                PIC 9(02).   
R071   01  WSH-GA-PREV-DTE. 
R071       05  WSH-GA-PREV-CC           PIC 9(02).  
R071       05  WSH-GA-PREV-YYDDD       PIC 9(05).   
R071   01  WSH-GA-PREV-DTE-N  REDEFINES  WSH-GA-PREV-DTE PIC 9(07). 
R053   01  PREV-RECORD. 
R053       05  PREV-GRP-MONTHS-PAYMENT        OCCURS  12.   
R053           10  PREV-NBR-MONTH-PAYDAY      PIC 9(02).
R053           10  PREV-GRP-DATES-PAYDAY      OCCURS  23.   
R053               15  PREV-DTE-DEADLINE      PIC 9(05).
R053               15  PREV-DTE-HOLD-BENEFIT
R053                                          PIC 9(05).
R053               15  PREV-DTE-PMT-SUPPL     PIC 9(05).
R053               15  PREV-DTE-PMT-RECUR     PIC 9(05).
R053
R070   01  WSH-PRIOR-END-DTE.   
R070       05  WSH-PRIOR-CCYY          PIC 9(04).   
R070       05  WSH-PRIOR-MM            PIC 9(02).   
R070       05  WSH-PRIOR-DD            PIC 9(02).   
R070   01  WSH-PRIOR-END-N  REDEFINES  WSH-PRIOR-END-DTE  PIC 9(08).
R070   01  WSH-PRIOR-JUL               PIC 9(07).   
R075A  01  S634-DTE-DUE-REDET               PIC 9(07).  
R075A  01  W634-DTE-DUE-REDET               PIC 9(08).  
R075A  01  W634-DTE-DUE-REDETX REDEFINES
R075A      W634-DTE-DUE-REDET.  
R075A      05  W634-REDET-GRG-YY            PIC 9(04).  
R075A      05  W634-REDET-GRG-MM            PIC 9(02).  
R075A      05  W634-REDET-GRG-DD            PIC 9(02).  
R075A  01  WS-REMAINDER                    PIC 9(01).   
R075A  01  WS-LEAP-YEAR                    PIC 9(03).   
R075A  01  WS-EOM-TABLEX                   PIC X(24)
R075A                      VALUE '312831303130313130313031'.
R075A  01  WS-EOM-TABLE REDEFINES WS-EOM-TABLEX.
R075A      05 WS-EOM OCCURS 12 TIMES       PIC 9(02).   
      ************************************************  
      *** WORKING STORAGE ACCUMULATORS & COUNTERS. ***  
      ************************************************  
       01  WSA-ACCUMULATORS.
      *** GENERAL COUNTS
           05 WSA-GENERAL-COUNTERS. 
              10 WSA-MAID-ONLY-CNT               PIC 9(8)  VALUE 0. 
R056
R056       05 WSA-CISMOE-CALL-CNT                PIC 9(8)  VALUE 0. 
R056       05 WSA-CISMOE-X-CNT                   PIC 9(8)  VALUE 0. 
R056       05 WSA-CISMOE-Y-CNT                   PIC 9(8)  VALUE 0. 
R056       05 WSA-CISMOE-N-CNT                   PIC 9(8)  VALUE 0. 
R056       05 WSA-CISMOE-ERROR-CNT               PIC 9(8)  VALUE 0. 
R067       05 WSA-CAT-PSC-DROP                   PIC 9(8)  VALUE 0. 
R056
      *** COUNT NO OF RECORDS IN INPUT FILES.   
           05 WSA-FILE-IN-COUNTERS. 
              10 WSA-ARM60001-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE10M01-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE20D01-REC-CNT            PIC 9(8)  VALUE 0. 

      *** COUNT NO OF GROSS RECORDS IN OUTPUT FILES.
           05 WSA-FILE-OUT-COUNTERS.
              10 WSA-ATE01D01-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D02-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D04-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D05-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D06-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D07-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D08-REC-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D09-REC-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D10-REC-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D11-REC-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D12-REC-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D13-REC-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D14-REC-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D15-REC-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D16-REC-CNT            PIC 9(8)  VALUE 0. 
R064          10 WSA-ATE01D17-REC-CNT            PIC 9(8)  VALUE 0. 
CC41B         10 WSA-ATE01D18-REC-CNT            PIC 9(8)  VALUE 0. 
R069          10 WSA-ATE01D19-REC-CNT            PIC 9(8)  VALUE 0. 
R070          10 WSA-ATE01D20-REC-CNT            PIC 9(8)  VALUE 0. 
R075A         10 WSA-ATE01D21-REC-CNT            PIC 9(8)  VALUE 0. 

      *** COUNT NO OF BLOCK RECORDS IN OUTPUT FILES.
           05 WSA-FILE-BLK-COUNTERS.
              10 WSA-ATE01D01-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D02-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D04-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D05-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D06-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D07-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D08-BLK-CNT            PIC 9(8)  VALUE 0. 
              10 WSA-ATE01D09-BLK-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D10-BLK-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D11-BLK-CNT            PIC 9(8)  VALUE 0. 
R053          10 WSA-ATE01D12-BLK-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D13-BLK-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D14-BLK-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D15-BLK-CNT            PIC 9(8)  VALUE 0. 
R056          10 WSA-ATE01D16-BLK-CNT            PIC 9(8)  VALUE 0. 
R064          10 WSA-ATE01D17-BLK-CNT            PIC 9(8)  VALUE 0. 
CC41B         10 WSA-ATE01D18-BLK-CNT            PIC 9(8)  VALUE 0. 
R069          10 WSA-ATE01D19-BLK-CNT            PIC 9(8)  VALUE 0. 
R070          10 WSA-ATE01D20-BLK-CNT            PIC 9(8)  VALUE 0. 
R075A         10 WSA-ATE01D21-BLK-CNT            PIC 9(8)  VALUE 0. 

      *** CHECKPOINT DATA COUNTERS  
           05 WSA-CHKPT-COUNTERS.   
              10 WSA-R666-CHKPT-REC-CNT          PIC 9(8)  VALUE 0. 
              10 WSA-CHKPT-CNT                   PIC 9(8)  VALUE 0. 

      *** COUNT NO OF RECORDS IN ALL ACCESSED DB RECORDS
           05 WSA-DB-REC-COUNTERS.  
              10 WSA-R666-COUNTS.   
                 15 WSA-R666-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R672-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R247-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R248-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R254-REC-CNT             PIC 9(8)  VALUE 0. 

              10 WSA-R246-COUNTS.   
                 15 WSA-R246-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R249-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R634-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R252-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R253-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R255-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R269-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R260-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R268-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R251-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R256-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R257-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R258-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R259-REC-CNT             PIC 9(8)  VALUE 0. 

              10 WSA-R637-COUNTS.   
                 15 WSA-R637-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R653-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R654-REC-CNT             PIC 9(8)  VALUE 0. 

              10 WSA-R270-COUNTS.   
                 15 WSA-R270-REC-CNT             PIC 9(8)  VALUE 0. 
                 15 WSA-R271-REC-CNT             PIC 9(8)  VALUE 0. 

      *** COUNT NO OF STORES IN DB  
           05 WSA-DB-STO-COUNTERS.  
              10 WSA-R246-STO-COUNTS.   
                 15 WSA-R255-STO-CNT             PIC 9(8)  VALUE 0. 
R070             15 WSA-R251-STO-CNT             PIC 9(8)  VALUE 0. 


      *** COUNT NO OF END-DATINGS.  
           05 WSA-END-DTE-COUNTS.   
              10 WSA-TOT-END-DTE-CNT             PIC 9(8)  VALUE 0. 
              10 WSA-R666-END-DTE-CNTS. 
                 15 WSA-R672-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R247-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R248-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R254-END-DTE-CNT         PIC 9(8)  VALUE 0. 

              10 WSA-R246-END-DTE-CNTS. 
                 15 WSA-R634-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R252-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R253-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R255-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R269-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R260-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R268-END-DTE-CNT         PIC 9(8)  VALUE 0. 

                 15 WSA-R251-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R256-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R257-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R258-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R259-END-DTE-CNT         PIC 9(8)  VALUE 0. 

                 15 WSA-R653-END-DTE-CNT         PIC 9(8)  VALUE 0. 
                 15 WSA-R654-END-DTE-CNT         PIC 9(8)  VALUE 0. 

      *** COUNTERS THAT ARE USED FOR SUMMARY REPORTING. 
           05 WSA-R-COUNTERS.   
              10 WSA-R-ACT-BDGT-CNT              PIC 9(08)     VALUE 0. 
              10 WSA-R-SUS-BDGT-CNT              PIC 9(08)     VALUE 0. 
              10 WSA-R-VEND-BDGT-CNT             PIC 9(08)     VALUE 0. 
              10 WSA-R-VEND-BDGT-AMT             PIC 9(10)V99  VALUE 0. 
              10 WSA-R-RCOU-BDGT-CNT             PIC 9(08)     VALUE 0. 
              10 WSA-R-RCOU-BDGT-AMT             PIC 9(10)V99  VALUE 0. 
              10 WSA-R-MAID-ONLY-CNT             PIC 9(08)     VALUE 0. 
              10 WSA-R-CHK-ISS-BDGT-CNT          PIC 9(08)     VALUE 0. 
              10 WSA-R-CHK-ISS-BDGT-AMT          PIC 9(10)V99  VALUE 0. 
              10 WSA-R-DD-BANK-CHG-CNT           PIC 9(08)     VALUE 0. 
              10 WSA-R-ACT-BDGT-MEM-CNT          PIC 9(08)     VALUE 0. 
              10 WSA-R-AGRZER-CNT                PIC 9(08)     VALUE 0. 
              10 WSA-R-PRO-CLOSE-BDGT-CNT        PIC 9(08)     VALUE 0. 
              10 WSA-R-PRO-CLOSE-BDGT-AMT        PIC 9(10)V99  VALUE 0. 
              10 WSA-R-MGA-LT-10-CNT             PIC 9(08)     VALUE 0. 
              10 WSA-R-R255-NOT-FOUND            PIC 9(08)     VALUE 0. 
R074          10 WSA-R-LIN-CLOSES                PIC 9(08)     VALUE 0. 

              10 WSA-R-CNTY-TOTALS. 
                 15 WSA-R-CNTY-ACT-BDGT-CNT      PIC 9(08)     VALUE 0. 
                 15 WSA-R-CNTY-MGA-AMT           PIC 9(08)V99  VALUE 0. 

              10 WSA-R-STATE-TOTALS.
                 15 WSA-R-STATE-ACT-BDGT-CNT     PIC 9(08)     VALUE 0. 
                 15 WSA-R-STATE-MGA-AMT          PIC 9(08)V99  VALUE 0. 

R070   01  WSA-TOT-EXCEPT-PCT          PIC 9(02)V99.
R070   01  WSA-TOT-CLOSE               PIC 9(02)V99.
R070   01  WSA-TOT-SUSPEND             PIC 9(02)V99.
R070   01  WSA-PCT-SUSPEND             PIC 9(02)V99.
R070   01  WSA-PCT-CLOSE               PIC 9(02)V99.
R070   01  WSA-PCT-EXCEPT              PIC 9(02)V99.
R070   01  WSH-TOT-PCT                 PIC 9(02) VALUE 0.   
R070   01  WSH-CLS-PCT                 PIC 9(02) VALUE 0.   
R070   01  WSH-SUS-PCT                 PIC 9(02) VALUE 0.   
R070   01  WSA-TOT-EXCEPT              PIC 9(08) VALUE 0.   
R070   01  WSA-CASH-EXCEPTION          PIC 9(08) VALUE 0.   
R070   01  WSA-CASH-NO-EXCEPTION       PIC 9(08) VALUE 0.   
R070   01  WSA-MA-EXCEPTION            PIC 9(08) VALUE 0.   
R070   01  WSA-MA-NO-EXCEPTION         PIC 9(08) VALUE 0.   
R070   01  WSA-EXEMPT                  PIC 9(08) VALUE 0.   
R070   01  WSA-SUSPEND                 PIC 9(08) VALUE 0.   
R070   01  WSA-CLOSED                  PIC 9(08) VALUE 0.   
R070   01  WSA-NO-ACTION               PIC 9(08) VALUE 0.   
R070   01  WSA-BYPASS-PH               PIC 9(08) VALUE 0.   
R070   01  WSA-NBR-REDET               PIC 9(08) VALUE 0.   
      ********************************************  
      *** STORE DATABASE KEYS                  ***  
      ********************************************  
       01  WSH-R666-DBK                          USAGE DATABASE-KEY.

       01  WSH-R672-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R672-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R247-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R247-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R248-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R248-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R254-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R254-2ND-DBK                      USAGE DATABASE-KEY.

       01  WSH-R634-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R634-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R252-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R252-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R253-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R253-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R255-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R255-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R255-NEW-DBK                      USAGE DATABASE-KEY.
       01  WSH-R269-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R269-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R260-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R260-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R268-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R268-2ND-DBK                      USAGE DATABASE-KEY.

       01  WSH-R251-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R251-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R256-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R256-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R257-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R257-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R258-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R258-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R259-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R259-2ND-DBK                      USAGE DATABASE-KEY.

       01  WSH-R653-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R653-2ND-DBK                      USAGE DATABASE-KEY.
       01  WSH-R654-1ST-DBK                      USAGE DATABASE-KEY.
       01  WSH-R654-2ND-DBK                      USAGE DATABASE-KEY.

       01  WSH-FET-DBK                           USAGE DATABASE-KEY.

R056   01  WS-CALCR15-AN.   
R056       05  WS-R15-1-2              PIC X(02) VALUE 'A5'.
R056       05  WS-R15-AREA-DIGIT       PIC 9(02) VALUE ZEROS.   
R056       05  WS-R15-5-12             PIC X(08) VALUE '-RCPT-15'.  
CC47   01  WS-CALCR15-AN-2. 
CC47       05  WS-R15-1-2-2            PIC X(02) VALUE 'A4'.
CC47       05  WS-R15-AREA-DIGIT-2     PIC 9(02) VALUE ZEROS.   
CC47       05  WS-R15-5-12-2           PIC X(08) VALUE '-RCPT-15'.  
R056
CC43   01  WS-CALCR25-AN.   
CC43       05  WS-R25-1-2              PIC X(02) VALUE 'A9'.
CC43       05  WS-R25-AREA-DIGIT       PIC 9(02) VALUE ZEROS.   
CC43       05  WS-R25-5-12             PIC X(08) VALUE '-RCPT-25'.  
CC43
R056   01  WS-CALCR17-AN.   
R056       05  WS-R17-1-2              PIC X(02) VALUE 'A6'.
R056       05  WS-R17-AREA-DIGIT       PIC 9(02) VALUE ZEROS.   
R056       05  WS-R17-5-12             PIC X(08) VALUE '-RCPT-17'.  
R056
R056   01  WS-CALCR19-AN.   
R056       05  WS-R19-1-2              PIC X(02) VALUE 'A7'.
R056       05  WS-R19-AREA-DIGIT       PIC 9(02) VALUE ZEROS.   
R056       05  WS-R19-5-12             PIC X(08) VALUE '-RCPT-19'.  

M307   01  HOLD-HST-DAT.
M307       05  HOLD-HST-CC                   PIC 9(2).  
M307       05  HOLD-HST-DATE                 PIC 9(5).  
M307   01  HOLD-HST-DAT-RDF REDEFINES HOLD-HST-DAT  
M307                                         PIC 9(07). 
R070   01  WSH-2ND-PAY-MINUS-1         PIC 9(07).   
R070   01  WSH-2ND-MINUS-1-GREG        PIC 9(08).   

R067   01  WSH-HLD-END-DTE             PIC 9(07).   
R070   01  WSH-END-PAY-DATE            PIC 9(07).   
R075A  01  W634-DTE-OPENED-BDGT.
R075A      05  W634-DTE-OPENED-YY      PIC 9(04).   
R075A      05  W634-DTE-OPENED-MM      PIC 9(02).   
R075A      05  W634-DTE-OPENED-DD      PIC 9(02).   
R070   01  WSH-BLD-END-PAY. 
R070       05  WSH-BLD-END-YY          PIC 9(04).   
R070       05  WSH-BLD-END-MM          PIC 9(02).   
R070       05  WSH-BLD-END-DD          PIC 9(02).   
R070   01  WSH-BLD-END-PAY-N  REDEFINES  WSH-BLD-END-PAY  PIC 9(08).
      **************************************************
      ***  DATE AND TIME FIELDS. THEY ARE REQD IN    ***
      ***  THE REPORT SECTION.                       ***
      **************************************************
       01  WSH-DATE-TIME.   
R075A      10  WSH-TODAYS-DATE                   PIC 9(7).  
           10  WSH-DATE.
               15 WSH-YY                         PIC 99.
               15 WSH-MM                         PIC 99.
               15 WSH-DD                         PIC 99.
           10  WSH-REP-DATE.
               15 WSH-REP-MM                     PIC 99.
               15 FILLER                         PIC X   VALUE '/'. 
               15 WSH-REP-DD                     PIC 99.
               15 FILLER                         PIC X   VALUE '/'. 
               15 WSH-REP-YY                     PIC 99.

           10  WSH-TIME.
               15 WSH-HH                         PIC 99.
               15 WSH-MIN                        PIC 99.
               15 WSH-SS                         PIC 99.
               15 WSH-MS                         PIC 99.
           10  WSH-REP-TIME.
               15 WSH-REP-HH                     PIC 99.
               15 FILLER                         PIC X   VALUE ':'. 
               15 WSH-REP-MIN                    PIC 99.
               15 FILLER                         PIC X   VALUE ':'. 
               15 WSH-REP-SS                     PIC 99.
           10  WSH-PMT-DATE-MMYY.   
               15 WSH-PMT-DATE-MM                PIC 99.
               15 WSH-PMT-DATE-YY                PIC 99.
           10  WSH-PMT-DATE-MMYY-R REDEFINES WSH-PMT-DATE-MMYY  
                                                 PIC 9(04). 

       01  WSH-MILLIES                           PIC 9(10) USAGE COMP   
                                                           VALUE 0. 
       01  WSH-EIGHTS                            PIC 9(05) USAGE COMP   
                                                           VALUE 88888. 
R067   01  WSA-PAGE-CNT                PIC 9(04) VALUE 0.   
R067   01  WSA-LINE-CNT                PIC 9(04) VALUE 69.  
R070   01  WSS-FUT-CLOS        PIC X(01).   

       01  WSH-TEMP-VARIABLES.  
           05 WSH-I                              PIC 9(3)  VALUE 0. 
           05 WSH-ERR-PARA-NO                    PIC X(4)  VALUE SPACES.
           05 WSH-RECORD-TYPE                    PIC X(4)  VALUE SPACES.
           05 WSH-TME-ACTN             PIC 9(8) VALUE 50000000. 

           05 WSH-OCC-GT-2-MSG. 
              10 WSH-OCC-GT-2-REC-TYPE           PIC X(4)  VALUE SPACES.
              10 FILLER                          PIC X(1)  VALUE SPACES.
              10 FILLER                          PIC X(7)   
                                                 VALUE 'OCC > 2'.   

           05 WSH-TSAPEN-ERR-MSG.   
              10 FILLER                          PIC X(7)   
                                                 VALUE 'TSAPEN?'.   
              10 FILLER                          PIC X(1) VALUE SPACES. 
              10 WSH-TSAPEN-ERR-STATUS           PIC 9(1) VALUE ZEROS.  

           05 WSH-ADR-ZIP-CODE. 
              10 WSH-ADR-ZIP-CODE-MAIN           PIC 9(5)  VALUE 0. 
              10 WSH-ADR-ZIP-CODE-EXTN           PIC 9(4)  VALUE 0. 

R009       05 WSH-NBR-VENDOR                     PIC 9(06). 
R009       05 WSH-NBR-VENDOR-X REDEFINES WSH-NBR-VENDOR.
R009          10 FILLER                          PIC X(02). 
R009          10 WSH-NBR-VENDOR-4                PIC 9(04). 

           05 WSH-DATES.
M307          10 WSH-PAYMENT-DATE                PIC 9(7)  VALUE 0. 
M307          10 WSH-PAYMENT-DATE-RDF REDEFINES WSH-PAYMENT-DATE.   
M307             15 WSH-PAYDATE-CC               PIC 9(02). 
M307             15 WSH-PAYDATE-5                PIC 9(05). 

M322          10 WSH-CPF-CYCLE-JUL               PIC 9(7).  
R053          10 WSH-CLCK-CLS-JUL                PIC 9(7).  

              10 WSH-FOR-DATES-DIFF.
M307             15 WSH-JUL-DATE1                PIC 9(7)  VALUE 0. 
                 15 WSH-JUL-DATE1-X REDEFINES WSH-JUL-DATE1.
M307                20 WSH-JUL-YY1               PIC 9(4).  
                    20 WSH-JUL-DD1               PIC 9(3).  

M307             15 WSH-JUL-DATE2                PIC 9(7)  VALUE 0. 
                 15 WSH-JUL-DATE2-X REDEFINES WSH-JUL-DATE2.
M307                20 WSH-JUL-YY2               PIC 9(4).  
                    20 WSH-JUL-DD2               PIC 9(3).  

M307             15 WSH-JUL-DATE3                PIC 9(7)  VALUE 0. 
                 15 WSH-JUL-DATE3-X REDEFINES WSH-JUL-DATE3.
M307                20 WSH-JUL-YY3               PIC 9(4).  
M307                20 WSH-JUL-DD3               PIC 9(3).  
                 15 WSH-JUL-DIFF-DD3             PIC 9(5)  VALUE 0. 

           05 WSH-PRO-RATED-DATA.   
              10 WSH-PRO-RATED-DAYS              PIC 9(5)  VALUE 0. 

M313       05 WSH-COM-DATE-TIME-NUM              PIC 9(13) .
           05 WSH-COM-DATE-TIME-X REDEFINES WSH-COM-DATE-TIME-NUM.  
M313          10 WSH-COM-DATE-JUL                PIC 9(7).  
R009          10 WSH-COM-TIME                    PIC 9(6).  

R009       05 WSH-SYS-TIME                       PIC 9(8).  
R009       05 WSH-SYS-TIME-X REDEFINES WSH-SYS-TIME.
R009          10 WSH-SYS-TIME-SEC                PIC 9(6).  
R009          10 FILLER                          PIC X(2).  

           05 WSH-CNTY-CASE-NBR.
              10 WSH-CNTY-NBR                    PIC 9(2)  VALUE 0. 
              10 WSH-CASE-NBR                    PIC 9(7)  VALUE 0. 

           05 WSH-CASE-BDGT-ID. 
              10 WSH-CASE-NUMBER                 PIC 9(9).  
              10 WSH-CDE-CATEGORY                PIC X(3).  
              10 WSH-NBR-GROUP-GRANT             PIC X(1).  

           05 WSH-PAYMENT-MONTH                  PIC 99.
              88 WSH-QUARTERLY         VALUES ARE 01 04 07 10.  

           05 WSH-PAYDAY-NBR                     PIC 99.
              88 WSH-FIRST-HALF        VALUES ARE 01 THRU 10.   
              88 WSH-SECOND-HALF       VALUES ARE 11 THRU 20.   
              88 WSH-SUPP-ONLY         VALUES ARE 21 THRU 23.   

           05 WSH-PAYDATES. 
M307          10 WSH-RECUR-PAYDATE               PIC 9(7).  
R045          10 WSH-RECUR-PAYDATE-RDF REDEFINES WSH-RECUR-PAYDATE. 
R045             15 WSH-RECUR-YY                 PIC 9(04). 
R045             15 WSH-RECUR-DAYS               PIC 9(03). 
R053          10 HOLD-RECUR-PAYDATE              PIC 9(7).  
R053          10 HOLD-RECUR-PAYDATE-RDF REDEFINES HOLD-RECUR-PAYDATE.   
R053             15 HOLD-RECUR-YY                PIC 9(04). 
R053             15 HOLD-RECUR-DAYS              PIC 9(03). 
M307          10 WSH-2-PAYDATE                   PIC 9(7).  
M307          10 WSH-3-PAYDATE                   PIC 9(7).  
M307          10 WSH-SUSPEND-DATE                PIC 9(7).  
R070          10 WSH-PAY-MINUS-1                 PIC 9(7).  
R053          10 WSH-RECUR-DEADLINE              PIC 9(07). 
R053          10 WSH-RECUR-DEADLINE-RDF REDEFINES WSH-RECUR-DEADLINE.   
R053             15 WSH-RECUR-DLE-YY             PIC 9(04). 
R053             15 WSH-RECUR-DLE-DAYS           PIC 9(03). 
R053          10 WSH-PREV-DEADLINE               PIC 9(07). 
R053          10 WSH-PREV-DEADLINE-RDF REDEFINES WSH-PREV-DEADLINE. 
R053             15 WSH-PREV-DLE-CC              PIC 9(02). 
R053             15 WSH-PREV-DLE-YYDD            PIC 9(05). 
R053          10 HOLD-RECUR-DEADLINE             PIC 9(07). 
R053          10 HOLD-RECUR-DEADLINE-RDF REDEFINES HOLD-RECUR-DEADLINE. 
R053             15 HOLD-RECUR-DLE-YY            PIC 9(04). 
R053             15 HOLD-RECUR-DLE-DAYS          PIC 9(03). 
R053          10 WSH-2-DEADLINE                  PIC 9(07). 
R053          10 WSH-2-DEADLINE-RDF     REDEFINES WSH-2-DEADLINE.   
R053             15 WSH-2-DLE-YY                 PIC 9(04). 
R053             15 WSH-2-DLE-DAYS               PIC 9(03). 
R053          10 WSH-3-DEADLINE                  PIC 9(07). 
R053          10 WSH-3-DEADLINE-RDF     REDEFINES WSH-3-DEADLINE.   
R053             15 WSH-3-DLE-YY                 PIC 9(04). 
R053             15 WSH-3-DLE-DAYS               PIC 9(03). 
R053          10 WSH-DEADLINE-MM                 PIC 9(02). 
R053          10 WSH-PREV-PAYDAY                 PIC 9(02). 

           05 WSH-SAVE-VALUES.  
              10 WSH-SAVE-CAT-CODE               PIC X(3)  VALUE SPACES.
              10 WSH-SAVE-COUNTY-CODE            PIC X(2)  VALUE SPACES.

           05 WSH-SAVE-DD-BANK-CHNG-DATA.   
              10 WSH-SAVE-BANK-NO-ORIG           PIC 9(6)  VALUE ZEROS. 
              10 WSH-SAVE-BANK-NO-NEW            PIC 9(6)  VALUE ZEROS. 
M307          10 WSH-SAVE-BANK-DTE-BGN           PIC 9(7)  VALUE ZEROS. 
M307          10 WSH-SAVE-BANK-DTE-CHNG          PIC 9(7)  VALUE ZEROS. 

           05 WSH-CDE-AUTH-CHNG-GRANT-CASH       PIC 9(5)  VALUE ZEROS. 

           05 WSH-PAYDAY-DIGIT-1-2. 
              10 WSH-PAYDAY-DIGIT-1              PIC 9(1).  
              10 WSH-PAYDAY-DIGIT-2              PIC 9(1).  

           05 WSH-AREA-NAMES.   
              10 WSH-BUILD-AREA-A84X.   
                 15 FILLER                    PIC X(3) VALUE 'A84'     .
                 15 WSH-AREA-A84X-X           PIC 9(1)                 .
                 15 FILLER                    PIC X(8) VALUE '-AE-CASE'.

CC43          10 WSH-BUILD-AREA-A94X.   
CC43             15 FILLER                    PIC X(3) VALUE 'A94'     .
CC43             15 WSH-AREA-A94X-X           PIC 9(1)                 .
CC43             15 FILLER                    PIC X(8) VALUE '-AE-CASE'.
              10 WSH-BUILD-AREA-A80X.   
                 15 FILLER                    PIC X(3) VALUE 'A80'     .
                 15 WSH-AREA-A80X-X           PIC 9(1)                 .
                 15 FILLER                    PIC X(8) VALUE '-CM-CASE'.

MD01          10 WSH-BUILD-AREA-A86X.   
MD01             15 FILLER                    PIC X(3) VALUE 'A86'     .
MD01             15 WSH-AREA-A86X-X           PIC 9(1)                 .
MD01             15 FILLER                    PIC X(8) VALUE '-CM-CASE'.
MD01
              10 WSH-BUILD-AREA-A81X.   
                 15 FILLER                    PIC X(3) VALUE 'A81'     .
                 15 WSH-AREA-A81X-X           PIC 9(1)                 .
                 15 FILLER                    PIC X(8) VALUE '-CM-MBRS'.

           05 WSH-DTE-BEGIN.
M307          10 WSH-DTE-BGN                  PIC 9(07).
              10 WSH-R666-DTE-BGN.  
M307             15 WSH-R672-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R672-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R247-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R247-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R248-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R248-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R254-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R254-2ND-DTE-BGN      PIC 9(07).

              10 WSH-R246-DTE-BGN.  
M307             15 WSH-R634-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R634-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R252-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R252-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R253-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R253-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R255-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R255-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R269-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R269-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R260-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R260-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R268-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R268-2ND-DTE-BGN      PIC 9(07).

M307             15 WSH-R251-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R251-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R256-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R256-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R257-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R257-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R258-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R258-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R259-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R259-2ND-DTE-BGN      PIC 9(07).

              10 WSH-R637-DTE-BGN.  
M307             15 WSH-R653-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R653-2ND-DTE-BGN      PIC 9(07).
M307             15 WSH-R654-1ST-DTE-BGN      PIC 9(07).
M307             15 WSH-R654-2ND-DTE-BGN      PIC 9(07).
R070   01  WSH-PART-CAT.
R070       05  WSH-PART-CAT-1          PIC X(01).   
R070       05  WSH-PART-CAT-2          PIC X(01).   
R070       05  WSH-PART-CAT-3          PIC X(01).   
R069   01  WSH-DTE-CLOSED-BDGT                 PIC 9(07).   
R070   01  WSS-CLOSE-SW                PIC X(01) VALUE 'N'. 
R070   01  WSS-EXEMPT          PIC X(01).   
R070   01  WSS-EXCEPT          PIC X(01).   
R070   01  WSS-TARB-EOF        PIC X(01).   
R070   01  WSS-TARB            PIC 9(04).   
R070   01  WSS-TARB-MAX        PIC 9(04)  VALUE  150.   
R070   01  WSS-TARB-LOAD       PIC 9(04).   
R070   01  WST-TARB-TABLE.  
R070       05  WST-TARB-ITEM  OCCURS  150  TIMES.   
R070           10  WST-TARB-CO         PIC 9(02).   
R070           10  WST-TARB-DIST       PIC X(01).   
R070           10  WST-TARB-IND        PIC X(01).   
R070           10  WST-TARB-BEG-DTE    PIC 9(08).   
R070           10  WST-TARB-END-DTE    PIC 9(08).   

TEST1 *01  WS-TEST-SW          PIC X(01)  VALUE 'N'.
      ************************************************  
      *** WORKING STORAGE GENERAL SUBSCRIPTS AND   ***  
      *** INDICES.                                 ***  
      *** INDICES NOT DEFINED HERE ARE IMPLICITLY  ***  
      *** DEFINED IN THE TABLE DEFINTIONS.         ***  
      ************************************************  
       01  WSI-INDICES. 
           05  WSI-I                             PIC 9(03) USAGE COMP.  

R047  *** HOLD R396-TABLE TO COMP R268-TABLE       ***  
R047  ************************************************  
R047   01  R396T-NBR-INDIV-TABLE.   
R047       10 R396T-NBR-INDIV-TAB OCCURS 30 TIMES.  
R047          15 R396T-NBR-INDIV                PIC 9(9) .  
R047          15 R396T-NBR-LINE-INDIV           PIC 9(2) .  
R047       10 R396T-SUB                         PIC 9(3)  VALUE  0. 
R047       10 R396-VERIF-CNT                    PIC 9(3)  VALUE  0. 

R047   01  R268-R396-SUBS.  
R047       05  R268-SUB          PIC 9(05) COMP VALUE 0.
R047       05  R396-SUB          PIC 9(05) COMP VALUE 0.

R069   01  WSS-R246-FOUND              PIC X(01).   
R069   01  WSS-R666-FOUND              PIC X(01).   

      ************************************************  
      *** WORKING STORAGE SWITCHES.                ***  
      ************************************************  
R062  *01  WSS-FIX-PROG-STAT           PIC X(01).   
       01  WSS-SWITCHES.
           05 WSS-FILE-OPEN-SWITCHES.   
              10 WSS-ARM60001-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ARM60001-OPEN-ON                   VALUE 1. 
              10 WSS-ATE10M01-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE10M01-OPEN-ON                   VALUE 1. 
              10 WSS-ATE20D01-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE20D01-OPEN-ON                   VALUE 1. 
              10 WSS-ATE01D01-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01D01-OPEN-ON                   VALUE 1. 
R069A *       10 WSS-ATE01D02-OPEN               PIC 9(1)  VALUE 0. 
R069A *          88 WSS-ATE01D02-OPEN-ON                   VALUE 1. 
              10 WSS-ATE01D04-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01D04-OPEN-ON                   VALUE 1. 
              10 WSS-ATE01D05-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01D05-OPEN-ON                   VALUE 1. 
R069A *       10 WSS-ATE01D06-OPEN               PIC 9(1)  VALUE 0. 
R069A *          88 WSS-ATE01D06-OPEN-ON                   VALUE 1. 
R069A *       10 WSS-ATE01D07-OPEN               PIC 9(1)  VALUE 0. 
R069A *          88 WSS-ATE01D07-OPEN-ON                   VALUE 1. 
              10 WSS-ATE01D08-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01D08-OPEN-ON                   VALUE 1. 
              10 WSS-ATE01D09-OPEN               PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01D09-OPEN-ON                   VALUE 1. 
R053          10 WSS-ATE01D10-OPEN               PIC 9(1)  VALUE 0. 
R053             88 WSS-ATE01D10-OPEN-ON                   VALUE 1. 
R053          10 WSS-ATE01D11-OPEN               PIC 9(1)  VALUE 0. 
R053             88 WSS-ATE01D11-OPEN-ON                   VALUE 1. 
R053          10 WSS-ATE01D12-OPEN               PIC 9(1)  VALUE 0. 
R053             88 WSS-ATE01D12-OPEN-ON                   VALUE 1. 
R056          10 WSS-ATE01D13-OPEN               PIC 9(1)  VALUE 0. 
R056             88 WSS-ATE01D13-OPEN-ON                   VALUE 1. 
R056          10 WSS-ATE01D14-OPEN               PIC 9(1)  VALUE 0. 
R056             88 WSS-ATE01D14-OPEN-ON                   VALUE 1. 
R056          10 WSS-ATE01D15-OPEN               PIC 9(1)  VALUE 0. 
R056             88 WSS-ATE01D15-OPEN-ON                   VALUE 1. 
R056          10 WSS-ATE01D16-OPEN               PIC 9(1)  VALUE 0. 
R056             88 WSS-ATE01D16-OPEN-ON                   VALUE 1. 
R064          10 WSS-ATE01D17-OPEN               PIC 9(1)  VALUE 0. 
R064             88 WSS-ATE01D17-OPEN-ON                   VALUE 1. 
CC41B         10 WSS-ATE01D18-OPEN               PIC 9(1)  VALUE 0. 
CC41B            88 WSS-ATE01D18-OPEN-ON                   VALUE 1. 
R069           10 WSS-ATE01D19-OPEN               PIC 9(1)  VALUE 0.
R069             88 WSS-ATE01D19-OPEN-ON                   VALUE 1. 
R070           10 WSS-ATE01D20-OPEN               PIC 9(1)  VALUE 0.
R070             88 WSS-ATE01D20-OPEN-ON                   VALUE 1. 
R075A          10 WSS-ATE01D21-OPEN               PIC 9(1)  VALUE 0.
R075A            88 WSS-ATE01D21-OPEN-ON                   VALUE 1. 
R067          10 WSS-ATE01DR01-OPEN              PIC 9(1)  VALUE 0. 
R067             88 WSS-ATE01DR01-OPEN-ON                  VALUE 1. 
              10 WSS-ATE01DR99-OPEN              PIC 9(1)  VALUE 0. 
                 88 WSS-ATE01DR99-OPEN-ON                  VALUE 1. 

           05 WSS-FILE-EOF-SWITCHES.
              10 WSS-ARM60001-EOF                PIC 9(1)  VALUE 0. 
                 88 WSS-ARM60001-EOF-ON                    VALUE 1. 
              10 WSS-ATE10M01-EOF                PIC 9(1)  VALUE 0. 
                 88 WSS-ATE10M01-EOF-ON                    VALUE 1. 
              10 WSS-ATE20D01-EOF                PIC 9(1)  VALUE 0. 
                 88 WSS-ATE20D01-EOF-ON                    VALUE 1. 

      *** CASE LEVEL SWITCHES.  
           05 WSS-DB-CASE-SWITCHES. 
              10 WSS-CASE-CLOSED                 PIC 9  VALUE 0.
                 88 WSS-CASE-CLOSED-ON                  VALUE 1.

      *** EOS SWITCHES FOR ALL DB RECORDS BUT ENTRY POINTS. 
           05 WSS-DB-EOS-SWITCHES.  
              10 WSS-R666-EP-SWITCHES.  
                 15 WSS-R672-EOS                 PIC 9  VALUE 0.
                    88 WSS-R672-EOS-ON                  VALUE 1.
                 15 WSS-R247-EOS                 PIC 9  VALUE 0.
                    88 WSS-R247-EOS-ON                  VALUE 1.
                 15 WSS-R248-EOS                 PIC 9  VALUE 0.
                    88 WSS-R248-EOS-ON                  VALUE 1.
                 15 WSS-R254-EOS                 PIC 9  VALUE 0.
                    88 WSS-R254-EOS-ON                  VALUE 1.

              10 WSS-R246-EP-SWITCHES.  
                 15 WSS-R249-EOS                 PIC 9  VALUE 0.
                    88 WSS-R249-EOS-ON                  VALUE 1.
                 15 WSS-R634-EOS                 PIC 9  VALUE 0.
                    88 WSS-R634-EOS-ON                  VALUE 1.
                 15 WSS-R252-EOS                 PIC 9  VALUE 0.
                    88 WSS-R252-EOS-ON                  VALUE 1.
                 15 WSS-R253-EOS                 PIC 9  VALUE 0.
                    88 WSS-R253-EOS-ON                  VALUE 1.
                 15 WSS-R255-EOS                 PIC 9  VALUE 0.
                    88 WSS-R255-EOS-ON                  VALUE 1.
                 15 WSS-R269-EOS                 PIC 9  VALUE 0.
                    88 WSS-R269-EOS-ON                  VALUE 1.
                 15 WSS-R260-EOS                 PIC 9  VALUE 0.
                    88 WSS-R260-EOS-ON                  VALUE 1.
                 15 WSS-R268-EOS                 PIC 9  VALUE 0.
                    88 WSS-R268-EOS-ON                  VALUE 1.
                 15 WSS-S105-EOS                 PIC 9  VALUE 0.
                    88 WSS-S105-EOS-ON                  VALUE 1.
                 15 WSS-R251-EOS                 PIC 9  VALUE 0.
                    88 WSS-R251-EOS-ON                  VALUE 1.
                 15 WSS-R256-EOS                 PIC 9  VALUE 0.
                    88 WSS-R256-EOS-ON                  VALUE 1.
                 15 WSS-R257-EOS                 PIC 9  VALUE 0.
                    88 WSS-R257-EOS-ON                  VALUE 1.
                 15 WSS-R258-EOS                 PIC 9  VALUE 0.
                    88 WSS-R258-EOS-ON                  VALUE 1.
                 15 WSS-R259-EOS                 PIC 9  VALUE 0.
                    88 WSS-R259-EOS-ON                  VALUE 1.
R075A            15 WSS-EOS-R249                 PIC 9  VALUE 0.
R075A               88  EOS-R249                        VALUE 1.
              10 WSS-R637-EP-SWITCHES.  
                 15 WSS-R653-EOS                 PIC 9  VALUE 0.
                    88 WSS-R653-EOS-ON                  VALUE 1.
                 15 WSS-R654-EOS                 PIC 9  VALUE 0.
                    88 WSS-R654-EOS-ON                  VALUE 1.

              10 WSS-R270-EP-SWITCHES.  
                 15 WSS-R271-EOS                 PIC 9  VALUE 0.
                    88 WSS-R271-EOS-ON                  VALUE 1.


      *** RECORD FOUND SWITCHES FOR ALL DB RECORDS. 
           05 WSS-DB-REC-SWITCHES.  
              10 WSS-R666-EP-REC-SWITCHES.  
                 15 WSS-R672-REC                 PIC 9  VALUE 0.
                    88 WSS-R672-REC-ON                  VALUE 1.
                 15 WSS-R672-FUTURE-REC          PIC 9  VALUE 0.
                    88 WSS-R672-FUTURE-REC-ON           VALUE 1.
                 15 WSS-R247-REC                 PIC 9  VALUE 0.
                    88 WSS-R247-REC-ON                  VALUE 1.
                 15 WSS-R248-REC                 PIC 9  VALUE 0.
                    88 WSS-R248-REC-ON                  VALUE 1.
                 15 WSS-R254-REC                 PIC 9  VALUE 0.
                    88 WSS-R254-REC-ON                  VALUE 1.

              10 WSS-R246-EP-REC-SWITCHES.  
                 15 WSS-R246-REC                 PIC 9  VALUE 0.
                    88 WSS-R246-REC-ON                  VALUE 1.
                 15 WSS-R249-REC                 PIC 9  VALUE 0.
                    88 WSS-R249-REC-ON                  VALUE 1.
                 15 WSS-R249-EP-REC-SWITCHES.   
                    20 WSS-R634-REC              PIC 9  VALUE 0.
                       88 WSS-R634-REC-ON               VALUE 1.
                    20 WSS-R634-FUTURE-REC       PIC 9  VALUE 0.
                       88 WSS-R634-FUTURE-REC-ON        VALUE 1.
                    20 WSS-R252-REC              PIC 9  VALUE 0.
                       88 WSS-R252-REC-ON               VALUE 1.
                    20 WSS-R253-REC              PIC 9  VALUE 0.
                       88 WSS-R253-REC-ON               VALUE 1.
                    20 WSS-R255-REC              PIC 9  VALUE 0.
                       88 WSS-R255-REC-ON               VALUE 1.
                    20 WSS-R269-REC              PIC 9  VALUE 0.
                       88 WSS-R269-REC-ON               VALUE 1.
                    20 WSS-R260-REC              PIC 9  VALUE 0.
                       88 WSS-R260-REC-ON               VALUE 1.
                    20 WSS-R268-REC              PIC 9  VALUE 0.
                       88 WSS-R268-REC-ON               VALUE 1.
                    20 WSS-R251-REC              PIC 9  VALUE 0.
                       88 WSS-R251-REC-ON               VALUE 1.
                    20 WSS-R256-REC              PIC 9  VALUE 0.
                       88 WSS-R256-REC-ON               VALUE 1.
                    20 WSS-R257-REC              PIC 9  VALUE 0.
                       88 WSS-R257-REC-ON               VALUE 1.
                    20 WSS-R258-REC              PIC 9  VALUE 0.
                       88 WSS-R258-REC-ON               VALUE 1.
                    20 WSS-R259-REC              PIC 9  VALUE 0.
                       88 WSS-R259-REC-ON               VALUE 1.

              10 WSS-R637-EP-REC-SWITCHES.  
                 15 WSS-R637-REC                 PIC 9  VALUE 0.
                    88 WSS-R637-REC-ON                  VALUE 1.
                 15 WSS-R637-EP-REC-SWS.
                    20 WSS-R653-REC              PIC 9  VALUE 0.
                       88 WSS-R653-REC-ON               VALUE 1.
                    20 WSS-R654-REC              PIC 9  VALUE 0.
                       88 WSS-R654-REC-ON               VALUE 1.

              10 WSS-R270-EP-REC-SWITCHES.  
                 15 WSS-R270-REC                 PIC 9  VALUE 0.
                    88 WSS-R270-REC-ON                  VALUE 1.
                 15 WSS-R271-REC                 PIC 9  VALUE 0.
                    88 WSS-R271-REC-ON                  VALUE 1.
           05 WSS-R256-SWITCHES.
              10 WSS-R256-END-DTE                PIC 9  VALUE 0.
                 88 WSS-R256-END-DTE-ON                 VALUE 1.
              10 WSS-R256-FIRST                  PIC 9  VALUE 0.
                 88 WSS-R256-FIRST-ON                   VALUE 1.

R056          10 WSS-R249-FIRST                  PIC 9  VALUE 0.
R056             88 WSS-R249-FIRST-ON                   VALUE 1.

      *** BUDGET STATUS SWITCHES.   
           05 WSS-BDGT-SWITCHES.
              10 WSS-BDGT-CASH-ISSNC             PIC 9  VALUE 0.
                 88 WSS-BDGT-CASH-ISSNC-ON              VALUE 1.
              10 WSS-BDGT-MAID-ISSNC             PIC 9  VALUE 0.
                 88 WSS-BDGT-MAID-ISSNC-ON              VALUE 1.
              10 WSS-BDGT-MAID-BYPASSED          PIC 9  VALUE 0.
                 88 WSS-BDGT-MAID-BYPASSED-ON           VALUE 1.
              10 WSS-BDGT-CLOSED-BEF-PERIOD      PIC 9  VALUE 0.
                 88 WSS-BDGT-CLOSED-BEF-PERIOD-ON       VALUE 1.
              10 WSS-BDGT-PRORATED-CLOSE         PIC 9  VALUE 0.
                 88 WSS-BDGT-PRORATED-CLOSE-ON          VALUE 1.
              10 WSS-BDGT-CHK-WITH-HIST          PIC 9  VALUE 0.
                 88 WSS-BDGT-CHK-WITH-HIST-ON           VALUE 1.
              10 WSS-BDGT-HMO-EXPIRED            PIC 9  VALUE 0.
                 88 WSS-BDGT-HMO-EXPIRED-ON             VALUE 1.
              10 WSS-BDGT-MAND-REC-MISSING       PIC 9  VALUE 0.
                 88 WSS-BDGT-MAND-REC-MISSING-ON        VALUE 1.
              10 WSS-BDGT-SUSPEND                PIC 9  VALUE 0.
                 88 WSS-BDGT-SUSPEND-ON                 VALUE 1.

      *** TABLE SEARCH SWITCHES FOR ALL TABLES. 
           05 WSS-TAB-SEARCH-SWITCHES.  
              10 WSS-CAT-FOUND                   PIC 9  VALUE 0.
                 88 WSS-CAT-FOUND-ON                    VALUE 1.
              10 WSS-CAT-ONLY-FOUND              PIC 9  VALUE 0.
                 88 WSS-CAT-ONLY-FOUND-ON               VALUE 1.
              10 WSS-DD-FOUND                    PIC 9  VALUE 0.
                 88 WSS-DD-FOUND-ON                     VALUE 1.
              10 WSS-CNTY-FOUND                  PIC 9  VALUE 0.
                 88 WSS-CNTY-FOUND-ON                   VALUE 1.
              10 WSS-MATCHING-R268-R396-SW       PIC 9  VALUE 0.
                 88 WSS-MATCHED-R268-R396-ON            VALUE 1.
                 88 WSS-UNMATCHED-R268-R396-ON          VALUE 2.

      *** REPORT PRINTING SWITCHES. 
           05 WSS-REP-SWITCHES. 
              10 WSS-CNTY-HDRS-PRINTED           PIC 9  VALUE 0.
                 88 WSS-CNTY-HDRS-PRINTED-ON            VALUE 1.

      ************************************************  
      ***    LOCAL  PROGRAM TABLES                 ***  
      ************************************************  

      ************************************************  
      *** CATEGORY TABLE.                          ***  
      *** IT IS BUILT FROM FILE ATE10M01.          ***  
CC37  *** INDEXED BY WSI-CAT-IDX, MAX 600 ENTRIES. ***  
      ************************************************  
       01  WST-CAT-TABLE.   
CC37       10  WST-CAT-TAB OCCURS 600 TIMES INDEXED BY WSI-CAT-IDX. 
               15  WST-CAT-PGM. 
                   20  WST-CAT-CODE              PIC X(3).  
                   20  WST-CAT-PGM-STATUS        PIC 9(2).  
               15  WST-CAT-TYPE                  PIC 9(1).  
CC37       10  WSH-CAT-TAB-MAX-SIZE          PIC 9(3)  VALUE 600.   
           10  WSH-CAT-TAB-SIZE                  PIC 9(3)  VALUE   0.   

      ************************************************  
      *** CATEGORY ONLY TABLE.                     ***  
      *** IT IS BUILTAT THE TIME WHEN CATEGORY TAB ***  
      *** IS BUILT, AND HAS ONLY UNIQUE INSTANCES  ***  
      *** OF COUNTY CODES.                         ***  
CC37  *** INDEXED BY WSI-CAT-ONLY-IDX, MAX SIZE 100***  
      ************************************************  
       01  WST-CAT-ONLY-TABLE.  
CC37       05 WST-CAT-ONLY-TAB OCCURS 100 TIMES 
                                   INDEXED BY WSI-CAT-ONLY-IDX. 
               10 WST-CAT-ONLY                   PIC X(03). 
CC37       05 WSH-CAT-ONLY-TAB-MAX-SIZE          PIC 9(03)  VALUE 100.  
           05 WSH-CAT-ONLY-TAB-SIZE              PIC 9(03)  VALUE  0.   

      ************************************************  
      *** COUNTY TABLE.                            ***  
      *** IT IS BUILT FROM FILE ARM60001.          ***  
      *** INDEXED BY WSI-CNTY-IDX, MAX 70 ENTRIES. ***  
      ************************************************  
       01  WST-CNTY-TABLE.  
R075A      10 WST-CNTY-TAB OCCURS 110 TIMES INDEXED BY WSI-CNTY-IDX.
              15 WST-CNTY-NBR                   PIC X(2) .  
              15 WST-CNTY-NAME                  PIC X(20).  
R075A *    10 WSH-CNTY-TAB-MAX-SIZE             PIC 9(3)  VALUE 70. 
R075A      10 WSH-CNTY-TAB-MAX-SIZE             PIC 9(3)  VALUE 110.
           10 WSH-CNTY-TAB-SIZE                 PIC 9(3)  VALUE  0. 

      ************************************************  
      *** BUDGET MEMBER RELATION TABLE.            ***  
      *** ALL RECORD OCCURENCES OF R268 UNDER ONE  ***  
      *** R249 CM-BDGT ARE STORED IN A WST, MAX 30 ***  
      *** INDIVS CAN BE ACCOMODATED.               ***  
      *** THIS TABLE WILL BE USED TO SUBSEQUENTLY  ***  
      *** STORE R396 RECORDS FOR THE CM BUDGET     ***  
      *** HISTORY AREA.                            ***  
      ************************************************  
       01  WST-NBR-INDIV-TABLE. 
           10 WST-NBR-INDIV-TAB OCCURS 30 TIMES INDEXED BY WSI-NBR-IDX. 
              15 WST-NBR-INDIV                  PIC 9(9) .  
              15 WST-NBR-LINE-INDIV             PIC 9(2) .  
           10 WSH-NBR-TAB-MAX-SIZE              PIC 9(3)  VALUE 30. 
           10 WSH-NBR-TAB-SIZE                  PIC 9(3)  VALUE  0. 

      ************************************************  
      *** COUNTY-CATEGORY TABLE.                   ***  
      *** THIS TABLE WILL RECORD :                 ***  
      ***    . NO OF ACTIVE BUDGETS                ***  
      ***    . MGA DOLLARS                         ***  
      *** FOR VARIOUS CATEGORIES IN ALL THE        ***  
      *** COUNTIES.                                ***  
      *** TABLE IS REFERENCED BY ITS OWN INDEX     ***  
      *** POINTERS THAT ARE SET AS FOLLOWS :       ***  
      ***    . COUNTY BY WSI-CNTY-IDX.             ***  
      ***    . CAT    BY WSI-CAT-ONLY-IDX.         ***  
      ***    . COUNTY INDEX IS SET ON A CASE LEVEL ***  
      ***      WHILE CAT INDEX IS SET FOR EACH     ***  
      ***      INSTANCE OF A R249 REC.             ***  
      ************************************************  

           10 WST-CNTY-CAT-CNTY-TAB      OCCURS 70 TIMES
                                         INDEXED BY WSI-C-C-CNTY-IDX.   
CC37          15 WST-CNTY-CAT-CAT-TAB    OCCURS 100 TIMES   
                                         INDEXED BY WSI-C-C-CAT-IDX.
                 20 WST-CNTY-CAT-ACT-BDGT-CNT    PIC 9(8)    USAGE COMP.
                 20 WST-CNTY-CAT-SUS-BDGT-CNT    PIC 9(8)    USAGE COMP.
                 20 WST-CNTY-CAT-MGA-DOLL        PIC 9(8)V99 USAGE COMP.
                 20 WST-CNTY-CAT-MEM-ACT-CNT     PIC 9(8)    USAGE COMP.
           10 WSH-CNTY-CAT-CNTY-TAB-MAX-SIZE     PIC 9(3)  VALUE 70.
           10 WSH-CNTY-CAT-CAT-TAB-MAX-SIZE      PIC 9(3)  VALUE 50.

      ************************************************  
      *** S105 TABLES.                             ***  
      *** NEXT TWO TABLES ARE USED TO STORE THE    ***  
      *** STATUS OF MEMBER RECORDS IN SET S105.    ***  
      ***                                          ***  
      *** 1. REC-TYPE-TABLE : STATIC TABLE.        ***  
      ***                     DEFINED ONCE IN THE  ***  
      ***                     PROGRAM.             ***  
      *** 2. REC-DETAILS-TAB: DYNAMIC TABLE.       ***  
      ***                     INITIALIZED FOR EACH ***  
      ***                     BUDGET.              ***  
      ************************************************  
       01  WST-REC-TYPE-FILLER. 
           10 FILLER                             PIC X(04) VALUE 'R251'.
           10 FILLER                             PIC X(04) VALUE 'R256'.
           10 FILLER                             PIC X(04) VALUE 'R257'.
           10 FILLER                             PIC X(04) VALUE 'R258'.
           10 FILLER                             PIC X(04) VALUE 'R259'.
           10 FILLER                             PIC X(04) VALUE '    '.

       01  WST-S105-REC-TYPE-TABLE REDEFINES WST-REC-TYPE-FILLER.   
           10 WST-S105-REC-TYPE-TAB      OCCURS 06 TIMES
                                         INDEXED BY WSI-S105-TYPE-IDX.  
              15 WST-S105-REC-TYPE               PIC X(04). 

       01  WST-S105-REC-DETAILS-TABLE.  
           10 WST-S105-REC-DETAILS-TAB   OCCURS 06 TIMES
                                         INDEXED BY WSI-S105-REC-IDX.   
              15 WST-S105-REC-OCCUR-TAB  OCCURS 02 TIMES
                                         INDEXED BY WSI-S105-OCC-IDX.   
                 20 WST-REC-SW                   PIC 9(01). 
                 20 WST-REC-DBK                  PIC 9(10) USAGE COMP.  
M307             20 WST-REC-DTE-BGN              PIC 9(07) USAGE COMP.  

      ************************************************  
      *** R256 TABLES.                             ***  
      *** NEXT TWO TABLES ARE USED TO STORE INFO   ***  
      *** ON R256-SPECIAL-ALLOWANCE RECORDS.       ***  
      ***                                          ***  
      *** 1. GRP-ALLOW TAB : USED TO STORE FIRST   ***  
      ***                    3 ALLOW CODE AND      ***  
      ***                    AMOUNTS.              ***  
      *** 2. R256-DBK TAB  : STORE DBK OF R256.    ***  
      ***                    OUTPUT FILES WILL GET ***  
      ***                    ALL ACTIVE R256 RECS. ***  
      ************************************************  
       01  WST-R256-GRP-ALLOWS-SPL-TABLE.   
           05 WST-R256-GRP-ALLOWS-SPECIAL OCCURS 03 TIMES   
                                         INDEXED BY WSI-R256-GRP-IDX.   
              10 WST-R256-CDE-ALLOW-SPECIAL      PIC 9(03). 
              10 WST-R256-AMT-ALLOW-SPECIAL      PIC 9(04)V99.  
M129          10 WST-R256-TXT-DESC-SPECIAL       PIC X(24). 
       01  WST-R256-DBK-TABLE.  
           05 WST-R256-DBK-TAB           OCCURS 10 TIMES
                                         INDEXED BY WSI-R256-DBK-IDX.   
              10 WST-R256-DBK                    PIC 9(10) USAGE COMP.  
       01  WSH-R256-DBK-TAB-MAX-SIZE             PIC 9(02) VALUE 10.
       01  WSH-R256-DBK-TAB-SIZE                 PIC 9(02) VALUE 0. 

      ******************************************************
      *** PACKED NAME/ADDRESS TABLE.                     ***
      *** THIS TABLE IS USED TO DETERMINE IF THERE IS A  ***
      *** CHANGE IN CURRENT BDGT NAME/ADDR AGAINST       ***
      *** EXISTING HISTORY R289.                         ***
      ******************************************************
       01  WST-NAME-ADDR-PACKED.
           05 WST-NAME-ADDR-PACKED-CHAR OCCURS 1 TO 156 TIMES   
                  DEPENDING ON WSH-CNT-NAME-ADDR.   
              10 FILLER                          PIC X(01). 
       01  WSH-CNT-NAME-ADDR                     PIC 9(03). 


R070   01  WSS-R249-SS                 PIC 9(02).   
R070   01  WSS-R249-LD                 PIC 9(02).   
R070   01  WSS-R249-MX                 PIC 9(02)  VALUE 50. 
R070   01  WST-R249-TABLE.  
R070       05  WST-R249-ITEM  OCCURS  50  TIMES.
R070           10  WST-R249-REC        PIC X(08).   
R070           10  WST-R249-DBK  USAGE  DATABASE-KEY.   
      ******************************************************
      *** REPORT TITLES AND COLUMN HEADERS FOR 2 REPORTS ***
      ******************************************************
R067   01  WSR-HD1-01.  
R067       10  FILLER           PIC X(01) VALUE SPACES. 
R067       10  FILLER           PIC X(12) VALUE 'REPORT ID:'.   
R067       10  FILLER           PIC X(09) VALUE 'ATE01DR01' .   
R067       10  FILLER           PIC X(03) VALUE SPACES. 
R067       10  FILLER           PIC X(19) VALUE SPACES. 
R067       10  FILLER           PIC X(41) VALUE 
CC47                  'PENNSYLVANIA DEPARTMENT OF HUMAN SERVICES'.  
R067       10  FILLER           PIC X(22) VALUE SPACES. 
R067       10  FILLER           PIC X(17) VALUE 'PROCESSING DATE: '.
R067       10  WSR-HD1-REP-DATE-01 PIC X(08) VALUE SPACES.  
R067       10  FILLER           PIC X(02) VALUE SPACES. 

       01  WSR-HD2. 
           10  FILLER           PIC X(01) VALUE SPACES. 
           10  FILLER           PIC X(12) VALUE 'CYCLE    :'.   
           10  WSR-HD2-PAY-NBR  PIC 9(02) VALUE ZEROS . 
           10  FILLER           PIC X(01) VALUE SPACES. 
           10  WSR-HD2-PRO-DATE PIC X(08) VALUE SPACES. 
           10  FILLER           PIC X(27) VALUE SPACES. 
           10  FILLER           PIC X(25) VALUE 
                                    'CLIENT INFORMATION SYSTEM'.
           10  FILLER           PIC X(31) VALUE SPACES. 
           10  FILLER           PIC X(17) VALUE 'PROCESSING TIME: '.
           10  WSR-HD2-REP-TIME PIC X(08) VALUE SPACES. 
           10  FILLER           PIC X(02) VALUE SPACES. 

R067   01  WSR-HD3-01.  
R067       10  FILLER           PIC X(01) VALUE SPACES. 
R067       10  FILLER           PIC X(12) VALUE 'FREQUENCY: '.  
R067       10  FILLER           PIC X(09) VALUE 'DAILY    '.
R067       10  FILLER           PIC X(28) VALUE SPACES. 
R067       10  FILLER           PIC X(45) VALUE 
R067                         'DROP CATEGORY REPORT'.
R067       10  FILLER           PIC X(12) VALUE SPACES. 
R067       10  FILLER           PIC X(17) VALUE 'PAGE NUMBER    : '.
R067       10  WSR-HD3-PAGE-NO-01  PIC 9(02) VALUE ZEROS .  
R067       10  FILLER           PIC X(02) VALUE SPACES. 
      ***        STATEMENTS. THEY HV BEEN PLACED STRATEGICALLY  *** 

       01  WSR-HD4. 
           10  FILLER           PIC X(51) VALUE SPACES. 
           10  FILLER           PIC X(16) VALUE 'ISSUANCE EXTRACT'. 

       01  WSR-HD5. 
           10  FILLER           PIC X(53) VALUE SPACES. 
           10  FILLER           PIC X(10) VALUE 'PAY CYCLE '.   
           10  WSR-HD5-PAY-NBR  PIC 9(02) VALUE ZEROS . 

R067   01  WSR-HD6-01.  
R067       05  FILLER  PIC X(25) VALUE 'CASE        CAT   GG  PSC'. 

R067   01  WSR-DE1-01.  
R067       05  WSR-DE1-01-CASE         PIC 9(09).   
R067       05  FILLER                  PIC X(03)  VALUE SPACES. 
R067       05  WSR-DE1-01-CAT          PIC X(03).   
R067       05  FILLER                  PIC X(03)  VALUE SPACES. 
R067       05  WSR-DE1-01-GG           PIC X(01).   
R067       05  FILLER                  PIC X(03)  VALUE SPACES. 
R067       05  WSR-DE1-01-PSC          PIC 9(02).   
R067       05  FILLER                  PIC X(109)  VALUE SPACES.

       01  WSR-E-O-R.   
           10  FILLER                  PIC X(50)         VALUE SPACES.  
           10  FILLER                  PIC X(21)         VALUE  
                                           '* * END OF REPORT * *'. 

R025   01  WS-SYSTEM-TIME              PIC 9(08).   
R025   01  WS-SYSTEM-TIME-R REDEFINES WS-SYSTEM-TIME.   
R025       10  WS-SYSTEM-HHMMSS        PIC 9(06).   
R025       10  WS-SYSTEM-FF            PIC 9(02).   

R031   01  WS-R654-AMT-GR-CASH         PIC 9(04)V99 USAGE COMP. 
R031   01  WS-R255-AMT-GRANT-CASH      PIC 9(04)V99 USAGE COMP. 
R064   01  WSH-R255-OTI                PIC X(01).   
R064   01  WSH-R255-REC.
R064       05  WSH-R255-51             PIC X(51).   
R064       05  WSH-R255-52             PIC X(01).   


      **************************************************
      *** WORKING STORAGE DEFINTION OF DATABASE      ***
      *** RECORDS.                                   ***
      *** DB RECORDS PROC NAMINING CONVENTION IS     ***
      *** TO PREFIX 'AER' TO 'REC NO' AND SUFFIX 'P'.***
      **************************************************

      *** ENTRY POINT R666. 
       COPY AER672P.

       COPY AER247P.

       COPY AER248P.

       COPY AER254P.

      *** ENTRY POINT R246. 
       COPY AER634P.

       COPY AER252P.

       COPY AER253P.

       COPY AER255P.

       COPY AER269P.

       COPY AER260P.

       COPY AER268P.

       COPY AER251P.

       COPY AER256P.

       COPY AER257P.

       COPY AER258P.

       COPY AER259P.


      *** ENTRY POINT R637. 
       COPY AER654P.

      *** ENTRY POINT R270. 
       COPY AER271P.

      *** ENTRY POINT R287. 
       COPY AER291P.

      *** ENTRY POINT R953. 
       COPY AER954P.
R065   01  WSS-UPDATE-FLAG             PIC X(01).   
R065       COPY  APB04BP.   

       COMMON-STORAGE SECTION.  

       PROCEDURE DIVISION.  
       0000-LOGIC-DRIVER SECTION.   
       0000-LOGIC-DRIVER-PARA.  
           SET SW-FATAL-ERROR-FLAG        OFF.  
           SET SW-ERROR-AFTER-GOOD-DEPART OFF.  
           PERFORM 1000-HOUSEKEEPING.   
R070       MOVE  ZEROES  TO  WST-AUTO-DISC-TOTALS.  
R070       MOVE  ZEROES  TO  WSS-AUTO-SS
R070                         WSS-AUTO-LOAD. 
R069       MOVE  'N'  TO  WSS-R246-EOA. 
TEST1 *    MOVE  'N'  TO  WS-TEST-SW.   
R075A      MOVE  M2K-CPF-CYCLE-DATE-NUM   TO   M2K-GREGORIAN-DATE.  
R075A      PERFORM  6520-GRG-TO-JUL.
R075A      MOVE  M2K-JULIAN-DATE          TO   WSH-TODAYS-DATE. 
R069       PERFORM 2000-PROCESS UNTIL WSS-R246-EOA  =  'Y'. 
           PERFORM 3000-CLOSING.


      ********************************************************  
      * THE FOLLOWING SECTION SHOULD CONTAIN ALL PRELIMINARY *  
      * DATA FIELD INITIALISATION, TABLE SETUPS, FILE        *  
      * SETUPS, AND DATABASE SETUP ETC.                      *  
      *                                                      *  
      * THIS IS THE MAIN HOUSEKEEPING DRIVER PARA.           *  
      ********************************************************  
       1000-HOUSEKEEPING SECTION.   
       1000-INITIALIZE. 
           MOVE 1000                   TO WSH-ERR-PARA-NO.  

R069       ACCEPT  WSH-RUN-FLAG  FROM  CARD-READER. 
R069       IF  WSH-RUN-FLAG  =  'A80'  OR  'A86'
R069           NEXT  SENTENCE   
R069       ELSE 
R069           DISPLAY 'INVALID RUN FLAG ' WSH-RUN-FLAG UPON PRINTER
R069           SET  SW-FATAL-ERROR-FLAG  ON 
R069           PERFORM  3999-STOP-RUN.  
R070       ACCEPT  WSH-SYS-TIME  FROM  TIME.
      ***************************************************   
      *** CALL ASB001 TO GET CYCLED DATE, NBR-PAYDAY, ***   
      *** AND DOUBLE-PAYDAY.                          ***   
      *** CONVERT CYCLE DATE TO JULIAN, AS IT WILL BE ***   
      *** STORED IN MANY DB RECORDS.                  ***   
      ***************************************************   
       1000-GET-CYCLE-DATE. 
           CALL 'ASB001' USING WS-CPF-PARAM-LIST.   
           IF CPF-STATUS-INDCTR1 NOT = ZEROS
              SET SW-FATAL-ERROR-FLAG  TO ON
              DISPLAY 'ERROR IN ASB001. STATUS IS ' CPF-STATUS-INDCTR1  
                      UPON PRINTER  
              PERFORM 3999-STOP-RUN.

M322       MOVE M2K-CPF-CYCLE-DATE-NUM TO M2K-GREGORIAN-DATE.   
           PERFORM 6520-GRG-TO-JUL. 
M307       MOVE M2K-JULIAN-DATE        TO  WSH-CPF-CYCLE-JUL.   

      ***************************************************   
      *** REGISTER PROGRAM ON BCF VIA ASB002.         ***   
      ***************************************************   
       1000-WRITE-INIT-REC-TO-BCF.  
           MOVE SPACES                 TO  WS-BCF-PARAM-LIST    .   
           MOVE CPF-CYCLE-DATE-NUM     TO  BCF-CYCLE-DATE       .   
           MOVE 'ATE01D'               TO  BCF-RUN-ID           .   
           MOVE SPACES                 TO  BCF-PROCESSING-DATEX .   
           MOVE SPACES                 TO  BCF-PROCESSING-TIMEX .   
           MOVE 'A'                    TO  BCF-RECORD-TYPE      .   
           MOVE SPACES                 TO  BCF-SECD-KEY         .   
           MOVE 'W'                    TO  BCF-READ-WRITE-FLAG  .   
           MOVE SPACES                 TO  BCF-APND-DATA        .   

           CALL 'ASB002' USING WS-BCF-PARAM-LIST.   
           IF BCF-STATUS-INDCTR2 > 0
              PERFORM 1820-ASB002-ERROR 
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 3999-STOP-RUN.

      ***************************************************   
      *** INITIALIZE THE SUMMARY COUNTY-CAT TABLE.    ***   
      *** THIS TABLE MUST BE  INITIALIZED PRIOR TO    ***   
      *** ALL PROCESSING, BECAUSE IN CASE OF ANY      ***   
      *** NORMAL TERMINATION DURING HOUSEKEEPING, IT  ***   
      *** WUD BUILD THE OUTPUT CONTROL FILE.          ***   
      ***************************************************   
       1000-INIT-CNTY-CAT-TAB.  
           PERFORM 1700-INIT-WST-CNTY-CAT-TAB    THRU 1700-EXIT.

      ***************************************************   
      *** OPEN ALL OUTPUT FILES NOW.                  ***   
      *** ALL OUTPUT FILES MUST BE OPENED BEFORE      ***   
      *** OTHER PROCESSING, BECAUSE IN CASE OF        ***   
      *** SUPPLEMENTAL PAYDAYS, IT WILL BE REQD THAT  ***   
      *** WE CREATE OUTPUT BLANK FILES. (3000 WILL    ***   
      *** DO THE CLOSING.)                            ***   
      ***************************************************   
       1000-OPEN-OUTPUT-FILES-NOW.  
           PERFORM 1600-OPEN-OUTPUT-FILES        THRU 1600-EXIT.

      ***************************************************   
      *** SUPPLEMENTAL PAYDAY PROCESSING.             ***   
      *** NO PROCESS IS DONE FOR SUPPLEMENTAL PAY     ***   
      *** DAYS. HOWEVER DO A NORMAL CLOSE OF ALL      ***   
      *** FILES , OUTPUT BCF COUNTS AND STOP.         ***   
      ***************************************************   
       1000-CHECK-SUPP-PAYDAY.  
           IF CPF-PAYDAY-NBR > 20   
              PERFORM 3000-CLOSING  
              PERFORM 3999-STOP-RUN.

       1000-DETAIL-SETUP.   
           PERFORM 1100-PRO-PAYMENT-INFO         THRU 1100-EXIT.
R070       PERFORM 1120-OPEN-TDTE        THRU 1120-EXIT.
R070       PERFORM  1150-GET-PCTS    THRU  1150-EXIT.   
           PERFORM 1200-SETUP-CAT                THRU 1200-EXIT.
           PERFORM 1400-SETUP-COUNTY             THRU 1400-EXIT.
R053       PERFORM 1950-LOAD-ARM61001            THRU 1950-EXIT.
           PERFORM 1500-SETUP-RUN-TYPE           THRU 1500-EXIT.
R067       PERFORM  1510-OPEN-ATE01DR01  THRU  1510-EXIT.   
MD02       PERFORM 1800-LOAD-TCAT-TABLE          THRU 1800-EXIT.
R053       PERFORM 1900-LOAD-TCLK-TABLE          THRU 1900-EXIT.
R070       PERFORM  1920-LOAD-TARB    THRU  1920-EXIT.  
           PERFORM 7000-OPEN-DB-AREAS-SECTION.  

       1000-EXIT-SECTION.   
           EXIT.

      ********************************************************  
      *** THE FOLLOWING SECTION CONTAINS ALL SUBROUTINES/  ***  
      *** DETAIL SUB-PARAS OF THE MAIN HOUSEKEEPING DRIVER ***  
      *** MODULE. SOME OF THEM MAY ALSO BE ACCESSED FROM   ***  
      *** OTHER SECTIONS.                                  ***  
      ********************************************************  
       1100-HOUSEKEEPING-SUBS SECTION.  

      ********************************************************  
      *** PROCESS PAYMENT INFO.                            ***  
      *** ALSO CHECK IF THIS IS A DOUBLE PAYMENT DAY:      ***  
      *** IF IT IS, THEN THIS RUN WILL BE SCHEDULED TWICE. ***  
      *** FIRST TIME, IT SHOULD PROCEED AS NORMAL, &       ***  
      *** SECOND TIME IT SHOULD PIKUP 2ND PDY INFO FROM    ***  
      *** ATE20D01 FILE.                                   ***  
      ********************************************************  
       1100-PRO-PAYMENT-INFO.   
           OPEN I-O ATE20D01.   
           MOVE 1                      TO WSS-ATE20D01-OPEN.

       1100-READ-ATE20D01.  
           READ ATE20D01 AT END 
                SET SW-FATAL-ERROR-FLAG          TO ON  
                MOVE 'F'               TO WS-SML-MESSAGE-CAT
                MOVE 024               TO WS-SML-MESSAGE-CODE   
                MOVE 'NO PAYDAY'       TO WS-SML-PARAM-1
                MOVE 'ATE20D01 '       TO WS-SML-PARAM-2
                PERFORM 1810-DISPLAY-MSG
                PERFORM 1850-CLOSE-FILES
                PERFORM 1840-FINAL-MSG  
                PERFORM 3999-STOP-RUN.  

       1100-CHECK-PAYDAY.   
      * 
      * 
R028       IF ( CPF-PAYDAY-NBR = PAYDAY-NBR 
R028                    IN FIRST-PAYDAY IN PAYDAY-REC )  AND
R028          ( PROGRAM-IND = '0' OR '1' )  
R028              GO TO 1100-SAVE-PAYMENT-DATE. 
R028       IF PROGRAM-IND = '2' AND DBL-PAYDAY-IND = '1'
R028         IF PAYDAY-NBR IN SECOND-PAYDAY IN PAYDAY-REC = 
R028            PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC + 1
R028              GO TO 1100-SAVE-PAYMENT-DATE. 
R028       SET SW-FATAL-ERROR-FLAG  TO ON.  
R028       MOVE 'F'                    TO WS-SML-MESSAGE-CAT.   
R028       MOVE 075                    TO WS-SML-MESSAGE-CODE.  
R028       MOVE 'DIFF PAYDAY'          TO WS-SML-PARAM-1.   
R028       MOVE 'ATE20D01 '            TO WS-SML-PARAM-2.   
R028       PERFORM 1810-DISPLAY-MSG.
R028       PERFORM 1850-CLOSE-FILES.
R028       PERFORM 1840-FINAL-MSG.  
R028       PERFORM 3999-STOP-RUN.   

       1100-SAVE-PAYMENT-DATE.  
M307       MOVE RECURR-PAY-DATE IN PAYDAY-REC TO WSH-PAYMENT-DATE.  
M307       MOVE RECURR-PAY-DATE IN PAYDAY-REC TO M2K-JULIAN-DATE.   
M307       PERFORM 6510-JUL-TO-GRG. 
M307       IF M2K-DATE-CONV-ERROR-IND NOT = 0   
M307          PERFORM 6530-DTE-CONV-ERROR   
M307       ELSE 
M307          MOVE M2K-GRG-Y              TO WSH-PMT-DATE-YY
M307          MOVE M2K-GRG-MM             TO WSH-PMT-DATE-MM.   
R070       MOVE  M2K-GREGORIAN-DATE    TO  WSH-PRIOR-END-N  
R070                                       WSH-BLD-END-PAY-N.   
R070       MOVE  01              TO  WSH-PRIOR-DD.  
R070       MOVE  WSH-PRIOR-END-N    TO  M2K-GREGORIAN-DATE. 
R070       PERFORM  6520-GRG-TO-JUL.
R070       MOVE  M2K-JULIAN-DATE  TO  WSH-PRIOR-JUL.
R070       ADD  1  TO  WSH-BLD-END-MM.  
R070       MOVE  01    TO  WSH-BLD-END-DD.  
R070       IF  WSH-BLD-END-MM  >  12
R070           MOVE  01  TO  WSH-BLD-END-MM 
R070           ADD    1  TO  WSH-BLD-END-YY.
R070       MOVE  WSH-BLD-END-PAY-N    TO  M2K-GREGORIAN-DATE.   
R070       PERFORM  6520-GRG-TO-JUL.
R070       MOVE  M2K-JULIAN-DATE      TO  M2K-CONV-JUL-DT.  
R070       MOVE  01   TO  M2K-IN-DAYS.  
R070       MOVE   0   TO  M2K-IN-YR.
R070       PERFORM  C010-SUBTRACT-JULIAN-M2K.   
R070       MOVE  M2K-CONV-JUL-DT      TO  WSH-END-PAY-DATE. 
R070       MOVE  2ND-PAY-DATE  IN  FIRST-PAYDAY  TO  M2K-CONV-JUL-DT.   
R070       MOVE  1  TO  M2K-IN-DAYS.
R070       MOVE  0  TO  M2K-IN-YR.  
R070       PERFORM  C010-SUBTRACT-JULIAN-M2K.   
R070       MOVE  M2K-CONV-JUL-DT  TO  WSH-2ND-PAY-MINUS-1   
R070                                  M2K-JULIAN-DATE.  
R070       PERFORM  6510-JUL-TO-GRG.
R070       MOVE  M2K-GREGORIAN-DATE  TO  WSH-2ND-MINUS-1-GREG.  

      ********************************************************  
      *** DOUBLE PAYDAY.                                   ***  
      *** START OF 1ST PASS. PROGRAM-IND HAS BEEN SET TO 0.***  
      *** END   OF 1ST PASS. PROGRAM IND WILL BE SET  TO 2.***  
      *** START OF 2ND PASS. PROGRAM-IND IS NOW 2.         ***  
      *** END   OF 2ND PASS. PROGRAM IND WILL BE SET  TO 1.***  
      ********************************************************  
       1100-CHECK-DBL-PDY-WHICH-RUN.
           IF DBL-PAYDAY-IND = '1' AND  
              PROGRAM-IND = '2' 
                MOVE PAYDAY-NBR        IN SECOND-PAYDAY    TO   
                     PAYDAY-NBR        IN FIRST-PAYDAY  
                MOVE 2ND-DEADLINE-DATE IN SECOND-PAYDAY    TO   
                     2ND-DEADLINE-DATE IN FIRST-PAYDAY  
                MOVE 2ND-PAY-DATE      IN SECOND-PAYDAY    TO   
                     2ND-PAY-DATE      IN FIRST-PAYDAY  
                MOVE 3RD-DEADLINE-DATE IN SECOND-PAYDAY    TO   
                     3RD-DEADLINE-DATE IN FIRST-PAYDAY  
                MOVE 3RD-PAY-DATE      IN SECOND-PAYDAY    TO   
                     3RD-PAY-DATE      IN FIRST-PAYDAY. 

       1100-EXIT.   
           EXIT.

R070   1120-OPEN-TDTE.  
R070       OPEN  INPUT  TDTE-FILE.  
R070       MOVE  99999999    TO  WSH-TDTE-BEG-DTE.  
R070       PERFORM  1125-READ-TDTE-FILE   THRU  1125-EXIT.  
R070       IF  WSH-TDTE-BEG-DTE  =  99999999
R070           DISPLAY  'NO TDTE FOR ADRS '  UPON  PRINTER  
R070           SET  SW-FATAL-ERROR-FLAG  ON 
R070           MOVE  'F'    TO  WS-SML-MESSAGE-CAT  
R070           MOVE  024    TO  WS-SML-MESSAGE-CODE 
R070           MOVE  'ADRS MISSING'  TO  WS-SML-PARAM-1 
R070           PERFORM  1810-DISPLAY-MSG
R070           PERFORM  1850-CLOSE-FILES
R070           PERFORM  1840-FINAL-MSG  
R070           PERFORM  3999-STOP-RUN.  
R070       CLOSE  TDTE-FILE.
R070   1120-EXIT.    EXIT.  
R070   1125-READ-TDTE-FILE. 
R070       READ  TDTE-FILE   AT  END
R070           GO  TO  1125-EXIT.   
R070       IF  TDTE-CODE  =  'ADRS  '   
R070           NEXT  SENTENCE   
R070       ELSE 
R070           GO  TO  1125-READ-TDTE-FILE. 
R070       MOVE  TDTE-START-DATE  TO  WSH-TDTE-BEG-DTE. 
R070   1125-EXIT.    EXIT.  
R070   1150-GET-PCTS.   
R070       OPEN  INPUT  ATE01DCD1.  
R070       READ  ATE01DCD1  AT  END 
R070           MOVE  ZEROES  TO  WSH-TOT-PCT
R070                             WSH-CLS-PCT
R070                             WSH-SUS-PCT
R070           CLOSE  ATE01DCD1 
R070           GO  TO  1150-EXIT.   
R070       IF  ATE01DCD1-TOT-PCT  NUMERIC   
R070           MOVE  ATE01DCD1-TOT-PCT  TO  WSH-TOT-PCT 
R070       ELSE 
R070           MOVE  ZEROES    TO  WSH-TOT-PCT. 
R070       IF  ATE01DCD1-CLS-PCT  NUMERIC   
R070           MOVE  ATE01DCD1-CLS-PCT  TO  WSH-CLS-PCT 
R070       ELSE 
R070           MOVE  ZEROES    TO  WSH-CLS-PCT. 
R070       IF  ATE01DCD1-SUS-PCT  NUMERIC   
R070           MOVE  ATE01DCD1-SUS-PCT  TO  WSH-SUS-PCT 
R070       ELSE 
R070           MOVE  ZEROES    TO  WSH-SUS-PCT. 
R070       CLOSE  ATE01DCD1.
R070   1150-EXIT.    EXIT.  
      ********************************************************  
      *** SETUP CATEGORY TABLE FROM ATE10M01.              ***  
      *** IF BCF COUNT ON ATE10M01 FILE DOES NOT MATCH     ***  
      *** ACTUAL RECORDS READ, AN ERROR CONDITION IS       ***  
      *** FLAGGED OUT.                                     ***  
      ********************************************************  
       1200-SETUP-CAT.  
           OPEN INPUT ATE10M01. 
           MOVE 1                      TO WSS-ATE10M01-OPEN.

       1200-FETCH-BCF-ATE10M01. 
           MOVE SPACES                 TO WS-BCF-PARAM-LIST.
           MOVE 'ATE10M01'             TO BCF-FILE-IDENTIF. 
           MOVE CPF-CYCLE-DATE         TO BCF-FILE-CYCLE-DATE.  
           MOVE 'R'                    TO BCF-READ-WRITE-FLAG.  
           CALL 'ASB002' USING WS-BCF-PARAM-LIST.   
           IF BCF-STATUS-INDCTR2 NOT = 0
              PERFORM 1820-ASB002-ERROR 
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 1840-FINAL-MSG
              PERFORM 3999-STOP-RUN.

       1200-BUILD-WST-CAT-TAB.  
           SET WSI-CAT-IDX             TO 1.
           SET WSI-CAT-ONLY-IDX        TO 1.
           PERFORM 1250-BUILD-WST-CAT-TAB        THRU 1250-EXIT 
                   UNTIL WSS-ATE10M01-EOF-ON.   

       1200-CHECK-REC-CNT.  
           IF WSA-ATE10M01-REC-CNT NOT = BCF-GROSS-CT   
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 018                 TO WS-SML-MESSAGE-CODE   
              MOVE 'REC CNT ?'         TO WS-SML-PARAM-1
              MOVE 'ATE10M01'          TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
              SET SW-ERROR-AFTER-GOOD-DEPART TO ON. 

       1200-EXIT.   
           EXIT.

      ********************************************************  
      *** DETAIL BUILD OF WST-CAT-TAB.                     ***  
      *** READ & MOVE ATE10M01 REC TO WST. AT EOF, SET     ***  
      *** EOF-SW AND EXIT.                                 ***  
      ***                                                  ***  
      *** IGNORE FOOD-STAMP CATEGORIES.                    ***  
      *** ALSO CONTROL THE BUILD PROCESS OF CATEGORY-ONLY  ***  
      *** TABLE.                                           ***  
      ********************************************************  
       1250-BUILD-WST-CAT-TAB.  
           READ ATE10M01 AT END 
                MOVE 1                 TO WSS-ATE10M01-EOF  
                SET WSI-CAT-IDX        DOWN BY 1
                SET WSI-CAT-ONLY-IDX   DOWN BY 1
                SET WSH-CAT-TAB-SIZE   TO WSI-CAT-IDX   
                SET WSH-CAT-ONLY-TAB-SIZE TO WSI-CAT-ONLY-IDX   
                GO TO 1250-EXIT.
           ADD 1                       TO WSA-ATE10M01-REC-CNT. 
R067       MOVE  0  TO  M2K-DATE-CONV-ERROR-IND.
R067       MOVE  M452-DTE-END-EFFV-YY  TO  M2K-GRG-YY.  
R067       MOVE  M452-DTE-END-EFFV-MM  TO  M2K-GRG-MM.  
R067       MOVE  M452-DTE-END-EFFV-DD  TO  M2K-GRG-DD.  
R067       IF  M2K-GREGORIAN-DATE  =  ZEROES
R067           MOVE  ZEROES  TO  M2K-JULIAN-DATE
R067       ELSE 
R067           PERFORM  6520-GRG-TO-JUL.
R067       IF  M2K-DATE-CONV-ERROR-IND  >  0
R067           PERFORM  6530-DTE-CONV-ERROR 
R067           SET  SW-FATAL-ERROR-FLAG  ON 
R067           PERFORM  1840-FINAL-MSG  
R067           PERFORM  3999-STOP-RUN.  
R067       IF  M2K-JULIAN-DATE  =  ZEROES   
R067           NEXT  SENTENCE   
R067       ELSE 
R067           IF  (WSH-PAYMENT-DATE  =  M2K-JULIAN-DATE  OR
R067                WSH-PAYMENT-DATE  >  M2K-JULIAN-DATE)   
TEST  *            DISPLAY 'CAT/PGM STAT END DATE = '  ATEKEY   
TEST  *                    '  '  M2K-GREGORIAN-DATE  UPON  PRINTER  
R067               GO  TO  1250-EXIT.   

       1250-IGNORE-FS-CAT.  
           IF M452-CDE-CATEGORY = 'FS ' 
              GO TO 1250-EXIT.  

       1250-CHECK-TAB-OVFL. 
           IF WSI-CAT-IDX > WSH-CAT-TAB-MAX-SIZE
R043          DISPLAY 'CATEGORY TABLE SIZE EXCEEDED ' UPON PRINTER  
              MOVE 'F'                 TO WS-SML-MESSAGE-CAT
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE ATEKEY IN ATE10M-RECORD TO WS-SML-PARAM-1
              MOVE WSH-CAT-TAB-MAX-SIZE    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
              PERFORM 1850-CLOSE-FILES  
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 1840-FINAL-MSG
              PERFORM 3999-STOP-RUN.

       1250-MOVE-REC-TO-TAB.
           MOVE ATEKEY                           TO WST-CAT-PGM 
                                                    (WSI-CAT-IDX).  
           MOVE M452-CDE-ISSNC-CATEGORY          TO WST-CAT-TYPE
                                                    (WSI-CAT-IDX).  

       1250-CONTROL-BLD-WST-CAT-ONLY.   
           IF WSH-SAVE-CAT-CODE NOT = M452-CDE-CATEGORY 
              MOVE M452-CDE-CATEGORY   TO WSH-SAVE-CAT-CODE 
              PERFORM 1270-BUILD-WST-CAT-ONLY    THRU 1270-EXIT.

       1250-INC-WSI-CAT-IDX.
           SET WSI-CAT-IDX             UP BY 1. 

       1250-EXIT.   
           EXIT.

      ********************************************************  
      *** DETAIL BUILD OF WST-CAT-ONLY                     ***  
      *** JUSTY STORE THE CATEGORE CODE.                   ***  
      ********************************************************  
       1270-BUILD-WST-CAT-ONLY. 
           EXIT.

       1270-CHECK-OVERFLOW. 
           IF WSI-CAT-ONLY-IDX > WSH-CAT-ONLY-TAB-MAX-SIZE  
              MOVE 'F'                 TO WS-SML-MESSAGE-CAT
R043          DISPLAY 'CATEGORY TABLE SIZE EXCEEDED ' UPON PRINTER  
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE M452-CDE-CATEGORY   TO WS-SML-PARAM-1
              MOVE WSH-CAT-ONLY-TAB-MAX-SIZE  TO WS-SML-PARAM-2 
              PERFORM 1810-DISPLAY-MSG  
              PERFORM 1850-CLOSE-FILES  
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 1840-FINAL-MSG
              PERFORM 3999-STOP-RUN.

       1270-DETAIL-MOVE.
           MOVE M452-CDE-CATEGORY      TO WST-CAT-ONLY  
                                          (WSI-CAT-ONLY-IDX).   

       1270-INC-WSI-CAT-ONLY-IDX.   
           SET WSI-CAT-ONLY-IDX        UP BY 1. 

       1270-EXIT.   
           EXIT.

      ********************************************************  
      *** SETUP COUNTY TABLE FROM ARM60001.                ***  
      *** IF BCF COUNT ON ARM60001 FILE DOES NOT MATCH     ***  
      *** ACTUAL RECORDS READ, AN ERROR CONDITION IS       ***  
      *** FLAGGED OUT.                                     ***  
      ********************************************************  
       1400-SETUP-COUNTY.   
           OPEN INPUT ARM60001. 
           MOVE 1                      TO WSS-ARM60001-OPEN.

       1400-FETCH-BCF-ARM60001. 
           MOVE SPACES                 TO WS-BCF-PARAM-LIST.
           MOVE 'ARM60001'             TO BCF-FILE-IDENTIF. 
           MOVE CPF-CYCLE-DATE         TO BCF-FILE-CYCLE-DATE.  
           MOVE 'R'                    TO BCF-READ-WRITE-FLAG.  
           CALL 'ASB002' USING WS-BCF-PARAM-LIST.   
           IF BCF-STATUS-INDCTR2 NOT = 0
              PERFORM 1820-ASB002-ERROR 
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 1840-FINAL-MSG
              PERFORM 3999-STOP-RUN.

       1400-BUILD-WST-CNTY-TAB. 
           SET WSI-CNTY-IDX            TO 01
           PERFORM 1450-BUILD-WST-CNTY-TAB       THRU 1450-EXIT 
                   UNTIL WSS-ARM60001-EOF-ON.   

       1400-CHECK-REC-CNT.  
           IF WSA-ARM60001-REC-CNT NOT = BCF-GROSS-CT   
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 018                 TO WS-SML-MESSAGE-CODE   
              MOVE 'REC CNT ?'         TO WS-SML-PARAM-1
              MOVE 'ARM60001'          TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
              SET SW-ERROR-AFTER-GOOD-DEPART TO ON. 

       1400-EXIT.   
           EXIT.

      ********************************************************  
      *** DETAIL BUILD OF WST-CNTY-TAB.                    ***  
      *** READ & MOVE ARM60001 REC TO WST. AT EOF, SET     ***  
      *** EOF-SW AND EXIT.                                 ***  
      ********************************************************  
       1450-BUILD-WST-CNTY-TAB. 
           READ ARM60001 AT END 
                MOVE 1                 TO WSS-ARM60001-EOF  
                MOVE 0                 TO WSS-ARM60001-OPEN 
                CLOSE ARM60001  
                SET WSI-CNTY-IDX       DOWN BY 1
                SET WSH-CNTY-TAB-SIZE  TO WSI-CNTY-IDX  
                GO TO 1450-EXIT.
           ADD 1                       TO WSA-ARM60001-REC-CNT. 

       1450-SAVE-ONLY-UNIQUE-CODES. 
           IF WSH-SAVE-COUNTY-CODE = COUNTY-CODE
              GO TO 1450-EXIT.  

       1450-CHECK-TAB-OVFL. 
           MOVE COUNTY-CODE            TO WSH-SAVE-COUNTY-CODE. 
           IF WSI-CNTY-IDX > WSH-CNTY-TAB-MAX-SIZE  
              MOVE 'F'                 TO WS-SML-MESSAGE-CAT
R043          DISPLAY 'COUNTY CODE TABLE SIZE EXCEEDED '
R043                              UPON PRINTER  
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE COUNTY-CODE IN SYS-REF-DET   
                                       TO WS-SML-PARAM-1
CHG35         MOVE WSH-CNTY-TAB-MAX-SIZE TO WS-SML-PARAM-2  
              PERFORM 1810-DISPLAY-MSG  
              PERFORM 1850-CLOSE-FILES  
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 1840-FINAL-MSG
              PERFORM 3999-STOP-RUN.

       1450-MOVE-REC-TO-TAB.
           MOVE COUNTY-CODE            TO WST-CNTY-NBR  
                                          (WSI-CNTY-IDX).   
           MOVE COUNTY-NAME            TO WST-CNTY-NAME 
                                          (WSI-CNTY-IDX).   

       1450-INC-WSI-CNTY-IDX.   
           SET WSI-CNTY-IDX            UP BY 1. 

       1450-EXIT.   
           EXIT.

      ********************************************************* 
      *** DESCRIBE PROCESS DESCRIPTION!!                    *** 
      ********************************************************* 
      ********************************************************* 
       1500-SETUP-RUN-TYPE. 
           EXIT.

       1500-SETUP-PAYMENT-MONTH.
           MOVE RECURR-PAY-DATE IN PAYDAY-REC   
M307                                   TO M2K-JULIAN-DATE.  
M307       PERFORM 6510-JUL-TO-GRG. 
M307       IF M2K-DATE-CONV-ERROR-IND NOT = 0   
M307          PERFORM 6530-DTE-CONV-ERROR   
M307       ELSE 
M307          MOVE M2K-GRG-MM             TO WSH-PAYMENT-MONTH. 

       1500-SETUP-PAYDAY-NBR.   
           MOVE PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC
                                       TO WSH-PAYDAY-NBR.   
R053
R053       MOVE WSH-PAYDAY-NBR         TO WSH-PREV-PAYDAY.  
R053       ACCEPT WSH-DATE             FROM DATE.   
R053       MOVE   WSH-MM               TO WSH-DEADLINE-MM.  
R053
R053       IF (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC > 00) AND   
R053          (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC < 11)   
R053           IF (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC < 6) AND
R053              (WSH-DD > 20) 
R053               MOVE WSH-DEADLINE-MM    TO ARM-MM-SUB
R053               ADD     10              TO WSH-PREV-PAYDAY   
R053               MOVE WSH-PREV-PAYDAY    TO ARM-PAY-SUB   
R053          ELSE  
R055              IF (WSH-MM = 01)  
R055                  MOVE 12 TO WSH-DEADLINE-MM
R055                  MOVE WSH-DEADLINE-MM    TO ARM-MM-SUB 
R055                  ADD     10              TO WSH-PREV-PAYDAY
R055                  MOVE WSH-PREV-PAYDAY    TO ARM-PAY-SUB
R055              ELSE  
R055                  SUBTRACT   1            FROM WSH-MM   
R055                                    GIVING WSH-DEADLINE-MM  
R055                  MOVE WSH-DEADLINE-MM    TO ARM-MM-SUB 
R055                  ADD     10              TO WSH-PREV-PAYDAY
R055                  MOVE WSH-PREV-PAYDAY    TO ARM-PAY-SUB
R053       ELSE 
R053          IF (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC > 10) AND
R053             (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC < 21)
R053              MOVE WSH-DEADLINE-MM TO ARM-MM-SUB
R053              SUBTRACT 10 FROM  
R053                        PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC
R053                GIVING WSH-PREV-PAYDAY  
R053              MOVE WSH-PREV-PAYDAY TO ARM-PAY-SUB.  
R053
R053       MOVE   20    TO WSH-PREV-DLE-CC. 
R053       MOVE PREV-DTE-DEADLINE (ARM-MM-SUB,ARM-PAY-SUB)  
R053         TO  WSH-PREV-DLE-YYDD. 
R053
R071       MOVE  20    TO  WSH-GA-PREV-CC.  
R071       MOVE  WSH-DEADLINE-MM  TO  WSH-PRIOR-MO. 
R071       SUBTRACT  1  FROM  WSH-PRIOR-MO. 
R071       MOVE  PREV-DTE-DEADLINE (WSH-PRIOR-MO CPF-PAYDAY-NBR)  TO
R071               WSH-GA-PREV-YYDDD.   
       1500-SETUP-RECUR-PAYDATE.
R053       MOVE DEADLINE-DATE IN FIRST-PAYDAY   
R053                                   TO M2K-CONV-JUL-DT.  
R053       MOVE 1                      TO M2K-IN-DAYS.  
R053       MOVE 0                      TO M2K-IN-YR.
R053       PERFORM C010-SUBTRACT-JULIAN-M2K.
R053       MOVE M2K-CONV-JUL-DT        TO WSH-RECUR-DEADLINE.   
R053
M307       MOVE RECURR-PAY-DATE IN FIRST-PAYDAY IN PAYDAY-REC   
M307                                   TO M2K-CONV-JUL-DT.  
M307       MOVE 1                      TO M2K-IN-DAYS.  
M307       MOVE 0                      TO M2K-IN-YR.
M307       PERFORM C010-SUBTRACT-JULIAN-M2K.
M307       MOVE M2K-CONV-JUL-DT        TO WSH-RECUR-PAYDATE.
R070       MOVE  1  TO  M2K-IN-DAYS.
R070       MOVE  0  TO  M2K-IN-YR.  
R070       PERFORM  C010-SUBTRACT-JULIAN-M2K.   
R070       MOVE  M2K-CONV-JUL-DT    TO  WSH-PAY-MINUS-1.

       1500-SETUP-2-PAYDATE.
R053       MOVE 2ND-DEADLINE-DATE IN FIRST-PAYDAY IN PAYDAY-REC 
R053                                   TO M2K-CONV-JUL-DT.  
R053       MOVE 1                      TO M2K-IN-DAYS.  
R053       MOVE 0                      TO M2K-IN-YR.
R053       PERFORM C010-SUBTRACT-JULIAN-M2K.
R053       MOVE M2K-CONV-JUL-DT        TO WSH-2-DEADLINE.   
R082       DISPLAY  '2ND DEADLINE '  WSH-2-DEADLINE  UPON  PRINTER.
R053
M307       MOVE 2ND-PAY-DATE IN FIRST-PAYDAY IN PAYDAY-REC  
M307                                   TO M2K-CONV-JUL-DT.  
M307       MOVE 1                      TO M2K-IN-DAYS.  
M307       MOVE 0                      TO M2K-IN-YR.
M307       PERFORM C010-SUBTRACT-JULIAN-M2K.
R082       MOVE M2K-CONV-JUL-DT        TO WSH-2-PAYDATE.
R082       DISPLAY  '2ND PAYDAY '  WSH-2-PAYDATE  UPON  PRINTER.

       1500-SETUP-3-PAYDATE.
R053       MOVE 3RD-DEADLINE-DATE IN FIRST-PAYDAY IN PAYDAY-REC 
R053                                   TO M2K-CONV-JUL-DT.  
R053       MOVE 1                      TO M2K-IN-DAYS.  
R053       MOVE 0                      TO M2K-IN-YR.
R053       PERFORM C010-SUBTRACT-JULIAN-M2K.
R053       MOVE M2K-CONV-JUL-DT        TO WSH-3-DEADLINE.   
R082       DISPLAY  '3RD DEADLINE '  WSH-3-DEADLINE  UPON  PRINTER.
R053
M307       MOVE 3RD-PAY-DATE IN FIRST-PAYDAY IN PAYDAY-REC  
M307                                   TO M2K-CONV-JUL-DT.  
M307       MOVE 1                      TO M2K-IN-DAYS.  
M307       MOVE 0                      TO M2K-IN-YR.
M307       PERFORM C010-SUBTRACT-JULIAN-M2K.
R082       MOVE M2K-CONV-JUL-DT        TO WSH-3-PAYDATE.
R082       DISPLAY  '3RD PAYDAY '  WSH-3-PAYDATE  UPON  PRINTER.
R053
R053   1500-SETUP-PAYDAY-DIFF.  
R053       MOVE WSH-RECUR-PAYDATE      TO HOLD-CALC-CURR-JUL-R  
R053       MOVE WSH-2-PAYDATE          TO HOLD-CALC-P2-JUL-R
R053
R053       IF (CALC-CURR-JUL-YY = CALC-P2-JUL-YY)   
R053           SUBTRACT CALC-CURR-JUL-DD FROM CALC-P2-JUL-DD
R053             GIVING HOLD-PAYDAY-DIFF.   
R053
R053       IF (CALC-CURR-JUL-YY < CALC-P2-JUL-YY)   
R053           SUBTRACT CALC-CURR-JUL-DD FROM 365   
R053             GIVING HOLD-PAYDAY-DIFF.   
R053
R053       DISPLAY '******* PAYDPAY DIFFERANCE *******' 
R053                                   UPON PRINTER.
R053       DISPLAY 'WSH-RECUR-PAYDATE  = ' WSH-RECUR-PAYDATE
R053                                   UPON PRINTER.
R053       DISPLAY 'WSH-2-PAYDATE      = ' WSH-2-PAYDATE
R053                                   UPON PRINTER.
R053       DISPLAY 'HOLD-PAYDAY-DIFF   = ' HOLD-PAYDAY-DIFF 
R053                                   UPON PRINTER.
R053
       1500-EXIT.   
           EXIT.

R067   1510-OPEN-ATE01DR01. 
R067       ACCEPT WSH-DATE             FROM DATE.   
R067       MOVE WSH-MM                 TO WSH-REP-MM.   
R067       MOVE WSH-DD                 TO WSH-REP-DD.   
R067       MOVE WSH-YY                 TO WSH-REP-YY.   
R067       MOVE WSH-REP-DATE           TO WSR-HD1-REP-DATE-01.  
R067       IF CPF-PAYDAY-NBR > 20   
R067                MOVE CPF-PAYDAY-NBR TO WSR-HD2-PAY-NBR  
R067         ELSE   MOVE WSH-PAYDAY-NBR TO WSR-HD2-PAY-NBR. 
R067       MOVE CPF-CYCLE-DATE         TO WSH-DATE. 
R067       MOVE WSH-MM                 TO WSH-REP-MM.   
R067       MOVE WSH-DD                 TO WSH-REP-DD.   
R067       MOVE WSH-YY                 TO WSH-REP-YY.   
R067       MOVE WSH-REP-DATE           TO WSR-HD2-PRO-DATE. 
R067
R067       ACCEPT WSH-TIME             FROM TIME.   
R067       MOVE WSH-HH                 TO WSH-REP-HH.   
R067       MOVE WSH-MIN                TO WSH-REP-MIN.  
R067       MOVE WSH-SS                 TO WSH-REP-SS.   
R067       MOVE WSH-REP-TIME           TO WSR-HD2-REP-TIME. 
R067       MOVE  WSH-PAYDAY-NBR  TO  WSR-HD5-PAY-NBR.   
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE  'ATE01DR01XST'    TO  WS-NEWFILE-NM
R069       ELSE 
R069           MOVE  'ATE01DR01FST'    TO  WS-NEWFILE-NM.   
R067       MOVE  SPACES            TO  WS-OLDFILE-NM.   
R067       MOVE  ZEROES            TO  WS-NEW-STATUS
R067                                   WS-OLD-STATUS
R067                                   WS-NEW-STATUS-WORD   
R067                                   WS-OLD-STATUS-WORD   
R067                                   WS-OLD-PAGE-CNT. 
R067       PERFORM  1870-CALL-ASB004.   
R067       DISPLAY 'FILE CREATED (' WS-NEWFILE-NM ')' UPON PRINTER. 
R067       OPEN  OUTPUT  ATE01DR01. 
R067       MOVE 1                      TO WSS-ATE01DR01-OPEN.   
R067       IF  WSA-LINE-CNT  >  55  
R067           PERFORM  2280-PRINT-HEADING  THRU  2280-EXIT.
R067   1510-EXIT.    EXIT.  
      ********************************************************  
      *** OPEN ALL REQUIRED OUTPUT FILES.                  ***  
      ********************************************************  
       1600-OPEN-OUTPUT-FILES.  
           OPEN OUTPUT ATE01D01.
R069A *    OPEN OUTPUT ATE01D02.
           OPEN OUTPUT ATE01D04.
           OPEN OUTPUT ATE01D05.
R069A *    OPEN OUTPUT ATE01D06.
R069A *    OPEN OUTPUT ATE01D07.
           OPEN OUTPUT ATE01D08.
           OPEN OUTPUT ATE01D09.
R053       OPEN OUTPUT ATE01D10.
R053       OPEN OUTPUT ATE01D11.
R053       OPEN OUTPUT ATE01D12.
R056       OPEN OUTPUT ATE01D13.
R056       OPEN OUTPUT ATE01D14.
R056       OPEN OUTPUT ATE01D15.
R056       OPEN OUTPUT ATE01D16.
R064       OPEN OUTPUT ATE01D17.
CC41B      OPEN OUTPUT ATE01D18.
R070       OPEN OUTPUT ATE01D20.
R075A      OPEN OUTPUT ATE01D21.
           OPEN OUTPUT ATE01DCKPT.  

       1600-SET-OPEN-SWITCHES.  
           MOVE 1                      TO WSS-ATE01D01-OPEN.
R069A *    MOVE 1                      TO WSS-ATE01D02-OPEN.
           MOVE 1                      TO WSS-ATE01D04-OPEN.
           MOVE 1                      TO WSS-ATE01D05-OPEN.
R069A *    MOVE 1                      TO WSS-ATE01D06-OPEN.
R069A *    MOVE 1                      TO WSS-ATE01D07-OPEN.
           MOVE 1                      TO WSS-ATE01D08-OPEN.
           MOVE 1                      TO WSS-ATE01D09-OPEN.
R053       MOVE 1                      TO WSS-ATE01D10-OPEN.
R053       MOVE 1                      TO WSS-ATE01D11-OPEN.
R053       MOVE 1                      TO WSS-ATE01D12-OPEN.
R056       MOVE 1                      TO WSS-ATE01D13-OPEN.
R056       MOVE 1                      TO WSS-ATE01D14-OPEN.
R056       MOVE 1                      TO WSS-ATE01D15-OPEN.
R056       MOVE 1                      TO WSS-ATE01D16-OPEN.
R064       MOVE 1                      TO WSS-ATE01D17-OPEN.
CC41B      MOVE 1                      TO WSS-ATE01D18-OPEN.
R070       MOVE 1                      TO WSS-ATE01D20-OPEN.
R075A      MOVE 1                      TO WSS-ATE01D21-OPEN.

       1600-INIT-FILE-RECORDS.  
           MOVE SPACES                 TO ATE01D08-RECORD.  
           MOVE SPACES                 TO ATE01D09-RECORD.  
R053       MOVE SPACES                 TO ATE01D10-RECORD.  
R053       MOVE SPACES                 TO ATE01D11-RECORD.  
R053       MOVE SPACES                 TO ATE01D12-RECORD.  
R056       MOVE SPACES                 TO ATE01D13-RECORD.  
R056       MOVE SPACES                 TO ATE01D14-RECORD.  
R056       MOVE SPACES                 TO ATE01D15-RECORD.  
R056       MOVE SPACES                 TO ATE01D16-RECORD.  
R064       MOVE SPACES                 TO ATE01D17-RECORD.  
CC41B      MOVE SPACES                 TO ATE01D18-RECORD.  
R070       MOVE SPACES                 TO ATE01D20-RECORD.  
R075A      MOVE SPACES                 TO ATE01D21-RECORD.  
       1600-EXIT.   
           EXIT.

      ********************************************************  
      *** INITIALIZE WST-CNTY-CAT-TABLE.                   ***  
      ********************************************************  
       1700-INIT-WST-CNTY-CAT-TAB.  
           PERFORM 1750-INIT-WST-CNTY-CAT-TAB    THRU 1750-EXIT 
                   VARYING WSI-C-C-CNTY-IDX  FROM 1 BY 1 UNTIL  
                   WSI-C-C-CNTY-IDX > WSH-CNTY-CAT-CNTY-TAB-MAX-SIZE
                       AFTER WSI-C-C-CAT-IDX FROM 1 BY 1 UNTIL  
                       WSI-C-C-CAT-IDX > WSH-CNTY-CAT-CAT-TAB-MAX-SIZE. 

       1700-EXIT.   
           EXIT.

      *******************************************************   
      *** DETAIL INITIALIZE.                              ***   
      *******************************************************   
       1750-INIT-WST-CNTY-CAT-TAB.  
           MOVE ZEROS                  TO WST-CNTY-CAT-ACT-BDGT-CNT 
                                          (WSI-C-C-CNTY-IDX 
                                           WSI-C-C-CAT-IDX).
           MOVE ZEROS                  TO WST-CNTY-CAT-SUS-BDGT-CNT 
                                          (WSI-C-C-CNTY-IDX 
                                           WSI-C-C-CAT-IDX).
           MOVE ZEROS                  TO WST-CNTY-CAT-MGA-DOLL 
                                          (WSI-C-C-CNTY-IDX 
                                           WSI-C-C-CAT-IDX).
           MOVE ZEROS                  TO WST-CNTY-CAT-MEM-ACT-CNT  
                                          (WSI-C-C-CNTY-IDX 
                                           WSI-C-C-CAT-IDX).

       1750-EXIT.   
           EXIT.

MD02   1800-LOAD-TCAT-TABLE.
MD02
MD02       OPEN INPUT TCAT-FILE.
MD02       SET TCAT-IDX TO 1.   
MD02
MD02   1800-LOAD-TCAT-TABLE-CONT.   
MD02
MD02       READ TCAT-FILE   
MD02          AT END MOVE 'Y' TO WSS-TCAT-FILE-SW.  
MD02       IF END-OF-TCAT-FILE  
MD02          CLOSE TCAT-FILE   
MD02          GO TO 1800-EXIT   
MD02       ELSE 
MD02           PERFORM 1805-CHECK-JAM-CATE  
MD02          MOVE CDE-CATEGORY OF TCAT-DATA TO 
MD02               TCAT-CDE-CATEGORY (TCAT-IDX) 
MD02          MOVE TCAT-PGM OF TCAT-DATA TO 
MD02               TCAT-TCAT-PGM (TCAT-IDX) 
MD02          SET TCAT-IDX UP BY 1  
MD02          ADD 1           TO TCAT-OCCURS-COUNT  
MD02          IF TCAT-OCCURS-COUNT > TCAT-TABLE-MAX 
MD02              CLOSE TCAT-FILE   
MD02              PERFORM 1820-ASB002-ERROR 
MD02              SET SW-FATAL-ERROR-FLAG  TO ON
MD02              PERFORM 1840-FINAL-MSG
MD02              MOVE 49 TO WS-SML-MESSAGE-CODE
MD02              MOVE 'F' TO WS-SML-MESSAGE-CAT
MD02              IF WS-SML-STATUS-INDCTR3 NOT = ZEROS  
MD02                  DISPLAY 'TERM - CAO TABLE MAX EXCEEDED'   
MD02                          UPON PRINTER  
MD02                  DISPLAY 'ASB003 ERROR' UPON PRINTER   
MD02                  PERFORM 3999-STOP-RUN 
MD02              ELSE  
MD02                  PERFORM 3999-STOP-RUN 
MD02          ELSE  
MD02             GO TO 1800-LOAD-TCAT-TABLE-CONT.   
MD02
MD02   1800-EXIT.   
MD02       EXIT.
MD02
MD02   1805-CHECK-JAM-CATE. 
MD02
MD02       IF CDE-CATEGORY OF TCAT-DATA = 'J  ' 
MD02                                   OR 'A  ' 
MD02                                   OR 'M  ' 
MD02           IF TCAT-PGM OF TCAT-DATA = 'M'   
MD02               MOVE 'Y' TO WSS-JAM-MEDI-FLAG
MD02           ELSE 
MD02           IF TCAT-PGM OF TCAT-DATA = 'C'   
MD02               MOVE 'Y' TO WSS-JAM-CASH-FLAG.   

      ********************************************************  
      *** THIS PARA DISPLAYS A MSG USING ASB003.           ***  
      *** PARAM VALUES COME FROM CALLING PARAS.            ***  
      ********************************************************  
       1810-DISPLAY-MSG.
           MOVE CPF-CYCLE-DATE         TO WS-SML-CYCLE-DATE  .  
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE  'ATE01D'    TO  WS-SML-RUN-ID  
R069       ELSE 
R069           MOVE  'ATF01D'    TO  WS-SML-RUN-ID. 
           CALL 'ASB003' USING SYS-MSG-LIST.
           PERFORM 1830-ASB003-ERROR.   
           MOVE SPACES                 TO SYS-MSG-LIST       .  

       1810-EXIT.   
           EXIT.

      ********************************************************  
      *** THIS PARA DISPLAYS ERROR THAT OCCURED, WHEN      ***  
      *** ASB002 WAS CALLED.                               ***  
      ********************************************************  
       1820-ASB002-ERROR.   
           MOVE 'W'                    TO WS-SML-MESSAGE-CAT .  
           MOVE 005                    TO WS-SML-MESSAGE-CODE.  
           MOVE 'ERROR IN ASB002'      TO WS-SML-PARAM-1     .  
           MOVE BCF-STATUS-INDCTR2     TO WS-SML-PARAM-2     .  
           PERFORM 1810-DISPLAY-MSG.
           SET SW-ERROR-AFTER-GOOD-DEPART TO ON.

       1820-EXIT.   
           EXIT.

      ********************************************************  
      *** THIS PARA IS INVOKED WHEN THERE IS AN ERROR IN   ***  
      *** DISPLAYING A SYSTEM MESSAGE.                     ***  
      ********************************************************  
       1830-ASB003-ERROR.   
           IF WS-SML-BAD
              DISPLAY 'ABNORMAL RETURN FROM SUBROUTINE ASB003'  
                       UPON PRINTER.

       1830-EXIT.   
           EXIT.

      ********************************************************  
      *** THIS PARA IS INVOKED JUST BEFORE THE PROGRAM     ***  
      *** WUD TERMINATE, AND CHECKS THE SWITCH VALUES.     ***  
      ********************************************************  
       1840-FINAL-MSG.  
           IF      SW-FATAL-ERROR-ON
                   MOVE 'F'            TO WS-SML-MESSAGE-CAT
                   MOVE 006            TO WS-SML-MESSAGE-CODE   
           ELSE IF SW-ERROR-AFTER-GOOD-DEPART-ON
                   MOVE 'W'            TO WS-SML-MESSAGE-CAT
                   MOVE 006            TO WS-SML-MESSAGE-CODE   
           ELSE 
                   MOVE 'R'            TO WS-SML-MESSAGE-CAT
                   MOVE 004            TO WS-SML-MESSAGE-CODE.  
           PERFORM 1810-DISPLAY-MSG.

       1840-EXIT.   
           EXIT.

      ********************************************************  
      *** THIS PARA WUD CLOSE ALL OPEN FILES.              ***  
      ********************************************************  
       1850-CLOSE-FILES.
           IF WSS-ARM60001-OPEN-ON  
              MOVE 0                   TO WSS-ARM60001-OPEN 
              CLOSE ARM60001.   

           IF WSS-ATE10M01-OPEN-ON  
              MOVE 0                   TO WSS-ATE10M01-OPEN 
              CLOSE ATE10M01.   

           IF WSS-ATE20D01-OPEN-ON  
              MOVE 0                   TO WSS-ATE20D01-OPEN 
              CLOSE ATE20D01.   
           IF WSS-ATE01D01-OPEN-ON  
              MOVE 0                   TO WSS-ATE01D01-OPEN 
              CLOSE ATE01D01.   

R069A *    IF WSS-ATE01D02-OPEN-ON  
R069A *       MOVE 0                   TO WSS-ATE01D02-OPEN 
R069A *       CLOSE ATE01D02.   

           IF WSS-ATE01D04-OPEN-ON  
              MOVE 0                   TO WSS-ATE01D04-OPEN 
              CLOSE ATE01D04.   

           IF WSS-ATE01D05-OPEN-ON  
              MOVE 0                   TO WSS-ATE01D05-OPEN 
              CLOSE ATE01D05.   

R069A *    IF WSS-ATE01D06-OPEN-ON  
R069A *       MOVE 0                   TO WSS-ATE01D06-OPEN 
R069A *       CLOSE ATE01D06.   
R069A * 
R069A *    IF WSS-ATE01D07-OPEN-ON  
R069A *       MOVE 0                   TO WSS-ATE01D07-OPEN 
R069A *       CLOSE ATE01D07.   

           IF WSS-ATE01D08-OPEN-ON  
              MOVE 0                   TO WSS-ATE01D08-OPEN 
              CLOSE ATE01D08.   

           IF WSS-ATE01D09-OPEN-ON  
              MOVE 0                   TO WSS-ATE01D09-OPEN 
              CLOSE ATE01D09.   

R053       IF WSS-ATE01D10-OPEN-ON  
R053          MOVE 0                   TO WSS-ATE01D10-OPEN 
R053          CLOSE ATE01D10.   
R053
R053       IF WSS-ATE01D11-OPEN-ON  
R053          MOVE 0                   TO WSS-ATE01D11-OPEN 
R053          CLOSE ATE01D11.   
R053
R053       IF WSS-ATE01D12-OPEN-ON  
R053          MOVE 0                   TO WSS-ATE01D12-OPEN 
R053          CLOSE ATE01D12.   
R053
R056       IF WSS-ATE01D13-OPEN-ON  
R056          MOVE 0                   TO WSS-ATE01D13-OPEN 
R056          CLOSE ATE01D13.   
R056
R056       IF WSS-ATE01D14-OPEN-ON  
R056          MOVE 0                   TO WSS-ATE01D14-OPEN 
R056          CLOSE ATE01D14.   
R056
R056       IF WSS-ATE01D15-OPEN-ON  
R056          MOVE 0                   TO WSS-ATE01D15-OPEN 
R056          CLOSE ATE01D15.   
R056
R056       IF WSS-ATE01D16-OPEN-ON  
R056          MOVE 0                   TO WSS-ATE01D16-OPEN 
R056          CLOSE ATE01D16.   
R056
R064       IF WSS-ATE01D17-OPEN-ON  
R064          MOVE 0                   TO WSS-ATE01D17-OPEN 
R064          CLOSE ATE01D17.   

CC41B      IF WSS-ATE01D18-OPEN-ON  
CC41B         MOVE 0                   TO WSS-ATE01D18-OPEN 
CC41B         CLOSE ATE01D18.   
R070       IF WSS-ATE01D20-OPEN-ON  
R070          MOVE 0                   TO WSS-ATE01D20-OPEN 
R070          CLOSE ATE01D20.   
R075A      IF WSS-ATE01D21-OPEN-ON  
R075A         MOVE 0                   TO WSS-ATE01D21-OPEN 
R075A         CLOSE ATE01D21.   
R067       IF  WSS-ATE01DR01-OPEN-ON
R067           IF  WSA-CAT-PSC-DROP  =  0   
R067               MOVE  '                 ***  NO RECORDS DROPPED'  TO 
R067                   ATE01DR01-REC
R067               WRITE  ATE01DR01-REC  AFTER  5.  
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE  'ATE01DR01XST'  TO  WS-OLDFILE-NM  
R069       ELSE 
R069           MOVE  'ATE01DR01FST'  TO  WS-OLDFILE-NM. 
R067       IF  WSS-ATE01DR01-OPEN-ON
R067           MOVE  0  TO  WSS-ATE01DR01-OPEN  
R067           CLOSE  ATE01DR01 
R067           MOVE  SPACES  TO  WS-NEWFILE-NM  
R067           MOVE  ZEROES  TO  WS-NEW-STATUS  
R067                             WS-OLD-STATUS  
R067                             WS-NEW-STATUS-WORD 
R067                             WS-OLD-STATUS-WORD 
R067           MOVE  WSA-PAGE-CNT  TO  WS-OLD-PAGE-CNT  
R067           PERFORM  1870-CALL-ASB004
R067           DISPLAY 'FILE FREED (' WS-OLDFILE-NM  ')' UPON PRINTER.  

           CLOSE ATE01DCKPT.
       1850-EXIT.   
           EXIT.

CC39   1870-CALL-ASB004.
CC39       CALL 'ASB004' USING WS-PRTCTL-LIST.  
CC39       IF NEW-BAD   
CC39          MOVE 005                 TO WS-SML-MESSAGE-CODE   
CC39          MOVE 'ASB004'            TO WS-SML-PARAM-1
CC39          MOVE WS-NEW-STATUS       TO WS-SML-PARM-2-X-2 
CC39          MOVE 'F'                 TO WS-SML-MESSAGE-CAT
CC39          PERFORM 1810-DISPLAY-MSG  
CC39          SET SW-FATAL-ERROR-FLAG ON
CC39          PERFORM 1850-CLOSE-FILES THRU 1850-EXIT   
CC39          PERFORM 1840-FINAL-MSG THRU 1840-EXIT 
CC39          PERFORM 3999-STOP-RUN.

CC39       IF OLD-BAD   
CC39          MOVE 005                 TO WS-SML-MESSAGE-CODE   
CC39          MOVE 'ASB004'            TO WS-SML-PARAM-1
CC39          MOVE WS-OLD-STATUS       TO WS-SML-PARM-2-X-2 
CC39          MOVE 'F'                 TO WS-SML-MESSAGE-CAT
CC39          PERFORM 1810-DISPLAY-MSG  
CC39          SET SW-FATAL-ERROR-FLAG ON
CC39          PERFORM 1850-CLOSE-FILES THRU 1850-EXIT   
CC39          PERFORM 1840-FINAL-MSG THRU 1840-EXIT 
CC39          PERFORM 3999-STOP-RUN.

R053   1900-LOAD-TCLK-TABLE.
R053       OPEN INPUT TCLK-FILE.
R053
R053       MOVE 'Y'  TO WSS-TCLK-FOUND-SW.  
R053       SET TCLK-IDX TO 1.   
R053       PERFORM 1910-READ-TCLK       THRU 1910-EXIT  
R053                                   UNTIL TCLK-NOT-FOUND.
R053
R053       CLOSE TCLK-FILE. 
R053   1900-EXIT.   
R053       EXIT.
R053
R053   1910-READ-TCLK.  
R053       READ TCLK-FILE   
R053          AT END MOVE 'N' TO WSS-TCLK-FOUND-SW GO TO 1910-EXIT. 
R053
R053       MOVE TCLK-KEY         TO TCLK-TBL-KEY         (TCLK-IDX) 
R053       MOVE TCLK-DESCRIPTION TO TCLK-TBL-DESCRIPTION (TCLK-IDX) 
R053       MOVE TCLK-PERIOD      TO TCLK-TBL-PERIOD      (TCLK-IDX) 
R053       SET TCLK-IDX UP BY 1.
R053   1910-EXIT.   
R053       EXIT.
R053
R070   1920-LOAD-TARB.  
R070       OPEN  INPUT  TARB-FILE.  
R070       MOVE  0      TO  WSS-TARB.   
R070       MOVE  SPACES     TO  WST-TARB-TABLE. 
R070       MOVE  'N'        TO  WSS-TARB-EOF.   
R070       PERFORM  1930-READ-TARB  THRU  1930-EXIT  UNTIL  
R070           WSS-TARB-EOF  =  'Y' 
R070       MOVE  WSS-TARB   TO  WSS-TARB-LOAD.  
R070       CLOSE  TARB-FILE.
R070   1920-EXIT.    EXIT.  
R070   1930-READ-TARB.  
R070       READ  TARB-FILE  AT  END 
R070           MOVE  'Y'  TO  WSS-TARB-EOF  
R070           GO  TO  1930-EXIT.   
R070       ADD  1  TO  WSS-TARB.
R070       IF  WSS-TARB  >  WSS-TARB-MAX
R070           CLOSE  TARB-FILE 
R070           SET  SW-FATAL-ERROR-FLAG  TO ON  
R070           MOVE  49  TO  WS-SML-MESSAGE-CODE
R070           MOVE  'F' TO  WS-SML-MESSAGE-CAT 
R070           MOVE  'CSR40MTARB'  TO  WS-SML-PARAM-1   
R070           MOVE  WSS-TARB-MAX  TO  WS-SML-PARAM-2   
R070           PERFORM  1810-DISPLAY-MSG
R070           PERFORM  1850-CLOSE-FILES
R070           PERFORM  1840-FINAL-MSG  
R070           PERFORM  3999-STOP-RUN.  
R070       MOVE  TARB-COUNTY    TO  WST-TARB-CO (WSS-TARB). 
R070       MOVE  TARB-DIST      TO  WST-TARB-DIST (WSS-TARB).   
R070       MOVE  TARB-CDE-IND-BYPASS  TO  WST-TARB-IND (WSS-TARB).  
R070       MOVE  TARB-DTE-BGN-BYPASS  TO  WST-TARB-BEG-DTE (WSS-TARB).  
R070       MOVE  TARB-DTE-END-BYPASS  TO  WST-TARB-END-DTE (WSS-TARB).  
R070   1930-EXIT.    EXIT.  
R053   1950-LOAD-ARM61001.  
R053       OPEN INPUT ARM61001. 
R053       READ ARM61001
R053          AT END MOVE 'N' TO WSS-ARM-FOUND-SW GO TO 1950-EXIT.  
R053
R053       MOVE RR305-RECORD TO PREV-RECORD.
R053       CLOSE ARM61001.  
R053   1950-EXIT.   
R053       EXIT.
R053
      ****************************************************  
      *** THIS SECTION IS PERFORMED UNTIL END OF       ***  
      *** R246 AREA, AND CONTAINS ALL MAJOR PROCESSING ***  
      *** PARAS.                                       ***  
      ***                                              ***  
      *** IT FETCHES A R666 CASE RECORD AND ALL ITS    ***  
      *** ASSOCIATED RECORDS,                          ***  
      *** FETCHES CORRESPONDING R246-CASE RECORD, AND  ***  
      *** PERFORMS PROCESS OF ALL CM BUDGET RECORDS IN ***  
      *** R249.                                        ***  
      ***                                              ***  
      ****************************************************  

      ****************************************************  
      *** ALL DATA BASE FETCHES PARAS WOULD RETURN     ***  
      *** A STATUS CODE IN RESPECTIVE 'WSS-R001-REC'   ***  
      *** SWITCHES.                                    ***  
      ***                                              ***  
      *** THIS SW WILL INDICATE SUCCESS/FAILURE OF     ***  
      *** DB FETCH. (EOS SW WILL BE USED INTERNALLY    ***  
      *** IN THE DB FETCH PARA)                        ***  
      ****************************************************  
       2000-PROCESS SECTION.
       2000-PROCESS-LOGIC-DRIVER.   
           MOVE 2000                   TO WSH-ERR-PARA-NO.  
       2000-INIT-ALL-WS-VARIABLES.  
           MOVE ZEROS                  TO WSS-DB-CASE-SWITCHES. 
           MOVE ZEROS                  TO WSS-DB-EOS-SWITCHES . 
           MOVE ZEROS                  TO WSS-DB-REC-SWITCHES . 
           MOVE ZEROS                  TO WSS-BDGT-SWITCHES   . 
           MOVE ZEROS                  TO WSS-TAB-SEARCH-SWITCHES . 

R069   2000-FETCH-R246. 
TEST1 *    DISPLAY  '2000-FETCH-R246 '  UPON  PRINTER.  
R069       MOVE  'N'  TO  WSS-R246-FOUND.   
R069       MOVE  'N'  TO  WSS-UPDATE-FLAG.  
R070       MOVE  'N'  TO  WSS-CLOSE-SW. 
R069       PERFORM  7300-FETCH-R246  THRU  7300-EXIT.   
R069       IF  WSS-R246-EOA  =  'Y' 
R069           GO  TO  2000-EXIT.   
CC43       MOVE  R246-NBR-CASE  TO  R666-NBR-CASE   
CC43                                LINK-NBR-CASE   
R069                                WSH-CASE-NUMBER.
PROD       IF WSA-R666-CHKPT-REC-CNT = 2000 
TFP   *    IF WSA-R666-CHKPT-REC-CNT = 2000 
PRL   *    IF WSA-R666-CHKPT-REC-CNT = 1000 
INTG  *    IF WSA-R666-CHKPT-REC-CNT = 1000 
UTTT  *    IF WSA-R666-CHKPT-REC-CNT = 1000 
R072          PERFORM 2060-PRO-CHKPT  THRU 2060-EXIT.   
TEST1 *    DISPLAY  'BEFORE DBPA20 '  LINK-NBR-CASE UPON PRINTER.   
CC43       CALL  'DBPA20'  USING  LINK-GET-CASE-AREAS.  
CC43       IF  LINK-CALL-STUS  NOT  =  0
CC43           MOVE  071    TO  WS-SML-MESSAGE-CODE 
CC43           MOVE  'W'    TO  WS-SML-MESSAGE-CAT  
CC43           MOVE  'R246'  TO  WS-SML-PARAM-1 
CC43           MOVE  R246-NBR-CASE  TO  WS-SML-PARM-2-X-1   
CC43           PERFORM  1810-DISPLAY-MSG
CC43           GO  TO  2000-EXIT.   
TEST1 *    IF  LINK-CALL-STUS  NOT  =  0
TEST1 *        DISPLAY  'DBPA20 ERROR '  LINK-NBR-CASE UPON PRINTER 
TEST1 *        GO  TO  2000-EXIT.   
CC43       IF  LINK-R246-AN  NOT  =  CALCR246-AN
CC43           DISPLAY 'CASE IN WRONG AREA ' R246-NBR-CASE UPON PRINTER 
CC43           GO  TO  2000-EXIT.   
CC43       MOVE  LINK-R666-AN    TO  CALCR666-AN.   
R069       PERFORM  7205-FETCH-R666  THRU  7205-EXIT.   
R069       IF  WSS-R666-FOUND  =  'Y'   
R069           ADD  1  TO  WSA-R666-REC-CNT 
R069       ELSE 
R069           MOVE  011  TO  WS-SML-MESSAGE-CODE   
R069           MOVE  'W'  TO  WS-SML-MESSAGE-CAT
R069           MOVE  'R666'  TO  WS-SML-PARAM-1 
R069           MOVE  R666-NBR-CASE  TO  WS-SML-PARM-2-X-1   
R069           PERFORM  1810-DISPLAY-MSG
R069           GO  TO  2000-EXIT.   

       2000-SETUP-ERR-HANDLING. 
           MOVE R666-NBR-CASE          TO WSH-CASE-NUMBER.  
           MOVE SPACES                 TO WSH-CDE-CATEGORY. 
           MOVE SPACES                 TO WSH-NBR-GROUP-GRANT.  

      ******************************************************
      *** WSH-CNTY-CASE-NBR IS A GROUP ITEM THAT DEFINES ***
      *** CNTY NO FOR CNTY TABLE LOOK UP.                ***
      ******************************************************
       2000-LOOKUP-COUNTY-TABLE.
           MOVE R666-NBR-CASE          TO WSH-CNTY-CASE-NBR.
           PERFORM 2050-LOOKUP-CNTY-TAB          THRU 2050-EXIT.
           IF NOT WSS-CNTY-FOUND-ON 
              GO TO 2000-EXIT.  

R025       IF R666-CNT-BUDGETS-ACT-CM NOT > 0   
R025          GO TO 2000-EXIT.  

R026       IF R666-CDE-STUS-CASE = 'C'  
R026          GO TO 2000-EXIT.  
R053
R053       IF R666-CDE-TYPE-CASE = 'P'  
R053          GO TO 2000-EXIT.  
R056
R056       MOVE  ZEROS                 TO CISMOE-ERR
R056                                      CISMOE-CASE   
R056                                      CISMOE-PROG-STAT  
R056                                      CISMOE-CNT.   
R056       MOVE  SPACES                TO CISMOE-WPR-STATUS.
R056       MOVE  1                     TO TANIF-WS-SUB. 
R056       PERFORM 2333-INITIALIZE-CISMOE THRU 2333-EXIT 20 TIMES.  
R056       MOVE SPACES TO D13-CISMOE-WPR-STATUS 
R056                      D13-CISMOE-CAT
R056                      D13-CISMOE-GG 
R056                      D13-CISMOE-PARENT 
R056                      D13-CISMOE-ELIG   
R056                      D13-CISMOE-PROJ   
R056                      D13-CISMOE-PROJ-B 
R061                      D13-CISMOE-SSI-FLAG   
R061                      D13-CISMOE-SCHOOL-FLAG
R061                      D13-CISMOE-CHILD-COMMON   
R061                      D13-CISMOE-SSI-PAR-1  
R061                      D13-CISMOE-SSI-PAR-2  
R061                      D13-CISMOE-WPR-RCPT   
R075B                     D13-CISMOE-HAVE-EA-JAM
R075B                     D13-CISMOE-HAVE-ETP-22
R075B                     D13-CISMOE-HAVE-ETP-54
R075B                     D13-CISMOE-HAVE-PAR-54
R075B                     D13-CISMOE-HAVE-ELG-SSI-PAR   
R056                      ATE02D05-CATEGORY 
R056                      ATE02D05-GRANT-GROUP  
R056                      ATE02D05-CDE-STUS 
R056                      D15-CISMOE-CAT
R056                      D15-CISMOE-GG 
R056                      D15-CISMOE-DIST   
R056                      D15-CISMOE-PMT-NAME   
R056                      ATE01D16-CDE-CAT  
R056                      ATE01D16-NBR-GG   
R056                      ATE01D16-NBR-TRANS.   
R056       MOVE ZEROS  TO D13-CISMOE-ERR
R056                      D13-CISMOE-CASE   
R056                      D13-CISMOE-PROG-STAT  
R061                      D13-CISMOE-PAY-DATE   
R056                      D13-CISMOE-CNT
R056                      D13-CISMOE-RCPT   
R056                      D13-CISMOE-AGE
R056                      D13-CISMOE-ETP
R056                      D13-CISMOE-WK-HRS 
R056                      D13-CISMOE-SELF-EMPL  
R061                      D13-CISMOE-PROJ-CORE-HRS  
R061                      D13-CISMOE-PROJ-NON-HRS   
R061                      D13-CISMOE-GOOD-CAUSE 
R061                      D13-CISMOE-PARENT-LINE-1  
R061                      D13-CISMOE-PARENT-LINE-2  
R056                      D13-CISMOE-LINE-NO
R075B                     D13-CISMOE-CITIZEN-CDE
R056                      ATE02D05-RCPT-NBR 
R056                      ATE02D05-CASE-NBR-N   
R056                      ATE02D05-OLD-PROG-STAT
R056                      ATE02D05-NEW-PROG-STAT
R056                      ATE02D05-TIME-ACTN
R056                      ATE02D05-DTE-CHNG 
R056                      ATE02D05-MPD-DATE 
R056                      D15-CISMOE-CASE   
R056                      D15-CISMOE-PREV-STAT  
R056                      D15-CISMOE-PROG-STAT  
R056                      D15-CISMOE-CO 
R056                      D15-CISMOE-CSLD   
R056                      ATE01D16-RECIPIENT
R056                      ATE01D16-NBR-CASE 
R056                      ATE01D16-CTL-DIGIT
R056                      ATE01D16-DTE-BGN-EFFV 
R056                      ATE01D16-DTE-END-EFFV 
R056                      ATE01D16-DTE-CHNG 
R056                      ATE01D16-TIME-ACTN.   
R056
      *******************************************************   
      *** IF A VALID REC IS NOT FOUND, CONFIRM THAT       ***   
      *** THE CASE WAS NOT CLOSED (THRU CASE-CLOSED-SW    ***   
      *** THAT IS SET IF AT-LEAST 1 R672 WITH 'C' STATUS  ***   
      *** IS FOUND. IF IT WAS CLOSED, BYPASS CASE, ELSE   ***   
      *** MANDATORY REC MISSING !                         ***   
      ***                                                 ***   
      *** IF VALID REC IS FOUND, PROCESS THE CASE ONLY,   ***   
      *** IF IT HAS CM BUDGETS.                           ***   
      ***************************************************** 
       2000-FETCH-R672. 
R067       MOVE  2002    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2000-FETCH-R672 '  WSH-ERR-PARA-NO 
TEST1 *            UPON  PRINTER.   
           PERFORM 7220-FETCH-R672               THRU 7220-EXIT.
           IF NOT WSS-R672-REC-ON   
              IF WSS-R672-FUTURE-REC-ON 
                 GO TO 2000-EXIT
              ELSE  
                 MOVE 'R672'           TO WS-SML-PARAM-2
                 PERFORM 7900-MISSING-RECORD     THRU 7900-EXIT 
                 GO TO 2000-EXIT.   

       2000-FETCH-R248. 
R067       MOVE  2003    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2000-FETCH-R248 '  WSH-ERR-PARA-NO 
TEST1 *            UPON  PRINTER.   
           MOVE WSH-R666-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7260-FETCH-R248               THRU 7260-EXIT.
           IF NOT WSS-R248-REC-ON   
              MOVE 'R248'              TO WS-SML-PARAM-2
              PERFORM 7900-MISSING-RECORD        THRU 7900-EXIT.
R056       MOVE R248-NAM-PMT           TO D15-CISMOE-PMT-NAME.  

       2000-FETCH-R254. 
R067       MOVE  2004    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2000-FETCH-R254 '  WSH-ERR-PARA-NO 
TEST1 *            UPON  PRINTER.   
           MOVE WSH-R666-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7280-FETCH-R254               THRU 7280-EXIT.

       2000-FETCH-R247. 
R067       MOVE  2005    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2000-FETCH-R247 '  WSH-ERR-PARA-NO 
TEST1 *            UPON  PRINTER.   
           MOVE WSH-R666-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7240-FETCH-R247               THRU 7240-EXIT.
           IF NOT WSS-R247-REC-ON   
              MOVE 'R247'              TO WS-SML-PARAM-2
              PERFORM 7900-MISSING-RECORD        THRU 7900-EXIT.

       2000-FETCH-R249. 
R075A      MOVE 0  TO  WSS-EOS-R249.
R075A      FIND CURRENT R246-CM-CASE RECORD.
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A      PERFORM 2111-FETCH-R249-SECTION  
R075A        UNTIL EOS-R249.
R078  *      IF  WSS-UPDATE-FLAG  =  'Y'
R078  *          PERFORM  2065-PROCESS-ASB04B  THRU  2065-EXIT. 
R075A      FIND CURRENT R246-CM-CASE RECORD.
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R056       MOVE 2000                   TO WSH-ERR-PARA-NO.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2000-FETCH-R249 '  WSH-ERR-PARA-NO 
TEST1 *            UPON  PRINTER.   
TEST1 *    DISPLAY '2000-FETCH-R249 A:' R246-CM-CASE UPON PRINTER.  
R070       MOVE  ZEROES  TO  WSS-R249-SS
R070                         WSS-R249-LD.   
R070       MOVE  SPACES  TO  WST-R249-TABLE.
R069       MOVE  1  TO  WSS-R249-FIRST. 
           PERFORM 7310-FETCH-R249               THRU 7310-EXIT.

       2000-PROCESS-ALL-CM-BDGTS.   
           PERFORM 2200-PRO-R249-CM-BDGT-SECTION UNTIL  
                   WSS-R249-EOS-ON. 
R070       IF  WSS-R249-LD  >  0
R070           PERFORM  2670-MODIFY-R249  THRU  2670-EXIT.  
      *    MOVE 0                      TO MCFLAG.   
R065  *    IF  WSS-UPDATE-FLAG  =  'Y'  
R065  *        PERFORM  2065-PROCESS-ASB04B  THRU  2065-EXIT.   

       2000-EXIT.   
           EXIT.
R075A  2111-FETCH-R249-SECTION SECTION. 
R075A  2111-FETCH-R249. 
R075A      IF NOT WSH-SECOND-HALF   
R075A         MOVE 1      TO WSS-EOS-R249   
R075A         GO TO 2111-EXIT.  
R075A      FETCH NEXT R249-CASH-MEDICAL-BUDGET  
R075A      WITHIN S535-CM-CASE-BDGT SET 
R075A        ON ERROR GO TO 211X-ERROR. 
R075A      IF ERROR-CODE = '07' OR '13' OR '06' 
R075A         MOVE 1                   TO WSS-EOS-R249  
R075A         GO TO 2111-EXIT   
R075A      ELSE 
R075A         IF ERROR-CODE = '00'  
R075A            NEXT SENTENCE  
R075A         ELSE  
R075A            PERFORM 7995-DB-ERROR. 
R075A  211X-ERROR.  
R075A      IF ERROR-CODE = '07' OR '13' OR '06' 
R075A         MOVE 1                   TO WSS-EOS-R249  
R075A         GO TO 2111-EXIT   
R075A      ELSE 
R075A         IF ERROR-CODE = '00'  
R075A            NEXT SENTENCE  
R075A         ELSE  
R075A            PERFORM 7995-DB-ERROR. 
R075A   
R075A      IF R249-CDE-CATEGORY = 'MG ' 
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         GO TO 2111-EXIT.  
R075A   
R075A      IF ( R249-CDE-STUS-BUDGET = 'O' OR 'S' ) 
R075A         GO TO 2111A-GET-R634  
R075A      ELSE 
R075A         MOVE +1 TO WSS-EOS-R249   
R075A         GO TO 2111-EXIT.  
R075A   
R075A  2111A-GET-R634.  
R075A      FETCH FIRST R634-CM-BUDGET-INFO  
R075A      WITHIN S396-CM-BDGT-INFO SET 
R075A      ON ERROR GO TO 222X-ERROR.   
R075A   
R075A  222X-ERROR.  
R075A      IF ERROR-CODE = '07' OR '13' OR '06' 
R075A         DISPLAY 'BAD MG :' R246-CM-CASE UPON PRINTER  
R075A         GO TO 2111-EXIT   
R075A      ELSE 
R075A         IF ERROR-CODE = '00'  
R075A            NEXT SENTENCE  
R075A         ELSE  
R075A            PERFORM 7995-DB-ERROR. 
R075A   
R075A      IF R634-DTE-END-EFFV = 0 
R075A         MOVE 9999999  TO R634-DTE-END-EFFV.   
R075A   
R075A      ACCEPT WSH-TODAYS-DATE FROM DAY YYYYDDD. 
R075A   
R075A      IF  R634-DTE-END-EFFV < R634-DTE-BGN-EFFV
R075A          GO TO 2111-EXIT. 
R075A      IF  R634-DTE-END-EFFV = R634-DTE-BGN-EFFV
R075A          GO TO 2111-EXIT. 
R075A   
R075A      IF  R634-CDE-STUS-PROG = 99  
R075A      AND R634-DTE-END-EFFV > WSH-TODAYS-DATE  
R075A          NEXT SENTENCE
R075A      ELSE 
R075A          GO TO 2111-EXIT. 
R075A   
R075A      IF R634-DTE-DUE-REDET > WSH-2-PAYDATE
R075A          GO TO 2111-EXIT. 
R075A   
R075A      MOVE 'N'    TO  WS-SWT-TCLK-FOUND.   
R075A   
R075A      SEARCH ALL TCLK-LEVEL
R075A        AT END 
R075A          MOVE ZEROS   
R075A            TO HOLD-INCARC-DAYS
R075A          MOVE 'N' TO WS-SWT-TCLK-FOUND
R075A        WHEN TCLK-TBL-KEY (TCLK-IDX) = 'MARCDV'
R075A          SET TCLK-SUB TO TCLK-IDX 
R075A          MOVE TCLK-TBL-PERIOD (TCLK-SUB)  
R075A            TO HOLD-INCARC-DAYS
R075A          MOVE 'Y' TO WS-SWT-TCLK-FOUND.   
R075A   
R075A      IF HOLD-INCARC-DAYS = 0  
R075A         MOVE SPACES                 TO ATE01D05-REC   
R075A         DISPLAY 'IN 2111C-MG99-CLOSE ' UPON PRINTER   
R075A         MOVE R634-DTE-DUE-REDET     TO ATE01D05-CLOSE-DATE
R075A         MOVE R246-NBR-CASE          TO ATE01D05-NBR-CASE  
R075A         MOVE R249-CDE-CATEGORY      TO ATE01D05-CDE-CATEGORY  
R075A         MOVE R249-NBR-GROUP-GRANT   TO ATE01D05-NBR-GROUP-GRANT   
R075A         MOVE R634-CDE-STUS-PROG     TO ATE01D05-STAT-CODE 
R075A         MOVE SPACES                 TO ATE01D05-CDE-SUFFIX
R075A         MOVE 'B'                    TO ATE01D05-TYP-TRANS 
R075A         MOVE ZEROS                  TO ATE01D05-NBR-RCPT  
R075A         WRITE ATE01D05-REC
R075A         MOVE SPACES                  TO ATE01D05-REC  
R075A         ADD 1                        TO WSA-ATE01D05-REC-CNT  
R075A         ADD 1                        TO WS-MG99-CLOSURE   
R075A         GO TO 2111-EXIT.  
R075A   
R075A  2111D-AUTO-XTNS. 
R075A      MOVE  R634-DTE-OPENED-BDGT  TO  M2K-JULIAN-DATE. 
R075A      PERFORM  6510-JUL-TO-GRG.
R075A      IF  M2K-DATE-CONV-ERROR-IND  NOT  =  0   
R075A          MOVE  ZEROES            TO  M2K-GREGORIAN-DATE   
R075A      ELSE 
R075A          MOVE M2K-GREGORIAN-DATE TO  W634-DTE-OPENED-BDGT.
R075A   
R076  *    PERFORM 2111G-CALC-EXTN     THRU 2111G-EXIT. 
CC47A   
R075A      MOVE  R634-DTE-DUE-REDET    TO  M2K-JULIAN-DATE  
R075A                                      S634-DTE-DUE-REDET.  
R075A      PERFORM  6510-JUL-TO-GRG.
R075A      IF  M2K-DATE-CONV-ERROR-IND  NOT  =  0   
R075A          MOVE  ZEROES            TO  M2K-GREGORIAN-DATE   
R075A      ELSE 
R075A          MOVE M2K-GREGORIAN-DATE TO  W634-DTE-DUE-REDET.  
R075A   
R076       PERFORM 2111G-CALC-EXTN     THRU 2111G-EXIT. 
CC47A *    COMPUTE WS-NO-OF-AUTO-EXTNS  
CC47A *          = W634-REDET-GRG-YY - W634-DTE-OPENED-YY.  
CC47A *    IF WS-NO-OF-AUTO-EXTNS < 0   
CC47A *       DISPLAY 'OPEN DT > REAPP DT:' R246-CM-CASE
CC47A *          UPON PRINTER   
CC47A *       GO TO 2111-EXIT.  
CC47A *    IF WS-NO-OF-AUTO-EXTNS < 2   
CC47A *       MOVE 0 TO WS-NO-OF-AUTO-EXTNS 
CC47A *    ELSE 
CC47A *       COMPUTE WS-NO-OF-AUTO-EXTNS = WS-NO-OF-AUTO-EXTNS - 1.
R076       DISPLAY ' WS-NO-OF-AUTO-EXTNS :' WS-NO-OF-AUTO-EXTNS 
R076          UPON PRINTER. 
R075A      IF WS-NO-OF-AUTO-EXTNS < HOLD-INCARC-DAYS
R075A         PERFORM 2111E-CLOSE-MG99 THRU 2111E-EXIT  
R075A      ELSE 
R075A         MOVE R634-DTE-DUE-REDET      TO ATE01D05-CLOSE-DATE   
R075A         MOVE R246-NBR-CASE           TO ATE01D05-NBR-CASE 
R075A         MOVE R249-CDE-CATEGORY       TO ATE01D05-CDE-CATEGORY 
R075A         MOVE R249-NBR-GROUP-GRANT    TO ATE01D05-NBR-GROUP-GRANT  
R075A         MOVE R634-CDE-STUS-PROG      TO ATE01D05-STAT-CODE
R075A         MOVE SPACES                  TO ATE01D05-CDE-SUFFIX   
R075A         MOVE 'B'                     TO ATE01D05-TYP-TRANS
R075A         MOVE ZEROS                   TO ATE01D05-NBR-RCPT 
R075A         WRITE ATE01D05-REC
R075A         MOVE SPACES                  TO ATE01D05-REC  
R075A         ADD 1                        TO WSA-ATE01D05-REC-CNT  
R075A         ADD 1                        TO WS-MG99-CLOSURE.  
R075A   
R075A  2111-EXIT.   
R075A      EXIT.
      *******************************************************   
      *** THIS SECTIONS CONTAINS SUBROUTINES OF 2000      ***   
      *** PROCESS  (CASE LEVEL) SECTION.                  ***   
      *** INDIVIDUAL PARA MODULES ARE EXECUTED.           ***   
      *******************************************************   
       2050-SUBS-OF-2000-SECTION SECTION.   
      *******************************************************   
      *** THIS PARA WUD SEARCH THE WST-CNTY TABLE FOR A   ***   
      *** MATCH ON COUNTY-CODE AND SET THE CNTY INDEX.    ***   
      *** THIS INDEX WUD BE USED TO MAKE A REF IN CNTY-   ***   
      *** CAT TABLE IN PARA 2380.                         ***   
      *******************************************************   
       2050-LOOKUP-CNTY-TAB.
           MOVE 0                      TO WSS-CNTY-FOUND.   
           SET WSI-CNTY-IDX            TO 1.
           SEARCH WST-CNTY-TAB VARYING WSI-CNTY-IDX 
             WHEN WSI-CNTY-IDX > WSH-CNTY-TAB-SIZE  
R073              MOVE 'W'             TO WS-SML-MESSAGE-CAT
                  MOVE 013             TO WS-SML-MESSAGE-CODE   
                  MOVE 'TBL-CNTY'      TO WS-SML-PARAM-1
                  MOVE R666-NBR-CASE   TO WS-SML-PARAM-2
                  PERFORM 1810-DISPLAY-MSG  
             WHEN WST-CNTY-NBR (WSI-CNTY-IDX) = WSH-CNTY-NBR
                  MOVE 1               TO WSS-CNTY-FOUND.   

       2050-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA WUD PROCESS CHECKPOINT CODE.          ***   
      *** MATCH ON COUNTY-CODE AND SET THE CNTY INDEX.    ***   
      *** THIS INDEX WUD BE USED TO MAKE A REF IN CNTY-   ***   
      *** CAT TABLE IN PARA 2380.                         ***   
      *******************************************************   
       2060-PRO-CHKPT.  
           MOVE 0                      TO WSA-R666-CHKPT-REC-CNT.   

       2060-DISPLAY-STATUS-AT-BEGIN.
           ACCEPT WSH-DATE             FROM DATE.   
           MOVE WSH-MM                 TO WSH-REP-MM.   
           MOVE WSH-DD                 TO WSH-REP-DD.   
           MOVE WSH-YY                 TO WSH-REP-YY.   

           ACCEPT WSH-TIME             FROM TIME.   
           MOVE WSH-HH                 TO WSH-REP-HH.   
           MOVE WSH-MIN                TO WSH-REP-MIN.  
           MOVE WSH-SS                 TO WSH-REP-SS.   

           ADD 1                       TO WSA-CHKPT-CNT.
           DISPLAY 'CHECKPOINT NBR ' WSA-CHKPT-CNT ' '  
                   'STARTED AT     ' WSH-REP-DATE  ' '  
                                     WSH-REP-TIME   
           UPON PRINTER.

       2060-CLOSE-AND-DEPART.   
           PERFORM 7050-DB-DEPART                THRU 7050-EXIT.

       2060-WRITE-ATE01DCKPT.   
           MOVE R666-NBR-CASE          TO ATE01DCKPT-RECORD.
           PERFORM 8895-DET-WRITE-ATE01DCKPT     THRU 8895-EXIT.

       2060-IMPART-AND-OPEN-DB-AREAS.   
           PERFORM 7000-OPEN-DB-AREAS-SECTION.  

R069   2060-REPOSITION-R246.
R069       MOVE  WSH-CASE-NUMBER  TO  R246-NBR-CASE.
R069       PERFORM  7305-FETCH-R246  THRU  7305-EXIT.   

       2060-DISPLAY-STATUS-AT-END.  
           ACCEPT WSH-DATE             FROM DATE.   
           MOVE WSH-MM                 TO WSH-REP-MM.   
           MOVE WSH-DD                 TO WSH-REP-DD.   
           MOVE WSH-YY                 TO WSH-REP-YY.   

           ACCEPT WSH-TIME             FROM TIME.   
           MOVE WSH-HH                 TO WSH-REP-HH.   
           MOVE WSH-MIN                TO WSH-REP-MIN.  
           MOVE WSH-SS                 TO WSH-REP-SS.   

           DISPLAY 'CHECKPOINT NBR ' WSA-CHKPT-CNT ' '  
                   'FINISHED AT    ' WSH-REP-DATE  ' '  
                                     WSH-REP-TIME   
                   UPON PRINTER.

       2060-EXIT.   
           EXIT.
R065   2065-PROCESS-ASB04B. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2065-PROCESS-ASB04B'  UPON  PRINTER.   
CC41B**    MOVE  SPACES                TO  ASB04B-BUFF. 
CC41B**    MOVE  R666-NBR-CASE         TO  ASB04B-KEY.  
CC41B**    MOVE  'C'                   TO  ASB04B-IND.  
CC41B**    MOVE  'E'                   TO  ASB04B-N-E-FLAG. 
CC41B**    MOVE  'ATE01D '             TO  ASB04B-PROG-ID.  
CC41B**    PERFORM  2070-CALL-ASB04B.   
CC41B**    IF  ASB04B-ERR-NBR  >  ZEROES
CC41B**        PERFORM  2075-ASB04B-ERROR  THRU  2075-EXIT. 
CC41B *     MOVE SPACES                 TO ATE01D18-RECORD. 
CC41B       MOVE  R666-NBR-CASE        TO  D18-KEY. 
CC41B       MOVE  'C'                  TO  D18-TYPE.
CC41B       MOVE  'E'                  TO  D18-EXIST.   
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069            MOVE  'ATE01D '            TO  D18-PROG-ID  
R069       ELSE 
R069            MOVE  'ATF01D '            TO  D18-PROG-ID. 
R078  *    MOVE  SPACES               TO  D18-REC-CDE.  
R078       MOVE 'X' TO D18-EXP-DIRUPD-FLAG. 
CC41B       WRITE ATE01D18-RECORD.  
R069       ADD  1  TO  WSA-ATE01D18-REC-CNT.
R065   2065-EXIT.    EXIT.  
R065       COPY  APB04PP  REPLACING 
R065               XXXX-CALL-ASB04B  BY  2070-CALL-ASB04B.  
R069       COPY  APB04FP  REPLACING 
R065               XXXX-ASB04B-ERROR    BY  2075-ASB04B-ERROR   
R065               XXXX-EXIT            BY  2075-EXIT   
R065               0000-STOP-RUN        BY  3000-CLOSING
R065               FATAL-ERROR-FLAG     BY  SW-FATAL-ERROR-FLAG 
R065               ACCTNG-RETURN-STATUS-IND  BY  ASB04B-KEY 
R069               XXXXXX               BY  WSH-RUN-NAME.   

      *******************************************************   
      *** THIS SECTIONS CONTROLS PROCESSING OF A BUDGET,  ***   
      *** AND IS PERFORMED CASE-NO-OF-BUDGET TIMES.       ***   
      ***     . PROCESS BUDGET                            ***   
      ***     . FETCH NEXT BUDGET                         ***   
      ***     . END SECTION.                              ***   
      *** CALLING PARA WILL PERFORM IT AGAIN, UNLESS NO   ***   
      *** MORE BUDGETS EXIST.                             ***   
      ***                                                 ***   
      *** IF ITS A 'FUTURE-ONLY' BUDGET, IT WILL BE       ***   
      *** BYPASSED, WITHOUT ANY ERROR MESAGE.             ***   
      *** ELSE, THERE MUST BE A VALID R634 TO A R249.     ***   
      *******************************************************   
       2200-PRO-R249-CM-BDGT-SECTION SECTION.   
       2200-CHECK-IF-BDGT-CLOSED.   
R070       MOVE  'N'  TO  WSS-CLOSE-SW. 
           IF R249-CDE-STUS-BUDGET = 'O' OR 'S' OR 'C'  
              NEXT SENTENCE 
           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 106                 TO WS-SML-MESSAGE-CODE   
              MOVE R249-CDE-STUS-BUDGET TO WS-SML-PARAM-1   
              MOVE R666-NBR-CASE       TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
R056          MOVE 2201                TO WSH-ERR-PARA-NO   
              PERFORM 7310-FETCH-R249            THRU 7310-EXIT 
              GO TO 2200-EXIT.  

           IF R249-CDE-STUS-BUDGET = 'C'
R056          MOVE 2202                TO WSH-ERR-PARA-NO   
TEST  *        DISPLAY  '2202 '  R666-NBR-CASE  UPON  PRINTER   
              PERFORM 7310-FETCH-R249            THRU 7310-EXIT 
              GO TO 2200-EXIT.  

MD02       IF R249-CDE-CATEGORY = 'J  ' 
MD02                           OR 'A  ' 
MD02                           OR 'M  ' 
MD02           IF JAM-CASH-CATE 
MD02              ADD 1 TO WSA-JAM-CASH-CNT 
R056              MOVE 2203           TO WSH-ERR-PARA-NO
TEST  *        DISPLAY  '2203 '  R666-NBR-CASE  UPON  PRINTER   
MD02               PERFORM 7310-FETCH-R249        THRU 7310-EXIT
MD02               GO TO 2200-EXIT  
MD02           ELSE 
MD02           IF JAM-MEDI-CATE 
MD02               ADD 1 TO WSA-JAM-MEDI-CNT.   

       2200-INITIALIZE-BDGT-SWITCHES.   
           PERFORM 2265-INIT-BDGT-SWITCHES       THRU 2265-EXIT.

       2200-SETUP-ERR-HANDLING. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2200-SETUP-ERR-HANDLING '  UPON  PRINTER.  
           MOVE R666-NBR-CASE          TO WSH-CASE-NUMBER.  
           MOVE R249-CDE-CATEGORY      TO WSH-CDE-CATEGORY. 
           MOVE R249-NBR-GROUP-GRANT   TO WSH-NBR-GROUP-GRANT.  

R067   2200-CHECK-R653. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2200-CHECK-R653 '  UPON  PRINTER.  
R067       PERFORM  2610-GET-R637  THRU  2610-EXIT. 
       2200-FETCH-R634. 
R067       MOVE  2212    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY '2200-FETCH-R634 '  WSH-ERR-PARA-NO  
TEST1 *            UPON  PRINTER.   
           PERFORM 7320-FETCH-R634               THRU 7320-EXIT.

           IF NOT WSS-R634-REC-ON   
              IF WSS-R634-FUTURE-REC-ON 
R056              MOVE 2204            TO WSH-ERR-PARA-NO   
                  PERFORM 7310-FETCH-R249        THRU 7310-EXIT 
                  GO TO 2200-EXIT   
              ELSE  
                  MOVE 'R634'          TO WS-SML-PARAM-2
                  PERFORM 7900-MISSING-RECORD    THRU 7900-EXIT 
R056              MOVE 2205            TO WSH-ERR-PARA-NO   
                  PERFORM 7310-FETCH-R249        THRU 7310-EXIT 
                  GO TO 2200-EXIT.  

R014       IF R249-CDE-STUS-BUDGET = R634-CDE-STUS-BDGT 
R014          NEXT SENTENCE 
R014       ELSE 
R014          MOVE 'W'                 TO WS-SML-MESSAGE-CAT
R014          MOVE 106                 TO WS-SML-MESSAGE-CODE   
R014          MOVE 'R249/R634'         TO WS-SML-PARAM-1
R014          MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
R014          PERFORM 1810-DISPLAY-MSG  
R014          DISPLAY '* R249 STUS ' R249-CDE-STUS-BUDGET UPON PRINTER  
R014          DISPLAY '* R634 STUS ' R634-CDE-STUS-BDGT   UPON PRINTER  
R056          MOVE 2206                TO WSH-ERR-PARA-NO   
R014          PERFORM 7310-FETCH-R249            THRU 7310-EXIT 
R014          GO TO 2200-EXIT.  

R081       IF  ((R249-CDE-CATEGORY  =  'D  '  AND   
R081             R634-CDE-STUS-PROG  =  02)  AND
R081            (R634-DTE-CLOSED-BDGT  >  WSH-2-DEADLINE  AND   
R081             R634-DTE-CLOSED-BDGT  <  WSH-3-DEADLINE))  
R081           PERFORM  2845-CREATE-976-NOTICE  THRU  2845-EXIT.
       2200-SPECIAL-EDITS.  
           PERFORM 2250-SPECIAL-EDITS            THRU 2250-EXIT.

       2200-SET-CAT-TABLES-IDXS.
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2200-SET-CAT-TABLES-IDXS'  
TEST1 *            UPON  PRINTER.   
R067       MOVE  R634-CDE-STUS-PROG  TO  WSH-HOLD-PS.   
R062  *    MOVE  'N'  TO  WSS-FIX-PROG-STAT.
           PERFORM 2255-SEARCH-WST-CAT           THRU 2255-EXIT.
R067       IF  WSS-CAT-FOUND  =  0  
R067           PERFORM  2275-CREATE-ATE01DR01  THRU  2275-EXIT  
R067           PERFORM  7310-FETCH-R249        THRU  7310-EXIT  
R067           GO  TO  2200-EXIT.   
           PERFORM 2260-SEARCH-WST-CAT-ONLY      THRU 2260-EXIT.
R067       IF  NOT  WSS-CAT-ONLY-FOUND-ON   
R056          MOVE 2207                TO WSH-ERR-PARA-NO   
              PERFORM 7310-FETCH-R249            THRU 7310-EXIT 
              GO TO 2200-EXIT.  

       2200-FETCH-ALTERNATE-RECORDS.
R067       MOVE  2209    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2200-FETCH-ALTERNATE-RECORDS ' 
TEST1 *            WSH-ERR-PARA-NO  UPON  PRINTER.  
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7360-FETCH-R253               THRU 7360-EXIT.

R067       MOVE  2210    TO  WSH-ERR-PARA-NO.   
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7350-FETCH-R252               THRU 7350-EXIT.

R067       MOVE  2211    TO  WSH-ERR-PARA-NO.   
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7380-FETCH-R269               THRU 7380-EXIT.

       2200-CHECK-BUDGET-STATUS.
           IF R634-CDE-STUS-BDGT = 'O'  
              ADD 1                    TO WSA-R-ACT-BDGT-CNT
           ELSE 
           IF R634-CDE-STUS-BDGT = 'S'  
              ADD 1                    TO WSA-R-SUS-BDGT-CNT.   

       2200-CLOSING.
R003       IF (R634-CDE-STUS-BDGT = 'O' OR 'S')  AND
M313          R634-DTE-CLOSED-BDGT > 0000000
                   PERFORM 2500-CLOSING-SECTION.
R070       IF  M2K-CPF-CYCLE-DATE-NUM  =  WSH-TDTE-BEG-DTE  OR  
R070           M2K-CPF-CYCLE-DATE-NUM  >  WSH-TDTE-BEG-DTE  
R070           IF  (R634-CDE-STUS-BDGT  =  'O'  OR  'S')  AND   
R070                WSS-FUT-CLOS  =  'N'
R070               PERFORM  2620-PROCESS-AUTO-DISC  THRU  2620-EXIT.
R070       IF  R634-CDE-STUS-BDGT  =  'C'  OR   
R070           WSS-CLOSE-SW  =  'Y' 
R070           GO  TO  2200-FETCH-NEXT-R249-CM-BUDGET.  

       2200-ISSUANCE.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2200-CLOSING '  UPON  PRINTER. 
           PERFORM 2300-ISSUANCE-SECTION.   
       2200-FETCH-NEXT-R249-CM-BUDGET.  
R056       MOVE 2208                   TO WSH-ERR-PARA-NO.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'WSH-ERR-PARA-NO = '  WSH-ERR-PARA-NO   
TEST1 *            UPON  PRINTER.   
R056       IF WSS-R249-EOS-ON   
R056          NEXT SENTENCE 
R056       ELSE 
              PERFORM 7310-FETCH-R249     THRU 7310-EXIT.   

       2200-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS SECTIONS CONTAINS SUBROUTINES OF 2200      ***   
      *** BUDGET-PROCESSING SECTION.                      ***   
      *** INDIVIDUAL PARA MODULES ARE EXECUTED.           ***   
      *******************************************************   
       2250-SUBS-OF-2200-SECTION SECTION.   

      *******************************************************   
      *** IF THE BUDGET IS OPEN , THERE MUST BE ACTIVE    ***   
      *** MEMBERS IN IT.                                  ***   
      *******************************************************   
       2250-SPECIAL-EDITS.  
           IF R634-CDE-STUS-BDGT = 'O' AND  
              R634-CNT-MEM-ACT < 1  
                 MOVE 'W'              TO WS-SML-MESSAGE-CAT
                 MOVE 111              TO WS-SML-MESSAGE-CODE   
                 MOVE R634-CNT-MEM-ACT TO WS-SML-PARAM-1
                 MOVE WSH-CASE-BDGT-ID TO WS-SML-PARAM-2
                 PERFORM 1810-DISPLAY-MSG.  

       2250-EXIT.   
           EXIT.
      *******************************************************   
      *** THIS PARA WUD SEARCH THE WST-CAT TABLE FOR A    ***   
      *** MATCH ON CATEGORY CODE & PROGRAM-STATUS.        ***   
      *******************************************************   
       2255-SEARCH-WST-CAT. 
           MOVE 0                      TO WSS-CAT-FOUND.
           SET WSI-CAT-IDX             TO 1.
           SEARCH WST-CAT-TAB VARYING WSI-CAT-IDX   
             WHEN WSI-CAT-IDX > WSH-CAT-TAB-SIZE
R073              MOVE 'W'             TO WS-SML-MESSAGE-CAT
R067              MOVE 013             TO WS-SML-MESSAGE-CODE   
R067              MOVE 'TBL-CAT'       TO WS-SML-PARAM-1
R067              MOVE WSH-CASE-BDGT-ID TO WS-SML-PARAM-2   
R067              PERFORM 1810-DISPLAY-MSG  
             WHEN WST-CAT-CODE (WSI-CAT-IDX) = R249-CDE-CATEGORY   AND  
R067              WST-CAT-PGM-STATUS (WSI-CAT-IDX) = WSH-HOLD-PS
                  MOVE 1               TO WSS-CAT-FOUND 
R067               GO  TO  2255-EXIT.   
       2255-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA WUD SEARCH THE WST-CAT-ONLY TABLE FOR ***   
      *** A MATCH ON CATEGORY CODE.                       ***   
      *** WSI-CAT-ONLY-IDX THUS SET WUD BE USED TO MAKE   ***   
      *** A REF INTO CNTY-CAT TABLE IN PARA 2380.         ***   
      *******************************************************   
       2260-SEARCH-WST-CAT-ONLY.
           MOVE 0                      TO WSS-CAT-ONLY-FOUND.   
           SET WSI-CAT-ONLY-IDX        TO 1.
           SEARCH WST-CAT-ONLY-TAB VARYING WSI-CAT-ONLY-IDX 
             WHEN WSI-CAT-ONLY-IDX > WSH-CAT-ONLY-TAB-SIZE  
R073              MOVE 'W'             TO WS-SML-MESSAGE-CAT
                  MOVE 013             TO WS-SML-MESSAGE-CODE   
                  MOVE 'TBL-CAT-ONLY'  TO WS-SML-PARAM-1
                  MOVE WSH-CASE-BDGT-ID TO WS-SML-PARAM-2   
                  PERFORM 1810-DISPLAY-MSG  
             WHEN R249-CDE-CATEGORY = WST-CAT-ONLY (WSI-CAT-ONLY-IDX)   
                  MOVE 1               TO WSS-CAT-ONLY-FOUND.   

       2260-EXIT.   
           EXIT.

      ***********************************************   
      *** INITIALIZE BUDGET LEVEL SWITCHES. THEY  ***   
      *** WUD BE INITIALIZED FOR EVERY BUDGET.    ***   
      ***********************************************   
       2265-INIT-BDGT-SWITCHES. 
           MOVE ZEROS                  TO WSS-R246-EP-SWITCHES. 
           MOVE ZEROS                  TO WSS-R637-EP-SWITCHES. 
           MOVE ZEROS                  TO WSS-R270-EP-SWITCHES. 
           MOVE ZEROS                  TO WSS-R249-EP-REC-SWITCHES. 
           MOVE ZEROS                  TO WSS-R637-EP-REC-SWITCHES. 
           MOVE ZEROS                  TO WSS-R270-EP-REC-SWITCHES. 
           MOVE ZEROS                  TO WSS-R256-SWITCHES.
           MOVE ZEROS                  TO WSS-BDGT-SWITCHES.

       2265-INIT-WST-NBR-INDIV-TAB. 
           MOVE ZEROS                  TO WSH-NBR-TAB-SIZE. 

       2265-INIT-S105-TAB.  
           PERFORM 2270-INIT-WST-S105-DET-TAB    THRU 2270-EXIT 
                   VARYING WSI-S105-REC-IDX  FROM 1 BY 1 UNTIL  
                   WSI-S105-REC-IDX > 6.

       2265-INIT-R256-TABLES.   
           MOVE ZEROS                  TO WST-R256-GRP-ALLOWS-SPL-TABLE.
           MOVE LOW-VALUES             TO WST-R256-DBK-TABLE.   
           MOVE ZEROS                  TO WSH-R256-DBK-TAB-SIZE.

       2265-EXIT.   
           EXIT.

      ****************************************************  
      *** INIT WST-S105-REC-DETAILS-TAB.               ***  
      *** THE TWO OCCURENCES ARE INITED EXPLICITLY     ***  
      *** TO SAVE ON A NESTED LOOP.                    ***  
      ****************************************************  
       2270-INIT-WST-S105-DET-TAB.  
           MOVE 0                      TO WST-REC-SW
                                          (WSI-S105-REC-IDX   1).   
           MOVE 0                      TO WST-REC-DBK   
                                          (WSI-S105-REC-IDX   1).   
M313       MOVE 0000000                TO WST-REC-DTE-BGN   
                                          (WSI-S105-REC-IDX   1).   

           MOVE 0                      TO WST-REC-SW
                                          (WSI-S105-REC-IDX   2).   
           MOVE 0                      TO WST-REC-DBK   
                                          (WSI-S105-REC-IDX   2).   
M313       MOVE 0000000                TO WST-REC-DTE-BGN   
                                          (WSI-S105-REC-IDX   2).   

       2270-EXIT.   
           EXIT.
R067   2275-CREATE-ATE01DR01.   
R067       IF  WSA-LINE-CNT  >  55  
R067           PERFORM  2280-PRINT-HEADING  THRU  2280-EXIT.
R067       ADD  1  TO  WSA-CAT-PSC-DROP.
R067       MOVE  R666-NBR-CASE      TO  WSR-DE1-01-CASE.
R067       MOVE  R249-CDE-CATEGORY  TO  WSR-DE1-01-CAT. 
R067       MOVE  R249-NBR-GROUP-GRANT  TO  WSR-DE1-01-GG.   
R067       MOVE  R634-CDE-STUS-PROG    TO  WSR-DE1-01-PSC.  
R067       WRITE  ATE01DR01-REC  FROM  WSR-DE1-01  AFTER  1.
R067       ADD  1  TO  WSA-LINE-CNT.
R067   2275-EXIT.    EXIT.  
R067   2280-PRINT-HEADING.  
R067       ADD  1  TO  WSA-PAGE-CNT.
R067       MOVE  WSA-PAGE-CNT  TO  WSR-HD3-PAGE-NO-01.  
R067       IF  WSA-PAGE-CNT  =  1   
R067           WRITE  ATE01DR01-REC  FROM  WSR-HD1-01   
R067       ELSE 
R067           WRITE  ATE01DR01-REC    FROM  WSR-HD1-01  AFTER  PAGE.   
R067       WRITE  ATE01DR01-REC    FROM  WSR-HD2  AFTER  1. 
R067       WRITE  ATE01DR01-REC    FROM  WSR-HD3-01  AFTER  1.  
R067       WRITE  ATE01DR01-REC    FROM  WSR-HD4  AFTER  1. 
R067       WRITE  ATE01DR01-REC    FROM  WSR-HD5  AFTER  1. 
R067       WRITE  ATE01DR01-REC    FROM  WSR-HD6-01  AFTER  2.  
R067       MOVE  SPACES  TO  ATE01DR01-REC. 
R067       WRITE  ATE01DR01-REC  AFTER  1.  
R067       MOVE  8    TO  WSA-LINE-CNT. 
R067   2280-EXIT.    EXIT.  

      ****************************************************  
      *** THIS SECTION CONTAINS THE DRIVER CODE FOR    ***  
      *** BOTH CHECK & MAID ISSUANCE PARAS. FOLLOWING  ***  
      *** THIS SECION WILL BE ITS SUBROUTINES/SUB-     ***  
      *** PARAS SECTION.                               ***  
      *** CAT-TYPE OF THE BUDGET DECIDES IF THE        ***  
      *** BUDGET IS BOTH CASH AND MEDICAL OR IT IS     ***  
      *** MEDICAL ONLY.                                ***  
      ***                                              ***  
      *** FOR CASH BUDGETS, ALSO CHECK IF ANY          ***  
      *** OVERRIDE REC EXISTS. IF IT DOES, THAT AMT    ***  
      *** WUD BE USED, AND WUD OVERRIDE REGULAR        ***  
      *** BENEFIT AMT.                                 ***  
      ***                                              ***  
      *** ALL S105 SET MEMBERS ARE FETCHED IN          ***  
      *** AN OPTIMISED WAY AND NOT RECORD-BY-RECORD.   ***  
      ****************************************************  

      *******************************************************   
      *** WST-INDIV-TABLE.                                ***   
      ***   IF ITS A SUSPENDED, CLOSED, MONTHLY-OR-QRTRLY-***   
      ***   IN-WRONG-PAYDAY-PERIOD, MAID ISSNC IS NOT DONE***   
      ***   & WST-R268-NBR-TAB WILL NOT BE BUILT.         ***   
      ***   SO WST IS TO BE BUILT EXCLUSIVELY FOR MAID-   ***   
      ***   BYPASSED CASES TOO.                           ***   
      *******************************************************   
       2300-ISSUANCE-SECTION SECTION.   
       2300-ISSUANCE-EXTRACT.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *    DISPLAY  '2300-ISSUANCE-EXTRACT '  R666-NBR-CASE  '  '   
TEST1 *       R246-NBR-CASE  UPON  PRINTER. 
R064       MOVE  'N'    TO  WSH-R255-OTI.   
R013       IF (WST-CAT-TYPE (WSI-CAT-IDX) = 0 ) OR  
R013          ( WSH-FIRST-HALF AND  
R069          (WST-CAT-TYPE (WSI-CAT-IDX) = 2 OR 3))
R056          MOVE  'N'      TO WS-TANIF-WS-REC 
              PERFORM 2310-CASH-ISSUANCE-DRIVER  THRU 2310-EXIT.

           PERFORM 2360-MAID-ISSUANCE-DETAIL     THRU 2360-EXIT.
R035       PERFORM 2320-WRITE-BUILD-INDIV-TABLE  THRU 2320-EXIT.
R080 ******* IF  R249-CDE-STUS-BUDGET  =  'S'   
R080 *******     NEXT  SENTENCE 
R080 ******* ELSE   
R080 *******     IF  WSH-R255-OTI  =  'Y'  AND  
R080 *******         WSS-BDGT-CLOSED-BEF-PERIOD = 0 
R080 *******         PERFORM  8610-WRITE-ATE01D17  THRU  8610-EXIT. 

           PERFORM 2390-FUTURE-CLOSE-INDIVS      THRU 2390-EXIT.
R069       IF  WST-CAT-TYPE (WSI-CAT-IDX)  =  1 
R069           PERFORM  8518-OPEN-BUDGET-COUNTS  THRU  8518-EXIT.   

       2300-EXIT-SECTION.   
           EXIT.

      *******************************************************   
      *** THIS SECTIONS CONTAINS SUBROUTINES OF 2300      ***   
      *** ISSUANCE SECTION.                               ***   
      *** INDIVIDUAL PARA MODULES ARE EXECUTED.           ***   
      *******************************************************   
       2310-SUBS-OF-2300-SECTION SECTION.   
      *******************************************************   
      *** CASH ISSUANCE DRIVER.                           ***   
      *** GET R255 MANDATORY RECORD AND CHECK FOR PRESENCE***   
      *** OF ANY OVERRIDE RECORD TOO.                     ***   
      ***                                                 ***   
      *** IF THE BUDGET IS TO BE CLOSED BEFORE THE NEXT   ***   
      *** PAYMENT DAY, PRO-RATE THE AMOUNT.               ***   
      *******************************************************   
       2310-CASH-ISSUANCE-DRIVER.   
           EXIT.

       2310-FETCH-R255. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *    DISPLAY  '2310-FETCH-R255 '  R666-NBR-CASE  '  ' 
TEST1 *       R246-NBR-CASE  UPON  PRINTER. 
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
R067       MOVE  2310    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'WSH-ERR-PARA-NO = '  WSH-ERR-PARA-NO   
TEST1 *            UPON  PRINTER.   
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7370-FETCH-R255               THRU 7370-EXIT.

R069       IF  R249-CDE-CATEGORY  =  'SC '  
R069           NEXT  SENTENCE   
R069       ELSE 
              IF NOT WSS-R255-REC-ON
                 ADD 1                 TO WSA-R-R255-NOT-FOUND  
                 MOVE 'R255'           TO WS-SML-PARAM-2
                 PERFORM 7900-MISSING-RECORD     THRU 7900-EXIT 
              GO TO 2310-EXIT.  
R064       MOVE  R255-CASH-GRANT  TO  WSH-R255-REC. 
R064       IF  WSH-R255-52  =  'Y'  
R064           MOVE  'Y'  TO  WSH-R255-OTI. 

       2310-FETCH-RECS-IN-S105. 
           PERFORM 7470-FETCH-S105-RECS          THRU 7470-EXIT.

       2310-PROCESS-R256.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2310-PROCESS-R256 '  R666-NBR-CASE  '  '   
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
R067       MOVE  2311    TO  WSH-ERR-PARA-NO.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'WSH-ERR-PARA-NO = '  WSH-ERR-PARA-NO   
TEST1 *            UPON  PRINTER.   
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           PERFORM 7580-FET-DET-R256             THRU 7580-EXIT.
           PERFORM 7570-PRO-R256                 THRU 7570-EXIT 
                   UNTIL WSS-R256-EOS-ON.   

       2310-CALC-PRO-RATE-PAY.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2310-CALC-PRO-RATE-PAY '  UPON  PRINTER.   
           IF WSS-BDGT-PRORATED-CLOSE-ON
              IF WST-CAT-TYPE (WSI-CAT-IDX) = 0                    OR   
                 ((WST-CAT-TYPE (WSI-CAT-IDX) = 2 OR 3)     AND 
                   WSH-FIRST-HALF   
                 )  
                      PERFORM 2340-CALC-PRO-RATE-PAY   THRU 2340-EXIT.  
R056
R067       MOVE  2312    TO  WSH-ERR-PARA-NO.   
R066       MOVE  'N'  TO  WSS-R654-FOUND.   
R067       MOVE  0  TO  WSS-R653-REC  WSS-R637-REC. 
R066       PERFORM  7600-FETCH-R637  THRU  7600-EXIT.   
R066       IF  WSS-R637-REC  =  1   
R067           MOVE  2313    TO  WSH-ERR-PARA-NO
R067           PERFORM  7625-FET-DET-R653  THRU  7625-EXIT. 
R066       IF  WSS-R653-REC  =  1   
R067           MOVE  2314    TO  WSH-ERR-PARA-NO
R066           PERFORM  7645-FET-DET-R654  THRU  7645-EXIT. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'PAYDAY = ' 
TEST1 *        PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC 
TEST1 *            ' R249-CDE-STUS-BUDGET = ' R249-CDE-STUS-BUDGET  
TEST1 *            ' R255-AMT-GRANT-CASH = ' R255-AMT-GRANT-CASH
TEST1 *            ' R249-CDE-CATEGORY = '  R249-CDE-CATEGORY   
TEST1 *                UPON  PRINTER.   
CC43       IF (PAYDAY-NBR IN FIRST-PAYDAY IN PAYDAY-REC > 10)   
R056           NEXT SENTENCE
R056       ELSE 
R056          IF (R249-CDE-STUS-BUDGET = 'S')   
R056              NEXT SENTENCE 
R056          ELSE  
R056             IF (R255-AMT-GRANT-CASH  >  010.00)
R056                IF (R249-CDE-CATEGORY = 'C' OR 'U') 
R056                    MOVE ZEROS          TO TANIF-WS-SUB 
R056                                           CISMOE-CNT   
R056                                           TANIF-BGN-R634   
R056                                           TANIF-NEW-STUS-PROG  
R056                    MOVE R249-CDE-CATEGORY    TO CISMOE-CAT 
R056                    MOVE R249-NBR-GROUP-GRANT TO CISMOE-GG  
R056                    MOVE R634-CDE-STUS-PROG   TO CISMOE-PROG-STAT   
R056                    PERFORM 2332-PROCESS-CISMOE THRU 2332-EXIT. 

       2310-CHECK-ISSUANCE-DETAIL.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2310-CHECK-ISSUANCE-DETAIL '   
TEST1 *            UPON  PRINTER.   
           PERFORM 2350-CHECK-ISSUANCE-DETAIL    THRU 2350-EXIT.

       2310-EXIT.   
           EXIT.

      *******************************************************   
      *** BUILD R268 TABL FOR MAID BYPASSED  BUDGETS.     ***   
      *******************************************************   
R035   2320-WRITE-BUILD-INDIV-TABLE.
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *    DISPLAY  '2320-WRITE-BUILD-INDIV-TABLE '  R666-NBR-CASE  
TEST1 *     '  '  R246-NBR-CASE  UPON  PRINTER. 
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT. 
R038       MOVE 0                      TO WSS-R268-REC. 
R038       MOVE 0                      TO WSS-R268-EOS. 
R064       MOVE  ZEROES  TO  WSH-R268-FIRST-RCPT.   
R067       MOVE  2320    TO  WSH-ERR-PARA-NO.   
           PERFORM 7450-FETCH-R268      THRU 7450-EXIT  
                   UNTIL WSS-R268-REC-ON OR 
                         WSS-R268-EOS-ON.   

           SET WSI-NBR-IDX        TO 1. 
R039       MOVE 0                      TO WSS-R268-EOS. 
R053       MOVE  'N'                   TO WSS-CLOCK-INDIV-SW
R053                                      WSS-ALERT-NOTICE-SW   
R077                                      WSS-ALERT-NOTICE-SW-D 
R077                                      WSS-ALERT-NOTICE-SW-PD
R077                                      WSS-CLOSE-CLOCK-SW-PD 
R077                                      WSS-CLOSE-CLOCK-SW-D  
R053                                      WSS-CLOSE-CLOCK-SW.   
R056       MOVE ZEROS                  TO TANIF-WS-SUB  
R056                                      CISMOE-CNT.   
           PERFORM 2370-BUILD-WST-NBR-LINE-TAB   THRU 2370-EXIT 
                   UNTIL WSS-R268-EOS-ON.   
           SET WSI-NBR-IDX             DOWN BY 1.   
           SET WSH-NBR-TAB-SIZE        TO WSI-NBR-IDX.  

R077  *    IF (YES-ALERT-NOTICE)
R077  *       IF (YES-CLOSE-CLOCK)  
R077  *           NEXT SENTENCE 
R077  *       ELSE  
R077  *           MOVE  'Y'                   TO WSS-CLOCK-INDIV-SW 
R077  *           PERFORM 8592-WRITE-ATE01D10 THRU 8592-EXIT
R077  *           MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME   
R077  *           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R077  *           MOVE D11-CDE-RSN-NOTICE     TO R634-CDE-RSN-NOTICE
R077  *           MOVE D11-CDE-TYPE-NOTICE    TO R634-CDE-TYPE-NOTICE   
R077  *           MOVE D11-CDE-OPTION-NOTICE  TO R634-CDE-OPTION-NOTICE 
R077  *           MOVE 'C'                    TO R634-CDE-STUS-NOTICE   
R077  *           MOVE  2321    TO  WSH-ERR-PARA-NO 
R077  *           PERFORM 7328-MODIFY-R634    THRU 7328-EXIT
R077  *           PERFORM 8594-WRITE-ATE01D11 THRU 8594-EXIT.   
R077  * 
R077       IF (YES-ALERT-NOTICE-D)  
R077          IF (YES-CLOSE-CLOCK-D)
R077              NEXT SENTENCE 
R077          ELSE  
R077              MOVE  'Y'                   TO WSS-CLOCK-INDIV-SW 
R077              PERFORM 8592-WRITE-ATE01D10 THRU 8592-EXIT
R077              MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME   
R077              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R077              MOVE D11-CDE-RSN-NOTICE     TO R634-CDE-RSN-NOTICE
R077              MOVE D11-CDE-TYPE-NOTICE    TO R634-CDE-TYPE-NOTICE   
R077              MOVE D11-CDE-OPTION-NOTICE  TO R634-CDE-OPTION-NOTICE 
R077              MOVE 'C'                    TO R634-CDE-STUS-NOTICE   
R077              MOVE  2321    TO  WSH-ERR-PARA-NO 
R077              PERFORM 7328-MODIFY-R634    THRU 7328-EXIT
R077              PERFORM 8594-WRITE-ATE01D11 THRU 8594-EXIT.   
R077
R077       IF (YES-ALERT-NOTICE-PD) 
R077          IF (YES-CLOSE-CLOCK-PD)   
R077              NEXT SENTENCE 
R077          ELSE  
R077              MOVE  'Y'                   TO WSS-CLOCK-INDIV-SW 
R077              PERFORM 8592-WRITE-ATE01D10 THRU 8592-EXIT
R077              MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME   
R077              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R077              MOVE D11-CDE-RSN-NOTICE     TO R634-CDE-RSN-NOTICE
R077              MOVE D11-CDE-TYPE-NOTICE    TO R634-CDE-TYPE-NOTICE   
R077              MOVE D11-CDE-OPTION-NOTICE  TO R634-CDE-OPTION-NOTICE 
R077              MOVE 'C'                    TO R634-CDE-STUS-NOTICE   
R077              MOVE  2321    TO  WSH-ERR-PARA-NO 
R077              PERFORM 7328-MODIFY-R634    THRU 7328-EXIT
R077              PERFORM 8594-WRITE-ATE01D11 THRU 8594-EXIT.   
R077
R077  *    IF (YES-CLOSE-CLOCK) 
R077       IF YES-CLOSE-CLOCK-PD
R054           MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME  
R054           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT  
R054           MOVE 474                    TO R634-CDE-REASON-STUS  
R054           MOVE WSH-CLCK-CLS-JUL       TO R634-DTE-CLOSED-BDGT  
R054           MOVE WSH-CLCK-CLS-JUL       TO ATE01D05-CLOSE-DATE   
R067           MOVE  2322    TO  WSH-ERR-PARA-NO
R054           PERFORM 7328-MODIFY-R634    THRU 7328-EXIT   
R054           PERFORM 8554-WRITE-ATE01D05-TRAN-B THRU 8554-EXIT.   
R077
R077       IF YES-CLOSE-CLOCK-D 
R077           MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME  
R077           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT  
R077           MOVE 474                    TO R634-CDE-REASON-STUS  
R077           MOVE WSH-CLCK-CLS-JUL       TO R634-DTE-CLOSED-BDGT  
R077           MOVE WSH-CLCK-CLS-JUL       TO ATE01D05-CLOSE-DATE   
R077           MOVE  2322    TO  WSH-ERR-PARA-NO
R077           PERFORM 7328-MODIFY-R634    THRU 7328-EXIT   
R077           PERFORM 8554-WRITE-ATE01D05-TRAN-B THRU 8554-EXIT.   
R054
       2320-EXIT.   
           EXIT.

R053   2321-PROCESS-CIS014. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *    DISPLAY  '2321-PROCESS-CIS014 '  R666-NBR-CASE  '  ' 
TEST1 *     R246-NBR-CASE  UPON  PRINTER.   
R062       MOVE  ZEROES  TO  WSH-GA-EXP-DATE.   
R053       MOVE  'N'                   TO WSS-DA-DV-SW. 
R053       MOVE R268-NBR-INDIV         TO CIS014-RECIPIENT  
R053       MOVE R249-CDE-CATEGORY      TO CIS014-CDE-CAT
R053       MOVE R249-NBR-GROUP-GRANT   TO CIS014-NBR-GG 
R077       MOVE WSH-RECUR-PAYDATE      TO CIS014-DD-RECUR   
R077       MOVE WSH-2-PAYDATE          TO CIS014-DD-NEXT-RECUR  
R053       MOVE 'N'                    TO CIS014-DA-IND 
R077                                      CIS014-DD-IND 
R053                                      CIS014-DV-IND.
R053       MOVE SPACES                 TO CIS014-NAM-LAST   
R053                                      CIS014-NAM-FIRST  
R053                                      CIS014-NAM-MI 
R053                                      CIS014-NAM-APPEL  
R053                                      CIS014-STATUS-TEXT
R053                                      CIS014-ELIG-STATUS.   
R053       MOVE ZEROS                  TO CIS014-DV-CLOCKS  
R053                                      CIS014-DA-CLOCKS  
R053                                      CIS014-DEP-QUAL   
R053                                      CIS014-CO 
R053                                      CIS014-RECORD 
R053                                      CIS014-PROG-STATUS
R053                                      CIS014-NBR-LINE   
R053                                      CIS014-STATUS.
R053
R053       CALL 'CIS014' USING CIS014-PARAMS
R053                           CIS014-DATA. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'AFTER CALL CIS014 '  R666-NBR-CASE  '  '   
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R053
R067       MOVE  2323    TO  WSH-ERR-PARA-NO.   
CC43       MOVE  WSH-CASE-NUMBER  TO  R666-NBR-CASE 
CC43                                  LINK-NBR-CASE.
CC43       CALL  'DBPA20'  USING  LINK-GET-CASE-AREAS.  
CC43       MOVE  LINK-R666-AN    TO  CALCR666-AN.   
R058       PERFORM  7205-FETCH-R666  THRU  7205-EXIT.   
R053       IF (CIS014-STATUS = ZEROS)   
R053           NEXT SENTENCE
R053       ELSE 
R053           GO TO 2321-EXIT. 
R053
R053       IF (CIS014-ELIG-STATUS = 'C')
R077           IF CIS014-DD-IND = 'Y'   
R077              NEXT SENTENCE 
R077           ELSE 
R053           GO TO 2321-EXIT. 
R053
R053       IF (CIS014-DA-IND = 'N') AND 
R077          (CIS014-DD-IND = 'N') AND 
R053          (CIS014-DV-IND = 'N') 
R053           GO TO 2321-EXIT. 
R053
R053       IF (CIS014-DA-IND = 'Y') 
R053           PERFORM 2322-DA-DAYS    THRU 2322-EXIT.  
R053
R053       IF (CIS014-DV-IND = 'Y') 
R053           PERFORM 2323-DV-DAYS    THRU 2323-EXIT.  
R053
R053       MOVE CIS014-RECIPIENT       TO NBR-INDIV 
R053                                      BNFT-NBR-RCPT.
R053       MOVE CIS014-CDE-CAT         TO   
R053                      CDE-CATEGORY OF ATE01D10-RECORD   
R053                                      BNFT-CATEGORY 
R053                                      D11-CDE-CATEGORY. 
R053       MOVE CIS014-NBR-GG          TO NBR-GROUP-GRANT   
R053                                      BNFT-GRANT-GROUP  
R053                                      D11-NBR-GG.   
R053
R053       MOVE CIS014-CO              TO D11-CDE-COUNTY
R053                                      CDE-COUNTY
R053                                      BNFT-CC.  
R053       MOVE CIS014-RECORD          TO D11-NBR-RECORD
R053                                      NBR-RECORD
R053                                      BNFT-RCD-NBR. 
R053       MOVE CIS014-PROG-STATUS     TO CDE-STATUS-PROGRAM
R053                                      BNFT-PGM-STATUS.  
R053       MOVE CIS014-NBR-LINE        TO NBR-LINE-INDIV.   
R053       MOVE CIS014-NAM-LAST        TO INDIV-LAST.   
R053       MOVE CIS014-NAM-FIRST       TO INDIV-FIRST.  
R053       MOVE CIS014-NAM-MI          TO INDIV-MI. 
R053       MOVE CIS014-NAM-APPEL       TO INDIV-APPEL.  
R054
R054       IF (R249-CDE-CATEGORY = 'PD')
R054           MOVE 'R634-CM-BUDGET-INFO'      TO WSH-RECORD-NAME   
R054           PERFORM 7100-FIND-CUR-IN-REC    THRU 7100-EXIT   
R054           IF (R634-DTE-OPENED-BDGT > WSH-RECUR-DEADLINE)   
R054               GO TO 2321-EXIT. 
R054
R071       IF  R249-CDE-CATEGORY  =  'PD '  AND 
R071           R634-CDE-REASON-STUS  =  477 
R071           IF  ((R634-DTE-OPENED-BDGT  >  WSH-GA-PREV-DTE-N)  AND   
R071                (R634-DTE-OPENED-BDGT  <  WSH-RECUR-DEADLINE  OR
R071                 R634-DTE-OPENED-BDGT  =  WSH-RECUR-DEADLINE))  
R071               GO  TO  2321-EXIT.   
R053       IF (R249-CDE-CATEGORY = 'PD')
R053           MOVE     'M'                    TO BNFT-TYPE-BENEFIT 
R054           MOVE 'R634-CM-BUDGET-INFO'      TO WSH-RECORD-NAME   
R054           PERFORM 7100-FIND-CUR-IN-REC    THRU 7100-EXIT   
R054           IF (R634-DTE-OPENED-BDGT > WSH-PREV-DEADLINE)
R054               MOVE R634-DTE-OPENED-BDGT   TO BNFT-START-DTE
R054           ELSE 
R054               MOVE WSH-PREV-DEADLINE      TO BNFT-START-DTE.   
R054
R054       IF (R249-CDE-CATEGORY = 'PD')
R054           IF (YES-CLOSE-CLOCK) 
R054               MOVE WSH-CLCK-CLS-JUL       TO BNFT-END-DTE  
R054               MOVE WSH-CLCK-CLS-JUL       TO ATE01D05-CLOSE-DATE   
R054               PERFORM 8596-WRITE-ATE01D12 THRU 8596-EXIT   
R054           ELSE 
R054               MOVE WSH-RECUR-DEADLINE     TO BNFT-END-DTE  
R054               PERFORM 8596-WRITE-ATE01D12 THRU 8596-EXIT.  
R054
R053       IF (NO-DA-DV)
R077          IF CIS014-DD-IND = 'Y'
R077             NEXT SENTENCE  
R077          ELSE  
R053           GO TO 2321-EXIT. 
R053
R077  *    MOVE  'Y'                   TO WSS-ALERT-NOTICE-SW   
R077       IF R249-CDE-CATEGORY = 'D'   
R077          MOVE 'Y'                 TO WSS-ALERT-NOTICE-SW-D.
R077       IF R249-CDE-CATEGORY = 'PD'  
R077          MOVE 'Y'                 TO WSS-ALERT-NOTICE-SW-PD.   
R053
R053       IF (R249-CDE-CATEGORY = 'D') 
R053           MOVE  'C'               TO BNFT-TYPE-BENEFIT.
R053
R053       MOVE  474                   TO D11-CDE-RSN-NOTICE.   
R053       MOVE  'D'                   TO D11-CDE-TYPE-NOTICE.  
R053
R053       IF (CIS014-DA-IND = 'Y') 
R053           MOVE  3                 TO D11-CDE-OPTION-NOTICE.
R053
R053       IF (CIS014-DV-IND = 'Y') 
R053           MOVE  4                 TO D11-CDE-OPTION-NOTICE.
R077       PERFORM 2321XX-DECIDE-NOTICE   THRU 2321XX-EXIT. 
R062       IF  WSH-GA-EXP-DATE  =  ZEROES   
R065           MOVE  ZEROES  TO  M2K-GREGORIAN-DATE 
R062       ELSE 
R062           PERFORM  2321A-DATE-CONV  THRU  2321A-EXIT.  
R065       MOVE  M2K-GREGORIAN-DATE  TO  D11-FROM-DATE. 
R070       MOVE  ZEROES               TO  D11-TO-DATE.  
R081       MOVE  ZEROES  TO  SDX-AMOUNT 
R081                         FROM-AMOUNT
R081                         TO-AMOUNT  
R081                         660-3-RCPT.
R081       MOVE  SPACES  TO  POP-BUCKET 
R081                         MNGD-CARE-PLAN-CDE.
R077       IF CIS014-DD-IND = 'Y'   
R077          PERFORM 2321B-DATE-CONV  THRU  2321B-EXIT.
R053
R053       MOVE  SPACES                TO CDE-DISPN-ALERT   
R053                                      TXT-1-MSG-ALERT.  
R053       MOVE  ZEROS                 TO DTE-DISPN-ALERT   
R053                                      NBR-OPTR-DSPO 
R053                                      NBR-IMW-DSPO  
R053                                      CDE-DIST-SENDING  
R053                                      CDE-COUNTY-SENDING
R053                                      NBR-IMW-SENDING   
R053                                      CNT-LINES-ADDNL.  
R053*******MOVE  'Y'                   TO WSS-CLOCK-INDIV-SW.   
R053       ACCEPT WS-SYSTEM-TIME       FROM TIME.   
R053       MOVE WS-SYSTEM-HHMMSS       TO TME-ALERT 
R053                                      TME-CHANGE-LAST.  
R053       ACCEPT HOLD-ALERT-DATE      FROM DAY YYYYDDD.
R053       MOVE HOLD-ALERT-DATE        TO DTE-ALERT 
R053                                      DTE-CHANGE-LAST.  
R053       MOVE  027                   TO NBR-ALERT.
R053       MOVE  'BUAC'                TO CDE-TYPE-ALERT.   
R053       MOVE  'W'                   TO CDE-MODE-DISPN.   
R053       MOVE HOLD-ALERT-DATE        TO DTE-DUE-ALERT.
R053   2321-EXIT.   
R053       EXIT.
R062   2321A-DATE-CONV. 
R062       MOVE  WSH-GA-EXP-DATE  TO  M2K-JULIAN-DATE.  
R062       PERFORM  6510-JUL-TO-GRG.
R062       IF  M2K-DATE-CONV-ERROR-IND  NOT  =  0   
R062           MOVE  ZEROES  TO  M2K-GREGORIAN-DATE.
R062       MOVE  M2K-GRG-YY    TO  WSH-GA-EXP-YY.   
R062       MOVE  M2K-GRG-MM    TO  WSH-GA-EXP-MM.   
R062       MOVE  M2K-GRG-DD    TO  WSH-GA-EXP-DD.   
R062   2321A-EXIT.    EXIT. 
R077
R077   2321B-DATE-CONV. 
R077       MOVE WSH-RECUR-PAYDATE      TO M2K-JULIAN-DATE   
R077       PERFORM  6510-JUL-TO-GRG 
R077       IF M2K-DATE-CONV-ERROR-IND  =  0 
R077          MOVE M2K-GREGORIAN-DATE  TO D11-FROM-DATE 
R077       ELSE 
R077          MOVE ZEROS               TO D11-FROM-DATE.
R077
R077       MOVE CIS014-DISB-END        TO M2K-JULIAN-DATE   
R077       PERFORM  6510-JUL-TO-GRG 
R077       IF M2K-DATE-CONV-ERROR-IND  =  0 
R077          MOVE M2K-GREGORIAN-DATE  TO D11-TO-DATE   
R077       ELSE 
R077          MOVE ZEROS               TO D11-TO-DATE.  
R081       MOVE  ZEROES  TO  SDX-AMOUNT 
R081                         FROM-AMOUNT
R081                         TO-AMOUNT  
R081                         660-3-RCPT.
R081       MOVE  SPACES  TO  POP-BUCKET 
R081                         MNGD-CARE-PLAN-CDE.
R077   2321B-EXIT.  
R077         EXIT.  
R053
R053   2322-DA-DAYS.
R053       MOVE 'LTGADA'               TO HOLD-TBL-KEY. 
R053       PERFORM 2324-SEARCH-TCLK    THRU 2324-EXIT.  
R053
R053       IF (R249-CDE-CATEGORY = 'D') 
R053           PERFORM 2325-DA-CASH-CALC THRU 2325-EXIT.
R053
R053       IF (R249-CDE-CATEGORY = 'PD')
R053           PERFORM 2326-DA-MEDICAL-CALC THRU 2326-EXIT. 
R053   2322-EXIT.   
R053       EXIT.
R053
R053   2323-DV-DAYS.
R053       MOVE 'LTGADV'               TO HOLD-TBL-KEY. 
R053       PERFORM 2324-SEARCH-TCLK    THRU 2324-EXIT.  
R053
R053       IF (R249-CDE-CATEGORY = 'D') 
R053           PERFORM 2327-DV-CASH-CALC THRU 2327-EXIT.
R053
R053       IF (R249-CDE-CATEGORY = 'PD')
R053           PERFORM 2328-DV-MEDICAL-CALC THRU 2328-EXIT. 
R053   2323-EXIT.   
R053       EXIT.
R053
R053   2324-SEARCH-TCLK.
R053       SEARCH ALL TCLK-LEVEL
R053         AT END 
R053           MOVE ZEROS   
R053             TO HOLD-GA-DAYS
R053           MOVE 'N' TO WS-SWT-TCLK-FOUND
R053         WHEN TCLK-TBL-KEY (TCLK-IDX) = HOLD-TBL-KEY
R053           SET TCLK-SUB TO TCLK-IDX 
R053           MOVE TCLK-TBL-PERIOD (TCLK-SUB)  
R053             TO HOLD-GA-DAYS
R053           MOVE 'Y' TO WS-SWT-TCLK-FOUND.   
R053   2324-EXIT.   
R053       EXIT.
R053
R053   2325-DA-CASH-CALC.   
R053       IF (CIS014-DA-CLOCKS = ZEROS)
R053           GO TO 2325-EXIT. 
R053
R053       IF (CIS014-DA-CLOCKS > HOLD-GA-DAYS) 
R053           DISPLAY 'EXCEEDED MAX DAYS = ' CIS014-DA-CLOCKS  
R053                                          UPON PRINTER  
R053           MOVE HOLD-GA-DAYS TO CIS014-DA-CLOCKS.   
R053***    ELSE 
R053***        ADD HOLD-PAYDAY-DIFF      TO CIS014-DA-CLOCKS.   
R053
R053       SUBTRACT CIS014-DA-CLOCKS FROM HOLD-GA-DAYS  
R053         GIVING HOLD-GA-DAYS-LEFT.  
R053
R053       MOVE WSH-RECUR-PAYDATE      TO HOLD-RECUR-PAYDATE.   
R053       ADD HOLD-GA-DAYS-LEFT       TO HOLD-RECUR-PAYDATE.   
R053       MOVE HOLD-RECUR-PAYDATE     TO HOLD-GA-EXP-DATE. 
R053
R053       MOVE HOLD-GA-EXP-DATE       TO HOLD-CALC-JUL-R.  
R053       PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT.  
R053       MOVE HOLD-CALC-JUL-R        TO HOLD-GA-EXP-DATE. 
R053
R053       IF (HOLD-GA-EXP-DATE <      WSH-2-PAYDATE)   
R053           MOVE WSH-2-PAYDATE      TO WSH-CLCK-CLS-JUL  
R053           MOVE WSH-CLCK-CLS-JUL   TO R634-DTE-CLOSED-BDGT  
R077  *        MOVE  'N'                   TO WSS-ALERT-NOTICE-SW   
R077           MOVE  'N'                   TO WSS-ALERT-NOTICE-SW-D 
R053           MOVE  'N'                   TO WSS-CLOCK-INDIV-SW
R053           MOVE  'Y'                   TO WSS-CLOSE-CLOCK-SW
R077                                          WSS-CLOSE-CLOCK-SW-D  
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2325-EXIT. 
R053
R053       IF (HOLD-GA-EXP-DATE > WSH-3-PAYDATE)
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2325-EXIT. 
R053
R053       MOVE 'Y' TO WSS-DA-DV-SW.
R062       MOVE  HOLD-GA-EXP-DATE  TO  WSH-GA-EXP-DATE. 
R053   2325-EXIT.   
R053       EXIT.
R053
R053   2326-DA-MEDICAL-CALC.
R053       IF (CIS014-DA-CLOCKS = ZEROS)
R053           GO TO 2326-EXIT. 
R053
R054       ADD  15  TO CIS014-DA-CLOCKS.
R053
R053       IF  CIS014-DA-CLOCKS > HOLD-GA-DAYS  
R053           DISPLAY 'EXCEEDED MAX DAYS = ' CIS014-DA-CLOCKS  
R053                                          UPON PRINTER  
R053           MOVE HOLD-GA-DAYS TO CIS014-DA-CLOCKS.   
R054
R053       SUBTRACT CIS014-DA-CLOCKS FROM HOLD-GA-DAYS  
R053         GIVING HOLD-GA-DAYS-LEFT.  
R053
R053       MOVE WSH-RECUR-DEADLINE     TO HOLD-RECUR-DEADLINE.  
R053       ADD HOLD-GA-DAYS-LEFT       TO HOLD-RECUR-DEADLINE.  
R053       MOVE HOLD-RECUR-DEADLINE    TO HOLD-GA-EXP-DATE. 
R053
R053       MOVE HOLD-GA-EXP-DATE       TO HOLD-CALC-JUL-R.  
R053       PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT.  
R053       MOVE HOLD-CALC-JUL-R        TO HOLD-GA-EXP-DATE. 
R053
R053       IF (HOLD-GA-EXP-DATE < WSH-2-DEADLINE)   
R053           MOVE WSH-CPF-CYCLE-JUL      TO WSH-CLCK-CLS-JUL  
R053           ADD HOLD-GA-DAYS-LEFT       TO WSH-CLCK-CLS-JUL  
R053           MOVE WSH-CLCK-CLS-JUL       TO HOLD-CALC-JUL-R   
R053           PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT   
R053           MOVE HOLD-CALC-JUL-R        TO WSH-CLCK-CLS-JUL  
R054           MOVE WSH-CLCK-CLS-JUL       TO M2K-CONV-JUL-DT   
R054           MOVE 1                      TO M2K-IN-DAYS   
R054           MOVE 0                      TO M2K-IN-YR 
R054           PERFORM C010-SUBTRACT-JULIAN-M2K 
R054           MOVE M2K-CONV-JUL-DT        TO R634-DTE-CLOSED-BDGT  
R054                                          WSH-CLCK-CLS-JUL  
R077  *        MOVE  'N'                   TO WSS-ALERT-NOTICE-SW   
R077           MOVE  'N'                   TO WSS-ALERT-NOTICE-SW-PD
R053           MOVE  'N'                   TO WSS-CLOCK-INDIV-SW
R053           MOVE  'Y'                   TO WSS-CLOSE-CLOCK-SW
R077                                          WSS-CLOSE-CLOCK-SW-PD 
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2326-EXIT. 
R053
R053       IF (HOLD-GA-EXP-DATE > WSH-3-DEADLINE)   
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2326-EXIT. 
R053
R053       MOVE 'Y' TO WSS-DA-DV-SW.
R062       MOVE  HOLD-GA-EXP-DATE  TO  WSH-GA-EXP-DATE. 
R053   2326-EXIT.   
R053       EXIT.
R053
R053   2327-DV-CASH-CALC.   
R053       IF (CIS014-DV-CLOCKS = ZEROS)
R053           GO TO 2327-EXIT. 
R053
R053       IF (CIS014-DV-CLOCKS > HOLD-GA-DAYS) 
R053           DISPLAY 'EXCEEDED MAX DAYS = ' CIS014-DV-CLOCKS  
R053                                          UPON PRINTER  
R053           MOVE HOLD-GA-DAYS TO CIS014-DV-CLOCKS.   
R053***    ELSE 
R053***        ADD HOLD-PAYDAY-DIFF      TO CIS014-DV-CLOCKS.   
R053
R053       SUBTRACT CIS014-DV-CLOCKS FROM HOLD-GA-DAYS  
R053         GIVING HOLD-GA-DAYS-LEFT.  
R053
R053       MOVE WSH-RECUR-PAYDATE      TO HOLD-RECUR-PAYDATE.   
R053       ADD HOLD-GA-DAYS-LEFT       TO HOLD-RECUR-PAYDATE.   
R053       MOVE HOLD-RECUR-PAYDATE     TO HOLD-GA-EXP-DATE. 
R053
R053       MOVE HOLD-GA-EXP-DATE       TO HOLD-CALC-JUL-R.  
R053       PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT.  
R053       MOVE HOLD-CALC-JUL-R        TO HOLD-GA-EXP-DATE. 
R053
R053
R053       IF (HOLD-GA-EXP-DATE < WSH-2-PAYDATE)
R053           MOVE WSH-2-PAYDATE      TO WSH-CLCK-CLS-JUL  
R053           MOVE WSH-CLCK-CLS-JUL   TO R634-DTE-CLOSED-BDGT  
R077  *        MOVE  'N'               TO WSS-ALERT-NOTICE-SW   
R077           MOVE  'N'               TO WSS-ALERT-NOTICE-SW-D 
R053           MOVE  'N'               TO WSS-CLOCK-INDIV-SW
R053           MOVE  'Y'               TO WSS-CLOSE-CLOCK-SW
R053                                      WSS-CLOSE-CLOCK-SW-D  
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2327-EXIT. 
R053
R053       IF (HOLD-GA-EXP-DATE > WSH-3-PAYDATE)
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2327-EXIT. 
R053
R053       MOVE 'Y' TO WSS-DA-DV-SW.
R062       MOVE  HOLD-GA-EXP-DATE  TO  WSH-GA-EXP-DATE. 
R053   2327-EXIT.   
R053       EXIT.
R053
R053   2328-DV-MEDICAL-CALC.
R053       IF (CIS014-DV-CLOCKS = ZEROS)
R053           GO TO 2328-EXIT. 
R053
R054       ADD  15  TO CIS014-DV-CLOCKS.
R053
R053       IF  CIS014-DV-CLOCKS > HOLD-GA-DAYS  
R053           DISPLAY 'EXCEEDED MAX DAYS = ' CIS014-DV-CLOCKS  
R053                                          UPON PRINTER  
R053           MOVE HOLD-GA-DAYS TO CIS014-DV-CLOCKS.   
R054
R053       SUBTRACT CIS014-DV-CLOCKS FROM HOLD-GA-DAYS  
R053         GIVING HOLD-GA-DAYS-LEFT.  
R053
R053       MOVE WSH-RECUR-DEADLINE     TO HOLD-RECUR-DEADLINE.  
R053       ADD HOLD-GA-DAYS-LEFT       TO HOLD-RECUR-DEADLINE.  
R053       MOVE HOLD-RECUR-DEADLINE    TO HOLD-GA-EXP-DATE. 
R053
R053       MOVE HOLD-GA-EXP-DATE       TO HOLD-CALC-JUL-R.  
R053       PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT.  
R053       MOVE HOLD-CALC-JUL-R        TO HOLD-GA-EXP-DATE. 
R053
R053       IF (HOLD-GA-EXP-DATE < WSH-2-DEADLINE)   
R053           MOVE WSH-CPF-CYCLE-JUL      TO WSH-CLCK-CLS-JUL  
R053           ADD HOLD-GA-DAYS-LEFT       TO WSH-CLCK-CLS-JUL  
R053           MOVE WSH-CLCK-CLS-JUL       TO HOLD-CALC-JUL-R   
R053           PERFORM 2329-CHECK-JUL-DATE THRU 2329-EXIT   
R053           MOVE HOLD-CALC-JUL-R        TO WSH-CLCK-CLS-JUL  
R054           MOVE WSH-CLCK-CLS-JUL       TO M2K-CONV-JUL-DT   
R054           MOVE 1                      TO M2K-IN-DAYS   
R054           MOVE 0                      TO M2K-IN-YR 
R054           PERFORM C010-SUBTRACT-JULIAN-M2K 
R054           MOVE M2K-CONV-JUL-DT        TO R634-DTE-CLOSED-BDGT  
R054                                          WSH-CLCK-CLS-JUL  
R077  *        MOVE  'N'                   TO WSS-ALERT-NOTICE-SW   
R077           MOVE  'N'                   TO WSS-ALERT-NOTICE-SW-PD
R053           MOVE  'N'                   TO WSS-CLOCK-INDIV-SW
R053           MOVE  'Y'                   TO WSS-CLOSE-CLOCK-SW
R077                                          WSS-CLOSE-CLOCK-SW-PD 
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2328-EXIT. 
R053
R053       IF (HOLD-GA-EXP-DATE > WSH-3-DEADLINE)   
R053           MOVE 'N' TO WSS-DA-DV-SW 
R053           GO TO 2328-EXIT. 
R053
R053       MOVE 'Y' TO WSS-DA-DV-SW.
R062       MOVE  HOLD-GA-EXP-DATE  TO  WSH-GA-EXP-DATE. 
R053   2328-EXIT.   
R053       EXIT.
R053
R053   2329-CHECK-JUL-DATE. 
R053       IF (CALC-JUL-DD > 365)   
R053           ADD    1            TO CALC-JUL-YY   
R053           SUBTRACT 365        FROM CALC-JUL-DD 
R053             GIVING HOLD-OVER-DAYS  
R053           MOVE CALC-JUL-YY    TO NEXT-JUL-YY   
R053           MOVE HOLD-OVER-DAYS TO NEXT-JUL-DD   
R053           MOVE HOLD-NEXT-JUL-R TO HOLD-CALC-JUL-R. 
R053   2329-EXIT.   
R053       EXIT.

R056   2332-PROCESS-CISMOE. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *    DISPLAY  '2332-PROCESS-CISMOE '  R666-NBR-CASE  '  ' 
TEST1 *      R246-NBR-CASE  UPON  PRINTER.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'WSS-BDGT-CLOSED-BEF-PERIOD-ON = '  
TEST1 *            WSS-BDGT-CLOSED-BEF-PERIOD UPON PRINTER. 
R056       IF (WSS-BDGT-CLOSED-BEF-PERIOD-ON)   
R056           GO TO 2332-EXIT. 
R056
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'WSS-R654-FOUND '  WSS-R654-FOUND   
TEST1 *            UPON  PRINTER.   
R066       IF  WSS-R654-FOUND  =  'Y'   
R066           IF  ((R654-CDE-EDBC-OVRD-NF    = 'Z')   AND  
R066               (R654-CDE-RSN-OVRD-NF  =  900  OR  903  OR  906))
R066               GO  TO  2332-EXIT.   
R066       IF  WSS-R654-FOUND  =  'Y'   
R066           IF  ((R654-CDE-EDBC-OVRD-RESRC = 'Z')   AND  
R066               (R654-CDE-RSN-OVRD-RESRC  =  900  OR  903  OR  906)) 
R066               GO  TO  2332-EXIT.   
R066       IF  WSS-R654-FOUND  =  'Y'   
R066           IF  ((R654-CDE-EDBC-OVRD-INC   = 'Z')  AND   
R066               (R654-CDE-RSN-OVRD-INC  =  900  OR  903  OR  906))   
R066               GO TO 2332-EXIT. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY 'CISMOE-PROG-STAT = '  CISMOE-PROG-STAT  
TEST1 *            UPON  PRINTER.   
R064       IF  CISMOE-PROG-STAT  =  71  OR  72  
R064           GO  TO  2332-EXIT.   
R056
R062  *    IF  WSS-FIX-PROG-STAT  =  'Y'
R062  *        NEXT  SENTENCE   
R062  *    ELSE 
R062           IF (CISMOE-PROG-STAT = 00 OR 07 OR 08 OR 
R062                                  53 OR 57 OR 58 OR 59) 
R062               NEXT SENTENCE
R062            ELSE
R062               GO TO 2332-EXIT. 
R056
R056       MOVE 'N'                    TO WS-TANIF-WS-REC.  
R056       MOVE R666-NBR-CASE          TO CISMOE-CASE.  
R061       MOVE  WSH-PAYMENT-DATE  TO  CISMOE-PAY-DATE. 
R056       ADD  1                      TO WSA-CISMOE-CALL-CNT.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'BEFORE CALL CISMOE '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       CALL 'CISMOE' USING CISMOE-BUFFER.   
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  'AFTER CALL CISMOE '  R666-NBR-CASE  '  '   
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R062  *    IF  WSS-FIX-PROG-STAT  =  'Y'
R062  *        MOVE  CISMOE-PROG-STAT  TO  D15-CISMOE-PREV-STAT 
R062  *        MOVE  00                TO  TANIF-NEW-STUS-PROG  
R062  *        MOVE  'R634-CM-BUDGET-INFO'  TO  WSH-RECORD-NAME 
R062  *        PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT   
R062  *        MOVE  TANIF-NEW-STUS-PROG  TO  R634-CDE-STUS-PROG
R062  *        MOVE  R634-DTE-BGN-EFFV  TO  TANIF-BGN-R634  
R062  *        PERFORM  7328-MODIFY-R634  THRU  7328-EXIT   
R062  *        PERFORM  2339-STORE-MODIFY-R634  THRU  2339-EXIT 
R062  *        PERFORM  2334-CISMOE-DATA  THRU  2334-EXIT   
R062  *        GO  TO  2332-EXIT.   
R056
R057       IF (CISMOE-PROG-STAT  = 59)  
R057           MOVE CISMOE-PROG-STAT        TO D15-CISMOE-PREV-STAT 
R057           MOVE  09                     TO TANIF-NEW-STUS-PROG  
R057           MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME  
R057           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT  
R057           MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG   
R057           MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634   
R067           MOVE  2333    TO  WSH-ERR-PARA-NO
R057           PERFORM 7328-MODIFY-R634     THRU 7328-EXIT  
R057           PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT
R057           PERFORM 2334-CISMOE-DATA THRU 2334-EXIT  
R057           GO TO 2332-EXIT. 
R057
R056       IF (CISMOE-ERR > ZEROS)  
R061           MOVE  1  TO  TANIF-WS-SUB
R057           PERFORM 2335-MOVE-ATE01D13  THRU 2335-EXIT   
R057                                 CISMOE-CNT TIMES   
R056           ADD  1                  TO WSA-CISMOE-ERROR-CNT  
R056           GO TO 2332-EXIT. 
R056
R056       IF (CISMOE-WPR-STATUS = 'X') 
R056           ADD  1                  TO WSA-CISMOE-X-CNT. 
R056
R056       IF (CISMOE-WPR-STATUS = 'Y') 
R056           ADD  1                  TO WSA-CISMOE-Y-CNT. 
R056
R056       IF (CISMOE-WPR-STATUS = 'Y' OR 'X')  
R056          IF (CISMOE-PROG-STAT  = 53)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  00                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2334    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 57)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  07                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2335    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 58)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  08                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2336    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 59)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  09                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2337    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056              MOVE CISMOE-PROG-STAT          TO TANIF-NEW-STUS-PROG 
R056              MOVE  1  TO TANIF-WS-SUB  
R056              PERFORM 2335-MOVE-ATE01D13  THRU 2335-EXIT
R056                                    CISMOE-CNT TIMES
R056              GO TO  2332-EXIT. 
R056
R056       IF (CISMOE-WPR-STATUS = 'N') 
R056           ADD  1                  TO WSA-CISMOE-N-CNT  
R056          IF (CISMOE-PROG-STAT  = 00)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  53                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2338    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 07)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  57                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2339    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 08)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  58                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2340    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056          IF (CISMOE-PROG-STAT  = 09)   
R056              MOVE CISMOE-PROG-STAT          TO D15-CISMOE-PREV-STAT
R056              MOVE  59                       TO TANIF-NEW-STUS-PROG 
R056              MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME   
R056              PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT   
R056              MOVE TANIF-NEW-STUS-PROG     TO R634-CDE-STUS-PROG
R056              MOVE R634-DTE-BGN-EFFV       TO TANIF-BGN-R634
R067              MOVE  2341    TO  WSH-ERR-PARA-NO 
R056              PERFORM 7328-MODIFY-R634     THRU 7328-EXIT   
R056              PERFORM 2339-STORE-MODIFY-R634 THRU 2339-EXIT 
R056          ELSE  
R056              MOVE CISMOE-PROG-STAT          TO TANIF-NEW-STUS-PROG 
R056              MOVE  1  TO TANIF-WS-SUB  
R056              PERFORM 2335-MOVE-ATE01D13  THRU 2335-EXIT
R056                                    CISMOE-CNT TIMES
R056              GO TO  2332-EXIT. 
R056
R056       PERFORM 2334-CISMOE-DATA THRU 2334-EXIT. 
R056   2332-EXIT.   
R056       EXIT.
R056
R056   2333-INITIALIZE-CISMOE.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2333-INITIALIZE-CISMOE '  UPON  PRINTER.   
R061       MOVE SPACES  TO  CISMOE-PARENT (TANIF-WS-SUB)
R056                            CISMOE-ELIG      (TANIF-WS-SUB) 
R056                            CISMOE-PROJ      (TANIF-WS-SUB) 
R061                            CISMOE-SSI-FLAG  (TANIF-WS-SUB) 
R061                            CISMOE-SCHOOL-FLAG  (TANIF-WS-SUB)  
R061                            CISMOE-SSI-PAR-1    (TANIF-WS-SUB)  
R061                            CISMOE-SSI-PAR-2    (TANIF-WS-SUB)  
CC46                            CISMOE-HAVE-EA-JAM  (TANIF-WS-SUB)  
CC46                            CISMOE-HAVE-ETP-22  (TANIF-WS-SUB)  
CC46                            CISMOE-HAVE-ETP-54  (TANIF-WS-SUB)  
CC46                            CISMOE-HAVE-PAR-54  (TANIF-WS-SUB)  
R075B                           CISMOE-HAVE-ELG-SSI-PAR (TANIF-WS-SUB)  
R056                            CISMOE-PROJ-B    (TANIF-WS-SUB).
R056       MOVE ZEROS        TO CISMOE-RCPT      (TANIF-WS-SUB) 
R056                            CISMOE-AGE       (TANIF-WS-SUB) 
R056                            CISMOE-ETP       (TANIF-WS-SUB) 
R061                            CISMOE-GOOD-CAUSE  (TANIF-WS-SUB)   
R056                            CISMOE-WK-HRS    (TANIF-WS-SUB) 
R056                            CISMOE-SELF-EMPL (TANIF-WS-SUB) 
R061                            CISMOE-PROJ-CORE-HRS  (TANIF-WS-SUB)
R061                            CISMOE-PROJ-NON-HRS   (TANIF-WS-SUB)
R061                            CISMOE-PARENT-LINE-1  (TANIF-WS-SUB)
R061                            CISMOE-PARENT-LINE-2  (TANIF-WS-SUB)
R075B                           CISMOE-CITIZEN-CDE  (TANIF-WS-SUB)  
R056                            CISMOE-LINE-NO   (TANIF-WS-SUB).
R056       ADD   1           TO TANIF-WS-SUB.   
R056   2333-EXIT.   
R056       EXIT.
R056
R056   2334-CISMOE-DATA.
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2334-CISMOE-DATA '  R666-NBR-CASE  '  '
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       MOVE 1  TO TANIF-WS-SUB. 
R056       PERFORM 2335-MOVE-ATE01D13  THRU 2335-EXIT CISMOE-CNT TIMES. 
R056       MOVE 1  TO TANIF-WS-SUB. 
R056       PERFORM 2336-MOVE-ATE01D14  THRU 2336-EXIT CISMOE-CNT TIMES. 
R056       PERFORM 2337-MOVE-ATE01D15  THRU 2337-EXIT.  
R056       MOVE 1  TO TANIF-WS-SUB. 
R056       PERFORM 2338-MOVE-ATE01D16  THRU 2338-EXIT.  
R056   2334-EXIT.   
R056       EXIT.
R056
R056   2335-MOVE-ATE01D13.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2335-MOVE-ATE01D13 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       MOVE CISMOE-ERR             TO D13-CISMOE-ERR.   
R056       MOVE CISMOE-WPR-STATUS      TO D13-CISMOE-WPR-STATUS.
R056       MOVE CISMOE-CASE            TO D13-CISMOE-CASE.  
R056       MOVE CISMOE-CAT             TO D13-CISMOE-CAT.   
R056       MOVE CISMOE-GG              TO D13-CISMOE-GG.
R056       MOVE CISMOE-PROG-STAT       TO D13-CISMOE-PROG-STAT. 
R056       MOVE TANIF-NEW-STUS-PROG    TO D13-CISMOE-NEW-PROG-STAT. 
R061       MOVE  CISMOE-PAY-DATE  TO  D13-CISMOE-PAY-DATE.  
R061       MOVE  CISMOE-CHILD-COMMON  TO  D13-CISMOE-CHILD-COMMON.  
R056       MOVE CISMOE-CNT             TO D13-CISMOE-CNT.   
R056
R056       MOVE CISMOE-RCPT      (TANIF-WS-SUB) 
R056         TO D13-CISMOE-RCPT.
R056       MOVE CISMOE-AGE       (TANIF-WS-SUB) 
R056         TO D13-CISMOE-AGE. 
R056       MOVE CISMOE-PARENT    (TANIF-WS-SUB) 
R056         TO D13-CISMOE-PARENT.  
R056       MOVE CISMOE-ELIG      (TANIF-WS-SUB) 
R056         TO D13-CISMOE-ELIG.
R056       MOVE CISMOE-ETP       (TANIF-WS-SUB) 
R056         TO D13-CISMOE-ETP. 
R061       MOVE  CISMOE-GOOD-CAUSE (TANIF-WS-SUB)  TO   
R061               D13-CISMOE-GOOD-CAUSE.   
R056       MOVE CISMOE-PROJ      (TANIF-WS-SUB) 
R056         TO D13-CISMOE-PROJ.
R056       MOVE CISMOE-WK-HRS    (TANIF-WS-SUB) 
R056         TO D13-CISMOE-WK-HRS.  
R056       MOVE CISMOE-SELF-EMPL (TANIF-WS-SUB) 
R056         TO D13-CISMOE-SELF-EMPL.   
R061       MOVE  CISMOE-PROJ-CORE-HRS (TANIF-WS-SUB)  TO
R061               D13-CISMOE-PROJ-CORE-HRS.
R061       MOVE  CISMOE-PROJ-NON-HRS (TANIF-WS-SUB)  TO 
R061               D13-CISMOE-PROJ-NON-HRS. 
R056       MOVE CISMOE-LINE-NO   (TANIF-WS-SUB) 
R056         TO D13-CISMOE-LINE-NO. 
R061       MOVE  CISMOE-PARENT-LINE-1 (TANIF-WS-SUB)  TO
R061               D13-CISMOE-PARENT-LINE-1.
R061       MOVE  CISMOE-PARENT-LINE-2 (TANIF-WS-SUB)  TO
R061               D13-CISMOE-PARENT-LINE-2.
R056       MOVE CISMOE-PROJ-B    (TANIF-WS-SUB) 
R056         TO D13-CISMOE-PROJ-B.  
R061       MOVE  CISMOE-SSI-FLAG (TANIF-WS-SUB)  TO 
R061               D13-CISMOE-SSI-FLAG. 
R061       MOVE  CISMOE-SCHOOL-FLAG (TANIF-WS-SUB)  TO  
R061               D13-CISMOE-SCHOOL-FLAG.  
R061       MOVE  CISMOE-SSI-PAR-1 (TANIF-WS-SUB)  TO
R061               D13-CISMOE-SSI-PAR-1.
R061       MOVE  CISMOE-SSI-PAR-2 (TANIF-WS-SUB)  TO
R061               D13-CISMOE-SSI-PAR-2.
R061       MOVE  CISMOE-WPR-STAT-RCPT (TANIF-WS-SUB)  TO
R061               D13-CISMOE-WPR-RCPT. 
R075B      MOVE  CISMOE-CITIZEN-CDE (TANIF-WS-SUB)  TO  
R075B            D13-CISMOE-CITIZEN-CDE.
R075B      MOVE  CISMOE-HAVE-EA-JAM (TANIF-WS-SUB)  TO  
R075B            D13-CISMOE-HAVE-EA-JAM.
R075B      MOVE  CISMOE-HAVE-ETP-22 (TANIF-WS-SUB)  TO  
R075B            D13-CISMOE-HAVE-ETP-22.
R075B      MOVE  CISMOE-HAVE-ETP-54 (TANIF-WS-SUB)  TO  
R075B            D13-CISMOE-HAVE-ETP-54.
R075B      MOVE  CISMOE-HAVE-ELG-SSI-PAR (TANIF-WS-SUB)  TO 
R075B            D13-CISMOE-HAVE-ELG-SSI-PAR.   
R075B      MOVE  CISMOE-HAVE-PAR-54 (TANIF-WS-SUB)  TO  
R075B            D13-CISMOE-HAVE-PAR-54.
R056
R056       PERFORM 8600-WRITE-ATE01D13 THRU 8600-EXIT.  
R056       ADD  1   TO TANIF-WS-SUB.
R056   2335-EXIT.   
R056       EXIT.
R056
R056   2336-MOVE-ATE01D14.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2336-MOVE-ATE01D14 '  R666-NBR-CASE  '  '  
TEST1 *        R246-NBR-CASE  UPON  PRINTER.
R056       MOVE CISMOE-RCPT (TANIF-WS-SUB) TO ATE02D05-RCPT-NBR.
R056       MOVE CISMOE-CASE                TO ATE02D05-CASE-NBR-N.  
R056       MOVE CISMOE-CAT                 TO ATE02D05-CATEGORY.
R056       MOVE R249-NBR-GROUP-GRANT       TO ATE02D05-GRANT-GROUP. 
R056       MOVE CISMOE-PROG-STAT           TO ATE02D05-OLD-PROG-STAT.   
R056       MOVE TANIF-NEW-STUS-PROG        TO ATE02D05-NEW-PROG-STAT.   
R056       ACCEPT WS-SYSTEM-TIME           FROM TIME.   
R056       MOVE WS-SYSTEM-HHMMSS           TO ATE02D05-TIME-ACTN.   
R056       MOVE WSH-CPF-CYCLE-JUL          TO ATE02D05-DTE-CHNG.
R056       MOVE WSH-PAYMENT-DATE           TO ATE02D05-MPD-DATE.
R056       MOVE SPACES                     TO ATE02D05-CDE-STUS.
R056
R056       PERFORM 8602-WRITE-ATE01D14 THRU 8602-EXIT.  
R056       ADD  1  TO TANIF-WS-SUB. 
R056   2336-EXIT.   
R056       EXIT.
R056
R056   2337-MOVE-ATE01D15.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2337-MOVE-ATE01D15 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       MOVE CISMOE-CASE            TO D15-CISMOE-CASE   
R056                                      WSH-CNTY-CASE-NBR.
R056       MOVE CISMOE-CAT             TO D15-CISMOE-CAT.   
R056       MOVE CISMOE-GG              TO D15-CISMOE-GG.
R056       MOVE CISMOE-PROG-STAT       TO D15-CISMOE-PREV-STAT. 
R056       MOVE TANIF-NEW-STUS-PROG    TO D15-CISMOE-PROG-STAT. 
R056       MOVE WSH-CNTY-NBR           TO D15-CISMOE-CO.
R056       MOVE R672-CDE-DIST          TO D15-CISMOE-DIST.  
R056       MOVE R672-NBR-CSLD          TO D15-CISMOE-CSLD.  
R056       MOVE R248-NAM-PMT           TO D15-CISMOE-PMT-NAME.  
R056
R056       PERFORM 8604-WRITE-ATE01D15 THRU 8604-EXIT.  
R056   2337-EXIT.   
R056       EXIT.
R056
R056   2338-MOVE-ATE01D16.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2338-MOVE-ATE01D16 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       MOVE CISMOE-RCPT (TANIF-WS-SUB) TO ATE01D16-RECIPIENT.   
R056       MOVE CISMOE-CASE            TO ATE01D16-NBR-CASE.
R056       MOVE CISMOE-CAT             TO ATE01D16-CDE-CAT. 
R056       MOVE CISMOE-GG              TO ATE01D16-NBR-GG.  
R056       MOVE R249-CTL-DIGIT         TO ATE01D16-CTL-DIGIT.   
R056       MOVE 'MOECON'               TO ATE01D16-NBR-TRANS.   
R056       MOVE WSH-CPF-CYCLE-JUL      TO ATE01D16-DTE-BGN-EFFV.
R056       MOVE ZEROS                  TO ATE01D16-DTE-END-EFFV.
R056       MOVE WSH-CPF-CYCLE-JUL      TO ATE01D16-DTE-CHNG.
R056       ACCEPT WS-SYSTEM-TIME       FROM TIME.   
R056       MOVE WS-SYSTEM-TIME         TO ATE01D16-TIME-ACTN.   
R056
R056       PERFORM 8606-WRITE-ATE01D16 THRU 8606-EXIT.  
R056       ADD  1  TO TANIF-WS-SUB. 
R056   2338-EXIT.   
R056       EXIT.
R056
R056   2339-STORE-MODIFY-R634.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339-STORE-MODIFY-R634 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R067       MOVE  2342    TO  WSH-ERR-PARA-NO.   
R056       PERFORM 2339D-FIND-CURRENT-R249  THRU 2339D-EXIT.
R056       PERFORM 2339E-FETCH-R634    THRU 2339E-EXIT. 
R056       IF (WSS-R634-EOS-ON) 
R056           GO TO 2339-EXIT. 
R056
R056       PERFORM 2339C-PROCESS-R634  THRU 2339C-EXIT. 
R056       PERFORM 2339B-NEXT-R634     THRU 2339B-EXIT  
R056                                   UNTIL WSS-R634-EOS-ON.   
R056
R056       MOVE 'R634-CM-BUDGET-INFO'  TO WSH-RECORD-NAME.  
R056       PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT. 
R056       MOVE CISMOE-CASE            TO ATE01D09-NBR-CASE.
R056       MOVE CISMOE-CAT             TO ATE01D09-CDE-CATEGORY.
R056       MOVE CISMOE-GG              TO ATE01D09-NBR-GROUP-GRANT. 
R056       MOVE 'R634'                 TO ATE01D09-FUTURE-REC-TYPE. 
R056       MOVE 1                      TO ATE01D09-RECORD-TYPE. 
R056       MOVE ZEROS                  TO ATE01D09-FUTURE-DATE-1
R056                                      ATE01D09-FUTURE-DATE-2
R056                                      ATE01D09-DD-BANK-ORIG 
R056                                      ATE01D09-DD-BANK-NEW. 
R056       PERFORM 8590-WRITE-ATE01D09 THRU 8590-EXIT.  
R056   2339-EXIT.   
R056       EXIT.
R056
R056   2339B-NEXT-R634. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339B-NEXT-R634 '  R666-NBR-CASE  '  ' 
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R067       MOVE  2343    TO  WSH-ERR-PARA-NO.   
R056       PERFORM 2339E-FETCH-R634    THRU 2339E-EXIT. 
R056       IF (WSS-R634-EOS-ON) 
R056           GO TO 2339B-EXIT.
R056
R056       PERFORM 2339C-PROCESS-R634  THRU 2339C-EXIT. 
R056   2339B-EXIT.  
R056       EXIT.
R056
R056   2339C-PROCESS-R634.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339C-PROCESS-R634 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R056       IF (R634-DTE-BGN-EFFV > TANIF-BGN-R634)  
R056           MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME  
R056           PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT  
R056           MOVE TANIF-NEW-STUS-PROG  TO R634-CDE-STUS-PROG  
R067           MOVE  2344    TO  WSH-ERR-PARA-NO
R056           PERFORM 7328-MODIFY-R634  THRU 7328-EXIT 
R056           GO TO 2339C-EXIT.
R056
R056       IF (R634-DTE-BGN-EFFV = TANIF-BGN-R634)  
R056          IF (R634-DTE-BGN-EFFV < WSH-PAYMENT-DATE) 
R056               NEXT SENTENCE
R056          ELSE  
R056              MOVE 1 TO WSS-R634-EOS
R056              GO TO 2339C-EXIT  
R056       ELSE 
R056           MOVE 1 TO WSS-R634-EOS   
R056           GO TO 2339C-EXIT.
R056
R056       MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME. 
R056       PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT. 
R056       MOVE  WSH-RECUR-PAYDATE     TO R634-DTE-END-EFFV.
R056       MOVE CISMOE-PROG-STAT       TO R634-CDE-STUS-PROG.   
R067       MOVE  2345    TO  WSH-ERR-PARA-NO.   
R070       PERFORM 7330-STORE-R634     THRU 7330-EXIT.  
R056
R056       PERFORM 2339F-FETCH-PRIOR-R634 THRU 2339F-EXIT.  
R056       MOVE 'R634-CM-BUDGET-INFO'       TO WSH-RECORD-NAME. 
R056       PERFORM 7100-FIND-CUR-IN-REC THRU 7100-EXIT. 
R056       MOVE ZEROS                  TO R634-DTE-END-EFFV.
R056       MOVE WSH-PAYMENT-DATE       TO R634-DTE-BGN-EFFV.
R056       MOVE WS-SYSTEM-HHMMSS       TO R634-TME-ACTN.
R056       MOVE WSH-CPF-CYCLE-JUL      TO R634-DTE-CHNG.
R056       MOVE TANIF-NEW-STUS-PROG    TO R634-CDE-STUS-PROG.   
R056       MOVE 471                    TO R634-CDE-REASON-STUS. 
R056       MOVE 99999                  TO R634-CDE-AUTH-CHG-BDGT.   
R056       MOVE SPACES                 TO R634-CDE-TYPE-NOTICE  
R056                                      R634-CDE-OPTION-NOTICE
R056                                      R634-CDE-STUS-NOTICE. 
R056       MOVE 471                    TO R634-CDE-RSN-NOTICE.  
R056       MOVE WSH-CPF-CYCLE-JUL      TO R634-DTE-CHANGE-HIPAA.
R056       MOVE 'F'                    TO R634-CDE-ACTN-BDGT.   
R067       MOVE  2346    TO  WSH-ERR-PARA-NO.   
R056       PERFORM 7328-MODIFY-R634    THRU 7328-EXIT.  
R056       MOVE 1 TO WSS-R634-EOS.  
R056   2339C-EXIT.  
R056       EXIT.
R056
R056   2339D-FIND-CURRENT-R249. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339D-FIND-CURRENT-R249 '  R666-NBR-CASE   
TEST1 *            '  '  R246-NBR-CASE  UPON  PRINTER.  
R067       MOVE  2347    TO  WSH-ERR-PARA-NO.   
R056       FIND CURRENT RECORD  
R056           WITHIN R249-CASH-MEDICAL-BUDGET RECORD.  
R056       IF ERROR-STATUS = '000000'   
R056          MOVE 0 TO WSS-R249-EOS
R056       ELSE 
R056          IF ERROR-NUM = '0006' OR '0007' OR '0013' 
R056             MOVE 1 TO WSS-R249-EOS 
R056          ELSE  
R056             PERFORM 7995-DB-ERROR THRU 7995-EXIT.  
R056   2339D-EXIT.  
R056       EXIT.
R056
R056   2339E-FETCH-R634.
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339E-FETCH-R634 '  R666-NBR-CASE  '  '
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R067       MOVE  2348    TO  WSH-ERR-PARA-NO.   
R056        FETCH NEXT R634-CM-BUDGET-INFO  
R056             WITHIN S396-CM-BDGT-INFO SET.  
R056        IF ERROR-STATUS = '000000'  
R056           MOVE 0 TO WSS-R634-EOS   
R056        ELSE
R056           IF ERROR-NUM = '0006' OR '0007' OR '0013'
R056              MOVE 1 TO WSS-R634-EOS
R056           ELSE 
R056              PERFORM 7995-DB-ERROR THRU 7995-EXIT. 
R056   2339E-EXIT.  
R056       EXIT.
R056
R056   2339F-FETCH-PRIOR-R634.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2339F-FETCH-PRIOR-R634 '  R666-NBR-CASE  '  '  
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
R067       MOVE  2349    TO  WSH-ERR-PARA-NO.   
R056        FETCH PRIOR R634-CM-BUDGET-INFO 
R056             WITHIN S396-CM-BDGT-INFO SET.  
R056        IF ERROR-STATUS = '000000'  
R056           MOVE 0 TO WSS-R634-EOS   
R056        ELSE
R056           IF ERROR-NUM = '0006' OR '0007' OR '0013'
R056              MOVE 1 TO WSS-R634-EOS
R056           ELSE 
R056              PERFORM 7995-DB-ERROR THRU 7995-EXIT. 
R056   2339F-EXIT.  
R056       EXIT.
R056
      *******************************************************   
      *** DETAIL CALCULATION OF PRORATED PAY MODULE.      ***   
      *** PRO-AMT AND PRO-CONSTANT ARE BUILT BY PROC &    ***   
      *******************************************************   
      *** DETAIL CALCULATION OF PRORATED PAY MODULE.      ***   
      *** PRO-AMT AND PRO-CONSTANT ARE BUILT BY PROC &    ***   
      *** THEN COPY PROC APR813 IS USED FOR DETAIL CALC.  ***   
      ***                                                 ***   
      *** IF NO OF PRORATED DAYS TURN OUT > 14, THEN      ***   
      *** ROUND OFF TO NEAREST 5 CENTS, & ISSUE MESSAGES. ***   
      *** HOWEVER, KEEP GOING & MAKE ISSUANCE.            ***   
      *******************************************************   
       2340-CALC-PRO-RATE-PAY.  
           IF WSS-R654-REC-ON   
              COMPUTE WS-PRORATION-AMT ROUNDED = R654-AMT-GR-CASH / 2.0 
           ELSE 
              COMPUTE WS-PRORATION-AMT ROUNDED =
                                              R255-AMT-GRANT-CASH / 2.0.

           IF WS-PRO-DAYS > 14  
              ADD .05                  TO WS-PRORATION-AMT  
              MOVE ZERO                TO WS-PRO-C-2
              GO TO 2340-EXIT.  

TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2340-AMT '  R666-NBR-CASE  '  '  R246-NBR-CASE 
TEST1 *            '  '  WS-PRORATION-AMT  UPON  PRINTER.   
       2340-CALC-DETAIL.
           COPY APR813P.

       2340-EXIT.   
           EXIT.

      *******************************************************   
      *** CHEQUE ISSUANCE MODULE.                         ***   
      ***     . CHECK IF BANK NOS HV CHANGED, IF YES :    ***   
      ***           . MODIFY R255 FOR DATES.              ***   
      ***           . STORE A NEW R255.                   ***   
      ***     . WRITE ATE01D05 RECORDS                    ***   
      ***     . FETCH R270/R271 RECOUPMENT RECORDS        ***   
      ***     . WRITE ATE01D01 RECORDS.                   ***   
      *******************************************************   
       2350-CHECK-ISSUANCE-DETAIL.  
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2350-CHECK-ISSUANCE-DETAILS '  R666-NBR-CASE   
TEST1 *            '  '  R246-NBR-CASE  UPON  PRINTER.  
           IF WSH-SECOND-HALF AND   
              ( WST-CAT-TYPE (WSI-CAT-IDX) = 2 OR 3 )   
                  GO TO 2350-EXIT.  

R069       IF NOT WSS-R255-REC-ON   
R069          GO TO 2350-EXIT.  

           IF WSS-BDGT-CLOSED-BEF-PERIOD-ON      AND
              NOT WSS-BDGT-PRORATED-CLOSE-ON
                  GO TO 2350-EXIT.  

           IF WSS-BDGT-PRORATED-CLOSE-ON         AND
              WS-PRORATION-AMT = 0  
                  GO TO 2350-EXIT.  

       2350-FETCH-R270-R271.
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '2350-FETCH-R270-R271 '  R666-NBR-CASE  '  '
TEST1 *            R246-NBR-CASE  UPON  PRINTER.
           IF NOT WSS-R258-REC-ON   
              GO TO 2350-FETCH-R270-R271-EXIT.  

R067       MOVE  2350    TO  WSH-ERR-PARA-NO.   
           PERFORM 7700-FETCH-R270               THRU 7700-EXIT.
           IF NOT WSS-R270-REC-ON   
              MOVE 'R270'              TO WS-SML-PARAM-2
              PERFORM 7900-MISSING-RECORD        THRU 7900-EXIT 
              GO TO 2350-FETCH-R270-R271-EXIT.  

R067       MOVE  2351    TO  WSH-ERR-PARA-NO.   
           PERFORM 7720-FETCH-R271               THRU 7720-EXIT.
           IF NOT WSS-R271-REC-ON   
              MOVE 'R271'              TO WS-SML-PARAM-2
              PERFORM 7900-MISSING-RECORD        THRU 7900-EXIT.

       2350-FETCH-R270-R271-EXIT.   
           EXIT.

       2350-WRITE-ATE01D01-ATE01D07.
TEST1 *        IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY '2350-WRITE-ATE01D01-D07 '  R666-NBR-CASE
TEST1 *            '  '  R246-NBR-CASE  UPON  PRINTER.  
           IF R634-CDE-STUS-BDGT = 'O'  
                 MOVE 1                TO WSS-BDGT-CASH-ISSNC   
                 PERFORM 8510-WRITE-ATE01D01     THRU 8510-EXIT 
           ELSE 
R069           IF  (WSH-FIRST-HALF AND WSH-QUARTERLY)   
R069              IF  R634-CDE-STUS-BDGT   =  'S'   
R069                   PERFORM  8510-WRITE-ATE01D01  THRU  8510-EXIT.   
R069       IF  WSS-R258-REC-ON  AND 
R069           R258-CDE-STATUS-RCOUPMT  NOT  =  01  
R069           MOVE  0  TO  WSS-R258-REC
R069                        WSS-R270-REC
R069                        WSS-R271-REC.   
R069       IF  WSS-BDGT-PRORATED-CLOSE-ON   
R069           IF  WSS-R654-REC-ON  
R069               MOVE  WS-PRORATION-AMT  TO  R654-AMT-GR-CASH 
R069           ELSE 
R069               MOVE  WS-PRORATION-AMT  TO  R255-AMT-GRANT-CASH. 
R069       IF  WSS-BDGT-MAND-REC-MISSING-ON 
R069           GO  TO  2350-EXIT.   
R069       IF  R634-CDE-STUS-BDGT  =  'O'   
R069           IF  WSS-R654-REC-ON  
R069               IF  R654-AMT-GR-CASH  <  10.0
R069                   PERFORM  2355-ADD-AGRZER  THRU  2355-EXIT
R069               ELSE 
R069                   NEXT  SENTENCE   
R069           ELSE 
R069               IF  R255-AMT-GRANT-CASH  <  10.0 
R069                   PERFORM  2355-ADD-AGRZER  THRU  2355-EXIT.   
R069       IF  R634-CDE-STUS-BDGT  =  'S'  AND  
R069           WSS-R258-REC-ON  
R069           PERFORM  2355-ADD-AGRZER  THRU  2355-EXIT.   
R069A *    IF R634-CDE-STUS-BDGT = 'S'           AND
R069A *        WSS-R258-REC-ON  
R069A *        PERFORM 8570-WRITE-ATE01D07     THRU 8570-EXIT.  
R069A * 
R069A *2350-WRITE-LT-10-TO-D07. 
R069A *    IF R634-CDE-STUS-BDGT  = 'O' 
R069A *       IF WSS-R654-REC-ON
R069A *          IF R654-AMT-GR-CASH < 10.0 
R069A *             PERFORM 8570-WRITE-ATE01D07  THRU 8570-EXIT 
R069A *          ELSE   
R069A *             NEXT SENTENCE   
R069A *       ELSE  
R069A *       IF R255-AMT-GRANT-CASH < 10.00
R069A *          PERFORM 8570-WRITE-ATE01D07     THRU 8570-EXIT.

R064  *    IF  WSH-R255-OTI  =  'Y' 
R064  *        PERFORM  8610-WRITE-ATE01D17  THRU  8610-EXIT.   
       2350-EXIT.   
           EXIT.
R069   2355-ADD-AGRZER. 
R069       IF  WSS-R654-REC-ON  
R069           IF  R654-AMT-GR-CASH  <  10.0
R069               ADD  1  TO  WSA-R-MGA-LT-10-CNT  
R069           ELSE 
R069               ADD  1  TO  WSA-R-AGRZER-CNT 
R069       ELSE 
R069           IF  R255-AMT-GRANT-CASH  <  10.0 
R069               ADD  1  TO  WSA-R-MGA-LT-10-CNT  
R069           ELSE 
R069               ADD  1  TO  WSA-R-AGRZER-CNT.
R069   2355-EXIT.    EXIT.  

      *******************************************************   
      *** MAID ISSUANCE MODULE.                           ***   
      ***     . CHECK PAYMENT MONTH AND PAYDAY NUMBERS    ***   
      ***     . FETCH R260/R262 BULK MAILING/ HMO RECORDS.***   
      ***     . WRITE ATE01D02 RECORDS.                   ***   
      ***                                                 ***   
      ***     . ALSO BUILD D03 FILE FROM R268 RECORDS.    ***   
      ***       AND THE WST TABLE THAT IS USED TO BUILD   ***   
      ***       R396 IN HISTORY AREA.                     ***   
      ***                                                 ***   
      ***     . COUNT HOW MANY 'OPEN', MEDICAL-ONLY       ***   
      ***       BUDGETS CAME IN FOR PROCESSING.           ***   
      ***                                                 ***   
      ***     . GENERALLY ALL CASH CATEGORIES ALSO RECV   ***   
      ***       MEDICAL & MEDICAL-ONLY DO NOT RECV CASH.  ***   
      ***       HOWEVER, IF MAID CARD IS NOT BEING ISSUED,***   
      ***       MAID-BYPASSED SW WILL BE SET, THIS SW WILL***   
      ***       BE TESTED SUBSEQUENTLY AND TABLE BUILT.   ***   
      *******************************************************   
       2360-MAID-ISSUANCE-DETAIL.   
R030       MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
R067       MOVE  2360    TO  WSH-ERR-PARA-NO.   
R030       PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
R069A *    PERFORM 7400-FETCH-R260               THRU 7400-EXIT.
R030
R030       MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
R030       PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.

           IF WST-CAT-TYPE (WSI-CAT-IDX) = 1
              ADD 1                    TO WSA-R-MAID-ONLY-CNT.  

           IF WSS-BDGT-CLOSED-BEF-PERIOD-ON      AND
              NOT WSS-BDGT-PRORATED-CLOSE-ON
                  MOVE 1               TO WSS-BDGT-MAID-BYPASSED
                  GO TO 2360-EXIT.  

           IF WSS-BDGT-PRORATED-CLOSE-ON         AND
              WS-PRORATION-AMT = 0  
                  MOVE 1               TO WSS-BDGT-MAID-BYPASSED
                  GO TO 2360-EXIT.  

           MOVE 1                      TO WSS-BDGT-MAID-ISSNC.  
R069       IF  WSS-BDGT-MAND-REC-MISSING-ON 
R069           NEXT  SENTENCE   
R069       ELSE 
R069           ADD  1  TO  WSA-ATE01D02-BLK-CNT.

R069A *2360-WRITE-ATE01D02. 
R069A *    PERFORM 8520-WRITE-ATE01D02           THRU 8520-EXIT.

       2360-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA BUILDS THE NBR-LINE-INDIV TABLE FROM  ***   
      *** R268 RECORDS. OVERFLOW CONDITION WILL BE        ***   
      *** DETECTED AND SWITCH 23 WILL BE SET, WITH A      ***   
      *** WARNING MSG DISPLAYED.                          ***   
      *** IF NO OVERFLOW, THEN :                          ***   
      ***    . BUILD TABLE AND FETCH NEXT R268.           ***   
      ***                                                 ***   
      *** IT CAN BE CALLED FROM EITHER MAID-ISSNC PARA,   ***   
      *** WHEN TABLE WILL BE BULIT AND D03 FILE WILL BE   ***   
      *** WRITTEN    OR,                                  ***   
      *** IF ITS A SUSPENDED OR 2500-CLOSED BDGT, THEN    ***   
      *** TABLE WILL BE BUILT, BUT DO3 WILL NOT BE        ***   
R069  *** WRITTEN.                                  -   
      *******************************************************   
       2370-BUILD-WST-NBR-LINE-TAB. 
           EXIT.

       2370-CHECK-OVERFLOW. 
           IF WSI-NBR-IDX > WSH-NBR-TAB-MAX-SIZE
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
R043          DISPLAY 'LINE NUMBER TABLE SIZE EXCEEDED '
R043                              UPON PRINTER  
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE 'TAB-NBR-LIN'       TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
              MOVE 1                   TO WSS-R268-EOS  
              GO TO 2370-EXIT.  

       2370-DETAIL-MOVE.
           MOVE R268-NBR-INDIV         TO WST-NBR-INDIV 
                                          (WSI-NBR-IDX).
           MOVE R268-NBR-LINE-INDIV    TO WST-NBR-LINE-INDIV
                                          (WSI-NBR-IDX).
R053       IF (R249-CDE-CATEGORY = 'D' OR 'PD') 
R053           PERFORM 2321-PROCESS-CIS014 THRU 2321-EXIT.  
R053
       2370-WRITE-ATE01D02. 
R069A *    IF WSS-BDGT-MAID-ISSNC-ON
R069A *       PERFORM 8530-WRITE-ATE01D02        THRU 8530-EXIT.
R038       IF WSS-BDGT-CASH-ISSNC-ON
R035          PERFORM 8535-WRITE-ATE01D01        THRU 8535-EXIT.

       2370-FETCH-NEXT-R268.
           MOVE 0                      TO WSS-R268-REC. 
           MOVE 0                      TO WSS-R268-EOS. 
           PERFORM 7450-FETCH-R268               THRU 7450-EXIT 
                   UNTIL WSS-R268-REC-ON OR 
                         WSS-R268-EOS-ON.   
           SET WSI-NBR-IDX             UP BY 1. 

       2370-EXIT.   
           EXIT.

      ******************************************************
      *** FUTURE CLOSE INDIVIDUALS CLOSE MODULE.         ***
      ***    . CRITERION FOR FETCH :                     ***
      ***        . END-DATE = PAYMENT DATE - 1           ***
      ***          (SET IN HOUSEKEEPING)                 ***
      ***    . FOR EACH SUCH R268 REC FETCHED , WRITE IT ***
      ***      TO ATE01D05 FILE AS TRANS TYPE 'I'.       ***
      ******************************************************
       2390-FUTURE-CLOSE-INDIVS.
           EXIT.

       2390-FETCH-FIRST-R268.   
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.
           MOVE 0                      TO WSS-R268-REC. 
           MOVE 0                      TO WSS-R268-EOS. 
           PERFORM 7460-FETCH-FUTURE-CLOSE-R268  THRU 7460-EXIT 
                   UNTIL WSS-R268-REC-ON OR 
                         WSS-R268-EOS-ON.   

       2390-PRO-ALL-FUTURE-CLOSE-IND.   
           PERFORM 2395-PRO-ALL-FUTURE-CLOSE-IND THRU 2395-EXIT 
                   UNTIL WSS-R268-EOS-ON.   

       2390-EXIT.   
           EXIT.

      ******************************************************
      *** THIS PARA IS A SUBROUTINE OF 2390-FUTURE-CLOSE ***
      *** AND IS A LOOP PROCESS.                         ***
      ***    . ONCE ENTERED, IT PERFORMS                 ***
      ***         . WRITE TO ATE01D05                    ***
      ***         . READS NEXT R268                      ***
      ***         . EXITS                                ***
      ******************************************************
       2395-PRO-ALL-FUTURE-CLOSE-IND.   
           PERFORM 8550-WRITE-ATE01D05-TRAN-I    THRU 8550-EXIT.

       2395-FETCH-NEXT-R268.
           MOVE 0                      TO WSS-R268-REC. 
           MOVE 0                      TO WSS-R268-EOS. 
           PERFORM 7460-FETCH-FUTURE-CLOSE-R268  THRU 7460-EXIT 
                   UNTIL WSS-R268-REC-ON OR 
                         WSS-R268-EOS-ON.   

       2395-EXIT.   
           EXIT.

R069   2400-SEARCH-TCAT  SECTION.   
R069   2400-FIND-MC-CATEGORY.   
R069       IF  TCAT-CDE-CATEGORY (MC-IDX)  =  WS-CATE   
R069           MOVE  'Y'  TO  WSS-TCAT-FOUND-SW 
R069           MOVE  TCAT-TCAT-PGM (MC-IDX)  TO  WS-TCAT-PGM.   
      *******************************************************   
      *** THIS SECTION DEFINES THE BUDGET CLOSING OP.     ***   
      *** IF THE BUDGET IS TO BE CLOSED SOMEWHERE         ***   
      *** IN THE FUTURE, NOT WITHIN SPECIFIED TIME LIMIT, ***   
      *** LEAVE IT ALONE.                                 ***   
      *** ELSE, WRITE A ATE01D05-BUDGET-TYPE RECORD,      ***   
      *** INDICATING ( TO ATE042D  ) THAT THIS            ***   
      *** BUDGET NEEDS TO BE CLOSED/UPDATED.              ***   
      ***                                                 ***   
      *** IF BUDGET IS GETTING CLOSED, A NEW R289 SHUD    ***   
      *** BE WRITTEN IN HISTORY AREA.                     ***   
      ***                                                 ***   
      *** IF IT IS GETTING PRORATED IN THIS TERM, ALSO    ***   
      *** PERFORM CLOSING OF THIS BUDGET.                 ***   
      *** PRO-RATION IS DONE ONLY IF THE BUDGET IS        ***   
      *** GETTING CLOSED BEFORE NEXT PAYMENT DATE - 1.    ***   
      ***                                                 ***   
R027  *** CLOSE SUSPENDED BUDGETS BACK TO SUSPEND-DATE.   ***   
R027  *** CLOSE DATE IS ALWAYS POSTED AS THE DAY BEFORE   ***   
R027  *** PAYMENT DAY AND THEREFORE CLOSE IT ON PYMT DAY. ***   
      *******************************************************   
       2500-CLOSING-SECTION SECTION.
       2500-CHECK-IF-CLOSED.
R064       MOVE  SPACES  TO  WS-CATE
R064                         WSS-TCAT-FOUND-SW  
R064                         WS-TCAT-PGM.   
R064       MOVE  R249-CDE-CATEGORY  TO  WS-CATE.
R064       PERFORM  2400-FIND-MC-CATEGORY  VARYING  MC-IDX  
R064           FROM  1  BY  1  UNTIL  MC-IDX  >  TCAT-OCCURS-COUNT  OR  
R064               TCAT-FOUND.  
R074       IF  R634-CDE-REASON-STUS  =  440 
R074           IF  R634-DTE-CLOSED-BDGT  <  WSH-RECUR-PAYDATE   
R074               MOVE  1  TO  WSS-BDGT-CLOSED-BEF-PERIOD  
R074               ADD  1  TO  WSA-R-LIN-CLOSES 
R074               MOVE  'Y'  TO  WSS-CLOSE-SW  
R074               PERFORM  8554-WRITE-ATE01D05-TRAN-B  THRU  8554-EXIT 
R074               GO  TO  2500-EXIT-SECTION.   
R050       IF (R249-CDE-CATEGORY = 'TA' OR 'TJ') AND
R050          R634-CDE-STUS-PROG = 68 AND   
R050          R634-DTE-CLOSED-BDGT < WSH-3-PAYDATE  
R050            MOVE 1                 TO WSS-BDGT-CLOSED-BEF-PERIOD
R050            PERFORM 8554-WRITE-ATE01D05-TRAN-B    THRU 8554-EXIT
R050       ELSE 
M307       IF R634-DTE-CLOSED-BDGT = WSH-RECUR-PAYDATE  
                MOVE 1                 TO WSS-BDGT-CLOSED-BEF-PERIOD
R025            IF WSS-BDGT-SUSPEND-ON  
M307               MOVE WSH-SUSPEND-DATE         TO R634-DTE-CLOSED-BDGT
R025               PERFORM 8554-WRITE-ATE01D05-TRAN-B    THRU 8554-EXIT 
                ELSE
                   PERFORM 8554-WRITE-ATE01D05-TRAN-B    THRU 8554-EXIT 
           ELSE 
M307       IF R634-DTE-CLOSED-BDGT < WSH-RECUR-PAYDATE  
R064           IF  (TCAT-TCAT-PGM (MC-IDX) NOT =  'M')  
R063                MOVE 'R634-CM-BUDGET-INFO'   TO WSH-RECORD-NAME 
R063                PERFORM 7100-FIND-CUR-IN-REC     THRU 7100-EXIT 
R063                MOVE WSH-RECUR-PAYDATE   TO R634-DTE-CLOSED-BDGT
R063                PERFORM 7328-MODIFY-R634         THRU 7328-EXIT 
R063                MOVE 1           TO WSS-BDGT-CLOSED-BEF-PERIOD  
R063                PERFORM 8554-WRITE-ATE01D05-TRAN-B THRU 8554-EXIT   
R063           ELSE 
R063               MOVE  1  TO  WSS-BDGT-CLOSED-BEF-PERIOD  
R063               PERFORM  8554-WRITE-ATE01D05-TRAN-B  THRU  8554-EXIT 
R063       ELSE 
           IF (WST-CAT-TYPE (WSI-CAT-IDX) = 2 OR 3) AND 
M307          R634-DTE-CLOSED-BDGT < WSH-3-PAYDATE  
                MOVE 1                 TO WSS-BDGT-CLOSED-BEF-PERIOD
                PERFORM 8554-WRITE-ATE01D05-TRAN-B    THRU 8554-EXIT
           ELSE 
M307       IF R634-DTE-CLOSED-BDGT   > WSH-RECUR-PAYDATE AND
M307                                 < WSH-2-PAYDATE
              MOVE 1                   TO WSS-BDGT-CLOSED-BEF-PERIOD
R025          IF WSS-BDGT-SUSPEND-ON
M307             MOVE WSH-SUSPEND-DATE           TO R634-DTE-CLOSED-BDGT
R025             PERFORM 8554-WRITE-ATE01D05-TRAN-B   THRU 8554-EXIT
R025          ELSE  
                MOVE 1                 TO WSS-BDGT-PRORATED-CLOSE   
R069               MOVE  R634-DTE-CLOSED-BDGT  TO  WSH-DTE-CLOSED-BDGT  
                PERFORM 8554-WRITE-ATE01D05-TRAN-B    THRU 8554-EXIT
R045            MOVE WSH-RECUR-YY      TO M2K-IN-YR 
R045            MOVE WSH-RECUR-DAYS    TO M2K-IN-DAYS   
R045            MOVE R634-DTE-CLOSED-BDGT TO M2K-CONV-JUL-DT
R045            PERFORM C010-SUBTRACT-JULIAN-M2K.   
R045            MOVE M2K-CONV-JUL-DT   TO WS-PRO-DAYS.  
       2500-EXIT-SECTION.   
           EXIT.

R027  *COMMENTED OUT 2600 SECTION AND PARAGRAPH FROM R025*  
R067   2600-CATCH-ALL  SECTION. 
R067   2610-GET-R637.   
R067       MOVE  0  TO  WSS-R637-REC
R067                    WSS-R653-REC
R067                    WSS-R654-REC.   
R067       MOVE  'N'  TO  WSS-R654-FOUND.   
R067       MOVE  2600    TO  WSH-ERR-PARA-NO.   
R067       PERFORM  7600-FETCH-R637  THRU  7600-EXIT.   
R067       IF  WSS-R637-REC  =  1   
R067           MOVE  2601    TO  WSH-ERR-PARA-NO
R067           PERFORM  7620-FETCH-R653  THRU  7620-EXIT.   
R067       MOVE  2602      TO  WSH-ERR-PARA-NO. 
R067       PERFORM  7311-FIND-CURR-R249  THRU  7311-EXIT.   
R067   2610-EXIT.    EXIT.  
R070   2620-PROCESS-AUTO-DISC.  
R070       MOVE  2620  TO  WSH-ERR-PARA-NO. 
R070       IF  R634-DTE-DUE-REDET  =  ZEROES
R070           GO  TO  2620-EXIT.   
R070       IF  R634-DTE-DUE-REDET  <  WSH-PRIOR-JUL 
R070           NEXT  SENTENCE   
R070       ELSE 
R070           GO  TO  2620-EXIT.   
R070       MOVE  'N'    TO  WSS-AUTO-FOUND. 
R070       MOVE  0      TO  WSS-AUTO-SS.
R070       PERFORM  2690-SETUP-SS  THRU  2690-EXIT  UNTIL   
R070           WSS-AUTO-FOUND  =  'Y'.  
R070       MOVE  0  TO  WSS-TARB.   
R070       ADD  1  TO  WSA-NBR-REDET.   
R070       ADD  1  TO  WST-AUTO-REDET (WSS-AUTO-SS).
R070       MOVE  'N'  TO  WSS-EXEMPT.   
R070       IF  R672-CDE-DIST  =  ' '
R070           MOVE  0  TO  R672-CDE-DIST.  
R070       PERFORM  2630-CHECK-TARB  THRU  2630-EXIT  UNTIL 
R070           WSS-TARB  >  WSS-TARB-LOAD.  
R070       IF  WSS-EXEMPT  =  'B'  OR  'R'  
R070           ADD  1  TO  WSA-EXEMPT   
R070           ADD  1  TO  WST-AUTO-EXEMPT (WSS-AUTO-SS)
R070           GO  TO  2620-EXIT.   
R070       IF  (R249-CDE-CATEGORY  =  'B  '  OR  'E  ')  OR 
R070           ((R249-CDE-CATEGORY  =  'PH ')  AND  
R070            (R634-CDE-STUS-PROG  =  20  OR  97))
R070           ADD  1  TO  WSA-BYPASS-PH
R070           ADD  1  TO  WST-AUTO-BYPASS (WSS-AUTO-SS)
R070           GO  TO  2620-EXIT.   
R070       MOVE  'N'  TO  WSS-EXCEPT.   
R070       PERFORM  2640-CALL-ASBRCE  THRU  2640-EXIT.  
R070       IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070           ADD  1  TO  WST-AUTO-EXCEPT (WSS-AUTO-SS)
R070           ADD  1  TO  WSA-TOT-EXCEPT.  
R070       IF  WSS-EXCEPT  =  'X'   
R070           PERFORM  2850-CREATE-MSG  THRU  2850-EXIT.   
R070       IF  CPF-PAYDAY-NBR  >  00  AND   
R070           CPF-PAYDAY-NBR  <  11
R070           PERFORM  2650-PROCESS-1-10  THRU  2650-EXIT. 
R070       IF  CPF-PAYDAY-NBR  >  10  AND   
R070           CPF-PAYDAY-NBR  <  21
R070           PERFORM  2660-PROCESS-11-20  THRU  2660-EXIT.
R070   2620-EXIT.    EXIT.  
R070   2630-CHECK-TARB. 
R070       ADD  1  TO  WSS-TARB.
R070       IF  WSS-TARB  >  WSS-TARB-LOAD   
R070           GO  TO  2630-EXIT.   
R070       IF  WST-TARB-CO (WSS-TARB)  =  WSH-CNTY-NBR  AND 
R070           WST-TARB-DIST (WSS-TARB)  =  R672-CDE-DIST   
R070           IF  ((WST-TARB-BEG-DTE (WSS-TARB)  = 
R070                  M2K-CPF-CYCLE-DATE-NUM  OR
R070                  WST-TARB-BEG-DTE (WSS-TARB)  <
R070                  M2K-CPF-CYCLE-DATE-NUM)  AND  
R070                ((WST-TARB-END-DTE (WSS-TARB)  =  ZEROES)  OR   
R070                 (WST-TARB-END-DTE (WSS-TARB)  =
R070                  M2K-CPF-CYCLE-DATE-NUM  OR
R070                  WST-TARB-END-DTE (WSS-TARB)  >
R070                  M2K-CPF-CYCLE-DATE-NUM))) 
R070               MOVE  WST-TARB-IND (WSS-TARB)  TO  WSS-EXEMPT
R070               MOVE  WSS-TARB-LOAD  TO  WSS-TARB.   
R070   2630-EXIT.    EXIT.  
R070   2640-CALL-ASBRCE.
R070       MOVE  2640  TO  WSH-ERR-PARA-NO. 
R070       MOVE  WSH-CASE-NUMBER  TO  ASBRCE-CASE.  
R070       MOVE  WSH-CDE-CATEGORY TO  ASBRCE-CAT.   
R070       MOVE  WSH-NBR-GROUP-GRANT  TO  ASBRCE-GG.
R070       MOVE  WSH-PAYMENT-DATE     TO  ASBRCE-CYCLE-DATE.
R070       MOVE  'REN'                TO  ASBRCE-TYPE.  
R070       MOVE  SPACE                TO  ASBRCE-EXCEPTION. 
R070       CALL  'ASBRCE'  USING  ASBRCE-PARAM. 
R070       MOVE  ASBRCE-EXCEPTION     TO  WSS-EXCEPT.   
R070       MOVE  ASBRCE-PARAM  TO  ATE01D20-RECORD. 
R070       WRITE  ATE01D20-RECORD.  
R070       ADD  1  TO  WSA-ATE01D20-REC-CNT.
R070       ADD  1  TO  WST-AUTO-CASES (WSS-AUTO-SS).
R070       PERFORM  7311-FIND-CURR-R249  THRU  7311-EXIT.   
R070   2640-EXIT.    EXIT.  
R070   2650-PROCESS-1-10.   
R070       MOVE  2650  TO  WSH-ERR-PARA-NO. 
R070       MOVE  WSH-CDE-CATEGORY    TO  WSH-PART-CAT.  
R070       IF  (WSH-CDE-CATEGORY  =  'A  '  OR  'B  '  OR  'C  '
R070           OR  'D  '  OR  'E  '  OR  'J  '  OR  'M  '  OR  'U  ')   
R070           IF  ((R634-CDE-STUS-BDGT  =  'S')  AND   
R070                (WSS-EXCEPT  =  'E'  OR  'X'))  
R070               ADD  1  TO  WSA-CASH-EXCEPTION   
R070               ADD  1  TO  WST-AUTO-CASH-EX (WSS-AUTO-SS)   
R070               GO  TO  2650-EXIT.   
R070       IF  (WSH-CDE-CATEGORY  =  'A  '  OR  'B  '  OR  'C  '  OR
R070           'D  '  OR  'E  '  OR  'J  '  OR  'M  '  OR  'U  ')   
R070           IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070               ADD  1  TO  WSA-CASH-EXCEPTION   
R070               ADD  1  TO  WST-AUTO-CASH-EX (WSS-AUTO-SS)   
R070               PERFORM  2700-CREATE-NOTICE-4471  THRU  2700-EXIT
R070               PERFORM  2710-CREATE-ALERT-074    THRU  2710-EXIT
R070               GO  TO  2650-EXIT
R070           ELSE 
R070               ADD  1  TO  WSA-CASH-NO-EXCEPTION
R070               ADD  1  TO  WST-AUTO-CASH-NO (WSS-AUTO-SS)   
R070               PERFORM  2700-CREATE-NOTICE-4471  THRU  2700-EXIT
R070               GO  TO  2650-EXIT.   
R070       IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070           ADD  1  TO  WSA-MA-EXCEPTION 
R070           ADD  1  TO  WST-AUTO-MA-EX (WSS-AUTO-SS) 
R070  *        PERFORM  2720-CREATE-ALERT-071  THRU  2720-EXIT  
R070           GO  TO  2650-EXIT.   
R070       IF  WSH-PART-CAT-3  =  'W'   
R070           ADD  1  TO  WSA-MA-NO-EXCEPTION  
R070           ADD  1  TO  WST-AUTO-MA-NO (WSS-AUTO-SS) 
R070           PERFORM  2730-CREATE-NOTICE-442C  THRU  2730-EXIT
R070       ELSE 
R070           IF  WSH-PART-CAT-3  =  'N'   
R070               ADD  1  TO  WSA-MA-NO-EXCEPTION  
R070               ADD  1  TO  WST-AUTO-MA-NO (WSS-AUTO-SS) 
R070               PERFORM  2740-CREATE-NOTICE-442B  THRU  2740-EXIT
R070           ELSE 
R070               ADD  1  TO  WSA-MA-NO-EXCEPTION  
R070               ADD  1  TO  WST-AUTO-MA-NO (WSS-AUTO-SS) 
R070               PERFORM  2750-CREATE-NOTICE-442A  THRU  2750-EXIT.   
R070   2650-EXIT.    EXIT.  
R070   2660-PROCESS-11-20.  
R070       MOVE  2660  TO  WSH-ERR-PARA-NO. 
R070       IF  (WSH-CDE-CATEGORY  =  'A  '  OR  'B  '  OR  'C  '
R070           OR  'D  '  OR  'E  '  OR  'J  '  OR  'M  '  OR  'U  ')   
R070           IF  ((R634-CDE-STUS-BDGT  =  'S')  AND   
R070                (WSS-EXCEPT  =  'E'  OR  'X'))  
R070               ADD  1  TO  WSA-CASH-EXCEPTION   
R070               ADD  1  TO  WST-AUTO-CASH-EX (WSS-AUTO-SS)   
R070               GO  TO  2660-EXIT.   
R070       IF  (WSH-CDE-CATEGORY  =  'A  '  OR  'B  '  OR  'C  '  OR
R070            'D  '  OR  'E  '  OR  'J  '  OR  'M  '  OR  'U  ')  
R070           IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070               PERFORM  2760-SUSPEND-450  THRU  2760-EXIT   
R070               GO  TO  2660-EXIT
R070           ELSE 
R070               PERFORM  2770-CLOSE-447  THRU  2770-EXIT 
R070               GO  TO  2660-EXIT.   
R070       IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070           ADD  1  TO  WSA-NO-ACTION
R070           ADD  1  TO  WST-AUTO-NO-ACTN (WSS-AUTO-SS)   
R070           GO  TO  2660-EXIT.   
R070       PERFORM  2780-CLOSE-442  THRU  2780-EXIT.
R070   2660-EXIT.    EXIT.  
R070   2670-MODIFY-R249.
R070       MOVE  0  TO  WSS-R249-SS.
R070       PERFORM  2680-MOD-R249  THRU  2680-EXIT  UNTIL   
R070           WSS-R249-SS  >  WSS-R249-LD. 
R070   2670-EXIT.    EXIT.  
R070   2680-MOD-R249.   
R070       MOVE  2680  TO  WSH-ERR-PARA-NO. 
R070       ADD  1  TO  WSS-R249-SS. 
R070       IF  WSS-R249-SS  >  WSS-R249-LD  
R070           GO  TO  2680-EXIT.   
R070       MOVE  'R249-CASH-MEDICAL-BUDGET'  TO  WSH-RECORD-NAME.   
R070       MOVE  WST-R249-DBK (WSS-R249-SS)  TO  WSH-FET-DBK.   
R070       PERFORM  7110-FETCH-REC-ON-KEY  THRU  7110-EXIT. 
R070       MOVE  WST-R249-REC (WSS-R249-SS)  TO 
R070               R249-CASH-MEDICAL-BUDGET.
R078             MOVE 'R249' TO D18-REC-CDE 
R070       PERFORM  7120-MODIFY-GEN-DB-REC  THRU  7120-EXIT.
R070   2680-EXIT.    EXIT.  
R070   2690-SETUP-SS.   
R070       ADD  1  TO  WSS-AUTO-SS. 
R070       IF  WST-AUTO-CNTY (WSS-AUTO-SS)  =  ZEROES   
R070           MOVE  WSH-CNTY-NBR  TO  WST-AUTO-CNTY (WSS-AUTO-SS)  
R070           MOVE  R672-CDE-DIST TO  WST-AUTO-DIST (WSS-AUTO-SS)  
R070           ADD  1  TO  WSS-AUTO-LOAD
R070           MOVE  'Y'    TO  WSS-AUTO-FOUND  
R070           GO  TO  2690-EXIT.   
R070       IF  WSH-CNTY-NBR  =  WST-AUTO-CNTY (WSS-AUTO-SS)  AND
R070           R672-CDE-DIST =  WST-AUTO-DIST (WSS-AUTO-SS) 
R070           MOVE  'Y'  TO  WSS-AUTO-FOUND.   
R070   2690-EXIT.    EXIT.  
R070   2700-CREATE-NOTICE-4471. 
R070       MOVE  2700  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  SPACES    TO  ATE01D11-RECORD. 
R070       MOVE  447       TO  D11-CDE-RSN-NOTICE.  
R070       IF  WSS-EXCEPT  =  'E'  OR  'X'  
R070           MOVE  450  TO  WSH-CDE-REASON-STUS   
R070       ELSE 
R070           MOVE  447    TO  WSH-CDE-REASON-STUS.
R070       MOVE  1         TO  D11-CDE-OPTION-NOTICE.   
R070       MOVE  'D'       TO  D11-CDE-TYPE-NOTICE. 
R070       PERFORM  2800-NOTICE-MOVE-UPDATE  THRU  2800-EXIT.   
R070       IF  R634-IND-CC-IMDT  =  'Y' 
R070           PERFORM  2840-CREATE-717-NOTICE  THRU  2840-EXIT.
R070   2700-EXIT.    EXIT.  
R070   2710-CREATE-ALERT-074.   
R070       MOVE  SPACES        TO  ATE01D10-RECORD. 
R070       MOVE  074           TO  NBR-ALERT.   
R070       PERFORM  2810-ALERT-MOVE    THRU  2810-EXIT. 
R070   2710-EXIT.    EXIT.  
R070   2720-CREATE-ALERT-071.   
R070       MOVE  SPACES        TO  ATE01D10-RECORD. 
R070       MOVE  071           TO  NBR-ALERT.   
R070       PERFORM  2810-ALERT-MOVE    THRU  2810-EXIT. 
R070   2720-EXIT.    EXIT.  
R070   2730-CREATE-NOTICE-442C. 
R070       MOVE  2730  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  SPACES         TO  ATE01D11-RECORD.
R070       MOVE  442            TO  D11-CDE-RSN-NOTICE. 
R070       MOVE  442    TO  WSH-CDE-REASON-STUS.
R070       MOVE  'C'            TO  D11-CDE-OPTION-NOTICE.  
R070       MOVE  'D'            TO  D11-CDE-TYPE-NOTICE.
R070       PERFORM  2800-NOTICE-MOVE-UPDATE  THRU  2800-EXIT.   
R070   2730-EXIT.    EXIT.  
R070   2740-CREATE-NOTICE-442B. 
R070       MOVE  2740  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  SPACES         TO  ATE01D11-RECORD.
R070       MOVE  442            TO  D11-CDE-RSN-NOTICE. 
R070       MOVE  442    TO  WSH-CDE-REASON-STUS.
R070       MOVE  'B'            TO  D11-CDE-OPTION-NOTICE.  
R070       MOVE  'D'            TO  D11-CDE-TYPE-NOTICE.
R070       PERFORM  2800-NOTICE-MOVE-UPDATE  THRU  2800-EXIT.   
R070   2740-EXIT.    EXIT.  
R070   2750-CREATE-NOTICE-442A. 
R070       MOVE  2750  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  SPACES         TO  ATE01D11-RECORD.
R070       MOVE  442            TO  D11-CDE-RSN-NOTICE. 
R070       MOVE  442    TO  WSH-CDE-REASON-STUS.
R070       MOVE  'A'            TO  D11-CDE-OPTION-NOTICE.  
R070       MOVE  'D'            TO  D11-CDE-TYPE-NOTICE.
R070       PERFORM  2800-NOTICE-MOVE-UPDATE  THRU  2800-EXIT.   
R070   2750-EXIT.    EXIT.  
R070   2760-SUSPEND-450.
R070       MOVE 'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.   
R070       MOVE  2760    TO  WSH-ERR-PARA-NO.   
R070  *    IF  R634-CDE-RSN-NOTICE  =  442  OR  447 
R070  *        NEXT  SENTENCE   
R070  *    ELSE 
R070  *        PERFORM  2830-ASB-MSG-253  THRU  2830-EXIT   
R070  *        GO  TO  2760-EXIT.   
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  WSH-RECUR-PAYDATE    TO  R634-DTE-END-EFFV.
R070       MOVE  WSH-CPF-CYCLE-JUL    TO  R634-DTE-CHNG 
R070                                      R634-DTE-CHANGE-HIPAA.
R070       MOVE  WSH-SYS-TIME-SEC     TO  R634-TME-ACTN.
R070       PERFORM  7328-MODIFY-R634  THRU  7328-EXIT.  
R070       PERFORM  7311-FIND-CURR-R249  THRU  7311-EXIT.   
R070       ADD  1  TO  WSS-R249-SS  
R070                   WSS-R249-LD. 
R070       MOVE  CURRENCY STATUS FOR RUN-UNIT  TO   
R070               WST-R249-DBK (WSS-R249-SS).  
R070       MOVE  'S'    TO  R249-CDE-STUS-BUDGET
R070                        R634-CDE-ACTN-BDGT  
R070                        R634-CDE-STUS-BDGT. 
R070       MOVE  R249-CASH-MEDICAL-BUDGET  TO   
R070               WST-R249-REC (WSS-R249-SS).  
R070       MOVE  450    TO  R634-CDE-REASON-STUS.   
R070       MOVE  447    TO  R634-CDE-RSN-NOTICE.
R070       MOVE    1    TO  R634-CDE-OPTION-NOTICE. 
R070       MOVE  ZEROES    TO  R634-DTE-END-EFFV.   
R070       MOVE  WSH-PAYMENT-DATE    TO  R634-DTE-BGN-EFFV. 
R070       MOVE  SPACE  TO  R634-IND-MA-AUTO.   
R070       PERFORM  7330-STORE-R634  THRU  7330-EXIT.   
R070       MOVE  0    TO  WSS-R268-EOS. 
R070       PERFORM  2820-BUILD-ATE01D14  THRU  2820-EXIT  UNTIL 
R070               WSS-R268-EOS  =  1.  
R070       PERFORM  2870-CREATE-R251  THRU  2870-EXIT.  
R070       ADD  1  TO  WSA-SUSPEND. 
R070       ADD  1  TO  WST-AUTO-SUSPEND (WSS-AUTO-SS).  
R070       ADD  1  TO  WST-AUTO-CASH-EX (WSS-AUTO-SS).  
R070       ADD  1  TO  WSA-CASH-EXCEPTION.  
R070       PERFORM  2860-CREATE-D16  THRU  2860-EXIT.   
R070   2760-EXIT.    EXIT.  
R070   2770-CLOSE-447.  
R070       MOVE  2770  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070  *    IF  R634-CDE-RSN-NOTICE  =  442  OR  447 
R070  *        NEXT  SENTENCE   
R070  *    ELSE 
R070  *        PERFORM  2830-ASB-MSG-253  THRU  2830-EXIT   
R070  *        GO  TO  2770-EXIT.   
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  447    TO  R634-CDE-REASON-STUS.   
R070       MOVE  WSH-RECUR-PAYDATE        TO  R634-DTE-CLOSED-BDGT. 
R070       MOVE  SPACE    TO  R634-IND-MA-AUTO. 
R070       PERFORM  7328-MODIFY-R634  THRU  7328-EXIT.  
R070       PERFORM  8554-WRITE-ATE01D05-TRAN-B  THRU  8554-EXIT.
R070       ADD  1  TO  WSA-CLOSED.  
R070       ADD  1  TO  WST-AUTO-CLOSED (WSS-AUTO-SS).   
R070       MOVE  'Y'  TO  WSS-CLOSE-SW. 
R070   2770-EXIT.    EXIT.  
R070   2780-CLOSE-442.  
R070       MOVE  2780  TO  WSH-ERR-PARA-NO. 
R070       MOVE  'R634-CM-BUDGET-INFO'    TO  WSH-RECORD-NAME.  
R070  *    IF  R634-CDE-RSN-NOTICE  =  442  OR  447 
R070  *        NEXT  SENTENCE   
R070  *    ELSE 
R070  *        PERFORM  2830-ASB-MSG-253  THRU  2830-EXIT   
R070  *        GO  TO  2780-EXIT.   
R070       PERFORM  7100-FIND-CUR-IN-REC  THRU  7100-EXIT.  
R070       MOVE  442    TO  R634-CDE-REASON-STUS.   
R070       MOVE  442    TO  R634-CDE-RSN-NOTICE.
R070       MOVE  SPACE  TO  R634-IND-MA-AUTO.   
R070       MOVE  WSH-END-PAY-DATE    TO  R634-DTE-CLOSED-BDGT.  
R070       PERFORM  7328-MODIFY-R634  THRU  7328-EXIT.  
R070       PERFORM  8554-WRITE-ATE01D05-TRAN-B  THRU  8554-EXIT.
R070       ADD  1  TO  WSA-CLOSED.  
R070       ADD  1  TO  WST-AUTO-CLOSED (WSS-AUTO-SS).   
R070       MOVE  'Y'  TO  WSS-CLOSE-SW. 
R070   2780-EXIT.    EXIT.  
R070   2800-NOTICE-MOVE-UPDATE. 
R070       MOVE  2800    TO  WSH-ERR-PARA-NO.   
R070       MOVE  WSH-RECUR-PAYDATE    TO  R634-DTE-END-EFFV.
R070       MOVE  WSH-CPF-CYCLE-JUL    TO  R634-DTE-CHNG 
R070                                      R634-DTE-CHANGE-HIPAA.
R070       MOVE  WSH-SYS-TIME-SEC     TO  R634-TME-ACTN.
R070       PERFORM  7328-MODIFY-R634  THRU  7328-EXIT.  
R070       PERFORM  7311-FIND-CURR-R249  THRU  7311-EXIT.   
R070       MOVE  WSH-CNTY-NBR         TO  D11-CDE-COUNTY.   
R070       MOVE  WSH-CASE-NBR         TO  D11-NBR-RECORD.   
R070       MOVE  WSH-CDE-CATEGORY     TO  D11-CDE-CATEGORY. 
R070       MOVE  WSH-NBR-GROUP-GRANT  TO  D11-NBR-GG.   
R070       MOVE  M2K-CPF-CYCLE-DATE-NUM  TO  D11-FROM-DATE. 
R070       MOVE  ZEROES               TO  D11-TO-DATE.  
R081       MOVE  ZEROES  TO  SDX-AMOUNT 
R081                         FROM-AMOUNT
R081                         TO-AMOUNT  
R081                         660-3-RCPT.
R081       MOVE  SPACES  TO  POP-BUCKET 
R081                         MNGD-CARE-PLAN-CDE.
R070       MOVE  WSH-PAYMENT-DATE     TO  R634-DTE-BGN-EFFV.
R070       MOVE  D11-CDE-RSN-NOTICE    TO  R634-CDE-RSN-NOTICE. 
R070       MOVE  WSH-CDE-REASON-STUS  TO  R634-CDE-REASON-STUS. 
R070       MOVE  D11-CDE-TYPE-NOTICE  TO  R634-CDE-TYPE-NOTICE. 
R070       MOVE  D11-CDE-OPTION-NOTICE  TO  R634-CDE-OPTION-NOTICE. 
R070       MOVE  'C'                    TO  R634-CDE-STUS-NOTICE.   
R070       MOVE  'Y'                    TO  R634-CDE-DISTN-MAIL.
R070       MOVE  'F'                    TO  R634-CDE-ACTN-BDGT. 
R070       MOVE  ZEROES                 TO  R634-DTE-END-EFFV.  
R070       MOVE  SPACE  TO  R634-IND-MA-AUTO.   
R070       PERFORM  7330-STORE-R634  THRU  7330-EXIT.   
R070       PERFORM  8594-WRITE-ATE01D11  THRU  8594-EXIT.   
R070   2800-EXIT.    EXIT.  
R070   2810-ALERT-MOVE. 
R070       MOVE  WSH-CNTY-NBR       TO  CDE-COUNTY. 
R070       MOVE  R672-CDE-DIST      TO  CDE-DIST.   
R070       MOVE  R672-NBR-CSLD      TO  NBR-CSLD.   
R070       ACCEPT  HOLD-ALERT-DATE  FROM  DAY  YYYYDDD. 
R070       MOVE  HOLD-ALERT-DATE    TO  DTE-ALERT   
R070                                    DTE-CHANGE-LAST 
R070                                    DTE-DUE-ALERT.  
R070       IF  NBR-ALERT  =  074
R070           MOVE  'SUSP'  TO  CDE-TYPE-ALERT 
R070       ELSE 
R070           MOVE  'BUAC'             TO  CDE-TYPE-ALERT. 
R070       ACCEPT  WS-SYSTEM-TIME  FROM  TIME.  
R070       MOVE  WS-SYSTEM-HHMMSS   TO  TME-ALERT   
R070                                    TME-CHANGE-LAST.
R070       MOVE  'S'                TO  CDE-MODE-DISPN. 
R070       MOVE  ZEROES             TO  DTE-DISPN-ALERT 
R070                                    NBR-OPTR-DSPO   
R070                                    NBR-IMW-DSPO
R070                                    CDE-COUNTY-SENDING  
R070                                    CDE-DIST-SENDING
R070                                    NBR-IMW-SENDING 
R070                                    CNT-LINES-ADDNL.
R070       MOVE  WSH-CASE-NBR       TO  NBR-RECORD. 
R070       MOVE  WSH-CDE-CATEGORY  TO  CDE-CATEGORY OF ATE01D10-RECORD. 
R070       MOVE  WSH-NBR-GROUP-GRANT  TO  NBR-GROUP-GRANT.  
R070       MOVE  R634-CDE-STUS-PROG   TO  CDE-STATUS-PROGRAM.   
R070       MOVE  R248-NAM-PMT         TO  NAM-CASE. 
R070       MOVE  ZEROES               TO  NBR-LINE-INDIV
R070                                      NBR-INDIV.
R070       PERFORM  8592-WRITE-ATE01D10  THRU  8592-EXIT.   
R070   2810-EXIT.    EXIT.  
R070   2820-BUILD-ATE01D14. 
R070       MOVE  2820  TO  WSH-ERR-PARA-NO. 
R070       PERFORM  7450-FETCH-R268  THRU  7450-EXIT.   
R070       IF  WSS-R268-EOS  =  1   
R070           GO  TO  2820-EXIT.   
R070       MOVE  SPACES           TO  ATE01D14-RECORD.  
R070       MOVE  R268-NBR-INDIV   TO  ATE02D05-RCPT-NBR.
R070       MOVE  WSH-CNTY-NBR     TO  ATE02D05-CNTY-NBR.
R070       MOVE  WSH-CASE-NBR     TO  ATE02D05-REC-NBR. 
R070       MOVE  WSH-CDE-CATEGORY    TO  ATE02D05-CATEGORY. 
R070       MOVE  WSH-NBR-GROUP-GRANT  TO  ATE02D05-GRANT-GROUP. 
R070       MOVE  R634-CDE-STUS-PROG   TO  ATE02D05-OLD-PROG-STAT
R070                                      ATE02D05-NEW-PROG-STAT.   
R070       MOVE  WS-SYSTEM-HHMMSS     TO  ATE02D05-TIME-ACTN.   
R070       MOVE  WSH-PAYMENT-DATE     TO  ATE02D05-MPD-DATE.
R070       MOVE  WSH-CPF-CYCLE-JUL    TO  ATE02D05-DTE-CHNG.
R070       MOVE  'S'                  TO  ATE02D05-CDE-STUS.
R070       PERFORM  8602-WRITE-ATE01D14  THRU  8602-EXIT.   
R070   2820-EXIT.    EXIT.  
R070   2830-ASB-MSG-253.
R070       MOVE  'F'    TO  WS-SML-MESSAGE-CAT. 
R070       MOVE  253    TO  WS-SML-MESSAGE-CODE.
R070       MOVE  WSH-CASE-NUMBER  TO  WS-SML-PARM-2-X-2.
R070       PERFORM  1810-DISPLAY-MSG.   
R070   2830-EXIT.    EXIT.  
R070   2840-CREATE-717-NOTICE.  
R070       MOVE  717    TO  D11-CDE-RSN-NOTICE. 
R070       MOVE    1    TO  D11-CDE-OPTION-NOTICE.  
R070       MOVE  'D'    TO  D11-CDE-TYPE-NOTICE.
R070       MOVE  WSH-CNTY-NBR  TO  D11-CDE-COUNTY.  
R070       MOVE  WSH-CASE-NBR  TO  D11-NBR-RECORD.  
R070       MOVE  WSH-CDE-CATEGORY  TO  D11-CDE-CATEGORY.
R070       MOVE  WSH-NBR-GROUP-GRANT  TO  D11-NBR-GG.   
R070       MOVE  R634-DTE-OPENED-BDGT  TO  M2K-JULIAN-DATE. 
R070       PERFORM  6510-JUL-TO-GRG.
R070       MOVE  M2K-GREGORIAN-DATE  TO  D11-FROM-DATE. 
R070       MOVE  WSH-2ND-MINUS-1-GREG  TO  D11-TO-DATE. 
R081       MOVE  ZEROES  TO  SDX-AMOUNT 
R081                         FROM-AMOUNT
R081                         TO-AMOUNT  
R081                         660-3-RCPT.
R081       MOVE  SPACES  TO  POP-BUCKET 
R081                         MNGD-CARE-PLAN-CDE.
R070       PERFORM  8594-WRITE-ATE01D11  THRU  8594-EXIT.   
R070   2840-EXIT.    EXIT.  
R081   2845-CREATE-976-NOTICE.  
R081       MOVE  976    TO  D11-CDE-RSN-NOTICE. 
R081       MOVE    3    TO  D11-CDE-OPTION-NOTICE.  
R081       MOVE  'D'    TO  D11-CDE-TYPE-NOTICE.
R081       MOVE  WSH-CNTY-NBR  TO  D11-CDE-COUNTY.  
R081       MOVE  WSH-CASE-NBR  TO  D11-NBR-RECORD.  
R081       MOVE  WSH-CDE-CATEGORY  TO  D11-CDE-CATEGORY.
R081       MOVE  WSH-NBR-GROUP-GRANT  TO  D11-NBR-GG.   
R081       MOVE  R634-DTE-OPENED-BDGT  TO  M2K-JULIAN-DATE. 
R081       PERFORM  6510-JUL-TO-GRG.
R081       MOVE  M2K-GREGORIAN-DATE  TO  D11-FROM-DATE. 
R081       MOVE  R634-DTE-CLOSED-BDGT  TO  M2K-JULIAN-DATE. 
R081       PERFORM  6510-JUL-TO-GRG.
R081       MOVE  M2K-GREGORIAN-DATE  TO  D11-TO-DATE.   
R081       MOVE  ZEROES  TO  SDX-AMOUNT 
R081                         FROM-AMOUNT
R081                         TO-AMOUNT  
R081                         660-3-RCPT.
R081       MOVE  SPACES  TO  POP-BUCKET 
R081                         MNGD-CARE-PLAN-CDE.
R081       PERFORM  8594-WRITE-ATE01D11  THRU  8594-EXIT.   
R081   2845-EXIT.    EXIT.  
R070   2850-CREATE-MSG. 
R070       MOVE  'W'   TO  WS-SML-MESSAGE-CAT.  
R070       MOVE  005   TO  WS-SML-MESSAGE-CODE. 
R070       MOVE  WSH-CASE-NUMBER  TO  WS-SML-PARAM-1.   
R070       MOVE  WSS-EXEMPT       TO  WS-SML-PARAM-2.   
R070       PERFORM  1810-DISPLAY-MSG.   
R070   2850-EXIT.    EXIT.  
R070   2860-CREATE-D16. 
R070       PERFORM  7450-FETCH-R268  THRU  7450-EXIT.   
R070       IF  WSS-R268-EOS  =  1   
R070           MOVE  011    TO  WS-SML-MESSAGE-CODE 
R070           MOVE  'W'    TO  WS-SML-MESSAGE-CAT  
R070           MOVE  WSH-CASE-NUMBER    TO  WS-SML-PARM-2-X-1   
R070           MOVE  'R268'             TO  WS-SML-PARAM-1  
R070           PERFORM  1810-DISPLAY-MSG
R070           GO  TO  2860-EXIT.   
R070       MOVE  R268-NBR-INDIV            TO ATE01D16-RECIPIENT.   
R070       MOVE  WSH-CASE-NUMBER       TO ATE01D16-NBR-CASE.
R070       MOVE  WSH-CDE-CATEGORY      TO ATE01D16-CDE-CAT. 
R070       MOVE  WSH-NBR-GROUP-GRANT   TO ATE01D16-NBR-GG.  
R070       MOVE R249-CTL-DIGIT         TO ATE01D16-CTL-DIGIT.   
R070       MOVE 'ARDSPD'               TO ATE01D16-NBR-TRANS.   
R070       MOVE WSH-CPF-CYCLE-JUL      TO ATE01D16-DTE-BGN-EFFV.
R070       MOVE ZEROS                  TO ATE01D16-DTE-END-EFFV.
R070       MOVE WSH-CPF-CYCLE-JUL      TO ATE01D16-DTE-CHNG.
R070       ACCEPT WS-SYSTEM-TIME       FROM TIME.   
R070       MOVE WS-SYSTEM-TIME         TO ATE01D16-TIME-ACTN.   
R070
R070       PERFORM 8606-WRITE-ATE01D16 THRU 8606-EXIT.  
R070   2860-EXIT.    EXIT.  
R070   2870-CREATE-R251.
R070       MOVE  SPACES  TO  R251-SUSPENSION.   
R070       MOVE  00      TO  R251-NBR-ORDER.
R070       MOVE  WSH-PAYMENT-DATE  TO  R251-DTE-BGN-EFFV
R070                                   R251-DTE-INACT-SPNSN.
R070       MOVE  ZEROES  TO  R251-DTE-END-EFFV. 
R070       MOVE  WSH-CPF-CYCLE-JUL  TO  R251-DTE-CHNG.  
R070       MOVE  WSH-SYS-TIME-SEC   TO  R251-TME-ACTN.  
R070       MOVE  SPACE              TO  R251-CDE-PRCS.  
R070       MOVE  450                TO  R251-CDE-REASON-SPNSN.  
R070       PERFORM  7572-STORE-R251  THRU  7572-EXIT.   
R070   2870-EXIT.    EXIT.  


      ****************************************************  
      *** CLOSING SECTION.                             ***  
      *** THIS SECTION WUD PERFORM ALL WINDUP OPS.     ***  
      *** MAJOR FUNCTIONS PERFORMED ARE :              ***  
      ***      . UPDATE BCF WITH ALL GROSS/BLOCK REC   ***  
      ***          COUNTS OF ALL OUTPUT FILES.         ***  
      ***      . WRITE ISSUANNCE CONTROL FILE D06.     ***  
      ***      . PRINT SUMMARY REPORT.                 ***  
      ****************************************************  
       3000-CLOSING  SECTION.   
       3000-CLOSING-DETAIL. 
           MOVE 3000                   TO WSH-ERR-PARA-NO.  
           DISPLAY '*****************************'   UPON PRINTER.  
R048       DISPLAY '* R653 END DATE ' WSA-R653-END-DTE-CNT UPON PRINTER.
           DISPLAY '*****************************'   UPON PRINTER.  
R067       DISPLAY 'CAT/PROG STAT DROP = '  WSA-CAT-PSC-DROP
R067                                      UPON PRINTER. 
R070       DISPLAY '***************************'  UPON  PRINTER.
R070       DISPLAY '* AUTOMATED DISCONTINUANCE *' UPON PRINTER. 
R070       DISPLAY '***************************'  UPON  PRINTER.
R070       DISPLAY '*  CASH EXCEPTION    = '  WSA-CASH-EXCEPTION ' *'   
R070           UPON PRINTER.
R070       DISPLAY '*  CASH NO EXCEPTION = ' WSA-CASH-NO-EXCEPTION ' *' 
R070               UPON  PRINTER.   
R070       DISPLAY '*  MA EXCEPTION      = ' WSA-MA-EXCEPTION ' *'  
R070           UPON PRINTER.
R070       DISPLAY '*  MA NO EXCEPTION   = ' WSA-MA-NO-EXCEPTION ' *'   
R070           UPON PRINTER.
R070       DISPLAY '*  EXEMPT            = '  WSA-EXEMPT ' *'   
R070           UPON PRINTER.
R070       DISPLAY '*  SUSPENDS          = ' WSA-SUSPEND ' *'   
R070           UPON PRINTER.
R070       DISPLAY '*  CLOSED            = '   WSA-CLOSED  ' *' 
R070           UPON PRINTER.
R070       DISPLAY '*  NO ACTION         = '  WSA-NO-ACTION ' *'
R070           UPON PRINTER.
R070       DISPLAY '*  BYPASS PH         = '  WSA-BYPASS-PH ' *'
R070           UPON PRINTER.
R070       DISPLAY '*  TOTAL REDET       = '  WSA-NBR-REDET ' *'
R070           UPON PRINTER.
R070       DISPLAY '*  TOTAL CASES       = '  WSA-R666-REC-CNT ' *' 
R070           UPON PRINTER.
R075A      DISPLAY '******* MA Recidivism *************' UPON PRINTER.  
R075A      DISPLAY 'TOTAL NO OF MG99 CLOSURE :'  WS-MG99-CLOSURE
R075A         UPON PRINTER. 
R075A      DISPLAY 'TOTAL NO OF MG99 RENEWAL :'  WS-MG99-AUTO-RENEW 
R075A         UPON PRINTER. 
R075A      DISPLAY '***********************************' UPON PRINTER.  
R070       MOVE  ZEROES   TO  WSA-PCT-EXCEPT
R070                          WSA-PCT-CLOSE 
R070                          WSA-PCT-SUSPEND.  
R070       IF  WSA-ATE01D20-REC-CNT  >  0  AND  
R070           WSA-TOT-EXCEPT        >  0  AND  
R070           WSH-TOT-PCT           >  0   
R070           COMPUTE  WSA-PCT-EXCEPT  =  WSA-TOT-EXCEPT  /
R070               WSA-ATE01D20-REC-CNT  *  100.
R070       IF  WSA-ATE01D20-REC-CNT  >  0  AND  
R070           WSA-CLOSED            >  0  AND  
R070           WSH-CLS-PCT           >  0   
R070           COMPUTE  WSA-PCT-CLOSE   =  WSA-CLOSED      /
R070               WSA-ATE01D20-REC-CNT  *  100.
R070       IF  WSA-ATE01D20-REC-CNT  >  0  AND  
R070           WSA-SUSPEND           >  0  AND  
R070           WSH-SUS-PCT           >  0   
R070           COMPUTE  WSA-PCT-SUSPEND  =  WSA-SUSPEND     /   
R070               WSA-ATE01D20-REC-CNT  *  100.
R070       IF  WSH-TOT-PCT  >  ZERO 
R070           IF  WSA-PCT-EXCEPT  >  WSH-TOT-PCT   
R070               SET  SW-ERROR-AFTER-GOOD-DEPART  ON  
R070               MOVE  'W'     TO  WS-SML-MESSAGE-CAT 
R070               MOVE  250     TO  WS-SML-MESSAGE-CODE
R070               MOVE  WSA-PCT-EXCEPT  TO  WS-SML-PARM-2-X-1  
R070               PERFORM  1810-DISPLAY-MSG.   
R070       IF  WSH-CLS-PCT    >  ZERO   
R070           IF  WSA-PCT-CLOSE   >  WSH-CLS-PCT   
R070               SET  SW-ERROR-AFTER-GOOD-DEPART  ON  
R070               MOVE  'W'     TO  WS-SML-MESSAGE-CAT 
R070               MOVE  251     TO  WS-SML-MESSAGE-CODE
R070               MOVE  WSA-PCT-CLOSE   TO  WS-SML-PARM-2-X-1  
R070               PERFORM  1810-DISPLAY-MSG.   
R070       IF  WSH-SUS-PCT      >  ZERO 
R070           IF  WSA-PCT-SUSPEND  >  WSH-SUS-PCT  
R070               SET  SW-ERROR-AFTER-GOOD-DEPART  ON  
R070               MOVE  'W'     TO  WS-SML-MESSAGE-CAT 
R070               MOVE  252     TO  WS-SML-MESSAGE-CODE
R070               MOVE  WSA-PCT-SUSPEND  TO  WS-SML-PARM-2-X-1 
R070               PERFORM  1810-DISPLAY-MSG.   
R056       DISPLAY '*****************************'   UPON PRINTER.  
R056       DISPLAY '* INFORMATIVE CISMOE COUNTS .'   UPON PRINTER.  
R056       DISPLAY '* CISMOE CALL ' WSA-CISMOE-CALL-CNT UPON PRINTER.   
R056       DISPLAY '* CISMOE X    ' WSA-CISMOE-X-CNT    UPON PRINTER.   
R056       DISPLAY '* CISMOE YES  ' WSA-CISMOE-Y-CNT    UPON PRINTER.   
R056       DISPLAY '* CISMOE NO   ' WSA-CISMOE-N-CNT    UPON PRINTER.   
R056       DISPLAY '*****************************'   UPON PRINTER.  
R056       DISPLAY '*CISMOE ERROR ' WSA-CISMOE-ERROR-CNT UPON PRINTER.  
R056       DISPLAY '*****************************'   UPON PRINTER.  
R067       IF  WSA-CAT-PSC-DROP  >  0   
R067           MOVE  'W'  TO  WS-SML-MESSAGE-CAT
R067           MOVE  242  TO  WS-SML-MESSAGE-CODE   
R067           MOVE  WSA-CAT-PSC-DROP  TO  WS-SML-PARAM-1   
R067           PERFORM  1810-DISPLAY-MSG  THRU  1810-EXIT.  

       3000-CLOSING-CONTROL.
           PERFORM 7050-DB-DEPART                THRU 7050-EXIT.
           PERFORM 3040-CHECK-IF-REWRITE-20D01   THRU 3040-EXIT.
R069A *    PERFORM 8560-WRITE-ATE01D06           THRU 8560-EXIT.
           PERFORM 3050-WRITE-OUTPUT-CNTS        THRU 3050-EXIT.
           PERFORM 4000-SUMMARY-REPORT-SECTION. 
           PERFORM 1850-CLOSE-FILES              THRU 1850-EXIT.
           PERFORM 1840-FINAL-MSG                THRU 1840-EXIT.

       3999-STOP-RUN.   
           STOP RUN.

       3999-EXIT.   
           EXIT.


      *******************************************************   
      *** SUBROUTINES OF 3000-CLOSING SECTION.            ***   
      *** INDIVIDUAL PARA MODULES ARE INVOKED.            ***   
      *******************************************************   
       3040-SUBS-OF-3000-SECTION SECTION.   

      ********************************************************  
      *** CHECK IF ATE20D01 IS TO BE REWRITTEN.            ***  
      *** THIS FILE WILL BE UPDATED ONLY IF IT WAS A       ***  
      *** DOUBLE PAYDAY UNDER FOLLOWING LOGIC :            ***  
      *** START OF 1ST PASS. PROGRAM-IND HAS BEEN SET TO 0.***  
      *** END   OF 1ST PASS. PROGRAM IND WILL BE SET  TO 2.***  
      *** START OF 2ND PASS. PROGRAM-IND IS NOW 2.         ***  
      *** END   OF 2ND PASS. PROGRAM IND WILL BE SET  TO 1.***  
      ********************************************************  
       3040-CHECK-IF-REWRITE-20D01. 
           IF SW-FATAL-ERROR-ON 
              NEXT SENTENCE 
           ELSE 
           IF NOT WSS-ATE20D01-OPEN-ON  
              NEXT SENTENCE 
           ELSE 
           IF DBL-PAYDAY-IND  = '1' 
              IF PROGRAM-IND  = '0' 
                 MOVE '2'              TO PROGRAM-IND   
                 PERFORM 8890-DET-WRITE-ATE20D01 THRU 8890-EXIT 
              ELSE  
              IF PROGRAM-IND  = '2' 
                 MOVE '1'              TO PROGRAM-IND   
                 PERFORM 8890-DET-WRITE-ATE20D01 THRU 8890-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              NEXT SENTENCE.

       3040-EXIT.   
           EXIT.

      *******************************************************   
      *** WRITE BLOCK/GROSS RECORD COUNTS FOR ALL         ***   
      *** OUTPUT FILES. ATE01D01 THRU ATE01D07.           ***   
      *******************************************************   
       3050-WRITE-OUTPUT-CNTS.  
           PERFORM 3053-FORMAT-BCF-PARAM         THRU 3053-EXIT.

       3050-WRITE-CNTS-ATE01D01.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D0101'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D0102'             TO BCF-FILE-IDENTIF.   
           MOVE WSA-ATE01D01-REC-CNT   TO BCF-GROSS-CT    . 
           MOVE WSA-ATE01D01-BLK-CNT   TO BCF-BLOCK-CT    . 
           MOVE ZEROS                  TO BCF-ACCUM-CT    . 
           PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

R069A *3050-WRITE-CNTS-ATE01D02.
R069A *    IF  WSH-RUN-FLAG  =  'A80'   
R069A *        MOVE 'ATE01D0201'             TO BCF-FILE-IDENTIF
R069A *    ELSE 
R069A *        MOVE 'ATE01D0202'             TO BCF-FILE-IDENTIF.   
R069A *    MOVE WSA-ATE01D02-REC-CNT   TO BCF-GROSS-CT    . 
R069A *    MOVE WSA-ATE01D02-BLK-CNT   TO BCF-BLOCK-CT    . 
R069A *    MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R069A *    PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

       3050-WRITE-CNTS-ATE01D04.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D0401'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D0402'             TO BCF-FILE-IDENTIF.   
           MOVE WSA-ATE01D04-REC-CNT   TO BCF-GROSS-CT    . 
           MOVE WSA-ATE01D04-BLK-CNT   TO BCF-BLOCK-CT    . 
           MOVE ZEROS                  TO BCF-ACCUM-CT    . 
           PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

       3050-WRITE-CNTS-ATE01D05.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D0501'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D0502'             TO BCF-FILE-IDENTIF.   
           MOVE WSA-ATE01D05-REC-CNT   TO BCF-GROSS-CT    . 
           MOVE WSA-ATE01D05-BLK-CNT   TO BCF-BLOCK-CT    . 
           MOVE ZEROS                  TO BCF-ACCUM-CT    . 
           PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

R069A *3050-WRITE-CNTS-ATE01D06.
R069A *    IF  WSH-RUN-FLAG  =  'A80'   
R069A *        MOVE 'ATE01D0601'             TO BCF-FILE-IDENTIF
R069A *    ELSE 
R069A *        MOVE 'ATE01D0602'             TO BCF-FILE-IDENTIF.   
R069A *    MOVE WSA-ATE01D06-REC-CNT   TO BCF-GROSS-CT    . 
R069A *    MOVE WSA-ATE01D06-BLK-CNT   TO BCF-BLOCK-CT    . 
R069A *    MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R069A *    PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R069A * 
R069A *3050-WRITE-CNTS-ATE01D07.
R069A *    IF  WSH-RUN-FLAG  =  'A80'   
R069A *        MOVE 'ATE01D0701'             TO BCF-FILE-IDENTIF
R069A *    ELSE 
R069A *        MOVE 'ATE01D0702'             TO BCF-FILE-IDENTIF.   
R069A *    MOVE WSA-ATE01D07-REC-CNT   TO BCF-GROSS-CT    . 
R069A *    MOVE WSA-ATE01D07-BLK-CNT   TO BCF-BLOCK-CT    . 
R069A *    MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R069A *    PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R069A * 
       3050-WRITE-CNTS-ATE01D08.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D0801'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D0802'             TO BCF-FILE-IDENTIF.   
           MOVE WSA-ATE01D08-REC-CNT   TO BCF-GROSS-CT    . 
           MOVE WSA-ATE01D08-BLK-CNT   TO BCF-BLOCK-CT    . 
           MOVE ZEROS                  TO BCF-ACCUM-CT    . 
           PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

       3050-WRITE-CNTS-ATE01D09.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D0901'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D0902'             TO BCF-FILE-IDENTIF.   
           MOVE WSA-ATE01D09-REC-CNT   TO BCF-GROSS-CT    . 
           MOVE WSA-ATE01D09-BLK-CNT   TO BCF-BLOCK-CT    . 
           MOVE ZEROS                  TO BCF-ACCUM-CT    . 
           PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.

R053   3050-WRITE-CNTS-ATE01D10.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1001'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1002'             TO BCF-FILE-IDENTIF.   
R053       MOVE WSA-ATE01D10-REC-CNT   TO BCF-GROSS-CT    . 
R053       MOVE WSA-ATE01D10-BLK-CNT   TO BCF-BLOCK-CT    . 
R053       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R053       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R053
R053   3050-WRITE-CNTS-ATE01D11.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1101'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1102'             TO BCF-FILE-IDENTIF.   
R053       MOVE WSA-ATE01D11-REC-CNT   TO BCF-GROSS-CT    . 
R053       MOVE WSA-ATE01D11-BLK-CNT   TO BCF-BLOCK-CT    . 
R053       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R053       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R053
R053   3050-WRITE-CNTS-ATE01D12.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1201'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1202'             TO BCF-FILE-IDENTIF.   
R053       MOVE WSA-ATE01D12-REC-CNT   TO BCF-GROSS-CT    . 
R053       MOVE WSA-ATE01D12-BLK-CNT   TO BCF-BLOCK-CT    . 
R053       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R053       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R053
R056   3050-WRITE-CNTS-ATE01D13.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1301'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1302'             TO BCF-FILE-IDENTIF.   
R056       MOVE WSA-ATE01D13-REC-CNT   TO BCF-GROSS-CT    . 
R056       MOVE WSA-ATE01D13-BLK-CNT   TO BCF-BLOCK-CT    . 
R056       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R056       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R056
R056   3050-WRITE-CNTS-ATE01D14.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1401'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1402'             TO BCF-FILE-IDENTIF.   
R056       MOVE WSA-ATE01D14-REC-CNT   TO BCF-GROSS-CT    . 
R056       MOVE WSA-ATE01D14-BLK-CNT   TO BCF-BLOCK-CT    . 
R056       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R056       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R056
R056   3050-WRITE-CNTS-ATE01D15.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1501'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1502'             TO BCF-FILE-IDENTIF.   
R056       MOVE WSA-ATE01D15-REC-CNT   TO BCF-GROSS-CT    . 
R056       MOVE WSA-ATE01D15-BLK-CNT   TO BCF-BLOCK-CT    . 
R056       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R056       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R056
R056   3050-WRITE-CNTS-ATE01D16.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1601'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1602'             TO BCF-FILE-IDENTIF.   
R056       MOVE WSA-ATE01D16-REC-CNT   TO BCF-GROSS-CT    . 
R056       MOVE WSA-ATE01D16-BLK-CNT   TO BCF-BLOCK-CT    . 
R056       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R056       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R056
R064   3050-WRITE-CNTS-ATE01D17.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1701'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1702'             TO BCF-FILE-IDENTIF.   
R064       MOVE WSA-ATE01D17-REC-CNT   TO BCF-GROSS-CT    . 
R064       MOVE WSA-ATE01D17-BLK-CNT   TO BCF-BLOCK-CT    . 
R064       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R064       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R064
R069   3050-WRITE-CNTS-ATE01D18.
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D1801'             TO BCF-FILE-IDENTIF
R069       ELSE 
R069           MOVE 'ATE01D1802'             TO BCF-FILE-IDENTIF.   
R069       MOVE WSA-ATE01D18-REC-CNT   TO BCF-GROSS-CT    . 
R069       MOVE WSA-ATE01D18-BLK-CNT   TO BCF-BLOCK-CT    . 
R068       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R070       DISPLAY  'ATE01D18 COUNT = '  WSA-ATE01D18-REC-CNT   
R070               UPON  PRINTER.   
R069       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R070   3050-WRITE-CNTS-ATE01D20.
R070       IF  WSH-RUN-FLAG  =  'A80'   
R070           MOVE 'ATE01D2001'             TO BCF-FILE-IDENTIF
R070       ELSE 
R070           MOVE 'ATE01D2002'             TO BCF-FILE-IDENTIF.   
R070       MOVE WSA-ATE01D20-REC-CNT   TO BCF-GROSS-CT    . 
R070       MOVE WSA-ATE01D20-BLK-CNT   TO BCF-BLOCK-CT    . 
R070       MOVE ZEROS                  TO BCF-ACCUM-CT    . 
R070       DISPLAY  'ATE01D20 COUNT = '  WSA-ATE01D20-REC-CNT   
R070               UPON  PRINTER.   
R070       PERFORM 3055-WRITE-BCF                THRU 3055-EXIT.
R069
R069
       3050-EXIT.   
           EXIT.

      *******************************************************   
      *** BCF PARAMETER FORMATTING PARA.                  ***   
      *** THIS PARA WOULD FORMAT THE BCF-PARAM-LIST FOR   ***   
      *** THE FIXED PARAMS.                               ***   
      ***                                                 ***   
      *** FILE IDENTIFIER AND COUNTS COME PREFORMATTED    ***   
      *** FROM CALLING PARA, 3050.                        ***   
      *******************************************************   
       3053-FORMAT-BCF-PARAM.   
           MOVE SPACES                 TO WS-BCF-PARAM-LIST.

       3053-FORMAT-PRIM-KEY.
           MOVE CPF-CYCLE-DATE         TO BCF-CYCLE-DATE.   
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE 'ATE01D'               TO BCF-RUN-ID
R069       ELSE 
R069           MOVE 'ATF01D'               TO BCF-RUN-ID.   
           ACCEPT BCF-PROCESSING-DATE  FROM DATE        .   
           ACCEPT BCF-PROCESSING-TIME  FROM TIME        .   
           MOVE 'C'                    TO BCF-RECORD-TYPE.  

       3053-FORMAT-SECD-KEY.
           MOVE CPF-CYCLE-DATE         TO BCF-FILE-CYCLE-DATE.  
           MOVE 'W'                    TO BCF-READ-WRITE-FLAG.  

       3053-EXIT.   
           EXIT.

      *******************************************************   
      *** BCF WRITE PARA.                                 ***   
      *** THIS PARA WOULD ACCEPT BCF-PARAM AND CALL       ***   
      *** ASB002 FOR BCF WRITE.                           ***   
      *******************************************************   
       3055-WRITE-BCF.  
           CALL 'ASB002' USING WS-BCF-PARAM-LIST.   
           IF BCF-STATUS-INDCTR2 > 0
              PERFORM 1820-ASB002-ERROR 
              SET SW-FATAL-ERROR-FLAG  TO ON
              PERFORM 3999-STOP-RUN.

       3055-EXIT.   
           EXIT.


      *******************************************************   
      *** SUMMARY REPORT SECTION.                         ***   
      *** 4000.                                           ***   
      *******************************************************   
       4000-SUMMARY-REPORT-SECTION SECTION. 
       4000-SUMMARY-REPORT-BEGIN.   
           EXIT.

       4000-BEGIN-PROCESSING.   
R069       OPEN  OUTPUT  ATE01D19.  
R069       MOVE  1  TO  WSS-ATE01D19-OPEN.  
R069       PERFORM 4200-WRITE-DATA-COUNTS        THRU 4200-EXIT.
R069       CLOSE  ATE01D19. 
R069       MOVE  0    TO  WSS-ATE01D19-OPEN.
R069       PERFORM  3053-FORMAT-BCF-PARAM  THRU  3053-EXIT. 
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           MOVE  'ATE01D1901'  TO  BCF-FILE-IDENTIF 
R069       ELSE 
R069           MOVE  'ATE01D1902'  TO  BCF-FILE-IDENTIF.
R069       MOVE  WSA-ATE01D19-REC-CNT  TO  BCF-GROSS-CT.
R069       MOVE  WSA-ATE01D19-BLK-CNT  TO  BCF-BLOCK-CT.
R069       MOVE  ZEROES                TO  BCF-ACCUM-CT.
R060       PERFORM  3055-WRITE-BCF  THRU  3055-EXIT.
       4000-EXIT.   
           EXIT.


      *******************************************************   
      *** THIS SECTIONS CONTAINS SUBROUTINES OF 4000      ***   
      *** PROCESS  (PRINT REPORT) SECTION.                ***   
      *** INDIVIDUAL PARA MODULES ARE EXECUTED.           ***   
      *******************************************************   
       4100-SUBS-OF-4000-SECTION SECTION.   

       4200-WRITE-DATA-COUNTS.  
R069       MOVE  '1'  TO  ATE01D19-REC-TYPE-1.  
R069       MOVE WSA-R666-REC-CNT           TO  ATE01D19-CASE-CNT.   
R069       MOVE WSA-R-ACT-BDGT-CNT     TO  ATE01D19-OPEN-CM-BDGT.   
R069       MOVE WSA-R-SUS-BDGT-CNT     TO  ATE01D19-SUSP-CM-BDGT.   
R069       MOVE WSA-R-VEND-BDGT-CNT    TO  ATE01D19-VEND-BDGT.  
R069       MOVE WSA-R-VEND-BDGT-AMT    TO  ATE01D19-VEND-AMT.   
R069       MOVE WSA-R-RCOU-BDGT-CNT    TO  ATE01D19-RECOUP-CM-BDGT. 
R069       MOVE WSA-R-RCOU-BDGT-AMT    TO  ATE01D19-RECOUP-AMT. 
R069       MOVE WSA-R-MAID-ONLY-CNT    TO  ATE01D19-MED-BDGT.   
R069       MOVE WSA-JAM-CASH-CNT       TO  ATE01D19-JAM-BDGT.   
R069       MOVE WSA-JAM-MEDI-CNT       TO  ATE01D19-JAM-MED-BDGT.   
R069       MOVE WSA-R-CHK-ISS-BDGT-CNT TO  ATE01D19-CHECK-ISSUE.
R069       MOVE WSA-R-CHK-ISS-BDGT-AMT TO  ATE01D19-CHECK-TOTAL.
R069       MOVE WSA-ATE01D02-BLK-CNT   TO  ATE01D19-MAID-WORK.  
R069       MOVE WSA-R-R255-NOT-FOUND   TO  ATE01D19-R255-N-F.   
R069       MOVE WSA-R654-REC-CNT       TO  ATE01D19-OVRD-RECS.  
R069       MOVE WSA-R-DD-BANK-CHG-CNT  TO  ATE01D19-DD-BANK-CHGS.   
R069       MOVE WSA-R-ACT-BDGT-MEM-CNT TO  ATE01D19-ACTV-BDGT-MEMB. 
R069       MOVE WSA-R-AGRZER-CNT       TO  ATE01D19-AGRZER-CNT. 
R069       MOVE  ZEROES    TO  ATE01D19-AGRZER-TO-TSA.  
R069       MOVE WSA-R-PRO-CLOSE-BDGT-CNT TO ATE01D19-PRO-RATE-CLOSE.
R069       MOVE WSA-R-PRO-CLOSE-BDGT-AMT TO ATE01D19-PRO-RATE-AMT.  
R069       MOVE WSA-R-MGA-LT-10-CNT    TO  ATE01D19-MGA-10-DOL. 
R074       MOVE  WSA-R-LIN-CLOSES  TO  ATE01D19-LIN-CLOSES. 
R069       WRITE  ATE01D19-REC. 
R069       ADD  1  TO  WSA-ATE01D19-REC-CNT.

R069       PERFORM 4450-DETAIL-WRITE-CAT-LINES   THRU 4450-EXIT 
                   VARYING WSI-C-C-CNTY-IDX FROM 1 BY 1 
                           UNTIL WSI-C-C-CNTY-IDX > WSH-CNTY-TAB-SIZE.  

R070       PERFORM  4460-WRITE-AUTO  THRU  4460-EXIT  VARYING   
R070           WSS-AUTO-SS  FROM  1  BY  1  UNTIL   
R070               WSS-AUTO-SS  >  WSS-AUTO-MAX.
       4200-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA IS LOOPED FOR COUNTY INDEX.           ***   
      *** AND IN TURN WILL LOOP ANOTHER PARA FOR CAT IDX. ***   
      *** COUNTY NAME IS MOVED TO REPORT VARIABLE, BECAUSE***   
      *** WE WUD LIKE IT TO BE PRINTED ONLY ONCE.         ***   
      *** IF THE COUNTY REPORT WAS PRINTYED, ITS TOTALS   ***   
      *** ARE ALSO PRINTED.                               ***   
      *******************************************************   
       4450-DETAIL-WRITE-CAT-LINES. 
R069       MOVE  ZEROES  TO  ATE01D19-REC-2.
           SET WSI-CNTY-IDX            TO WSI-C-C-CNTY-IDX. 
R069       SET  WSI-CO    TO  WSI-C-C-CNTY-IDX. 
R069       MOVE  '2'   TO  ATE01D19-REC-TYPE-2. 
           MOVE WST-CNTY-NAME (WSI-CNTY-IDX)
R069               TO  ATE01D19-CO-NAME.
R069       MOVE  WSI-CO    TO  ATE01D19-COUNTY. 
           PERFORM 4455-DETAIL-WRITE-CAT-LINE    THRU 4455-EXIT 
                   VARYING WSI-C-C-CAT-IDX FROM 1 BY 1 UNTIL
                           WSI-C-C-CAT-IDX > WSH-CAT-ONLY-TAB-SIZE. 

R069       WRITE  ATE01D19-REC-2.   
R069       ADD  1  TO  WSA-ATE01D19-REC-CNT.
       4450-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA PERFORMS DETAILED WRITING FOR COUNTY  ***   
      *** AND CAT CODE.                                   ***   
      *** THE WRITING IS PERFORMED ONLY IF BDGT COUNT     ***   
      *** IS NON ZEROS. AND AT THAT TIME ONLY THE HEADERS ***   
      *** ARE PRINTED.                                    ***   
      *** COUNTY TOTALS ARE ALSO ACCUMULATED.             ***   
      *******************************************************   
       4455-DETAIL-WRITE-CAT-LINE.  
           IF WST-CNTY-CAT-ACT-BDGT-CNT 
              (WSI-C-C-CNTY-IDX  WSI-C-C-CAT-IDX)   
                    NOT > 0 
                        GO TO 4455-EXIT.

           SET WSI-CAT-ONLY-IDX        TO WSI-C-C-CAT-IDX.  
R069       SET  WSI-CAT    TO  WSI-C-C-CAT-IDX. 
           MOVE WST-CAT-ONLY (WSI-CAT-ONLY-IDX) 
R069               TO  ATE01D19-CATEGORY (WSI-CAT). 
           MOVE WST-CNTY-CAT-ACT-BDGT-CNT   
                (WSI-C-C-CNTY-IDX  WSI-C-C-CAT-IDX) 
R069               TO  ATE01D19-CO-ACT-BDGT (WSI-CAT).  
           MOVE WST-CNTY-CAT-MGA-DOLL   
                (WSI-C-C-CNTY-IDX  WSI-C-C-CAT-IDX) 
R069               TO  ATE01D19-CO-GR-AMT (WSI-CAT).

       4455-EXIT.   
           EXIT.
R070   4460-WRITE-AUTO. 
R070       IF  WST-AUTO-CNTY (WSS-AUTO-SS)  =  00   
R070           GO  TO  4460-EXIT.   
R070       MOVE  '3'    TO  ATE01D19-REC-TYPE-3.
R070       MOVE  WST-AUTO-CNTY (WSS-AUTO-SS)    TO  ATE01D19-REC3-CNTY. 
R070       MOVE  WST-AUTO-DIST (WSS-AUTO-SS)    TO  ATE01D19-REC3-DIST. 
R070       MOVE  WST-AUTO-CASES (WSS-AUTO-SS)   TO  ATE01D19-REC3-CASES.
R070       MOVE  WST-AUTO-REDET (WSS-AUTO-SS)   TO  ATE01D19-REC3-REDET.
R070       MOVE  WST-AUTO-EXCEPT (WSS-AUTO-SS) TO ATE01D19-REC3-EXCEPT. 
R070       MOVE  WST-AUTO-BYPASS (WSS-AUTO-SS)  TO ATE01D19-REC3-BYPASS.
R070       MOVE  WST-AUTO-NO-ACTN (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-NO-ACTN.  
R070       MOVE  WST-AUTO-CASH-NO (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-CASH-NO.  
R070       MOVE  WST-AUTO-CASH-EX (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-CASH-EX.  
R070       MOVE  WST-AUTO-MA-NO   (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-MA-NO.
R070       MOVE  WST-AUTO-MA-EX   (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-MA-EX.
R070       MOVE  WST-AUTO-EXEMPT  (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-EXEMPT.   
R070       MOVE  WST-AUTO-CLOSED  (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-CLOSED.   
R070       MOVE  WST-AUTO-SUSPEND (WSS-AUTO-SS) TO  
R070                    ATE01D19-REC3-SUSPEND.  
R070       WRITE  ATE01D19-REC-3.   
R070       ADD  1  TO  WSA-ATE01D19-REC-CNT.
R070   4460-EXIT.    EXIT.  
      *******************************************************   
      *** DATE MANIPULATION SECTION.                      ***   
      *** THE FOLLOWING CODE IS DEFINED :                 ***   
      ***    . JUL TO GRG                                 ***   
      ***    . GRG TO JUL                                 ***   
      ***    . CONVERSION ERROR HANDLING PROC             ***   
      ***    . DATE ADDITION/SUBTRACTION                  ***   
      ***    . DATE DIFF                                  ***   
      *******************************************************   
       6500-DATE-MANIPULATION-SECTION SECTION.  

      ***********************************   
      *** JULIAN TO GREGORIAN         ***   
      ***********************************   
       6510-JUL-TO-GRG. 

M307***COPY APR800P.
M307   COPY MIL002P.

      ***********************************   
      *** GREGORIAN TO JULIAN         ***   
      ***********************************   
       6520-GRG-TO-JUL. 

M307***COPY APR801P.
M307   COPY MIL003P.

      ***********************************   
      *** DATE CONV ERROR HANDLING    ***   
      ***********************************   
       6530-DTE-CONV-ERROR. 
M307   COPY MIL005P.

      ***********************************   
      *** DATE ADD/SUB                ***   
      ***********************************   
M307   COPY MIL012P.

      ***************************************************   
      *** CALCULATE DIFF IN 2 JUL DAYS.               ***   
      *** INPUT IS IN WSH-JUL-DATE1-R & WSH-JUL-DATE2 ***   
      *** -R.  DATE2 > DATE1                          ***   
      *** AND OUTPUT IS IN WSH-JUL-DATE3.             ***   
      *** LEAP YR CALCULATION IS DONE.                ***   
      ***************************************************   


      *******************************************************   
      *** OPEN DATA BASE AREAS, SET UP THE ACCESS KEYS AS ***   
      *** REQUIRED.                                       ***   
      ***    . R666/A84X-AE-CASE                          ***   
      ***    . R246/A80X-AE-CASE                          ***   
      ***    . R287/A521-BNFTHST                          ***   
      *******************************************************   
       7000-OPEN-DB-AREAS-SECTION SECTION.  
       7000-IMPART. 
           MOVE 'PROD-ACCESS'          TO SCH-ACCKEY.   
           MOVE 'UPDAT#CIS$$$'         TO DB-UPDAT-KEY. 
           IMPART.  

       7000-DISSECT-PAYADY-NBR. 
R004       MOVE WSH-PAYDAY-NBR         TO WSH-PAYDAY-DIGIT-1-2. 

       7000-OPEN-A84X.  
           MOVE WSH-PAYDAY-DIGIT-2     TO WSH-AREA-A84X-X.  
           MOVE WSH-BUILD-AREA-A84X    TO WSH-AREA-A84X  .  
           MOVE WSH-BUILD-AREA-A84X    TO CALCR666-AN    .  
           OPEN WSH-AREA-A84X USAGE-MODE IS RETRIEVAL   
                ON ERROR GO TO 7010-OPEN-ERROR. 
CC43       MOVE  WSH-PAYDAY-DIGIT-2    TO  WSH-AREA-A94X-X. 
CC43       MOVE  WSH-BUILD-AREA-A94X   TO  WSH-AREA-A94X
CC43                                       CALCR666-AN. 
CC43       OPEN  WSH-AREA-A94X  USAGE-MODE  IS  RETRIEVAL   
CC43           ON  ERROR  GO  TO  7010-OPEN-ERROR.  

       7000-OPEN-A80X.  
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           NEXT  SENTENCE   
R069       ELSE 
R069           GO  TO  7000-OPEN-A86X.  
           MOVE WSH-PAYDAY-DIGIT-2     TO WSH-AREA-A80X-X.  
           MOVE WSH-BUILD-AREA-A80X    TO WSH-AREA-A80X  .  
           MOVE WSH-BUILD-AREA-A80X    TO CALCR246-AN    .  
           OPEN WSH-AREA-A80X USAGE-MODE IS UPDATE  
                ON ERROR GO TO 7010-OPEN-ERROR. 

MD01   7000-OPEN-A86X.  
R069       IF  WSH-RUN-FLAG  =  'A86'   
R069           NEXT  SENTENCE   
R069       ELSE 
R069           GO  TO  7000-OPEN-A81X.  
MD01       MOVE WSH-PAYDAY-DIGIT-2     TO WSH-AREA-A86X-X.  
MD01       MOVE WSH-BUILD-AREA-A86X    TO WSH-AREA-A86X  .  
MD01       MOVE WSH-BUILD-AREA-A86X    TO CALCR246-AN    .  
MD01       OPEN WSH-AREA-A86X USAGE-MODE IS UPDATE  
MD01            ON ERROR GO TO 7010-OPEN-ERROR. 
MD01
       7000-OPEN-A81X.  
           MOVE WSH-PAYDAY-DIGIT-2     TO WSH-AREA-A81X-X.  
           MOVE WSH-BUILD-AREA-A81X    TO WSH-AREA-A81X  .  
           MOVE WSH-BUILD-AREA-A81X    TO CALCR637-AN    .  
R069       OPEN WSH-AREA-A81X USAGE-MODE IS RETRIEVAL   
                ON ERROR GO TO 7010-OPEN-ERROR. 

       7000-OPEN-A681.  
           MOVE 'A681-RECOUP'          TO RCOUPMT-AN.   
           OPEN A681-RECOUP USAGE-MODE IS RETRIEVAL 
                ON ERROR GO TO 7010-OPEN-ERROR. 
R056       MOVE 80           TO WS-R15-AREA-DIGIT.  
R056       PERFORM 7002-OPEN-A580-A599-AREAS
R056                                    THRU 7002-EXIT 20 TIMES.
CC47       MOVE 00           TO WS-R15-AREA-DIGIT-2.
CC47       PERFORM 7002A-OPEN-A400-A419-AREAS   
CC47                                    THRU 7002A-EXIT 20 TIMES.   
CC43       MOVE  80  TO  WS-R25-AREA-DIGIT. 
CC43       PERFORM  7003-OPEN-A980-A999-AREAS  THRU  7003-EXIT  
CC43               20  TIMES.   
R056       MOVE 30           TO WS-R17-AREA-DIGIT.  
R056       PERFORM 7004-OPEN-A630-A649-AREAS
R056                                    THRU 7004-EXIT 20 TIMES.
R056       MOVE 40           TO WS-R19-AREA-DIGIT.  
R056       PERFORM 7006-OPEN-A740-A759-AREAS
R056                                    THRU 7006-EXIT 20 TIMES.
R056
R056       MOVE 'A670-RCPT-20'   TO CALCR20-AN. 
R069       OPEN CALCR20-AN  USAGE-MODE IS RETRIEVAL.
R056       IF ERROR-STATUS = '000000' OR '000928'   
R056          NEXT SENTENCE 
R056       ELSE 
R056          GO TO 7010-OPEN-ERROR.
       7000-EXIT-SECTION.   
           EXIT.

R056   7002-OPEN-INDIV-AREA SECTION.
R056   7002-OPEN-A580-A599-AREAS.   
R056       MOVE WS-CALCR15-AN    TO CALCR15-AN. 
R056       OPEN CALCR15-AN  USAGE-MODE IS RETRIEVAL.
R056       IF ERROR-STATUS = '000000' OR '000928'   
R056          NEXT SENTENCE 
R056       ELSE 
R056          GO TO 7010-OPEN-ERROR.
R056
R056       ADD 1 TO WS-R15-AREA-DIGIT.  
R056   7002-EXIT.   
R056       EXIT.
R056
CC47   7002A-OPEN-A400-A419-AREAS.  
CC47       MOVE  WS-CALCR15-AN-2  TO  CALCR15-AN.   
CC47       OPEN  CALCR15-AN  USAGE-MODE  IS  RETRIEVAL. 
CC47       IF  ERROR-STATUS  =  '000000'  OR  '000928'  
CC47           NEXT  SENTENCE   
CC47       ELSE 
CC47           GO  TO  7010-OPEN-ERROR. 
CC47       ADD  1  TO  WS-R15-AREA-DIGIT-2. 
CC47   7002A-EXIT.    EXIT. 
CC43   7003-OPEN-A980-A999-AREAS.   
CC43       MOVE  WS-CALCR25-AN    TO  CALCR25-AN.   
CC43       OPEN  CALCR25-AN  USAGE-MODE  IS  RETRIEVAL. 
CC43       IF  ERROR-STATUS  =  '000000'  OR  '000928'  
CC43           NEXT  SENTENCE   
CC43       ELSE 
CC43           GO  TO  7010-OPEN-ERROR. 
CC43       ADD  1  TO  WS-R25-AREA-DIGIT.   
CC43   7003-EXIT.    EXIT.  
R056   7004-OPEN-A630-A649-AREAS.   
R056       MOVE WS-CALCR17-AN    TO CALCR17-AN. 
R069       OPEN CALCR17-AN  USAGE-MODE IS RETRIEVAL.
R056       IF ERROR-STATUS = '000000' OR '000928'   
R056          NEXT SENTENCE 
R056       ELSE 
R056          GO TO 7010-OPEN-ERROR.
R056
R056       ADD 1 TO WS-R17-AREA-DIGIT.  
R056   7004-EXIT.   
R056       EXIT.
R056
R056   7006-OPEN-A740-A759-AREAS.   
R056       MOVE WS-CALCR19-AN    TO CALCR19-AN. 
R069       OPEN CALCR19-AN  USAGE-MODE IS RETRIEVAL.
R056       IF ERROR-STATUS = '000000' OR '000928'   
R056          NEXT SENTENCE 
R056       ELSE 
R056          GO TO 7010-OPEN-ERROR.
R056
R056       ADD 1 TO WS-R19-AREA-DIGIT.  
R056   7006-EXIT.   
R056       EXIT.
R056
      *******************************************************   
      *** OPEN ERROR PROCESS ROUTINE.                     ***   
      *******************************************************   
       7010-OPEN-ERROR-SECTION SECTION. 
       7010-OPEN-ERROR. 
           SET SW-FATAL-ERROR-FLAG     TO ON.   
           PERFORM GENERAL-ERROR-RTN.   

       7010-EXIT.   
           EXIT.


      *******************************************************   
      *** DATABASE DEPART SECTION.                        ***   
      *******************************************************   
       7050-DB-DEPART-SECTION SECTION.  
       7050-DB-DEPART.  
           IF IMPART-DEPART = 1 
TEST            DEPART. 
TEST  *         DEPART WITH ROLLBACK.   
TEST  *    DISPLAY 'DEPART WITH ROLLBACK'  UPON  PRINTER.   

       7050-EXIT.   
           EXIT.


      *******************************************************   
      *** GENERAL DATA BASE ACCESS PARAS, NOT SPECIFIC    ***   
      *** TO ANY PARTICULAR RECORD TYPE.                  ***   
      *** ENTRY POINTS ARE :                              ***   
      ***    . 7100-FIND-CUR-IN-REC                       ***   
      ***    . 7110-FETCH-REC-ON-KEY                      ***   
      *******************************************************   
       7100-GENERAL-DB-SECTION SECTION. 

      *******************************************************   
      *** FIND CURRNET RECORD IN SPECIFIED RECORD-TYPE.   ***   
      *** WSH-RECORD-NAME COMES FORMATTED FROM CALLING    ***   
      *** PARA.                                           ***   
      *******************************************************   
       7100-FIND-CUR-IN-REC.
           FIND CURRENT RECORD WITHIN WSH-RECORD-NAME RECORD
                ON ERROR GO TO 7100-ERROR.  
           GO TO 7100-EXIT. 

       7100-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7100-EXIT.   
           EXIT.

      *******************************************************   
      *** FETCH THE SPECIFIED RECORD TYPE ON A GIVEN      ***   
      *** DATABASE KEY.                                   ***   
      *** WSH-RECORD-NAME & WSH-FET-DBK COME PRE-FORMATTED***   
      *** FROM THE CALLING PARA.                          ***   
      *******************************************************   
       7110-FETCH-REC-ON-KEY.   
           FETCH WSH-RECORD-NAME RECORD WSH-FET-DBK 
                ON ERROR GO TO 7110-ERROR.  
           GO TO 7110-EXIT. 

       7110-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7110-EXIT.   
           EXIT.

      *******************************************************   
      *** MODIFY DB RECORDS.                              ***   
      *** THIS ROUTINE IS MOSTLY USED FROM THOSE PARAS    ***   
      *** THAT END-DATE THE DB RECORDS.                   ***   
      *******************************************************   
       7120-MODIFY-GEN-DB-REC.  
           MODIFY WSH-RECORD-NAME RECORD
                  ON ERROR GO TO 7120-ERROR.
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R065       MOVE  'Y'  TO  WSS-UPDATE-FLAG.  

       7120-PROCESS.
           GO TO 7120-EXIT. 

       7120-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7120-EXIT.   
           EXIT.
R025  *******************************************************   
R025  *** FROM THE CALLING PARA.                          ***   
R025  *** WSH-RECORD-NAME & WSH-SET-NAM COME PRE-FORMATTED***   
R025  *** FROM THE CALLING PARA.                          ***   
R025  *******************************************************   
R025   7140-FETCH-NEXT-GEN-REC-SET. 
R025       FETCH NEXT WSH-RECORD-NAME WITHIN WSH-SET-NAME SET   
R025            ON ERROR GO TO 7140-ERROR.  
R025       GO TO 7140-EXIT. 
R025
R025   7140-ERROR.  
R025       IF ERROR-NUM = '0007' OR '0013'  
R025          NEXT SENTENCE 
R025       ELSE 
R025          PERFORM 7995-DB-ERROR              THRU 7995-EXIT.
R025
R025   7140-EXIT.   
R025       EXIT.


      *******************************************************   
      *** DATA BASE ACCESS SECTIONS.                      ***   
      *** FOLLOWING SECTIONS HAVE BEEN DEFINED :          ***   
      ***    . SECTION 7200 . ENTRY POINT R666            ***   
      ***    . SECTION 7300 . ENTRY POINT R246            ***   
      ***    . SECTION 7700 . ENTRY POINT R270            ***   
      ***    . SECTION 7800 . ENTRY POINT R287            ***   
      ***                                                 ***   
      *** TO QUICLY LOCATE A RECORD :                     ***   
      ***    . GO IN THAT SECTION, USE THE DB DIAGRAM     ***   
      ***    . CODE IS ORGANISED AS PER SETS,             ***   
      ***        LEFT TO RIGHT                            ***   
      ***    . WITHIN A SET, RECORDS ARE AVAILABLE IN AN  ***   
      ***        ASCENDING SEQUENCE.                      ***   
      ***                                                 ***   
      *** ALL FETCH/STORE/MODIFY PARA ARE STORED          ***   
      *** CONSECUTIVELY, IN THAT SEQ.                     ***   
      *** FOLLOWING PARA NUMBERING CONVENTION IS FOLLOWED:***   
      ***     . FETCH  :  XXX0, EG 7320-FETCH-R634 .      ***   
      ***     . STORE  :  XXX2, EG 7378-STORE-R255 .      ***   
      ***     . MODIFY :  XXX4, EG 7328-MODIFY-R634.      ***   
      *** (UNFORTUNATELY, COULD NOT BE MAINTAINED !)      ***   
      ***                                                 ***   
      *** ALMOST ALL DB FETCHES OF RECORDS-IN-SETS WUD    ***   
      *** FETCH RECORDS WITH END-DTE = ZEROS AND          ***   
      *** BEGIN-DTE <= PAYMENT DATES.                     ***   
      *** FORMAT-4 IS USED WITH A 'BACKWARD GO TO', IF    ***   
      *** END-DTE IS NOT = 0.                             ***   
      ***                                                 ***   
      *** HAPPY HUNTING !                                 ***   
      *******************************************************   

      *******************************************************   
      *** R666 CASE SECTION                               ***   
      *** 2 SETS DESCRIBED, S369 AND S101.                ***   
      *** THIS AREA IS OPEN FOR RETRIEVAL ONLY AND WUD    ***   
      *** NOT SEE ANY UPDATES.                            ***   
      *******************************************************   

      *******************************************************   
      *** COMMON PROCESING LOGIC FOR VIA SET RECORDS.     ***   
      ***   . MAIN LINE WILL PERFORM THE DB FETCH         ***   
      ***     AND SUCCESS/FAILURE MUST BE INDICATED IN    ***   
      ***     WSS-R001-REC SWITCH.                        ***   
      ***                                                 ***   
      ***   . FIRST VALID REC WITH 0 END-DTE AND          ***   
      ***     BEGIN DATE WITHIN CURRENT PAYMENT DATE WILL ***   
      ***     INDICATE A SUCCESSFUL FIRST REC READ.       ***   
      ***                                                 ***   
      ***   . ATEMPT WILL BE MADE TO READ ONE MORE REC    ***   
      ***     WITH ABOVE CONDITIONS.                      ***   
      ***     IF FOUND, THE LATEST REC WILL BE KEPT       ***   
      ***     FOR PROCESSING AND OLDER REC WILL BE        ***   
      ***     END DATED, IN A SUBSEQUENT PROCESS.         ***   
      ***                                                 ***   
      ***     THIS RECORD SHOULD BE TAGGED IN ATE01D08    ***   
      ***     ALONG WITH ITS CASE NUMBER AND RECORD TYPE. ***   
      *******************************************************   

      ****************************************************  
      *** 1. IF AT LEAST 1 VALID REC WAS FOUND,        ***  
      ***    CORRESPONDING REC-FOUND-SW IS TURNED ON.  ***  
      *** 2. IF NO MORE VALID OCCURENCES ARE THERE,    ***  
      ***    CHECK IF AT LEAST A CLOSED/FUTURE REC     ***  
      ***    WAS FOUND. IF IT WAS FOUND, MAKE THE      ***  
      ***    VALID REC CURRENT.                        ***  
      *** 3. IF 2 VALID RECS ARE FOUND, END DATE ONE   ***  
      ***    OF THEM.                                  ***  
      ****************************************************  
       7200-R666-SECTION SECTION.   

      *******************************************************   
      *** R666 ENTRY POINT REC.                          ****   
      *** BEFORE DOING A 'FETCH NEXT', REPOSITION R666.  ****   
      *******************************************************   
R058   7205-FETCH-R666. 
TEST1 *    IF  WS-TEST-SW  =  'Y'   
TEST1 *        DISPLAY  '7205-FETCH-R666 '  R666-NBR-CASE UPON PRINTER. 
R069       MOVE  'N'  TO  WSS-R666-FOUND.   
R058       FETCH  R666-AE-CASE  RECORD  ON  ERROR   
R058           GO  TO  7205-ERROR.  
R058   7205-ERROR.  
R058       IF  ERROR-CODE  =  '00'  
R069           MOVE  'Y'  TO  WSS-R666-FOUND
R058       ELSE 
R069           IF  ERROR-NUM  =  '0006'  OR  '0007'  OR  '0013' 
R069               MOVE  'N'    TO  WSS-R666-FOUND  
R069           ELSE 
R069               PERFORM  7995-DB-ERROR  THRU  7995-EXIT. 
R058   7205-EXIT.    EXIT.  


      *******************************************************   
      *** R672 . ONLY RECORD WITHIN THE SET.              ***   
      *** SET S369.                                       ***   
      ***                                                 ***   
      *** THE FOLLOWING EXCEPTIONS OCCUR :                ***   
      ***     1. THIS IS A FUTURE CASE. ONLY 1 OPEN       ***   
      ***        672 BUT IT HAS A FUTURE BEGIN DATE.      ***   
      ***     2. THE CASE IS CLOSED. NO ZERO END-DTE      ***   
      ***        672 BUT THE ONE THAT DID EXIST, HAD      ***   
      ***        A 'CLOSED' STATUS.                       ***   
      ***                                                 ***   
      ***  NORMAL CASE.                                   ***   
      ***     1. VALID OPEN 672.                          ***   
      ***     2. 'FUTURE-672' JUST GOING ACTIVE.          ***   
      *******************************************************   
       7220-FETCH-R672. 
           MOVE ZEROS                  TO WSS-R672-REC. 
           MOVE ZEROS                  TO WSS-CASE-CLOSED.  
           MOVE ZEROS                  TO WSS-R672-FUTURE-REC.  

       7220-FETCH-FIRST-R672.   
           PERFORM 7222-FET-DET-R672             THRU 7222-EXIT.
           IF WSS-R672-EOS-ON   
              GO TO 7220-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R672-1ST-DBK 
                   ON ERROR GO TO 7220-BAD-CURRENCY 
              MOVE R672-DTE-BGN-EFFV   TO WSH-R672-1ST-DTE-BGN  
R053          MOVE R672-CDE-DIST       TO CDE-DIST  
R053          MOVE R672-NBR-CSLD       TO NBR-CSLD  
              MOVE 1                   TO WSS-R672-REC  
              ADD 1                    TO WSA-R672-REC-CNT. 

       7220-FETCH-SECOND-R672.  
           PERFORM 7222-FET-DET-R672             THRU 7222-EXIT.
           IF WSS-R672-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7220-BAD-CURRENCY 
              IF WSH-R672-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R672-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R672-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R672-2ND-DBK
                   ON ERROR GO TO 7220-BAD-CURRENCY 
              MOVE R672-DTE-BGN-EFFV   TO WSH-R672-2ND-DTE-BGN  
              PERFORM 7226-END-DTE-R672          THRU 7226-EXIT 
              ADD 1                    TO WSA-R672-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7220-EXIT. 

       7220-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7220-EXIT.   
           EXIT.

      *******************************************************   
      *** R672 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7222-FET-DET-R672.   
           MOVE 0                      TO WSS-R672-EOS. 
           FETCH NEXT WSH-R672-NAME WITHIN  
                 S369-CASE-ATTRIB SET   
                      ON ERROR GO TO 7222-ERROR.

       7222-CHECK-VALID-REC.
M313       IF R672-DTE-END-EFFV = 0000000   
                 GO TO 7222-EXIT
           ELSE 
R029             MOVE    1   TO   WSS-R672-EOS  
R029             GO TO 7222-EXIT.   

       7222-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R672-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7222-EXIT.   
           EXIT.

      *******************************************************   
      *** R672 . IDENTIFY THE RECORD THAT IS OLD          ***   
      *** AND PUT IT TO ATE01D08 TO BE UPDATED LATER.     ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7226-END-DTE-R672.   
           IF WSH-R672-1ST-DTE-BGN  <  WSH-R672-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R672'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 
           ELSE 
           IF WSH-R672-1ST-DTE-BGN  >  WSH-R672-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R672'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 

              MOVE WSH-R672-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R672-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R672-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE R666-NBR-CASE       TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
R007          MOVE WSH-R672-NAME       TO WSH-RECORD-NAME   
R007          MOVE WSH-R672-1ST-DBK    TO WSH-FET-DBK   
R007          PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT.

       7226-EXIT.   
           EXIT.

      *******************************************************   
      *** R247 . 1ST  RECORD WITHIN THE SET.              ***   
      *** SET 101.                                        ***   
      *******************************************************   
       7240-FETCH-R247. 
           MOVE ZEROS                  TO WSS-R247-REC. 

       7240-FETCH-FIRST-R247.   
           PERFORM 7242-FET-DET-R247             THRU 7242-EXIT.
           IF WSS-R247-EOS-ON   
              GO TO 7240-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R247-1ST-DBK 
                   ON ERROR GO TO 7240-BAD-CURRENCY 
              MOVE R247-DTE-BGN-EFFV   TO WSH-R247-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R247-REC  
              ADD 1                    TO WSA-R247-REC-CNT. 

       7240-FETCH-SECOND-R247.  
           PERFORM 7242-FET-DET-R247             THRU 7242-EXIT.
           IF WSS-R247-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7240-BAD-CURRENCY 
              IF WSH-R247-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R247-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R247-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R247-2ND-DBK
                   ON ERROR GO TO 7240-BAD-CURRENCY 
              MOVE R247-DTE-BGN-EFFV   TO WSH-R247-2ND-DTE-BGN  
              PERFORM 7246-END-DTE-R247          THRU 7246-EXIT 
              ADD 1                    TO WSA-R247-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7240-EXIT. 

       7240-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7240-EXIT.   
           EXIT.

      *******************************************************   
      *** R247 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7242-FET-DET-R247.   
           MOVE 0                      TO WSS-R247-EOS. 
           FETCH NEXT WSH-R247-NAME WITHIN  
                 S101-CASE-NAME-ADR SET 
                      ON ERROR GO TO 7242-ERROR.

       7242-CHECK-VALID-REC.
M313       IF R247-DTE-END-EFFV = 0000000   
                 GO TO 7242-EXIT
           ELSE 
R029          MOVE 1                   TO WSS-R247-EOS  
R029          GO TO 7242-EXIT.  

       7242-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R247-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7242-EXIT.   
           EXIT.

      *******************************************************   
      *** R247 . IDENTIFY THE RECORD THAT IS OLD          ***   
      *** AND PUT IT TO ATE01D08 TO BE UPDATED LATER.     ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7246-END-DTE-R247.   
           IF WSH-R247-1ST-DTE-BGN  <  WSH-R247-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R247'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 
           ELSE 
           IF WSH-R247-1ST-DTE-BGN  >  WSH-R247-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R247'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 

              MOVE WSH-R247-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R247-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R247-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE R666-NBR-CASE       TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7246-EXIT.   
           EXIT.

      *******************************************************   
      *** R248 . 2ND  RECORD WITHIN THE SET.              ***   
      *** SET 101.                                        ***   
      *******************************************************   
       7260-FETCH-R248. 
           MOVE ZEROS                  TO WSS-R248-REC. 

       7260-FETCH-FIRST-R248.   
           PERFORM 7262-FET-DET-R248             THRU 7262-EXIT.
           IF WSS-R248-EOS-ON   
              GO TO 7260-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R248-1ST-DBK 
                   ON ERROR GO TO 7260-BAD-CURRENCY 
R053***       MOVE R248-NAM-PMT        TO NAM-CASE  
              MOVE R248-DTE-BGN-EFFV   TO WSH-R248-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R248-REC  
              ADD 1                    TO WSA-R248-REC-CNT. 

       7260-FETCH-SECOND-R248.  
           PERFORM 7262-FET-DET-R248             THRU 7262-EXIT.
           IF WSS-R248-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7260-BAD-CURRENCY 
              IF WSH-R248-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R248-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R248-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R248-2ND-DBK
                   ON ERROR GO TO 7260-BAD-CURRENCY 
              MOVE R248-DTE-BGN-EFFV   TO WSH-R248-2ND-DTE-BGN  
              PERFORM 7266-END-DTE-R248          THRU 7266-EXIT 
              ADD 1                    TO WSA-R248-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7260-EXIT. 

       7260-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7260-EXIT.   
           EXIT.

      *******************************************************   
      *** R248 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7262-FET-DET-R248.   
           MOVE 0                      TO WSS-R248-EOS. 
           FETCH NEXT WSH-R248-NAME WITHIN  
                 S101-CASE-NAME-ADR SET 
                      ON ERROR GO TO 7262-ERROR.

       7262-CHECK-VALID-REC.
M313       IF R248-DTE-END-EFFV = 0000000   
                 GO TO 7262-EXIT
           ELSE 
R029          MOVE 1                   TO WSS-R248-EOS  
R029          GO TO 7262-EXIT.  

       7262-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R248-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7262-EXIT.   
           EXIT.

      *******************************************************   
      *** R248 . IDENTIFY THE RECORD THAT IS OLD          ***   
      *** AND PUT IT TO ATE01D08 TO BE UPDATED LATER.     ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7266-END-DTE-R248.   
           IF WSH-R248-1ST-DTE-BGN  <  WSH-R248-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R248'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 
           ELSE 
           IF WSH-R248-1ST-DTE-BGN  >  WSH-R248-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R248'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 

              MOVE WSH-R248-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R248-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R248-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE R666-NBR-CASE       TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7266-EXIT.   
           EXIT.

      *******************************************************   
      *** R254 . 3RD  RECORD WITHIN THE SET.              ***   
      *** SET 101.                                        ***   
      *******************************************************   
       7280-FETCH-R254. 
           MOVE ZEROS                  TO WSS-R254-REC. 

       7280-FETCH-FIRST-R254.   
           PERFORM 7282-FET-DET-R254             THRU 7282-EXIT.
           IF WSS-R254-EOS-ON   
              GO TO 7280-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R254-1ST-DBK 
                   ON ERROR GO TO 7280-BAD-CURRENCY 
              MOVE R254-DTE-BGN-EFFV   TO WSH-R254-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R254-REC  
              ADD 1                    TO WSA-R254-REC-CNT. 

       7280-FETCH-SECOND-R254.  
           PERFORM 7282-FET-DET-R254             THRU 7282-EXIT.
           IF WSS-R254-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7280-BAD-CURRENCY 
              IF WSH-R254-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R254-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R254-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R254-2ND-DBK
                   ON ERROR GO TO 7280-BAD-CURRENCY 
              MOVE R254-DTE-BGN-EFFV   TO WSH-R254-2ND-DTE-BGN  
              PERFORM 7286-END-DTE-R254          THRU 7286-EXIT 
              ADD 1                    TO WSA-R254-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7280-EXIT. 

       7280-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7280-EXIT.   
           EXIT.

      *******************************************************   
      *** R254 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7282-FET-DET-R254.   
           MOVE 0                      TO WSS-R254-EOS. 
           FETCH NEXT WSH-R254-NAME WITHIN  
                 S101-CASE-NAME-ADR SET 
                      ON ERROR GO TO 7282-ERROR.

       7282-CHECK-VALID-REC.
M313       IF R254-DTE-END-EFFV = 0000000   
                 GO TO 7282-EXIT
           ELSE 
R029          MOVE 1                   TO WSS-R254-EOS  
R029          GO TO 7282-EXIT.  

       7282-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R254-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7282-EXIT.   
           EXIT.

      *******************************************************   
      *** R254 . IDENTIFY THE RECORD THAT IS OLD          ***   
      *** AND PUT IT TO ATE01D08 TO BE UPDATED LATER.     ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7286-END-DTE-R254.   
           IF WSH-R254-1ST-DTE-BGN  <  WSH-R254-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R254'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 
           ELSE 
           IF WSH-R254-1ST-DTE-BGN  >  WSH-R254-2ND-DTE-BGN 
              MOVE R666-NBR-CASE       TO WSH-CNTY-CASE-NBR 
              MOVE 'R254'              TO WSH-RECORD-TYPE   
              PERFORM 8580-WRITE-ATE01D08        THRU 8580-EXIT 

              MOVE WSH-R254-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R254-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R254-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE R666-NBR-CASE       TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7286-EXIT.   
           EXIT.

      *******************************************************   
      *** R246 CASE SECTION                               ***   
      *** 6 SETS DESCRIBED, IN THE SEQUENCE :             ***   
      ***   . S535-CM-CASE-BDGT                           ***   
      ***   . S396-CM-BDGT-INFO                           ***   
      ***   . S535-CM-ALT-GG                              ***   
      ***   . S535-CM-HMO-BULK-MAIL                       ***   
      ***   . S535-CM-BDGT-MBR-RLTN                       ***   
      ***   . S535-CM-BDGT-INFO                           ***   
      ***                                                 ***   
      *** THIS AREA IS OPEN FOR UPDATE AND WUD SEE QUITE  ***   
      *** A FEW UPDATES. THE FOLLOWING RECORDS ARE BEING  ***   
      *** STORED :                                        ***   
      ***   . R255                                        ***   
      *******************************************************   

      *******************************************************   
      *** COMMON PROCESING LOGIC FOR VIA SET RECORDS.     ***   
      ***   . MAIN LINE WILL PERFORM THE DB FETCH         ***   
      ***     AND SUCCESS/FAILURE MUST BE INDICATED IN    ***   
      ***     WSS-R001-REDC SWITCH.                       ***   
      ***                                                 ***   
      ***   . FIRST VALID REC WITH 0 END-DTE AND          ***   
      ***     BEGIN DATE WITHIN CURRENT PAYMENT DATE WILL ***   
      ***     INDICATE A SUCCESSFUL FIRST REC READ.       ***   
      ***                                                 ***   
      ***   . ATEMPT WILL BE MADE TO READ ONE MORE REC    ***   
      ***     WITH ABOVE CONDITIONS.                      ***   
      ***     IF FOUND, THE LATEST REC WILL BE KEPT       ***   
      ***     FOR PROCESSING AND OLDER REC WILL BE        ***   
      ***     END DATED.( I.E.    M O D I F I E D !!)     ***   
      *******************************************************   
       7300-R246-SECTION SECTION.   

      *******************************************************   
      *** R246 CASE ENTRY PT RECORD.                      ***   
      *******************************************************   
       7300-FETCH-R246. 
R069       IF  WSA-R246-REC-CNT  =  0   
R069           FETCH  FIRST  R246-CM-CASE  WITHIN  CALCR246-AN AREA 
R069               ON ERROR  GO  TO  7300-ERROR 
R069       ELSE 
R069           FIND  CURRENT  R246-CM-CASE  RECORD  
R069           FETCH  NEXT  R246-CM-CASE WITHIN CALCR246-AN AREA
R069               ON ERROR  GO  TO  7300-ERROR.
R069       ADD  1  TO  WSA-R246-REC-CNT 
R069                   WSA-R666-CHKPT-REC-CNT.  
R069   7300-ERROR.  
R069       IF  ERROR-STATUS  =  '000000'
R069           MOVE  'Y'  TO  WSS-R246-FOUND
R069       ELSE 
R069           IF  ERROR-CODE  =  '06'  OR  '07'  OR  '13'  
R069               MOVE  'Y'  TO  WSS-R246-EOA  
R069           ELSE 
R069               PERFORM  7995-DB-ERROR  THRU  7995-EXIT. 
R069   7300-EXIT.    EXIT.  
R069   7305-FETCH-R246. 
R069       FETCH  R246-CM-CASE  RECORD  ON ERROR  GO  TO  7305-ERROR.   
R069   7305-ERROR.  
R069       IF  ERROR-STATUS  =  ZEROES  
R069           NEXT  SENTENCE   
R069       ELSE 
R069           PERFORM  7995-DB-ERROR  THRU  7995-EXIT. 
R069   7305-EXIT.    EXIT.  

      *******************************************************   
      *** R249-CM-BDGT RECORD                             ***   
      *** S535. ONLY RECORD IN SET.                       ***   
      *******************************************************   
       7310-FETCH-R249. 
           MOVE 0                      TO WSS-R249-EOS. 
           MOVE 0                      TO WSS-R249-REC. 
R056       IF WSS-R249-FIRST-ON 
R056          MOVE 0                   TO WSS-R249-FIRST
R056          FETCH FIRST WSH-R249-NAME WITHIN  
R056             S535-CM-CASE-BDGT SET  
R056                  ON ERROR GO TO 7310-ERROR 
R056       ELSE 
R056          PERFORM 2339D-FIND-CURRENT-R249  THRU 2339D-EXIT  
R056          FETCH NEXT WSH-R249-NAME WITHIN   
R056             S535-CM-CASE-BDGT SET  
R056                  ON ERROR GO TO 7310-ERROR.
TEST****
TEST****   DISPLAY 'R249-NBR-CASE = ' R246-NBR-CASE 
TEST****           R249-CDE-CATEGORY  R249-NBR-GROUP-GRANT  
TEST****                                     UPON PRINTER.  
R056****   DISPLAY 'NBR# '   WSH-ERR-PARA-NO UPON PRINTER.  


       7310-PROCESS.
           ADD 1                       TO WSA-R249-REC-CNT. 
           MOVE 1                      TO WSS-R249-REC. 
           GO TO 7310-EXIT. 

       7310-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R249-EOS  
              MOVE 0                   TO WSS-R249-REC  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7310-EXIT.   
           EXIT.

R067   7311-FIND-CURR-R249. 
R067       FIND  CURRENT  R249-CASH-MEDICAL-BUDGET  RECORD  ON ERROR
R067           GO TO  7311-ERROR.   
R067       GO  TO  7311-EXIT.   
R067   7311-ERROR.  
R067       PERFORM  7995-DB-ERROR  THRU  7995-EXIT. 
R067   7311-EXIT.    EXIT.  
      *******************************************************   
      *** R634 . ONLY RECORD WITHIN THE SET.              ***   
      *** SET S396.                                       ***   
      ***      . POSSIBILITY OF A FUTURE BUDGET EXISTS.   ***   
      ***      . ATTEMPTS WUD BE MADE TO FETCH A LIVE     ***   
      ***        634 REC, SO THAT PROCESSING MAY CONTINUE.***   
      ***      . NO LIVE 634, BUT A FUTURE 634, WILL NOT  ***   
      ***        BE AN ERROR, BUT WILL BE BYPASSED.       ***   
      ***      . NO 0 END DATED 634 REC WILL BE AN ERROR. ***   
      ***                                                 ***   
      ***      . FUTURE-REC-SW WILL BE SET IF A VALID     ***   
      ***        FUTURE REC EXISTS.                       ***   
      *******************************************************   
       7320-FETCH-R634. 
           MOVE ZEROS                  TO WSS-R634-REC. 
           MOVE ZEROS                  TO WSS-R634-FUTURE-REC.  
R070       MOVE  'N'  TO  WSS-FUT-CLOS. 

       7320-FETCH-FIRST-R634.   
           PERFORM 7322-FET-DET-R634             THRU 7322-EXIT.
           IF WSS-R634-EOS-ON   
              GO TO 7320-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R634-1ST-DBK 
                   ON ERROR GO TO 7320-BAD-CURRENCY 
              MOVE R634-DTE-BGN-EFFV   TO WSH-R634-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R634-REC  
              ADD 1                    TO WSA-R634-REC-CNT. 

       7320-FETCH-SECOND-R634.  
           PERFORM 7322-FET-DET-R634             THRU 7322-EXIT.
           IF WSS-R634-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7320-BAD-CURRENCY 
              IF WSH-R634-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R634-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R634-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R634-2ND-DBK
                   ON ERROR GO TO 7320-BAD-CURRENCY 
              MOVE R634-DTE-BGN-EFFV   TO WSH-R634-2ND-DTE-BGN  
              PERFORM 7326-END-DTE-R634          THRU 7326-EXIT 
              ADD 1                    TO WSA-R634-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7320-EXIT. 

       7320-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7320-EXIT.   
           EXIT.

      *******************************************************   
      *** R634 . DETAIL DB FETCH.                         ***   
      *** SPECIAL LOGIC. LOOK CAREFULLY.                  ***   
      *** R634 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7322-FET-DET-R634.   
           MOVE 0                      TO WSS-R634-EOS. 
           FETCH NEXT WSH-R634-NAME WITHIN  
                 S396-CM-BDGT-INFO SET  
                      ON ERROR GO TO 7322-ERROR.

       7322-CHECK-VALID-REC.
M313       IF R634-DTE-END-EFFV > 0000000   
R029          MOVE 1                   TO WSS-R634-EOS  
R029          GO TO 7322-EXIT.  
R070       IF  R634-DTE-CLOSED-BDGT  >  0  AND  
R070           R634-DTE-END-EFFV     =  0   
TEST  *            DISPLAY  'FUTURE CLOSE DATE SWITCH SET FOR ' 
TEST  *                R246-NBR-CASE  UPON  PRINTER 
R070           MOVE  'Y'  TO  WSS-FUT-CLOS. 
M313       IF R634-DTE-END-EFFV = 0000000   
              IF R634-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE   
                  GO TO 7322-EXIT   
              ELSE  
                  MOVE 1               TO WSS-R634-FUTURE-REC.  

           GO TO 7322-FET-DET-R634. 
       7322-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R634-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7322-EXIT.   
           EXIT.

      *******************************************************   
      *** R634 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7326-END-DTE-R634.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R634'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R634-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R634-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R634-1ST-DTE-BGN  <  WSH-R634-2ND-DTE-BGN 
              MOVE WSH-R634-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R634-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R634-DTE-END-EFFV   
              MOVE WSH-R634-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R634' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R634-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R634-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R634-1ST-DTE-BGN  >  WSH-R634-2ND-DTE-BGN 
M307          MOVE WSH-RECUR-PAYDATE             TO R634-DTE-END-EFFV   
              MOVE WSH-R634-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R634' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R634-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R634-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R634-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7326-EXIT.   
           EXIT.

      *******************************************************   
      *** R634 . MODIFY.                                  ***   
      *******************************************************   
       7328-MODIFY-R634.
           MODIFY R634-CM-BUDGET-INFO RECORD
                  ON ERROR GO TO 7328-ERROR.
R078       MOVE 'R634' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R065       MOVE  'Y'  TO  WSS-UPDATE-FLAG.  

       7328-PROCESS.
           GO TO 7328-EXIT. 

       7328-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7328-EXIT.   
           EXIT.

R056   7330-STORE-R634. 
R056       STORE R634-CM-BUDGET-INFO
R070             ON ERROR GO TO 7330-ERROR. 
R078       MOVE 'R634' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R065       MOVE  'Y'  TO  WSS-UPDATE-FLAG.  
R056
R056   7330-PROCESS.
R056       GO TO 7330-EXIT. 
R056
R056   7330-ERROR.  
R056       PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.
R056
R056   7330-EXIT.   
R056       EXIT.
R056
      *******************************************************   
      *** R252 . 1ST  RECORD WITHIN THE SET.              ***   
      *** SET S536.                                       ***   
      *******************************************************   
       7350-FETCH-R252. 
           MOVE ZEROS                  TO WSS-R252-REC. 

       7350-FETCH-FIRST-R252.   
           PERFORM 7352-FET-DET-R252             THRU 7352-EXIT.
           IF WSS-R252-EOS-ON   
              GO TO 7350-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R252-1ST-DBK 
                   ON ERROR GO TO 7350-BAD-CURRENCY 
              MOVE R252-DTE-BGN-EFFV   TO WSH-R252-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R252-REC  
              ADD 1                    TO WSA-R252-REC-CNT. 

       7350-FETCH-SECOND-R252.  
           PERFORM 7352-FET-DET-R252             THRU 7352-EXIT.
           IF WSS-R252-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7350-BAD-CURRENCY 
              IF WSH-R252-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R252-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R252-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R252-2ND-DBK
                   ON ERROR GO TO 7350-BAD-CURRENCY 
              MOVE R252-DTE-BGN-EFFV   TO WSH-R252-2ND-DTE-BGN  
              PERFORM 7356-END-DTE-R252          THRU 7356-EXIT 
              ADD 1                    TO WSA-R252-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7350-EXIT. 

       7350-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7350-EXIT.   
           EXIT.

      *******************************************************   
      *** R252 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7352-FET-DET-R252.   
           MOVE 0                      TO WSS-R252-EOS. 
           FETCH NEXT WSH-R252-NAME WITHIN  
                 S536-CM-ALT-CG SET 
                      ON ERROR GO TO 7352-ERROR.

       7352-CHECK-VALID-REC.
M313       IF R252-DTE-END-EFFV > 0000000   
R029          MOVE 1                   TO WSS-R252-EOS  
R029          GO TO 7352-EXIT.  
M313       IF R252-DTE-END-EFFV = 0000000 AND   
              R252-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7352-EXIT   
           ELSE 
                  GO TO 7352-FET-DET-R252.  
       7352-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R252-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7352-EXIT.   
           EXIT.

      *******************************************************   
      *** R252 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7356-END-DTE-R252.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R252'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R252-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R252-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R252-1ST-DTE-BGN  <  WSH-R252-2ND-DTE-BGN 
              MOVE WSH-R252-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R252-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R252-DTE-END-EFFV   
              MOVE WSH-R252-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R252' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R252-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R252-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R252-1ST-DTE-BGN  >  WSH-R252-2ND-DTE-BGN 
M307          MOVE WSH-RECUR-PAYDATE             TO R252-DTE-END-EFFV   
              MOVE WSH-R252-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R252' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R252-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R252-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R252-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7356-EXIT.   
           EXIT.

      *******************************************************   
      *** R253 . 2ND  RECORD WITHIN THE SET.              ***   
      *** SET S536.                                       ***   
      *******************************************************   
       7360-FETCH-R253. 
           MOVE ZEROS                  TO WSS-R253-REC. 

       7360-FETCH-FIRST-R253.   
           PERFORM 7362-FET-DET-R253             THRU 7362-EXIT.
           IF WSS-R253-EOS-ON   
              GO TO 7360-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R253-1ST-DBK 
                   ON ERROR GO TO 7360-BAD-CURRENCY 
              MOVE R253-DTE-BGN-EFFV   TO WSH-R253-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R253-REC  
              ADD 1                    TO WSA-R253-REC-CNT. 

       7360-FETCH-SECOND-R253.  
           PERFORM 7362-FET-DET-R253             THRU 7362-EXIT.
           IF WSS-R253-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7360-BAD-CURRENCY 
              IF WSH-R253-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R253-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R253-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R253-2ND-DBK
                   ON ERROR GO TO 7360-BAD-CURRENCY 
              MOVE R253-DTE-BGN-EFFV   TO WSH-R253-2ND-DTE-BGN  
              PERFORM 7366-END-DTE-R253          THRU 7366-EXIT 
              ADD 1                    TO WSA-R253-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7360-EXIT. 

       7360-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7360-EXIT.   
           EXIT.

      *******************************************************   
      *** R253 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7362-FET-DET-R253.   
           MOVE 0                      TO WSS-R253-EOS. 
           FETCH NEXT WSH-R253-NAME WITHIN  
                 S536-CM-ALT-CG SET 
                      ON ERROR GO TO 7362-ERROR.

       7362-CHECK-VALID-REC.
M313       IF R253-DTE-END-EFFV > 0000000   
R029          MOVE 1                   TO WSS-R253-EOS  
R029          GO TO 7362-EXIT.  
M313       IF R253-DTE-END-EFFV = 0000000 AND   
              R253-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7362-EXIT   
           ELSE 
                  GO TO 7362-FET-DET-R253.  

       7362-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R253-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7362-EXIT.   
           EXIT.

      *******************************************************   
      *** R253 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7366-END-DTE-R253.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R253'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R253-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R253-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R253-1ST-DTE-BGN  <  WSH-R253-2ND-DTE-BGN 
              MOVE WSH-R253-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R253-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R253-DTE-END-EFFV   
              MOVE WSH-R253-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R253' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R253-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R253-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R253-1ST-DTE-BGN  >  WSH-R253-2ND-DTE-BGN 
M307          MOVE WSH-RECUR-PAYDATE             TO R253-DTE-END-EFFV   
              MOVE WSH-R253-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R253' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R253-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R253-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R253-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7366-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . 3RD  RECORD WITHIN THE SET.              ***   
      *** SET S536.                                       ***   
      *******************************************************   
       7370-FETCH-R255. 
           MOVE ZEROS                  TO WSS-R255-REC. 

       7370-FETCH-FIRST-R255.   
           PERFORM 7372-FET-DET-R255             THRU 7372-EXIT.
           IF WSS-R255-EOS-ON   
              GO TO 7370-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R255-1ST-DBK 
                   ON ERROR GO TO 7370-BAD-CURRENCY 
              MOVE R255-DTE-BGN-EFFV   TO WSH-R255-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R255-REC  
              ADD 1                    TO WSA-R255-REC-CNT. 

       7370-FETCH-SECOND-R255.  
           PERFORM 7372-FET-DET-R255             THRU 7372-EXIT.
           IF WSS-R255-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7370-BAD-CURRENCY 
              IF WSH-R255-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R255-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R255-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R255-2ND-DBK
                   ON ERROR GO TO 7370-BAD-CURRENCY 
              MOVE R255-DTE-BGN-EFFV   TO WSH-R255-2ND-DTE-BGN  
              PERFORM 7376-END-DTE-R255          THRU 7376-EXIT 
              ADD 1                    TO WSA-R255-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7370-EXIT. 

       7370-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7370-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7372-FET-DET-R255.   
           MOVE 0                      TO WSS-R255-EOS. 
           FETCH NEXT WSH-R255-NAME WITHIN  
                 S536-CM-ALT-CG SET 
                      ON ERROR GO TO 7372-ERROR.

       7372-CHECK-VALID-REC.
M313       IF R255-DTE-END-EFFV > 0000000   
R029          MOVE 1      TO WSS-R255-EOS   
R029          GO TO 7372-EXIT.  
M313       IF R255-DTE-END-EFFV = 0000000 AND   
              R255-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7372-EXIT   
           ELSE 
                  GO TO 7372-FET-DET-R255.  

       7372-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R255-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7372-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . SPECIAL FETCH VERSION.                   ***   
      *** IT IS USED IN DD BANK CHANGES ROUTINES AND      ***   
      *** WOULD RETURN ALL RECORDS WITHOUT DOING ANY DATE ***   
      *** CHECKS. CHECKS WUD BE PERFORMED IN CALLING PARA.***   
      *******************************************************   
       7374-FETCH-R255. 
           MOVE 0                      TO WSS-R255-EOS. 
           FETCH NEXT WSH-R255-NAME WITHIN  
                 S536-CM-ALT-CG SET 
                      ON ERROR GO TO 7374-ERROR.
           GO TO 7374-EXIT. 

       7374-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R255-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7374-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7376-END-DTE-R255.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R255'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R255-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R255-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R255-1ST-DTE-BGN  <  WSH-R255-2ND-DTE-BGN 
              MOVE WSH-R255-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R255-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R255-DTE-END-EFFV   
              MOVE WSH-R255-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R255' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R255-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R255-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R255-1ST-DTE-BGN  >  WSH-R255-2ND-DTE-BGN 
M307          MOVE WSH-RECUR-PAYDATE             TO R255-DTE-END-EFFV   
              MOVE WSH-R255-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R255' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R255-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R255-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R255-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7376-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . STORE                                    ***   
      *******************************************************   
       7378-STORE-R255. 
           STORE R255-CASH-GRANT
                 ON ERROR GO TO 7378-ERROR. 
R078       MOVE 'R255' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R065       MOVE  'Y'  TO  WSS-UPDATE-FLAG.  

       7378-PROCESS.
           ADD 1                       TO WSA-R255-STO-CNT. 
           GO TO 7378-EXIT. 

       7378-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7378-EXIT.   
           EXIT.

      *******************************************************   
      *** R255 . MODIFY                                   ***   
      *******************************************************   
       7379-MODIFY-R255.
           MODIFY R255-CASH-GRANT RECORD
                 ON ERROR GO TO 7379-ERROR. 
R078       MOVE 'R255' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R065       MOVE  'Y'  TO  WSS-UPDATE-FLAG.  

       7379-PROCESS.
           GO TO 7379-EXIT. 

       7379-ERROR.  
           PERFORM 7995-DB-ERROR                 THRU 7995-EXIT.

       7379-EXIT.   
           EXIT.

      *******************************************************   
      *** R269 . 4TH  RECORD WITHIN THE SET.              ***   
      *** SET S536.                                       ***   
      *******************************************************   
       7380-FETCH-R269. 
           MOVE ZEROS                  TO WSS-R269-REC. 

       7380-FETCH-FIRST-R269.   
           PERFORM 7382-FET-DET-R269             THRU 7382-EXIT.
           IF WSS-R269-EOS-ON   
              GO TO 7380-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R269-1ST-DBK 
                   ON ERROR GO TO 7380-BAD-CURRENCY 
              MOVE R269-DTE-BGN-EFFV   TO WSH-R269-1ST-DTE-BGN  
              MOVE 1                   TO WSS-R269-REC  
              ADD 1                    TO WSA-R269-REC-CNT. 

       7380-FETCH-SECOND-R269.  
           PERFORM 7382-FET-DET-R269             THRU 7382-EXIT.
           IF WSS-R269-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7380-BAD-CURRENCY 
              IF WSH-R269-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R269-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R269-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R269-2ND-DBK
                   ON ERROR GO TO 7380-BAD-CURRENCY 
              MOVE R269-DTE-BGN-EFFV   TO WSH-R269-2ND-DTE-BGN  
              PERFORM 7386-END-DTE-R269          THRU 7386-EXIT 
              ADD 1                    TO WSA-R269-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7380-EXIT. 

       7380-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7380-EXIT.   
           EXIT.

      *******************************************************   
      *** R269 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7382-FET-DET-R269.   
           MOVE 0                      TO WSS-R269-EOS. 
           FETCH NEXT WSH-R269-NAME WITHIN  
                 S536-CM-ALT-CG SET 
                      ON ERROR GO TO 7382-ERROR.

       7382-CHECK-VALID-REC.
M313          IF R269-DTE-END-EFFV > 0000000
R029             MOVE 1                   TO WSS-R269-EOS   
R029             GO TO     7382-EXIT.   
M313       IF R269-DTE-END-EFFV = 0000000  AND  
              R269-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7382-EXIT   
           ELSE 
                  GO TO 7382-FET-DET-R269.  
       7382-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R269-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7382-EXIT.   
           EXIT.

      *******************************************************   
      *** R269 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7386-END-DTE-R269.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R269'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R269-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R269-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R269-1ST-DTE-BGN  <  WSH-R269-2ND-DTE-BGN 
              MOVE WSH-R269-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R269-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R269-DTE-END-EFFV   
              MOVE WSH-R269-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R269' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R269-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R269-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R269-1ST-DTE-BGN  >  WSH-R269-2ND-DTE-BGN 
M307          MOVE WSH-RECUR-PAYDATE             TO R269-DTE-END-EFFV   
              MOVE WSH-R269-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R269' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R269-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R269-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R269-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7386-EXIT.   
           EXIT.

      *******************************************************   
      *** R260 . 1ST  RECORD WITHIN THE SET.              ***   
      *** SET S538.                                       ***   
      *******************************************************   
R069A *7400-FETCH-R260. 
R069A *    MOVE ZEROS                  TO WSS-R260-REC. 

R069A *7400-FETCH-FIRST-R260.   
R069A *    PERFORM 7402-FET-DET-R260             THRU 7402-EXIT.
R069A *    IF WSS-R260-EOS-ON   
R069A *       GO TO 7400-EXIT   
R069A *    ELSE 
R069A *       MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R260-1ST-DBK 
R069A *            ON ERROR GO TO 7400-BAD-CURRENCY 
R069A *       MOVE R260-DTE-BGN-EFFV   TO WSH-R260-1ST-DTE-BGN  
R069A *       MOVE 1                   TO WSS-R260-REC  
R069A *       ADD 1                    TO WSA-R260-REC-CNT. 

R069A *7400-FETCH-SECOND-R260.  
R069A *    PERFORM 7402-FET-DET-R260             THRU 7402-EXIT.
R069A *    IF WSS-R260-EOS-ON   
R069A *       MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
R069A *            ON ERROR GO TO 7400-BAD-CURRENCY 
R069A *       IF WSH-R260-1ST-DBK      NOT = WSH-FET-DBK
R069A *          MOVE WSH-R260-1ST-DBK TO WSH-FET-DBK   
R069A *          MOVE WSH-R260-NAME    TO WSH-RECORD-NAME   
R069A *          PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
R069A *       ELSE  
R069A *          NEXT SENTENCE  
R069A *    ELSE 
R069A *       MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R260-2ND-DBK
R069A *            ON ERROR GO TO 7400-BAD-CURRENCY 
R069A *       MOVE R260-DTE-BGN-EFFV   TO WSH-R260-2ND-DTE-BGN  
R069A *       PERFORM 7406-END-DTE-R260          THRU 7406-EXIT 
R069A *       ADD 1                    TO WSA-R260-END-DTE-CNT  
R069A *       ADD 1                    TO WSA-TOT-END-DTE-CNT.  
R069A *    GO TO 7400-EXIT. 

R069A *7400-BAD-CURRENCY.   
R069A *    PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.
R069A * 
R069A *7400-EXIT.   
R069A *    EXIT.

      *******************************************************   
      *** R260 . DETAIL DB FETCH.                         ***   
      *******************************************************   
R069A *7402-FET-DET-R260.   
R069A *    MOVE 0                      TO WSS-R260-EOS. 
R069A *    FETCH NEXT WSH-R260-NAME WITHIN  
R069A *          S538-CM-HMO-BULK-MAIL SET  
R069A *               ON ERROR GO TO 7402-ERROR.

R069A *7402-CHECK-VALID-REC.
R069A *    IF R260-DTE-END-EFFV = 0000000  AND  
R069A *       R260-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
R069A *           GO TO 7402-EXIT   
R069A *    ELSE 
R069A *           GO TO 7402-FET-DET-R260.  

R069A *7402-ERROR.  
R069A *    IF ERROR-CODE = '07' OR '13' OR '06' 
R069A *       MOVE 1                   TO WSS-R260-EOS  
R069A *    ELSE 
R069A *       PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

R069A *7402-EXIT.   
R069A *    EXIT.

      *******************************************************   
      *** R260 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
R069A *7406-END-DTE-R260.   
R069A *    MOVE 1                      TO ATE01D09-RECORD-TYPE. 
R069A *    MOVE 'R260'                 TO ATE01D09-FUTURE-REC-TYPE. 
R069A *    MOVE WSH-R260-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
R069A *    MOVE WSH-R260-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
R069A *    PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.
R069A * 
R069A *    IF WSH-R260-1ST-DTE-BGN  <  WSH-R260-2ND-DTE-BGN 
R069A *       MOVE WSH-R260-NAME       TO WSH-RECORD-NAME   
R069A *       MOVE WSH-R260-1ST-DBK    TO WSH-FET-DBK   
R069A *       PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

R069A *       MOVE WSH-RECUR-PAYDATE             TO R260-DTE-END-EFFV   
R069A *       MOVE WSH-R260-NAME       TO WSH-RECORD-NAME   
R069A *       PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

R069A *       MOVE WSH-R260-NAME       TO WSH-RECORD-NAME   
R069A *       MOVE WSH-R260-2ND-DBK    TO WSH-FET-DBK   
R069A *       PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

R069A *    ELSE 
R069A *    IF WSH-R260-1ST-DTE-BGN  >  WSH-R260-2ND-DTE-BGN 
R069A *       MOVE WSH-RECUR-PAYDATE             TO R260-DTE-END-EFFV   
R069A *       MOVE WSH-R260-NAME       TO WSH-RECORD-NAME   
R069A *       PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

R069A *       MOVE WSH-R260-NAME       TO WSH-RECORD-NAME   
R069A *       MOVE WSH-R260-1ST-DBK    TO WSH-FET-DBK   
R069A *       PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

R069A *    ELSE 
R069A *       MOVE 'W'                 TO WS-SML-MESSAGE-CAT
R069A *       MOVE 079                 TO WS-SML-MESSAGE-CODE   
R069A *       MOVE 'R260-DTE-BGN'      TO WS-SML-PARAM-1
R069A *       MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
R069A *       PERFORM 1810-DISPLAY-MSG. 

R069A *7406-EXIT.   
R069A *    EXIT.


      *******************************************************   
      *** R268 . ONLY RECORD WITHIN THE SET.              ***   
      *** SET S104.                                       ***   
      *******************************************************   
       7450-FETCH-R268. 
           MOVE ZEROS                  TO WSS-R268-REC. 
           MOVE ZEROS                  TO WSS-R268-EOS. 
           MOVE ZEROS                  TO R268-DTE-END-EFFV.
           FETCH NEXT R268-BUDGET-MEMBER-RELATION WITHIN
                 S104-CM-BDGT-MBR-RLTN SET  
                      ON ERROR GO TO 7450-ERROR.

       7450-CHECK-DTE-END.  
M313       IF R268-DTE-END-EFFV NOT = 0000000   
R029          MOVE  1      TO  WSS-R268-EOS 
R029          GO TO 7450-EXIT.  
R064       IF  WSH-R268-FIRST-RCPT  =  ZEROES   
R064           MOVE  R268-NBR-INDIV  TO  WSH-R268-FIRST-RCPT.   
       7450-PROCESS.
           IF R268-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
              ADD 1                    TO WSA-R268-REC-CNT  
              MOVE 1                   TO WSS-R268-REC. 
R053       GO TO 7450-EXIT. 

       7450-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R268-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7450-EXIT.   
           EXIT.

      *******************************************************   
      *** R268 . SECOND TYPE OF FETCH.                    ***   
      *** THIS PARA IS USED EXCLUSIVELY FOR DETERMINING   ***   
      *** FUTURE CLOSE INDIVIDUALS WHOSE DTE-END-FUTURE   ***   
      *** HAS BECOME <=    TO PAYMENT DATE - 1.           ***   
      ***                                                 ***   
      *** PARA DOES A BASIC DMS FETCH AND STATUS CHECKS   ***   
      *** BUT DOES NOT PERFORM ANY BEGIN DATE CHECK NOR   ***   
      *** DOES KEEPS ANY COUNT OF SUCH CASES.             ***   
      *** END-DTE COMES PRE-FORMATTED TO THIS PARA.       ***   
      *******************************************************   
       7460-FETCH-FUTURE-CLOSE-R268.
           MOVE ZEROS                  TO WSS-R268-REC. 
           MOVE ZEROS                  TO WSS-R268-EOS. 
           FETCH NEXT R268-BUDGET-MEMBER-RELATION WITHIN
                 S104-CM-BDGT-MBR-RLTN SET  
                      ON ERROR GO TO 7460-ERROR.

       7460-CHECK-DTE-END.  
M313       IF R268-DTE-END-EFFV > 0000000   
R029            MOVE  1  TO WSS-R268-EOS
R029            GO TO 7460-EXIT.
M313       IF R268-DTE-END-EFFV        = 0000000                    AND 
M313          R268-DTE-END-FUTURE NOT  = 0000000                    AND 
M307         (R268-DTE-END-FUTURE      < WSH-RECUR-PAYDATE  OR  
M307                                   = WSH-RECUR-PAYDATE) 
                MOVE 1                 TO WSS-R268-REC  
                GO TO 7460-EXIT 
           ELSE 
                GO TO 7460-FETCH-FUTURE-CLOSE-R268. 
       7460-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R268-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7460-EXIT.   
           EXIT.

      *******************************************************   
      *** SET S105. 6 RECORDS WITHIN SET.                 ***   
      *** THE SET IS TRAVERSED ONLY ONCE AND ON EACH      ***   
      *** FETCH IT UPDATES THE WST-S105-REC-DETAILS-TAB   ***   
      *** NOTING DOWN WHAT IT ACTUALLY FOUND .            ***   
      ***                                                 ***   
      *** AT THE END OF SET, THIS TABLE IS LOOKED UP      ***   
      *** TO DETERMINE WHICH RECORDS WERE FOUND, AND      ***   
      *** WHICH RECORDS NEED TO BE END-DATED.             ***   
      ***                                                 ***   
      *** DISPLAY OF TABLE IS FOR TESTING ONLY, & SHUD    ***   
      *** BE COMMENTED OUT BEFORE PROD.                   ***   
      *******************************************************   
       7470-FETCH-S105-RECS.
           EXIT.

       7470-MAKE-OWNER-OF-SET-CUR.  
           MOVE WSH-R249-NAME          TO WSH-RECORD-NAME.  
           PERFORM 7100-FIND-CUR-IN-REC          THRU 7100-EXIT.

       7470-PROCESS-S105.   
           PERFORM 7475-FET-DET-S105             THRU 7475-EXIT.
           PERFORM 7480-BUILD-S105-TABLE         THRU 7480-EXIT 
                   UNTIL WSS-S105-EOS-ON.   
TEST  *    PERFORM 7485-DISPLAY-S105-TABLE       THRU 7485-EXIT 
TEST  *            VARYING WSI-S105-REC-IDX FROM 1 BY 1 UNTIL   
TEST  *                    WSI-S105-REC-IDX > 6.
           PERFORM 7490-EXAMINE-S105-TABLE       THRU 7490-EXIT.

       7470-EXIT.   
           EXIT.

      ****************************************************  
      *** DETAIL FETCH OF S105 SET.                    ***  
      *** FETCH FORMAT-3 IS USED.                      ***  
      *** VALIDITY OF RECORD IE. END-DTE = 0, AND      ***  
      *** BGN-DTE <= 0 WILL BE CHECKED IN BUILD-TABLE. ***  
      ****************************************************  
       7475-FET-DET-S105.   
           MOVE 0                      TO WSS-S105-EOS. 
           FETCH NEXT RECORD WITHIN S105-CM-BDGT-INFO SET   
                 ON ERROR GO TO 7475-ERROR. 
           MOVE RECORD-NAME            TO WSH-RECORD-TYPE.  
           GO TO 7475-EXIT. 

       7475-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-S105-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7475-EXIT.   
           EXIT.

      ****************************************************  
      *** BUILD WST-S105-REC-DETAILS-TAB.              ***  
      *** REC-TYPE STATIC TABLE IS SEARCHED TO         ***  
      *** SEARCH ON RECORD-TYPE FOUND IN THE SET.      ***  
      *** THIS INDEX IS USED TO POINT TO FIRST         ***  
      *** DIMENSION IN S105-DETAILS TABLE.             ***  
      ***                                              ***  
      *** CHECK VALIDITY OF RECORD FETCHED.            ***  
      ***    RECORD MUST HAVE 0 END END-DTE AND        ***  
      ***    BEGIN-DATE MUST BE <= PAYMENT DTE.        ***  
      *** DO NOT BUILD THE TABLE FOR CLOSED/FUTURE     ***  
      *** RECORDS.                                     ***  
      ***                                              ***  
      *** MAXIMUM 2 OCCURENCES OF A REC-TYPE CAN BE    ***  
      *** STORED. > 2 OCCURENCES WILL BE WARNINGS.     ***  
      *** FOR EACH OCCURENCE STORE DBK & BEGIN-DATE.   ***  
      ***                                              ***  
      *** R256 IS NO LONGER BEING PROCESSED HERE.      ***  
      *** R679, 6TH OCCURENCE IS DELETED, TAB IS       ***  
      *** BLANKED OUT & SHUD NOT BE THERE. IF THERE    ***  
      *** DISPLAY ERROR MSG & EXIT.                    ***  
      ****************************************************  
       7480-BUILD-S105-TABLE.   
           SET WSI-S105-TYPE-IDX       TO 1.
           SEARCH WST-S105-REC-TYPE-TAB VARYING WSI-S105-TYPE-IDX   
             AT END 
                MOVE 'W'               TO WS-SML-MESSAGE-CAT
                MOVE 025               TO WS-SML-MESSAGE-CODE   
                MOVE WSH-RECORD-TYPE   TO WS-SML-PARAM-1
                MOVE WSH-CASE-BDGT-ID  TO WS-SML-PARAM-2
                PERFORM 1810-DISPLAY-MSG
                PERFORM 7475-FET-DET-S105        THRU 7475-EXIT 
                GO TO 7480-EXIT 
             WHEN WST-S105-REC-TYPE (WSI-S105-TYPE-IDX) 
                                       = WSH-RECORD-TYPE
                SET WSI-S105-REC-IDX   TO WSI-S105-TYPE-IDX.

       7480-VAL-REC-N-SAVE-DATE.
           IF WSI-S105-TYPE-IDX = 1 
M313          IF R251-DTE-END-EFFV     = 0000000 AND
                 R251-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE   
                    MOVE R251-DTE-BGN-EFFV       TO WSH-DTE-BGN 
              ELSE  
                    PERFORM 7475-FET-DET-S105    THRU 7475-EXIT 
                    GO TO 7480-EXIT 
           ELSE 
           IF WSI-S105-TYPE-IDX = 2 
                    PERFORM 7475-FET-DET-S105    THRU 7475-EXIT 
                    GO TO 7480-EXIT 
           ELSE 
           IF WSI-S105-TYPE-IDX = 3 
M313          IF R257-DTE-END-EFFV     = 0000000 AND
                 R257-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE   
                    MOVE R257-DTE-BGN-EFFV       TO WSH-DTE-BGN 
              ELSE  
                    PERFORM 7475-FET-DET-S105    THRU 7475-EXIT 
                    GO TO 7480-EXIT 
           ELSE 
           IF WSI-S105-TYPE-IDX = 4 
M313          IF R258-DTE-END-EFFV     = 0000000 AND
                 R258-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE   
                    MOVE R258-DTE-BGN-EFFV       TO WSH-DTE-BGN 
              ELSE  
                    PERFORM 7475-FET-DET-S105    THRU 7475-EXIT 
                    GO TO 7480-EXIT 
           ELSE 
           IF WSI-S105-TYPE-IDX = 5 
M313          IF R259-DTE-END-EFFV     = 0000000 AND
                 R259-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE   
                    MOVE R259-DTE-BGN-EFFV       TO WSH-DTE-BGN 
              ELSE  
                    PERFORM 7475-FET-DET-S105    THRU 7475-EXIT 
                    GO TO 7480-EXIT 
           ELSE 
           IF WSI-S105-TYPE-IDX = 6 
              NEXT SENTENCE 
           ELSE 
              NEXT SENTENCE.

       7480-SAVE-DBK.   
           MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-FET-DBK 
                ON ERROR GO TO 7990-BAD-CURRENCY.   

       7480-WHICH-REC-OCCURENCE.
           IF WST-REC-SW (WSI-S105-REC-IDX   1)  = 0
              MOVE 1                   TO WST-REC-SW
                                          (WSI-S105-REC-IDX 1)  
              MOVE WSH-FET-DBK         TO WST-REC-DBK   
                                          (WSI-S105-REC-IDX 1)  
              MOVE WSH-DTE-BGN         TO WST-REC-DTE-BGN   
                                          (WSI-S105-REC-IDX 1)  
           ELSE 
           IF WST-REC-SW (WSI-S105-REC-IDX   2)  = 0
              MOVE 1                   TO WST-REC-SW
                                          (WSI-S105-REC-IDX 2)  
              MOVE WSH-FET-DBK         TO WST-REC-DBK   
                                          (WSI-S105-REC-IDX 2)  
              MOVE WSH-DTE-BGN         TO WST-REC-DTE-BGN   
                                          (WSI-S105-REC-IDX 2)  
           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 025                 TO WS-SML-MESSAGE-CODE   
              MOVE WSH-RECORD-TYPE     TO WSH-OCC-GT-2-REC-TYPE 
              MOVE WSH-OCC-GT-2-MSG    TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG  
              PERFORM 7475-FET-DET-S105          THRU 7475-EXIT 
              GO TO 7480-EXIT.  

       7480-FETCH-NEXT-S105-REC.
           PERFORM 7475-FET-DET-S105             THRU 7475-EXIT.

       7480-EXIT.   
           EXIT.

      ****************************************************  
      *** DISPLAY WST-S105-REC-DETAILS-TAB.            ***  
      *** THIS CODE IS FOR TEST-PURPOSES.              ***  
      ****************************************************  
       7485-DISPLAY-S105-TABLE. 
           DISPLAY WST-REC-SW         (WSI-S105-REC-IDX       1)
                   UPON PRINTER.
           DISPLAY WST-REC-DBK        (WSI-S105-REC-IDX       1)
                   UPON PRINTER.
           DISPLAY WST-REC-DTE-BGN    (WSI-S105-REC-IDX       1)
                   UPON PRINTER.

           DISPLAY WST-REC-SW         (WSI-S105-REC-IDX       2)
                   UPON PRINTER.
           DISPLAY WST-REC-DBK        (WSI-S105-REC-IDX       2)
                   UPON PRINTER.
           DISPLAY WST-REC-DTE-BGN    (WSI-S105-REC-IDX       2)
                   UPON PRINTER.

       7485-EXIT.   
           EXIT.

      ****************************************************  
      *** EXAMINE WST-S105-REC-DETAILS-TAB.            ***  
      *** IF THE FIRST SW IS ON, CORRESPONDING REC-SW  ***  
      *** IS SET ON.                                   ***  
      *** IF THE SECOND SW IS ALSO ON, END DATING      ***  
      *** WILL BE SCHEDULED FOR THAT REC-TYPE.         ***  
      ****************************************************  
       7490-EXAMINE-S105-TABLE. 
           PERFORM 7495-EXAMINE-S105-TABLE-DET   THRU 7495-EXIT 
                   VARYING WSI-S105-REC-IDX FROM 1 BY 1 UNTIL   
                           WSI-S105-REC-IDX > 6.

       7490-EXIT.   
           EXIT.

      ****************************************************  
      *** DETAIL EXAMINE WST-S105-REC-DETAILS-TAB.     ***  
      ****************************************************  
       7495-EXAMINE-S105-TABLE-DET. 
           IF WSI-S105-REC-IDX = 2  
              GO TO 7495-EXIT.  

       7495-CHECK-1ST-SW.   
           IF WST-REC-SW (WSI-S105-REC-IDX   1) = 0 
              GO TO 7495-EXIT.  

       7495-SET-REC-FOUND-SW.   
           IF WSI-S105-REC-IDX = 1  
              MOVE 1                   TO WSS-R251-REC  
           ELSE 
           IF WSI-S105-REC-IDX = 3  
              MOVE 1                   TO WSS-R257-REC  
           ELSE 
           IF WSI-S105-REC-IDX = 4  
              MOVE 1                   TO WSS-R258-REC  
           ELSE 
           IF WSI-S105-REC-IDX = 5  
              MOVE 1                   TO WSS-R259-REC  
           ELSE 
           IF WSI-S105-REC-IDX = 6  
              NEXT SENTENCE 
           ELSE 
              NEXT SENTENCE.

       7495-CHECK-2ND-SW.   
           IF WST-REC-SW (WSI-S105-REC-IDX   2) = 0 
              IF WSI-S105-REC-IDX = 1   
                 MOVE CURRENCY STATUS FOR WSH-R251-NAME RECORD  
                                       TO WSH-FET-DBK ON ERROR  
                                          GO TO 7990-BAD-CURRENCY   
                 IF WST-REC-DBK (1 1)        NOT =  WSH-FET-DBK 
                    MOVE WST-REC-DBK (1 1)       TO WSH-FET-DBK 
                    MOVE WSH-R251-NAME TO WSH-RECORD-NAME   
                    PERFORM 7110-FETCH-REC-ON-KEY THRU 7110-EXIT
                    GO TO 7495-EXIT 
                 ELSE   
                    GO TO 7495-EXIT 
              ELSE  
              IF WSI-S105-REC-IDX = 3   
                 MOVE CURRENCY STATUS FOR WSH-R257-NAME RECORD  
                                       TO WSH-FET-DBK ON ERROR  
                                          GO TO 7990-BAD-CURRENCY   
                 IF WST-REC-DBK (3 1)        NOT =  WSH-FET-DBK 
                    MOVE WST-REC-DBK (3 1)       TO WSH-FET-DBK 
                    MOVE WSH-R257-NAME TO WSH-RECORD-NAME   
                    PERFORM 7110-FETCH-REC-ON-KEY THRU 7110-EXIT
                    GO TO 7495-EXIT 
                 ELSE   
                    GO TO 7495-EXIT 
              ELSE  
              IF WSI-S105-REC-IDX = 4   
                 MOVE CURRENCY STATUS FOR WSH-R258-NAME RECORD  
                                       TO WSH-FET-DBK ON ERROR  
                                          GO TO 7990-BAD-CURRENCY   
                 IF WST-REC-DBK (4 1)        NOT =  WSH-FET-DBK 
                    MOVE WST-REC-DBK (4 1)       TO WSH-FET-DBK 
                    MOVE WSH-R258-NAME TO WSH-RECORD-NAME   
                    PERFORM 7110-FETCH-REC-ON-KEY THRU 7110-EXIT
                    GO TO 7495-EXIT 
                 ELSE   
                    GO TO 7495-EXIT 
              ELSE  
              IF WSI-S105-REC-IDX = 5   
                 MOVE CURRENCY STATUS FOR WSH-R259-NAME RECORD  
                                       TO WSH-FET-DBK ON ERROR  
                                          GO TO 7990-BAD-CURRENCY   
                 IF WST-REC-DBK (5 1)        NOT =  WSH-FET-DBK 
                    MOVE WST-REC-DBK (5 1)       TO WSH-FET-DBK 
                    MOVE WSH-R259-NAME TO WSH-RECORD-NAME   
                    PERFORM 7110-FETCH-REC-ON-KEY THRU 7110-EXIT
                    GO TO 7495-EXIT 
                 ELSE   
                    GO TO 7495-EXIT 
              ELSE  
              IF WSI-S105-REC-IDX = 6   
                 NEXT SENTENCE  
              ELSE  
                 NEXT SENTENCE. 

       7495-END-DTE-RECORDS.
           IF WSI-S105-REC-IDX = 1  
              MOVE WST-REC-DBK     (1 1)         TO WSH-R251-1ST-DBK
              MOVE WST-REC-DBK     (1 2)         TO WSH-R251-2ND-DBK
              MOVE WST-REC-DTE-BGN (1 1)         TO WSH-R251-1ST-DTE-BGN
              MOVE WST-REC-DTE-BGN (1 2)         TO WSH-R251-2ND-DTE-BGN
              PERFORM 7506-END-DTE-R251          THRU 7506-EXIT 
           ELSE 
           IF WSI-S105-REC-IDX = 3  
              MOVE WST-REC-DBK     (3 1)         TO WSH-R257-1ST-DBK
              MOVE WST-REC-DBK     (3 2)         TO WSH-R257-2ND-DBK
              MOVE WST-REC-DTE-BGN (3 1)         TO WSH-R257-1ST-DTE-BGN
              MOVE WST-REC-DTE-BGN (3 2)         TO WSH-R257-2ND-DTE-BGN
              PERFORM 7526-END-DTE-R257          THRU 7526-EXIT 
           ELSE 
           IF WSI-S105-REC-IDX = 4  
              MOVE WST-REC-DBK     (4 1)         TO WSH-R258-1ST-DBK
              MOVE WST-REC-DBK     (4 2)         TO WSH-R258-2ND-DBK
              MOVE WST-REC-DTE-BGN (4 1)         TO WSH-R258-1ST-DTE-BGN
              MOVE WST-REC-DTE-BGN (4 2)         TO WSH-R258-2ND-DTE-BGN
              PERFORM 7536-END-DTE-R258          THRU 7536-EXIT 
           ELSE 
           IF WSI-S105-REC-IDX = 5  
              MOVE WST-REC-DBK     (5 1)         TO WSH-R259-1ST-DBK
              MOVE WST-REC-DBK     (5 2)         TO WSH-R259-2ND-DBK
              MOVE WST-REC-DTE-BGN (5 1)         TO WSH-R259-1ST-DTE-BGN
              MOVE WST-REC-DTE-BGN (5 2)         TO WSH-R259-2ND-DTE-BGN
              PERFORM 7546-END-DTE-R259          THRU 7546-EXIT 
           ELSE 
           IF WSI-S105-REC-IDX = 6  
              NEXT SENTENCE 
           ELSE 
              NEXT SENTENCE.

       7495-EXIT.   
           EXIT.

      *******************************************************   
      *** 7506 - 7556 ARE CALLED FROM TABLE-EXAMINE       ***   
      *** PROCESS.                                        ***   
      *** PLS NOTE THE DIFF IN END-DATING PROCESS :       ***   
      *** WHEN 1ST > 2ND , MAKE 2ND CURRENT BEFORE        ***   
      *** MODIFYING IT , BECAUSE IT MIGHT HAVE FOUND      ***   
      *** OTHER CLOSED/FUTURE OCCURENCES OF THAT REC TYPE.***   
      *** PROCESS.                                        ***   
      *** IN OTHER SECTIONS, IT IS NOT NECCESSARY,        ***   
      *** BECAUSE FURTHER FETCHING WUD STOP IF 2ND REC    ***   
      *** IS HIT, SO IT IS CURRENT.                       ***   
      *******************************************************   

      *******************************************************   
      *** R251 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7506-END-DTE-R251.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R251'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R251-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R251-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R251-1ST-DTE-BGN  <  WSH-R251-2ND-DTE-BGN 
              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R251-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R251-DTE-END-EFFV   
              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R251' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R251-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R251-1ST-DTE-BGN  >  WSH-R251-2ND-DTE-BGN 
              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R251-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R251-DTE-END-EFFV   
              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R251' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R251-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R251-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R251-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7506-EXIT.   
           EXIT.

      *******************************************************   
      *** R257 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7526-END-DTE-R257.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R257'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R257-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R257-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R257-1ST-DTE-BGN  <  WSH-R257-2ND-DTE-BGN 
              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R257-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R257-DTE-END-EFFV   
              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R257' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R257-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R257-1ST-DTE-BGN  >  WSH-R257-2ND-DTE-BGN 
              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R257-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R257-DTE-END-EFFV   
              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R257' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R257-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R257-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R257-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7526-EXIT.   
           EXIT.

      *******************************************************   
      *** R258 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7536-END-DTE-R258.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R258'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R258-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R258-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R258-1ST-DTE-BGN  <  WSH-R258-2ND-DTE-BGN 
              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R258-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R258-DTE-END-EFFV   
              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R258' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R258-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R258-1ST-DTE-BGN  >  WSH-R258-2ND-DTE-BGN 
              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R258-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R258-DTE-END-EFFV   
              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R258' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R258-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R258-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R258-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7536-EXIT.   
           EXIT.

      *******************************************************   
      *** R259 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7546-END-DTE-R259.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R259'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R259-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R259-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R259-1ST-DTE-BGN  <  WSH-R259-2ND-DTE-BGN 
              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R259-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R259-DTE-END-EFFV   
              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R259' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R259-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
           IF WSH-R259-1ST-DTE-BGN  >  WSH-R259-2ND-DTE-BGN 
              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R259-2ND-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

M307          MOVE WSH-RECUR-PAYDATE             TO R259-DTE-END-EFFV   
              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
R078          MOVE 'R259' TO D18-REC-CDE
              PERFORM 7120-MODIFY-GEN-DB-REC     THRU 7120-EXIT 

              MOVE WSH-R259-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R259-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R259-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7546-EXIT.   
           EXIT.

      *******************************************************   
      *** R256 . PROCESS.                                 ***   
      *** DIFF LOGIC EXISTS FOR R256. CHECK CAREFULLY.    ***   
      ***                                                 ***   
      *** 1. END DATING OF RECORDS IS DONE ONLY IF        ***   
      ***    A REC IS GOING CURRENT TODAY.                ***   
      ***    IT IS ASSUMED THAT FIRST REC HIT, WILL BE    ***   
      ***    A FUTURE-GOING-CURRENT, & HENCE ALL OTHER    ***   
      ***    PAST RECS WILL BE END-DATED & IGNORED.       ***   
      ***                                                 ***   
      *** 2. FOR BUILDING HISTORY, ALLOW-CODE WILL BE     ***   
      ***    USED ONLY FROM 1ST R256. ALL OTHERS WILL BE  ***   
      ***    DISPLAYED AS 'REMARKS'.                      ***   
      ***                                                 ***   
      *** 3. ALL ACTIVE RECORDS DBK WILL BE STORED IN     ***   
      ***    A TABLE, WHICH WILL BE USED TO BUILD OUTPUT  ***   
      ***    RECORDS.                                     ***   
      *******************************************************   
       7570-PRO-R256.   
           IF R256-DTE-BGN-EFFV = WSH-PAYMENT-DATE  
              MOVE 1                   TO WSS-R256-END-DTE. 

       7570-END-DTE-PAST-RECS.  
           IF WSS-R256-END-DTE-ON   
              IF R256-DTE-BGN-EFFV < WSH-PAYMENT-DATE   
                 MOVE 1                TO ATE01D09-RECORD-TYPE  
                 MOVE 'R256'           TO ATE01D09-FUTURE-REC-TYPE  
                 MOVE WSH-PAYMENT-DATE TO ATE01D09-FUTURE-DATE-1
                 MOVE R256-DTE-BGN-EFFV TO ATE01D09-FUTURE-DATE-2   
                 PERFORM 8590-WRITE-ATE01D09     THRU 8590-EXIT 

M307             MOVE WSH-RECUR-PAYDATE          TO R256-DTE-END-EFFV   
                 MOVE WSH-R256-NAME    TO WSH-RECORD-NAME   
R078             MOVE 'R256' TO D18-REC-CDE 
                 PERFORM 7120-MODIFY-GEN-DB-REC  THRU 7120-EXIT 

                 PERFORM 7580-FET-DET-R256       THRU 7580-EXIT 
                 GO TO 7570-EXIT.   

       7570-STORE-CDE-AMT-ALLOW.
           IF WSS-R256-FIRST = 0
              MOVE 1                   TO WSS-R256-FIRST
              MOVE 1                   TO WSS-R256-REC  
              PERFORM 7574-SETUP-WST-R256 VARYING WSH-I FROM 1 BY 1 
                      UNTIL WSH-I > R256-CNT-SPECIAL
           ELSE 
              MOVE 'R'                 TO WS-SML-MESSAGE-CAT
R043          DISPLAY 'SPECIAL ALLOWANCE TABLE SIZE EXCEEDED '  
R043                              UPON PRINTER  
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R256-GRP-TAB'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7570-STORE-REC-DBK-IN-TAB.   
           IF WSH-R256-DBK-TAB-SIZE < WSH-R256-DBK-TAB-MAX-SIZE 
              ADD 1                    TO WSH-R256-DBK-TAB-SIZE 
              SET WSI-R256-DBK-IDX     TO WSH-R256-DBK-TAB-SIZE 
              MOVE CURRENCY STATUS FOR WSH-R256-NAME RECORD 
                   TO WSH-FET-DBK ON ERROR GO TO 7990-BAD-CURRENCY  
              MOVE WSH-FET-DBK         TO WST-R256-DBK  
                                         (WSI-R256-DBK-IDX) 
           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
R043          DISPLAY 'SPECIAL ALLOWANCE TABLE SIZE EXCEEDED '  
R043                              UPON PRINTER  
              MOVE 049                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R256-DBK-TAB'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7570-FET-NEXT-R256.  
           PERFORM 7580-FET-DET-R256             THRU 7580-EXIT.

       7570-EXIT.   
           EXIT.
R070   7572-STORE-R251. 
R070       STORE  R251-SUSPENSION  ON  ERROR
R070           GO  TO  7572-ERROR.  
R078       MOVE 'R251' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R070       ADD  1  TO  WSA-R251-STO-CNT.
R070       GO  TO  7572-EXIT.   
R070   7572-ERROR.  
R070       PERFORM  7995-DB-ERROR  THRU  7995-EXIT. 
R070   7572-EXIT.   EXIT.   

      *******************************************************   
      *** SETUP R256 WST TABLE.                           ***   
      *******************************************************   
       7574-SETUP-WST-R256. 
           MOVE R256-CDE-ALLOW-SPECIAL (WSH-I)  
                                 TO WST-R256-CDE-ALLOW-SPECIAL (WSH-I). 
           MOVE R256-AMT-ALLOW-SPECIAL (WSH-I)  
                                 TO WST-R256-AMT-ALLOW-SPECIAL (WSH-I). 
           MOVE R256-TXT-DESC-SPECIAL  (WSH-I)  
                                 TO WST-R256-TXT-DESC-SPECIAL  (WSH-I). 

      *******************************************************   
      *** R256 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7580-FET-DET-R256.   
           MOVE 0                      TO WSS-R256-EOS. 
           FETCH NEXT WSH-R256-NAME WITHIN  
                 S105-CM-BDGT-INFO SET  
                      ON ERROR GO TO 7580-ERROR.

       7580-CHECK-VALID-REC.
M313       IF R256-DTE-END-EFFV = 0000000  AND  
              R256-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7580-EXIT   
           ELSE 
                  GO TO 7580-FET-DET-R256.  

       7580-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R256-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7580-EXIT.   
           EXIT.


      *******************************************************   
      *** R637 CM BUDGET RESULTS SECTION.                 ***   
      *** 2 SETS DESCRIBED :                              ***   
      ***   . S371-CM-RESULT                              ***   
      ***        . R653-CM-RESULT                         ***   
      ***   . S540-CM-RESULT-OVRD                         ***   
      ***        . R653-CM-OVRD                           ***   
      ***                                                 ***   
      *** THIS AREA IS OPEN FOR UPDATE AND WUD GET        ***   
      *** UPDATES FOR END DATED RECORDS.                  ***   
      *******************************************************   
       7600-R637-SECTION SECTION.   

      *******************************************************   
      *** R637-CMBDGT-EP RECORD.                          ***   
      *******************************************************   
       7600-FETCH-R637. 
           MOVE 0                      TO WSS-R637-REC. 
           MOVE R666-NBR-CASE          TO WSH-CASE-NUMBER      .
           MOVE R249-CDE-CATEGORY      TO WSH-CDE-CATEGORY     .
           MOVE R249-NBR-GROUP-GRANT   TO WSH-NBR-GROUP-GRANT  .
           MOVE WSH-CASE-BDGT-ID       TO R637-CMBDGT-ID       .
           FETCH WSH-R637-NAME RECORD   
                 ON ERROR GO TO 7600-ERROR. 

       7600-PROCESS.
           ADD 1                       TO WSA-R637-REC-CNT. 
           MOVE 1                      TO WSS-R637-REC    . 
           GO TO 7600-EXIT. 

       7600-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 0                   TO WSS-R637-REC  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7600-EXIT.   
           EXIT.

      *******************************************************   
      *** R653 . 1ST  RECORD WITHIN THE SET.              ***   
      *** SET S371.                                       ***   
      *******************************************************   
       7620-FETCH-R653. 
           MOVE ZEROS                  TO WSS-R653-REC. 

       7620-FETCH-FIRST-R653.   
           PERFORM 7624-FET-DET-R653             THRU 7624-EXIT.
           IF WSS-R653-EOS-ON   
              GO TO 7620-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R653-1ST-DBK 
                   ON ERROR GO TO 7620-BAD-CURRENCY 
              MOVE R653-DTE-BGN-EFFV             TO WSH-R653-1ST-DTE-BGN
              MOVE 1                   TO WSS-R653-REC  
              ADD 1                    TO WSA-R653-REC-CNT. 

       7620-FETCH-SECOND-R653.  
           PERFORM 7624-FET-DET-R653             THRU 7624-EXIT.
           IF WSS-R653-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7620-BAD-CURRENCY 
              IF WSH-R653-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R653-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R653-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R653-2ND-DBK
                   ON ERROR GO TO 7620-BAD-CURRENCY 
              MOVE R653-DTE-BGN-EFFV             TO WSH-R653-2ND-DTE-BGN
              PERFORM 7628-END-DTE-R653          THRU 7628-EXIT 
              ADD 1                    TO WSA-R653-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7620-EXIT. 

       7620-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7620-EXIT.   
           EXIT.

      *******************************************************   
      *** R653 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7624-FET-DET-R653.   
           MOVE 0                      TO WSS-R653-EOS. 
           FETCH NEXT WSH-R653-NAME WITHIN  
                 S371-CM-RESULT SET 
                      ON ERROR GO TO 7624-ERROR.

       7624-CHECK-VALID-REC.
R068       IF  R653-DTE-END-EFFV  >  ZEROES 
R068           MOVE  1  TO  WSS-R653-EOS
R068           GO  TO  7624-EXIT.   
M313       IF R653-DTE-END-EFFV = 0000000 AND   
              R653-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
                  GO TO 7624-EXIT   
           ELSE 
                  GO TO 7624-FET-DET-R653.  

       7624-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R653-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7624-EXIT.   
           EXIT.

R067   7625-FET-DET-R653.   
R067       MOVE 0                      TO WSS-R653-EOS. 
R067       FETCH NEXT WSH-R653-NAME WITHIN  
R067             S371-CM-RESULT SET 
R067                  ON ERROR GO TO 7625-ERROR.
R067   7625-CHECK-VALID-REC.
R068       IF  R653-DTE-END-EFFV  >  ZEROES 
R068           MOVE  1  TO  WSS-R653-EOS
R068           GO  TO  7625-EXIT.   
R067       IF R653-DTE-END-EFFV = 0000000 AND   
R067          R653-DTE-BGN-EFFV NOT > WSH-PAYMENT-DATE  
R067           MOVE  1  TO  WSS-R653-REC
R067              GO TO 7625-EXIT   
R067       ELSE 
R067              GO TO 7625-FET-DET-R653.  
R067   7625-ERROR.  
R067       IF ERROR-CODE = '07' OR '13' OR '06' 
R067          MOVE 1                   TO WSS-R653-EOS  
R067       ELSE 
R067          PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

R067   7625-EXIT.   
R067       EXIT.
      *******************************************************   
      *** R653 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7628-END-DTE-R653.   
           IF WSH-R653-1ST-DTE-BGN  <  WSH-R653-2ND-DTE-BGN 
R069           MOVE  R637-NBR-CASE    TO  WSH-CNTY-CASE-NBR 
R069           MOVE  'R653'           TO  WSH-RECORD-TYPE   
R069           PERFORM  8580-WRITE-ATE01D08  THRU  8580-EXIT
           ELSE 
           IF WSH-R653-1ST-DTE-BGN  >  WSH-R653-2ND-DTE-BGN 
R069           MOVE  R637-NBR-CASE    TO  WSH-CNTY-CASE-NBR 
R069           MOVE  'R653'           TO  WSH-RECORD-TYPE   
R069           PERFORM  8580-WRITE-ATE01D08  THRU  8580-EXIT
              MOVE WSH-R653-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R653-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R653-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
R069          PERFORM 1810-DISPLAY-MSG  
R069           MOVE  WSH-R653-NAME    TO  WSH-RECORD-NAME   
R069           MOVE  WSH-R653-1ST-DBK  TO  WSH-FET-DBK  
R069           PERFORM  7110-FETCH-REC-ON-KEY  THRU  7110-EXIT. 

       7628-EXIT.   
           EXIT.


      *******************************************************   
      *** R654 . 1ST  RECORD WITHIN THE SET.              ***   
      *** SET S371.                                       ***   
      *******************************************************   
       7640-FETCH-R654. 
           MOVE ZEROS                  TO WSS-R654-REC. 

       7640-FETCH-FIRST-R654.   
           PERFORM 7644-FET-DET-R654             THRU 7644-EXIT.
           IF WSS-R654-EOS-ON   
              GO TO 7640-EXIT   
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO WSH-R654-1ST-DBK 
                   ON ERROR GO TO 7640-BAD-CURRENCY 
              MOVE R654-DTE-BGN-PER-BNFT         TO WSH-R654-1ST-DTE-BGN
              MOVE 1                   TO WSS-R654-REC  
              ADD 1                    TO WSA-R654-REC-CNT. 

       7640-FETCH-SECOND-R654.  
           PERFORM 7644-FET-DET-R654             THRU 7644-EXIT.
           IF WSS-R654-EOS-ON   
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-FET-DBK 
                   ON ERROR GO TO 7640-BAD-CURRENCY 
              IF WSH-R654-1ST-DBK      NOT = WSH-FET-DBK
                 MOVE WSH-R654-1ST-DBK TO WSH-FET-DBK   
                 MOVE WSH-R654-NAME    TO WSH-RECORD-NAME   
                 PERFORM 7110-FETCH-REC-ON-KEY   THRU 7110-EXIT 
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              MOVE CURRENCY STATUS FOR RUN-UNIT TO  WSH-R654-2ND-DBK
                   ON ERROR GO TO 7640-BAD-CURRENCY 
              MOVE R654-DTE-BGN-PER-BNFT         TO WSH-R654-2ND-DTE-BGN
              PERFORM 7648-END-DTE-R654          THRU 7648-EXIT 
              ADD 1                    TO WSA-R654-END-DTE-CNT  
              ADD 1                    TO WSA-TOT-END-DTE-CNT.  
           GO TO 7640-EXIT. 

       7640-BAD-CURRENCY.   
           PERFORM 7990-BAD-CURRENCY             THRU 7990-EXIT.

       7640-EXIT.   
           EXIT.

      *******************************************************   
      *** R654 . DETAIL DB FETCH.                         ***   
      *******************************************************   
       7644-FET-DET-R654.   
           MOVE 0                      TO WSS-R654-EOS. 
           FETCH NEXT WSH-R654-NAME WITHIN  
                 S540-CM-RESULT-OVRD SET
                      ON ERROR GO TO 7644-ERROR.

       7644-CHECK-VALID-REC.
M313       IF R654-DTE-END-PER-BNFT  = 0000000 AND  
              R654-DTE-BGN-PER-BNFT NOT > WSH-PAYMENT-DATE  
                  GO TO 7644-EXIT   
           ELSE 
                  GO TO 7644-FET-DET-R654.  

       7644-ERROR.  
M313       IF ERROR-CODE = '07' OR '13' OR '06' 
              MOVE 1                   TO WSS-R654-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7644-EXIT.   
           EXIT.

R067   7645-FET-DET-R654.   
R067       MOVE 0                      TO WSS-R654-EOS. 
R067       FETCH NEXT WSH-R654-NAME WITHIN  
R067             S540-CM-RESULT-OVRD SET
R067                  ON ERROR GO TO 7645-ERROR.
R067   7645-CHECK-VALID-REC.
R067       IF R654-DTE-END-PER-BNFT  = 0000000 AND  
R067          R654-DTE-BGN-PER-BNFT NOT > WSH-PAYMENT-DATE  
R067           MOVE  'Y'  TO  WSS-R654-FOUND
R067              GO TO 7645-EXIT   
R067       ELSE 
R067              GO TO 7645-FET-DET-R654.  
R067   7645-ERROR.  
R067       IF ERROR-CODE = '07' OR '13' OR '06' 
R067          MOVE 1                   TO WSS-R654-EOS  
R067       ELSE 
R067          PERFORM 7995-DB-ERROR              THRU 7995-EXIT.
R067   7645-EXIT.   
R067       EXIT.
      *******************************************************   
      *** R654 . END DATE THE RECORD THAT IS OLD WITH     ***   
      *** PAYMENT-DATE-MINUS-1, & MODIFY IT.              ***   
      *** MAKE THE LATEST RECORD CURRENT.                 ***   
      *** IF THEY HAPPEN TO BE BEGINNING ON SAME DATE,    ***   
      *** DISPLAY IT AS ERROR.                            ***   
      *******************************************************   
       7648-END-DTE-R654.   
           MOVE 1                      TO ATE01D09-RECORD-TYPE. 
           MOVE 'R654'                 TO ATE01D09-FUTURE-REC-TYPE. 
           MOVE WSH-R654-1ST-DTE-BGN   TO ATE01D09-FUTURE-DATE-1.   
           MOVE WSH-R654-2ND-DTE-BGN   TO ATE01D09-FUTURE-DATE-2.   
           PERFORM 8590-WRITE-ATE01D09           THRU 8590-EXIT.

           IF WSH-R654-1ST-DTE-BGN  <  WSH-R654-2ND-DTE-BGN 
              MOVE WSH-R654-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R654-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 
           ELSE 
           IF WSH-R654-1ST-DTE-BGN  >  WSH-R654-2ND-DTE-BGN 
              MOVE WSH-R654-NAME       TO WSH-RECORD-NAME   
              MOVE WSH-R654-1ST-DBK    TO WSH-FET-DBK   
              PERFORM 7110-FETCH-REC-ON-KEY      THRU 7110-EXIT 

           ELSE 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
              MOVE 079                 TO WS-SML-MESSAGE-CODE   
              MOVE 'R654-DTE-BGN'      TO WS-SML-PARAM-1
              MOVE WSH-CASE-BDGT-ID    TO WS-SML-PARAM-2
              PERFORM 1810-DISPLAY-MSG. 

       7648-EXIT.   
           EXIT.


      *******************************************************   
      *** R270 RCOUPMT-CASE-BDGT SECTION.                 ***   
      *** 1 SET  DESCRIBED :                              ***   
      ***   . S178-RECOUPMENT                             ***   
      ***        . R271-RECOUPMENT                        ***   
      ***                                                 ***   
      *** THIS AREA IS OPEN FOR RETRIEVAL AND WUD NOT     ***   
      *** HAVE ANY UPDATES.                               ***   
      *******************************************************   
       7700-R270-SECTION SECTION.   

      *******************************************************   
      *** R270-RCOUPMT-CASE-BUDGET RECORD.                ***   
      *******************************************************   
       7700-FETCH-R270. 
           MOVE 0                      TO WSS-R270-REC. 
           MOVE R666-NBR-CASE          TO R270-NBR-CASE        .
           MOVE R249-CDE-CATEGORY      TO R270-CDE-CATEGORY    .
           MOVE R249-NBR-GROUP-GRANT   TO R270-NBR-GROUP-GRANT .
           FETCH R270-RCOUPMT-CASE-BUDGET RECORD
                 ON ERROR GO TO 7700-ERROR. 

       7700-PROCESS.
           ADD 1                       TO WSA-R270-REC-CNT. 
           MOVE 1                      TO WSS-R270-REC    . 
           GO TO 7700-EXIT. 

       7700-ERROR.  
           IF ERROR-CODE = '07' OR '13' 
              MOVE 0                   TO WSS-R270-REC  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7700-EXIT.   
           EXIT.

      *******************************************************   
      *** R271 . ONLY RECORD WITHIN THE SET.              ***   
      *** SET S178.                                       ***   
      *******************************************************   
       7720-FETCH-R271. 
           MOVE ZEROS                  TO WSS-R271-REC  .   
           MOVE ZEROS                  TO WSS-R271-EOS  .   
           MOVE R258-NBR-REFL          TO R271-NBR-REFL .   
           FETCH R271-RECOUPMENT VIA S178-RECOUPMENT
                 USING R271-NBR-REFL
                      ON ERROR GO TO 7720-ERROR.

       7720-PROCESS.
           ADD 1                       TO WSA-R271-REC-CNT .
           MOVE 1                      TO WSS-R271-REC     .
           GO TO 7720-EXIT. 

       7720-ERROR.  
           IF ERROR-CODE = '07' OR '13' 
              MOVE 1                   TO WSS-R271-EOS  
           ELSE 
              PERFORM 7995-DB-ERROR              THRU 7995-EXIT.

       7720-EXIT.   
           EXIT.

      *******************************************************   


      *******************************************************   
      *** THIS SECTION PROCESSES DATA BASE ERRORS.        ***   
      *******************************************************   
       7900-DB-ERROR-SECTION SECTION.   

      *******************************************************   
      *** THIS PARA IS INVOKED WHEN ONE OF THE MANDATORY  ***   
      *** RECORD IS MISSING. IT JUST DISPLAYS A MESSAGE   ***   
      *** BUT WUDNOT CAUSE PROG TO TERMINATE.             ***   
      ***                                                 ***   
      *** PARAM-1. SETUP AS CASE NO FOR CASE LEVEL ERRORS ***   
      ***          AND CASE/BDGT FOR BUDGET LEVEL ERRORS. ***   
      *** PARAM-2. COMES FILLED IN FROM CALLING PARA.     ***   
      ***                                                 ***   
      *** R270/271 ABSENT IS NOT FATAL AND WUD LET        ***   
      *** PROCESSING CONTINUE. BUT DO DISPLAY A MSG.      ***   
      *******************************************************   
       7900-MISSING-RECORD. 
           EXIT.

       7900-SET-MESSAGE-CAT.
           IF WS-SML-PARAM-2 = 'R270' OR 'R271' 
              MOVE 'W'                 TO WS-SML-MESSAGE-CAT
           ELSE 
              MOVE 1                   TO WSS-BDGT-MAND-REC-MISSING 
R073          MOVE 'W'                 TO WS-SML-MESSAGE-CAT.   

       7900-SET-OTHER-FIELDS.   
           MOVE 025                    TO WS-SML-MESSAGE-CODE.  
           MOVE WSH-CASE-BDGT-ID       TO WS-SML-PARAM-1.   
           PERFORM 1810-DISPLAY-MSG.
           IF WS-SML-BAD
              DISPLAY 'MANDATORY RECORD MISSING. ', 
                      WS-SML-PARAM-1, ' ',  
                      WS-SML-PARAM-2
                         UPON PRINTER.  

       7900-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA IS INVOKED WHEN THERE WAS A PROBLEM   ***   
      *** IN STORING THE CURRENCY STATUS FOR RUN-UNIT.    ***   
      *** IT WOULD DISPLAY 'BAD CURRENCY' AND DB ERRORS   ***   
      *** STATUS AND TERMINATE.                           ***   
      *******************************************************   
       7990-BAD-CURRENCY.   
           DISPLAY 'BAD CURRENCY FOR RUN-UNIT'   UPON PRINTER.  
           PERFORM GENERAL-ERROR-RTN.   
           SET SW-FATAL-ERROR-FLAG     TO ON.   
           MOVE 'F'                    TO WS-SML-MESSAGE-CAT.   
           MOVE 006                    TO WS-SML-MESSAGE-CODE.  
           MOVE R666-NBR-CASE          TO WS-SML-PARAM-1.   
           MOVE 'BAD DB CUR'           TO WS-SML-PARAM-2.   
           PERFORM 1810-DISPLAY-MSG.
           IF WS-SML-BAD
              DISPLAY 'MANDATORY RECORD MISSING. ', 
                      WS-SML-PARAM-1, ' ',  
                      WS-SML-PARAM-2
                         UPON PRINTER.  

       7990-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA IS INVOKED WHEN THERE WAS A PROBLEM   ***   
      *** IN A GENERAL DB ACCESS.                         ***   
      *** IT WOULD DISPLAY 'DATA-BASE ERROR' AND DB       ***   
      *** STATUS AND TERMINATE.                           ***   
      *******************************************************   
       7995-DB-ERROR.   
           DISPLAY 'GENERAL DATA-BASE ERROR  '   UPON PRINTER.  
           PERFORM GENERAL-ERROR-RTN.   
           SET SW-FATAL-ERROR-FLAG     TO ON.   
           MOVE 'F'                    TO WS-SML-MESSAGE-CAT.   
           MOVE 006                    TO WS-SML-MESSAGE-CODE.  
           MOVE R666-NBR-CASE          TO WS-SML-PARAM-1.   
           MOVE 'GEN DB ERR'           TO WS-SML-PARAM-2.   
           PERFORM 1810-DISPLAY-MSG.
           IF WS-SML-BAD
              DISPLAY 'MANDATORY RECORD MISSING. ', 
                      WS-SML-PARAM-1, ' ',  
                      WS-SML-PARAM-2
                         UPON PRINTER.  
       7995-EXIT.   
           EXIT.


      *******************************************************   
      *** SEQUENTIAL FILE WRITE SECTION.                  ***   
      *** SECTION 8500.                                   ***   
      *** FOLLOWING ENTRY POINTS ARE DEFINED :            ***   
      ***    . 8510     ATE01D01.                         ***   
      ***    . 8520     ATE01D02.                         ***   
      ***    . 8540     ATE01D04.                         ***   
      ***    . 8550     ATE01D05.                         ***   
      ***    . 8560     ATE01D06.                         ***   
      ***    . 8570     ATE01D06.                         ***   
      ***                                                 ***   
      *** EACH WRITE MODULE MAY PERFORM A DB RECORD MOVE  ***   
      *** TO AN EQUIVALENT WS RECORD. THE MOVES ARE DONE  ***   
      *** ON A FIELD LEVEL TO TAKE CARE OF VARIOUS DATA   ***   
      *** TYPES EXISTING IN THE DB RECORD AND A DESIRE    ***   
      *** TO HAVE UNIFORM DATA TYPES IN THE SEQ FILES.    ***   
      ***                                                 ***   
      *** THESE MOVES ARE CODED INDEPENDENTLY  IN         ***   
      *** SECTION 8700.                                   ***   
      ***                                                 ***   
      *** DETAILED PHYSICAL WRITES ARE CODED IN SECTION   ***   
      *** 8800.                                           ***   
      *******************************************************   

       8500-WRITE-SEQ-OUT-FILE-SECT SECTION.

      *******************************************************   
      *** WRITE ATE01D01 FILE.                            ***   
      *** ATE01D01 SHARES THE SAME RECORDS AND WRITE      ***   
      *** LOGIC WITH ATE01D07 FILE. (EXCEPTING THAT 07    ***   
      *** ALSO GETS AN EXTRA R954 REC).                   ***   
      ***                                                 ***   
      *** HOWEVER, ALL SUMMARY REPORT COUNTS ARE INCR-    ***   
      *** EMENTED ONLY IN ATE01D01 WRITE.                 ***   
      *** THIS IS OK, BECAUSE A WRITE TO 01D07 FILE IS    ***   
      *** ALWAYS FOLLOWED BY A WRITE TO 01D01 FILE IN     ***   
      *** THE MAIN CALLING LOGIC.                         ***   
      ***                                                 ***   
      *** FILE 01 RECORDS HAVE A PREFIX OF 'C'.           ***   
      *******************************************************   
       8510-WRITE-ATE01D01. 
           EXIT.

       8510-CHECK-MAND-REC-SW.  
           IF WSS-BDGT-MAND-REC-MISSING-ON  
              GO TO 8510-EXIT.  

       8510-ALL-OK-GO-AHEAD.
           ADD 1                       TO WSA-ATE01D01-BLK-CNT. 

       8510-CHECK-RCOUP-STUS-SW.
           IF WSS-R258-REC-ON AND   
              R258-CDE-STATUS-RCOUPMT NOT = 01  
                  MOVE 0               TO WSS-R258-REC  
                  MOVE 0               TO WSS-R270-REC  
                  MOVE 0               TO WSS-R271-REC. 

       8510-WRITE-R672. 
           PERFORM 8712-MOVE-R672                THRU 8712-EXIT.
           MOVE B672-CASE-ATTRIBS      TO C672-CASE-ATTRIBS.
           WRITE C672-CASE-ATTRIBS. 
           ADD 1                       TO WSA-ATE01D01-REC-CNT. 

R006  *** R253 IF FOUND, WILL BE FORMATTED AS R248. 
       8510-WRITE-R248-R253.
           IF WSS-R253-REC-ON   
              PERFORM 8738-MOVE-R253             THRU 8738-EXIT 
R006          MOVE B248-CASE-NAME      TO C248-CASE-NAME
R006          WRITE C248-CASE-NAME  
              ADD 1                    TO WSA-ATE01D01-REC-CNT  
           ELSE 
           IF WSS-R248-REC-ON   
              PERFORM 8716-MOVE-R248             THRU 8716-EXIT 
              MOVE B248-CASE-NAME      TO C248-CASE-NAME
              WRITE C248-CASE-NAME  
              ADD 1                    TO WSA-ATE01D01-REC-CNT. 

       8510-WRITE-R254-R269.
           IF NOT WSS-R253-REC-ON   
              IF WSS-R254-REC-ON
                 PERFORM 8718-MOVE-R254          THRU 8718-EXIT 
                 MOVE B254-SECOND-CASE-NAME 
                                       TO C254-SECOND-CASE-NAME 
                 WRITE C254-SECOND-CASE-NAME
                 ADD 1                 TO WSA-ATE01D01-REC-CNT  
              ELSE  
                 NEXT SENTENCE  
           ELSE 
              IF WSS-R269-REC-ON
                 PERFORM 8742-MOVE-R269          THRU 8742-EXIT 
                 MOVE B269-ALT-PAYEE-NAME2       TO C269-ALT-PAYEE-NAME2
                 WRITE C269-ALT-PAYEE-NAME2 
                 ADD 1                 TO WSA-ATE01D01-REC-CNT  
              ELSE  
                 NEXT SENTENCE. 

       8510-WRITE-R247-R252.
           IF WSS-R252-REC-ON   
              PERFORM 8736-MOVE-R252             THRU 8736-EXIT 
              MOVE B252-ALTERNATE-ADDRESS   
                                       TO C252-ALTERNATE-ADDRESS
              WRITE C252-ALTERNATE-ADDRESS  
              ADD 1                    TO WSA-ATE01D01-REC-CNT  
           ELSE 
           IF WSS-R247-REC-ON   
              PERFORM 8714-MOVE-R247             THRU 8714-EXIT 
              MOVE B247-CASE-ADDRESS   TO C247-CASE-ADDRESS 
              WRITE C247-CASE-ADDRESS   
              ADD 1                    TO WSA-ATE01D01-REC-CNT. 

       8510-WRITE-R634. 
           PERFORM 8734-MOVE-R634                THRU 8734-EXIT.
           MOVE B634-CM-BUDGET-INFO    TO C634-CM-BUDGET-INFO  .
           WRITE C634-CM-BUDGET-INFO.   
           ADD 1                       TO WSA-ATE01D01-REC-CNT .

       8510-GEN-CLOSED-BDGT-CNTS.   
           IF WSS-BDGT-PRORATED-CLOSE-ON
              ADD 1                    TO WSA-R-PRO-CLOSE-BDGT-CNT  
              ADD WS-PRORATION-AMT     TO WSA-R-PRO-CLOSE-BDGT-AMT .

       8510-WRITE-R255. 
           PERFORM 8740-MOVE-R255                THRU 8740-EXIT.
           IF WSS-BDGT-PRORATED-CLOSE-ON         AND
              NOT WSS-R654-REC-ON   
                 MOVE WS-PRORATION-AMT TO B255-AMT-GRANT-CASH  .

           MOVE B255-CASH-GRANT        TO C255-CASH-GRANT      .
           WRITE C255-CASH-GRANT.   
           ADD 1                       TO WSA-ATE01D01-REC-CNT .

       8510-WRITE-R654. 
           IF WSS-R654-REC-ON   
              PERFORM 8774-MOVE-R654             THRU 8774-EXIT 
              IF WSS-BDGT-PRORATED-CLOSE-ON 
                 MOVE WS-PRORATION-AMT TO B654-AMT-GR-CASH  
                 MOVE B654-CM-OVRD     TO C654-CM-OVRD  
                 WRITE C654-CM-OVRD 
                 ADD 1                 TO WSA-ATE01D01-REC-CNT  
              ELSE  
                 MOVE B654-CM-OVRD     TO C654-CM-OVRD  
                 WRITE C654-CM-OVRD 
                 ADD 1                 TO WSA-ATE01D01-REC-CNT. 

       8510-INC-CHECK-ISS-CNTS. 
R069       IF  WSS-BDGT-CASH-ISSNC      =  0  OR
R069           R634-CDE-STUS-BDGT       =  'S'  
R069           GO  TO  8510-WRITE-R256. 
           ADD 1                       TO WSA-R-CHK-ISS-BDGT-CNT.   

           IF WSS-BDGT-PRORATED-CLOSE-ON
              ADD WS-PRORATION-AMT     TO WSA-R-CHK-ISS-BDGT-AMT
           ELSE 
           IF WSS-R654-REC-ON   
              ADD R654-AMT-GR-CASH     TO WSA-R-CHK-ISS-BDGT-AMT
           ELSE 
              ADD R255-AMT-GRANT-CASH  TO WSA-R-CHK-ISS-BDGT-AMT.   

       8510-WRITE-R256. 
           IF WSS-R256-REC-ON   
              PERFORM 8514-WRITE-ATE01D01-R256   THRU 8514-EXIT 
                 VARYING WSI-R256-DBK-IDX FROM 1 BY 1   
                   UNTIL WSI-R256-DBK-IDX > WSH-R256-DBK-TAB-SIZE.  

       8510-WRITE-R257. 
           IF WSS-R257-REC-ON   
              PERFORM 8748-MOVE-R257             THRU 8748-EXIT 
              MOVE B257-NET-INCOME     TO C257-NET-INCOME   
              WRITE C257-NET-INCOME 
              ADD 1                    TO WSA-ATE01D01-REC-CNT .

       8510-WRITE-R258-R271.
           IF WSS-R258-REC-ON  AND  
              WSS-R271-REC-ON   
                 PERFORM 8750-MOVE-R258          THRU 8750-EXIT 
                 MOVE B258-RECOUPMENT-REFERRAL  
                                       TO C258-RECOUPMENT-REFERRAL  
                 WRITE C258-RECOUPMENT-REFERRAL 
                 ADD 1                 TO WSA-ATE01D01-REC-CNT  
                 PERFORM 8780-MOVE-R271          THRU 8780-EXIT 
                 MOVE B271-RECOUPMENT  TO C271-RECOUPMENT   
                 WRITE C271-RECOUPMENT  
                 ADD 1                 TO WSA-ATE01D01-REC-CNT  
R069             IF  WSS-BDGT-CLOSED-BEF-PERIOD-ON  OR  
R069                 WSS-BDGT-CASH-ISSNC      =  0  OR  
R069                 R634-CDE-STUS-BDGT       =  'S'
R069                 NEXT  SENTENCE 
R069             ELSE   
                     ADD 1                 TO WSA-R-RCOU-BDGT-CNT   
                     ADD R271-AMT-INSTMT   TO WSA-R-RCOU-BDGT-AMT.  

       8510-WRITE-R259. 
           IF WSS-R259-REC-ON   
              PERFORM 8752-MOVE-R259             THRU 8752-EXIT 
              MOVE B259-VENDOR-PAYMENT TO C259-VENDOR-PAYMENT   
              WRITE C259-VENDOR-PAYMENT 
              ADD 1                    TO WSA-ATE01D01-REC-CNT  
R069           IF  WSS-BDGT-CLOSED-BEF-PERIOD-ON  OR
R069               WSS-BDGT-CASH-ISSNC      =  0  OR
R069               R634-CDE-STUS-BDGT       =  'S'  
R069               NEXT  SENTENCE   
R069           ELSE 
R069              ADD 1                    TO WSA-R-VEND-BDGT-CNT   
R069              ADD R259-AMT-PAYMENT-VENDOR   
                                       TO WSA-R-VEND-BDGT-AMT.  
       8510-WRITE-R251. 
           IF WSS-R251-REC-ON   
              PERFORM 8744-MOVE-R251             THRU 8744-EXIT 
              MOVE B251-SUSPENSION     TO C251-SUSPENSION   
              WRITE C251-SUSPENSION 
              ADD 1                    TO WSA-ATE01D01-REC-CNT. 

       8510-INC-OPEN-BUDGET-COUNTS. 
           PERFORM 8518-OPEN-BUDGET-COUNTS       THRU 8518-EXIT.
R069       IF  (WSS-BDGT-CLOSED-BEF-PERIOD-ON  OR   
R069             WSS-BDGT-CASH-ISSNC-ON)   AND  
R070           (R255-AMT-GRANT-CASH  >  9.99   AND  
R070            R255-AMT-GRANT-CASH  <  1500.01)
R069           PERFORM  8512-WRITE-ATE01D01-R291  THRU  8512-EXIT.  

       8510-EXIT.   
           EXIT.

      *******************************************************   
      *** WRITE ATE01D01 FILE.                            ***   
      *** WRITE REC R291.                                 ***   
      *** FILE 01 RECORDS HAVE A PREFIX OF 'C'.           ***   
      *******************************************************   
       8512-WRITE-ATE01D01-R291.
R069       IF  WSS-BDGT-CASH-ISSNC  =  0      OR
R069           R634-CDE-STUS-BDGT   =  'S'  
R069           GO  TO  8512-EXIT.   
           PERFORM 8790-MOVE-R291                THRU 8790-EXIT.
           MOVE B291-BENEFIT           TO C291-BENEFIT. 
           WRITE C291-BENEFIT.  
           ADD 1                       TO WSA-ATE01D01-REC-CNT. 

       8512-EXIT.   
           EXIT.

      *******************************************************   
      *** WRITE R256 TO ATE01D01 FILE.                    ***   
      *** ALL R256 RECORDS WILL BE WRITTEN.               ***   
      *** FILE 01 HAS A PREFIX OF 'C'.                    ***   
      *******************************************************   
       8514-WRITE-ATE01D01-R256.
           EXIT.

       8514-FETCH-R256-ON-KEY.  
           MOVE WSH-R256-NAME          TO WSH-RECORD-NAME.  
           MOVE WST-R256-DBK (WSI-R256-DBK-IDX)  TO WSH-FET-DBK.
           PERFORM 7110-FETCH-REC-ON-KEY         THRU 7110-EXIT.

       8514-WRITE-REC-NOW.  
           PERFORM 8746-MOVE-R256                THRU 8746-EXIT.
           MOVE B256-SPECIAL-ALLOWANCE TO C256-SPECIAL-ALLOWANCE.   
           WRITE C256-SPECIAL-ALLOWANCE.
           ADD 1                       TO WSA-ATE01D01-REC-CNT .

       8514-EXIT.   
           EXIT.

      *******************************************************   
      *** THIS PARA WUD BUILD CNTY-CAT TABLE              ***   
      *** FOR OPEN CASH BUDGETS.                          ***   
      *** CNTY INDEX IS SET FROM PARA 2000 (CASE LEVEL).  ***   
      *** CAT  INDEX IS SET FROM PARA 2260 (CAT  LEVEL).  ***   
      ***                                                 ***   
      *** IT IS INVOKED BOTH FROM 8510 (CASH) AND 8520    ***   
      *** (ONLY FOR MEDICAL-ONLY BUDGETS).                ***   
      ***                                                 ***   
      *** UPDATE $AMT ONLY FOR CASH BUDGETS.              ***   
      *******************************************************   
       8518-OPEN-BUDGET-COUNTS. 
           EXIT.

       8518-SET-WST-CNTY-CAT-INDICES.   
           SET WSI-C-C-CNTY-IDX        TO WSI-CNTY-IDX. 
           SET WSI-C-C-CAT-IDX         TO WSI-CAT-ONLY-IDX. 

       8518-INC-ACT-MEM-CNT.
R069           ADD R634-CNT-MEM-ACT        TO WST-CNTY-CAT-MEM-ACT-CNT  
R069                                 (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) 
R069           ADD R634-CNT-MEM-ACT        TO WSA-R-ACT-BDGT-MEM-CNT.   

       8518-CHECK-ACTIVE.   
           IF WST-CAT-TYPE (WSI-CAT-IDX) = 0 OR 1 OR 2 OR 3 
              ADD 1                    TO WST-CNTY-CAT-ACT-BDGT-CNT 
                                     (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX).

       8518-CHECK-TYPE-0.   
R069       IF  R634-CDE-STUS-BDGT  =  'S'   
R069           GO  TO  8518-EXIT.   
           IF WST-CAT-TYPE (WSI-CAT-IDX) = 0 OR 2 OR 3  
              IF WSS-BDGT-PRORATED-CLOSE-ON 
                 ADD WS-PRORATION-AMT  TO WST-CNTY-CAT-MGA-DOLL 
                                     (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) 
              ELSE  
              IF WSS-R654-REC-ON
                 ADD R654-AMT-GR-CASH  TO WST-CNTY-CAT-MGA-DOLL 
                                     (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) 
              ELSE  
              IF WSS-R255-REC-ON
                 ADD R255-AMT-GRANT-CASH TO WST-CNTY-CAT-MGA-DOLL   
                                     (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX).

       8518-EXIT.   
           EXIT.

      *******************************************************   
      *** WRITE ATE01D02 FILE.                            ***   
      *** FILE 02 RECORDS HAVE A PREFIX OF 'E'.           ***   
      ***                                                 ***   
      *** IF ITS A MEDICAL-ONLY BUDGET, SUMMARY-TABLE HAS ***   
      *** NOT BEEN BUILT, SO BUILD IT NOW.                ***   
      *******************************************************   
R069A *8520-WRITE-ATE01D02. 
R069A *    EXIT.
R069A * 
R069A *8520-CHECK-MAND-REC-SW.  
R069A *    IF WSS-BDGT-MAND-REC-MISSING-ON  
R069A *       GO TO 8520-EXIT.  
R069A * 
R069A *8520-INC-BLOCK-CNT.  
R069A *    ADD 1                       TO WSA-ATE01D02-BLK-CNT. 
R069A * 
R069A *8520-INC-REPORT-CNT. 
R069A *    IF WST-CAT-TYPE (WSI-CAT-IDX) = 1
R069A *       PERFORM 8518-OPEN-BUDGET-COUNTS    THRU 8518-EXIT.
R069A * 
R069A *8520-WRITE-R672. 
R069A *    PERFORM 8712-MOVE-R672                THRU 8712-EXIT.
R069A *    MOVE B672-CASE-ATTRIBS      TO E672-CASE-ATTRIBS.
R069A *    WRITE E672-CASE-ATTRIBS. 
R069A *    ADD 1                       TO WSA-ATE01D02-REC-CNT. 
R069A * 
R069A *** FOR FUTURE CLOSES, PASS STATUS AS CLOSED TO FACILITATE      * 
R069A *** LINKING BUDGETS WITH INDIVIDUALS IN MAID PATH.      * 
R069A *8520-WRITE-R634. 
R069A *    PERFORM 8734-MOVE-R634                THRU 8734-EXIT.
R069A *    IF WSS-BDGT-CLOSED-BEF-PERIOD-ON 
R069A *       MOVE 'C'                 TO B634-CDE-STUS-BDGT.   
R069A * 
R069A *    MOVE B634-CM-BUDGET-INFO    TO E634-CM-BUDGET-INFO  .
R069A *    WRITE E634-CM-BUDGET-INFO.   
R069A *    ADD 1                       TO WSA-ATE01D02-REC-CNT .
R069A * 
R069A *** R253 IF FOUND, WILL BE FORMATTED AS R248.      *  
R069A *8520-WRITE-R248-R253.
R069A *    IF WSS-R253-REC-ON   
R069A *       PERFORM 8738-MOVE-R253             THRU 8738-EXIT 
R069A *       MOVE B248-CASE-NAME      TO E248-CASE-NAME
R069A *       WRITE E248-CASE-NAME  
R069A *       ADD 1                    TO WSA-ATE01D02-REC-CNT  
R069A *    ELSE 
R069A *    IF WSS-R248-REC-ON   
R069A *       PERFORM 8716-MOVE-R248             THRU 8716-EXIT 
R069A *       MOVE B248-CASE-NAME      TO E248-CASE-NAME
R069A *       WRITE E248-CASE-NAME  
R069A *       ADD 1                    TO WSA-ATE01D02-REC-CNT. 
R069A * 
R069A *8520-WRITE-R254-R269.
R069A *    IF NOT WSS-R253-REC-ON   
R069A *       IF WSS-R254-REC-ON
R069A *          PERFORM 8718-MOVE-R254          THRU 8718-EXIT 
R069A *          MOVE B254-SECOND-CASE-NAME 
R069A *                                TO E254-SECOND-CASE-NAME 
R069A *          WRITE E254-SECOND-CASE-NAME
R069A *          ADD 1                 TO WSA-ATE01D02-REC-CNT  
R069A *       ELSE  
R069A *          NEXT SENTENCE  
R069A *    ELSE 
R069A *       IF WSS-R269-REC-ON
R069A *          PERFORM 8742-MOVE-R269          THRU 8742-EXIT 
R069A *          MOVE B269-ALT-PAYEE-NAME2       TO E269-ALT-PAYEE-NAME2
R069A *          WRITE E269-ALT-PAYEE-NAME2 
R069A *          ADD 1                 TO WSA-ATE01D02-REC-CNT  
R069A *       ELSE  
R069A *          NEXT SENTENCE. 
R069A * 
R069A *8520-WRITE-R247-R252.
R069A *    IF WSS-R252-REC-ON   
R069A *       PERFORM 8736-MOVE-R252             THRU 8736-EXIT 
R069A *       MOVE B252-ALTERNATE-ADDRESS   
R069A *                                TO E252-ALTERNATE-ADDRESS
R069A *       WRITE E252-ALTERNATE-ADDRESS  
R069A *       ADD 1                    TO WSA-ATE01D02-REC-CNT  
R069A *    ELSE 
R069A *    IF WSS-R247-REC-ON   
R069A *       PERFORM 8714-MOVE-R247             THRU 8714-EXIT 
R069A *       MOVE B247-CASE-ADDRESS   TO E247-CASE-ADDRESS 
R069A *       WRITE E247-CASE-ADDRESS   
R069A *       ADD 1                    TO WSA-ATE01D02-REC-CNT. 
R069A * 
R069A *8520-WRITE-R260. 
R069A *    IF WSS-R260-REC-ON   
R069A *       PERFORM 8758-MOVE-R260             THRU 8758-EXIT 
R069A *       MOVE B260-BULK-MAILING   TO E260-BULK-MAILING 
R069A *       WRITE E260-BULK-MAILING   
R069A *       ADD 1                    TO WSA-ATE01D02-REC-CNT. 
R069A *  8520-EXIT. 
R069A *      EXIT.  
R069A * 
      ******************************************************
      *** IF THIS INDIV WAS A FUTURE-DELETE, NOW BEING   ***
      *** DONE, OVERLAY 268-END-DTE BY FUTURE-DELETE     ***
      *** DATE.                                          ***
R017  *** DO NOT WRITE IT TO OUTPUT FILE BECAUSE NO      ***
R017  *** MAID SHOULD BE ISSUED TO THIS INDIV.           ***
      ***                                                ***
      *** IF THE BUDGET HAS BEEN CLOSED (BECAUSE OF      ***
      *** WHATEVER REASONS) OVERWRITE 268-END-DTE BY     ***
      *** 634-BUDGET-CLOSED DATE.                        ***
      ******************************************************
R069A *8530-WRITE-ATE01D02. 
R069A *    PERFORM 8756-MOVE-R268                THRU 8756-EXIT.
R069A *    IF R268-DTE-END-FUTURE NOT = 0000000  AND
R069A *       R268-DTE-END-FUTURE NOT > WSH-PAYMENT-DATE
R069A *       GO TO 8530-EXIT   
R069A *    ELSE 
R069A *    IF WSS-BDGT-CLOSED-BEF-PERIOD-ON 
R069A *       MOVE R634-DTE-CLOSED-BDGT          TO B268-DTE-END-EFFV.  
R069A * 
R069A *    MOVE B268-BUDGET-MEMBER-RELATION 
R069A *                                TO E268-BUDGET-MEMBER-RELATION.  
R069A *    WRITE E268-BUDGET-MEMBER-RELATION.   
R069A *    ADD 1                       TO WSA-ATE01D02-REC-CNT. 
R069A * 
R069A *8530-EXIT.   
R069A *    EXIT.
R069A * 
R035   8535-WRITE-ATE01D01. 
R035       PERFORM 8756-MOVE-R268                THRU 8756-EXIT.
M313       IF R268-DTE-END-FUTURE NOT = 0000000  AND
R035          R268-DTE-END-FUTURE NOT > WSH-PAYMENT-DATE
R035          GO TO 8535-EXIT   
R035       ELSE 
R035       IF WSS-BDGT-CLOSED-BEF-PERIOD-ON 
R035          MOVE R634-DTE-CLOSED-BDGT          TO B268-DTE-END-EFFV.  
R035
R035       MOVE B268-BUDGET-MEMBER-RELATION 
R035                                   TO C268-BUDGET-MEMBER-RELATION.  
R035       WRITE C268-BUDGET-MEMBER-RELATION.   
R035       ADD 1                       TO WSA-ATE01D01-REC-CNT. 
R035
R035   8535-EXIT.   
R035       EXIT.

      ******************************************************
      *** WRITE ATE01D04 FILE                            ***
      *** IT WRITES A 954 RECORD AND THEN                ***
      ***     . WRITES THE ORIGINAL R255 RECORD          ***
      ***     . WRITES THE MODIFIED R255 RECORD.         ***
      *** FILE 04 RECORDS HAVE A PREFIX OF 'G'.           ***   
      ******************************************************
       8540-WRITE-ATE01D04. 
           EXIT.

       8540-WRITE-R954. 
           PERFORM 8770-MOVE-R954                THRU 8770-EXIT.
           MOVE WSH-TME-ACTN           TO B954-TME-ACTN.
R024       MOVE 'DDBCHG'               TO B954-NBR-TRANS.   
           MOVE B954-SECD-ACTN         TO G954-SECD-ACTN .  
           WRITE G954-SECD-ACTN.
           ADD 1                       TO WSH-TME-ACTN. 
           ADD 1                       TO WSA-ATE01D04-REC-CNT. 

       8540-WRITE-R634. 
           PERFORM 8734-MOVE-R634                THRU 8734-EXIT.
           MOVE B634-CM-BUDGET-INFO    TO G634-CM-BUDGET-INFO  .
           WRITE G634-CM-BUDGET-INFO.   
           ADD 1                       TO WSA-ATE01D04-REC-CNT. 

       8540-WRITE-ORIGINAL-R255.
           MOVE WSH-R255-1ST-DBK       TO WSH-FET-DBK.  
           MOVE 'R255-CASH-GRANT'      TO WSH-RECORD-NAME.  
           PERFORM 7110-FETCH-REC-ON-KEY         THRU 7110-EXIT.
           PERFORM 8740-MOVE-R255                THRU 8740-EXIT.
           MOVE B255-CASH-GRANT        TO G255-CASH-GRANT.  
           WRITE G255-CASH-GRANT.   
           ADD 1                       TO WSA-ATE01D04-REC-CNT. 

       8540-WRITE-MODIFIED-R255.
           MOVE WSH-R255-NEW-DBK       TO WSH-FET-DBK.  
           MOVE 'R255-CASH-GRANT'      TO WSH-RECORD-NAME.  
           PERFORM 7110-FETCH-REC-ON-KEY         THRU 7110-EXIT.
           PERFORM 8740-MOVE-R255                THRU 8740-EXIT.
           MOVE B255-CASH-GRANT        TO G255-CASH-GRANT.  
           WRITE G255-CASH-GRANT.   
           ADD 1                       TO WSA-ATE01D04-REC-CNT. 

       8540-INC-CTR.
           ADD 1                       TO WSA-R-DD-BANK-CHG-CNT.

       8540-EXIT.   
           EXIT.

      ******************************************************
      *** WRITE ATE01D05 FILE ( I )                      ***
      *** R268 RECORD.                                   ***
      *** THIS PROCESS WILL BE INVOKED FOR EACH 268      ***
      *** FUTURE CLOSE INDIV , AND WILL WRITE A 'I'      ***
      *** TYPE TRANSACTION TO FILE ATE01D05.             ***
      ******************************************************
       8550-WRITE-ATE01D05-TRAN-I.  
           EXIT.

       8550-WRITE-TRAN-I.   
           PERFORM 8558-MOVE-DATA-TO-D05-REC     THRU 8558-EXIT.
           MOVE 'I'                    TO ATE01D05-TYP-TRANS   .
           MOVE R268-NBR-INDIV         TO ATE01D05-NBR-RCPT    .
           MOVE R268-DTE-END-FUTURE    TO ATE01D05-CLOSE-DATE  .
           PERFORM 8850-DET-WRITE-ATE01D05       THRU 8850-EXIT.

       8550-EXIT.   
           EXIT.

      ******************************************************
      *** WRITE ATE01D05 FILE ( II )                     ***
      *** THIS PROCESS WILL BE INVOKED IF THE BDGT       ***
      *** HAS BEEN CLOSED BECAUSE OF WHATEVER REASONS.   ***
      *** IT WRITES A TRANS TYPE 'B' TO FILE ATE01D05.   ***
      ******************************************************
       8554-WRITE-ATE01D05-TRAN-B.  
           EXIT.

       8554-WRITE-TRAN-B.   
           PERFORM 8558-MOVE-DATA-TO-D05-REC     THRU 8558-EXIT.
           MOVE 'B'                    TO ATE01D05-TYP-TRANS   .
           MOVE ZEROS                  TO ATE01D05-NBR-RCPT    .
           MOVE R634-DTE-CLOSED-BDGT   TO ATE01D05-CLOSE-DATE  .
           PERFORM 8850-DET-WRITE-ATE01D05       THRU 8850-EXIT.

       8554-EXIT.   
           EXIT.

      ******************************************************
      *** THIS PROCESS WILL ASSEMBLE DATA INTO ATE01D05  ***
      *** RECORD COMMON FIELDS BETWEEN BUDGET AND        ***
      *** INDIVIDUALS/RECIPIENTS.                        ***
      ******************************************************
       8558-MOVE-DATA-TO-D05-REC.   
           MOVE SPACES                 TO ATE01D05-REC             .
           MOVE R666-NBR-CASE          TO ATE01D05-NBR-CASE        .
           MOVE R249-CDE-CATEGORY      TO ATE01D05-CDE-CATEGORY    .
           MOVE R249-NBR-GROUP-GRANT   TO ATE01D05-NBR-GROUP-GRANT .
           MOVE R634-CDE-STUS-PROG     TO ATE01D05-STAT-CODE       .
           MOVE SPACES                 TO ATE01D05-CDE-SUFFIX      .

       8558-EXIT.   
           EXIT.

      ******************************************************
      *** WRITE ATE01D06 FILE                            ***
      ******************************************************
R069A *8560-WRITE-ATE01D06. 
R069A *    MOVE SPACES                 TO ATE01D06-RECORD.  
R069A * 
R069A *8560-LOOP-FOR-WST-CNTY-CAT.  
R069A *    PERFORM 8565-MOVE-ATE01D06            THRU 8565-EXIT 
R069A *            VARYING WSI-C-C-CNTY-IDX FROM 1 BY 1 
R069A *              UNTIL WSI-C-C-CNTY-IDX > WSH-CNTY-TAB-SIZE 
R069A *                  AFTER WSI-C-C-CAT-IDX FROM 1 BY 1  
R069A *                  UNTIL WSI-C-C-CAT-IDX > WSH-CAT-ONLY-TAB-SIZE. 
R069A * 
R069A *8560-EXIT.   
R069A *    EXIT.
R069A * 
      ******************************************************
      *** MOVE EACH CNTY/CAT OCCURENCE DATA TO FILE RD   ***
      *** AREA, AND WRITE THE DETAIL ATE01D06 RECORD.    ***
      ***                                                ***
      *** IGNORE THIS CONTROL RECORD IF ALL COUNTS ARE   ***
      *** 0, BECAUSE COUNTIES ARE NOT PAID ON ALL PDYS.  ***
      *** THIS WUD HELP AVOID WRITING UNNECCESSARY R265  ***
      *** RECORDS SUBSEQUENTLY.                          ***
      ******************************************************
R069A *8565-MOVE-ATE01D06.  
R069A *    SET WSI-CNTY-IDX            TO WSI-C-C-CNTY-IDX. 
R069A *    SET WSI-CAT-ONLY-IDX        TO WSI-C-C-CAT-IDX . 
R069A * 
R069A *8565-CHECK-IF-ALL-CNTS-ZERO. 
R069A *    IF WST-CNTY-CAT-ACT-BDGT-CNT 
R069A *       (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) = 0     AND
R069A *       WST-CNTY-CAT-SUS-BDGT-CNT 
R069A *       (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) = 0     AND
R069A *       WST-CNTY-CAT-MGA-DOLL 
R069A *       (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) = 0     AND
R069A *       WST-CNTY-CAT-MEM-ACT-CNT  
R069A *       (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX) = 0
R069A *           GO TO 8565-EXIT.  
R069A * 
R069A *8565-MOVE-ID-DATA.   
R069A *    MOVE WSH-PAYDAY-NBR         TO PAYDAY-NBR
R069A *                                IN ATE01D06-RECORD.  
R069A *    MOVE WST-CNTY-NBR (WSI-CNTY-IDX) 
R069A *                                TO COUNTY-NBR
R069A *                                IN ATE01D06-RECORD.  
R069A *    MOVE WST-CAT-ONLY (WSI-CAT-ONLY-IDX) 
R069A *                                TO CDE-CATEGORY  
R069A *                                IN ATE01D06-RECORD.  
R069A * 
R069A *8565-MOVE-COUNTS.
R069A *    MOVE WST-CNTY-CAT-ACT-BDGT-CNT   
R069A *         (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX)  
R069A *                                TO CNT-BDGTS-ACTIVE  
R069A *                                IN ATE01D06-RECORD.  
R069A *    MOVE WST-CNTY-CAT-SUS-BDGT-CNT   
R069A *         (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX)  
R069A *                                TO CNT-BDGTS-SUSPD   
R069A *                                IN ATE01D06-RECORD.  
R069A *    MOVE WST-CNTY-CAT-MGA-DOLL   
R069A *         (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX)  
R069A *                                TO AMT-GRANT-MONTHLY 
R069A *                                IN ATE01D06-RECORD.  
R069A *    MOVE WST-CNTY-CAT-MEM-ACT-CNT
R069A *         (WSI-C-C-CNTY-IDX WSI-C-C-CAT-IDX)  
R069A *                                TO CNT-MEM-ACTIVE
R069A *                                IN ATE01D06-RECORD.  
R069A * 
R069A *8565-NOW-WRITE-ATE01D06. 
R069A *    PERFORM 8860-DET-WRITE-ATE01D06       THRU 8860-EXIT.
R069A * 
R069A *8565-EXIT.   
R069A *    EXIT.
R069A * 
      ******************************************************
      *** WRITE ATE01D07 FILE                            ***
      *** IT WRITES R954 RECORD AND THEN DUPLICATES THE  ***
      *** CODE OF ATE01D01-WRITE.                        ***
      *** ( PLS ALSO READ THE NARRATION ON 8510 WRITE-   ***
      *** ATE01D01-FILE FOR COMPLETENESS).               ***
      *** FILE 07 RECORDS HAVE A PREFIX OF 'D'.           ***   
      ******************************************************
R069A *8570-WRITE-ATE01D07. 
R069A *    EXIT.
R069A * 
R069A *8570-CHECK-MAND-REC-SW.  
R069A *    IF WSS-BDGT-MAND-REC-MISSING-ON  
R069A *       GO TO 8570-EXIT.  
R069A * 
R069A *8570-ALL-OK-GO-AHEAD.
R069A *    ADD 1                       TO WSA-ATE01D07-BLK-CNT. 
R069A * 
R069A *8570-CHECK-RCOUPMT-STATUS.   
R069A *    IF WSS-R258-REC-ON AND   
R069A *       R258-CDE-STATUS-RCOUPMT NOT = 01  
R069A *           MOVE 0               TO WSS-R258-REC  
R069A *           MOVE 0               TO WSS-R270-REC  
R069A *           MOVE 0               TO WSS-R271-REC. 
R069A * 
R069A *8570-WRITE-R954. 
R069A *    PERFORM 8770-MOVE-R954                THRU 8770-EXIT.
R069A *    MOVE 'AGRZER'               TO B954-NBR-TRANS.   
R069A *    MOVE WSH-TME-ACTN           TO B954-TME-ACTN.
R069A *    MOVE B954-SECD-ACTN         TO D954-SECD-ACTN.   
R069A *    WRITE D954-SECD-ACTN.
R069A *    ADD 1                       TO WSA-ATE01D07-REC-CNT. 
R069A *    ADD 1                       TO WSH-TME-ACTN. 
R069A * 
R069A *8570-WRITE-R672. 
R069A *    PERFORM 8712-MOVE-R672                THRU 8712-EXIT.
R069A *    MOVE B672-CASE-ATTRIBS      TO D672-CASE-ATTRIBS.
R069A *    WRITE D672-CASE-ATTRIBS. 
R069A *    ADD 1                       TO WSA-ATE01D07-REC-CNT. 
R069A * 
R006  *** R253 IF FOUND, WILL BE FORMATTED AS PER R248. 
R069A *8570-WRITE-R248-R253.
R069A *    IF WSS-R253-REC-ON   
R069A *       PERFORM 8738-MOVE-R253             THRU 8738-EXIT 
R069A *       MOVE B248-CASE-NAME      TO D248-CASE-NAME
R069A *       WRITE D248-CASE-NAME  
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT  
R069A *    ELSE 
R069A *    IF WSS-R248-REC-ON   
R069A *       PERFORM 8716-MOVE-R248             THRU 8716-EXIT 
R069A *       MOVE B248-CASE-NAME      TO D248-CASE-NAME
R069A *       WRITE D248-CASE-NAME  
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-WRITE-R254-R269.
R069A *    IF NOT WSS-R253-REC-ON   
R069A *       IF WSS-R254-REC-ON
R069A *          PERFORM 8718-MOVE-R254          THRU 8718-EXIT 
R069A *          MOVE B254-SECOND-CASE-NAME 
R069A *                                TO D254-SECOND-CASE-NAME 
R069A *          WRITE D254-SECOND-CASE-NAME
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT  
R069A *       ELSE  
R069A *          NEXT SENTENCE  
R069A *    ELSE 
R069A *       IF WSS-R269-REC-ON
R069A *          PERFORM 8742-MOVE-R269          THRU 8742-EXIT 
R069A *          MOVE B269-ALT-PAYEE-NAME2       TO D269-ALT-PAYEE-NAME2
R069A *          WRITE D269-ALT-PAYEE-NAME2 
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT  
R069A *       ELSE  
R069A *          NEXT SENTENCE. 
R069A * 
R069A *8570-WRITE-R247-R252.
R069A *    IF WSS-R252-REC-ON   
R069A *       PERFORM 8736-MOVE-R252             THRU 8736-EXIT 
R069A *       MOVE B252-ALTERNATE-ADDRESS   
R069A *                                TO D252-ALTERNATE-ADDRESS
R069A *       WRITE D252-ALTERNATE-ADDRESS  
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT  
R069A *    ELSE 
R069A *    IF WSS-R247-REC-ON   
R069A *       PERFORM 8714-MOVE-R247             THRU 8714-EXIT 
R069A *       MOVE B247-CASE-ADDRESS   TO D247-CASE-ADDRESS 
R069A *       WRITE D247-CASE-ADDRESS   
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-WRITE-R634. 
R069A *    PERFORM 8734-MOVE-R634                THRU 8734-EXIT.
R069A *    MOVE B634-CM-BUDGET-INFO    TO D634-CM-BUDGET-INFO  .
R069A *    WRITE D634-CM-BUDGET-INFO.   
R069A *    ADD 1                       TO WSA-ATE01D07-REC-CNT .
R069A * 
R069A *8570-WRITE-R255. 
R069A *    PERFORM 8740-MOVE-R255                THRU 8740-EXIT.
R069A *    IF WSS-BDGT-PRORATED-CLOSE-ON         AND
R069A *       NOT WSS-R654-REC-ON   
R069A *          MOVE WS-PRORATION-AMT TO B255-AMT-GRANT-CASH  .
R069A * 
R069A *    MOVE B255-CASH-GRANT        TO D255-CASH-GRANT      .
R069A *    WRITE D255-CASH-GRANT.   
R069A *    ADD 1                       TO WSA-ATE01D07-REC-CNT .
R069A * 
R069A *8570-WRITE-R654. 
R069A *    IF WSS-R654-REC-ON   
R069A *       PERFORM 8774-MOVE-R654             THRU 8774-EXIT 
R069A *       IF WSS-BDGT-PRORATED-CLOSE-ON 
R069A *          MOVE WS-PRORATION-AMT TO B654-AMT-GR-CASH  
R069A *          MOVE B654-CM-OVRD     TO D654-CM-OVRD  
R069A *          WRITE D654-CM-OVRD 
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT  
R069A *       ELSE  
R069A *          MOVE B654-CM-OVRD     TO D654-CM-OVRD  
R069A *          WRITE D654-CM-OVRD 
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-MGA-OR-AGRZER.  
R069A *    IF WSS-R654-REC-ON   
R069A *       IF R654-AMT-GR-CASH < 10.0
R069A *          ADD 1                 TO WSA-R-MGA-LT-10-CNT   
R069A *       ELSE  
R069A *          ADD 1                 TO WSA-R-AGRZER-CNT  
R069A *    ELSE 
R069A *    IF R255-AMT-GRANT-CASH < 10.0
R069A *       ADD 1                    TO WSA-R-MGA-LT-10-CNT   
R069A *    ELSE 
R069A *       ADD 1                    TO WSA-R-AGRZER-CNT. 
R069A * 
R069A *8570-WRITE-R256. 
R069A *    IF WSS-R256-REC-ON   
R069A *       PERFORM 8574-WRITE-ATE01D07-R256   THRU 8574-EXIT 
R069A *          VARYING WSI-R256-DBK-IDX FROM 1 BY 1   
R069A *            UNTIL WSI-R256-DBK-IDX > WSH-R256-DBK-TAB-SIZE.  
R069A * 
R069A *8570-WRITE-R257. 
R069A *    IF WSS-R257-REC-ON   
R069A *       PERFORM 8748-MOVE-R257             THRU 8748-EXIT 
R069A *       MOVE B257-NET-INCOME     TO D257-NET-INCOME   
R069A *       WRITE D257-NET-INCOME 
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-WRITE-R258-R271.
R069A *    IF WSS-R258-REC-ON  AND  
R069A *       WSS-R271-REC-ON   
R069A *          PERFORM 8750-MOVE-R258          THRU 8750-EXIT 
R069A *          MOVE B258-RECOUPMENT-REFERRAL  
R069A *                                TO D258-RECOUPMENT-REFERRAL  
R069A *          WRITE D258-RECOUPMENT-REFERRAL 
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT  
R069A *          PERFORM 8780-MOVE-R271          THRU 8780-EXIT 
R069A *          MOVE B271-RECOUPMENT  TO D271-RECOUPMENT   
R069A *          WRITE D271-RECOUPMENT  
R069A *          ADD 1                 TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-WRITE-R259. 
R069A *    IF WSS-R259-REC-ON   
R069A *       PERFORM 8752-MOVE-R259             THRU 8752-EXIT 
R069A *       MOVE B259-VENDOR-PAYMENT TO D259-VENDOR-PAYMENT   
R069A *       WRITE D259-VENDOR-PAYMENT 
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-WRITE-R251. 
R069A *    IF WSS-R251-REC-ON   
R069A *       PERFORM 8744-MOVE-R251             THRU 8744-EXIT 
R069A *       MOVE B251-SUSPENSION     TO D251-SUSPENSION   
R069A *       WRITE D251-SUSPENSION 
R069A *       ADD 1                    TO WSA-ATE01D07-REC-CNT. 
R069A * 
R069A *8570-EXIT.   
R069A *    EXIT.
R069A * 
      *******************************************************   
      *** WRITE R256 TO ATE01D07 FILE.                    ***   
      *** ALL R256 RECORDS WILL BE WRITTEN.               ***   
      *** FILE 01 HAS A PREFIX OF 'D'.                    ***   
      *******************************************************   
R069A *8574-WRITE-ATE01D07-R256.
R069A *    EXIT.
R069A * 
R069A *8574-FETCH-R256-ON-KEY.  
R069A *    MOVE WSH-R256-NAME          TO WSH-RECORD-NAME.  
R069A *    MOVE WST-R256-DBK (WSI-R256-DBK-IDX)  TO WSH-FET-DBK.
R069A *    PERFORM 7110-FETCH-REC-ON-KEY         THRU 7110-EXIT.
R069A * 
R069A *8574-WRITE-REC-NOW.  
R069A *    PERFORM 8746-MOVE-R256                THRU 8746-EXIT.
R069A *    MOVE B256-SPECIAL-ALLOWANCE TO D256-SPECIAL-ALLOWANCE.   
R069A *    WRITE D256-SPECIAL-ALLOWANCE.
R069A *    ADD 1                       TO WSA-ATE01D07-REC-CNT .
R069A * 
R069A *8574-EXIT.   
R069A *    EXIT.

      ******************************************************
      *** WRITE ATE01D08 FILE                            ***
      *** THIS PROCESS WILL BE INVOKED FOR EACH CASE     ***
      *** MEMEBER RECORD THAT HAS A FUTURE-RECORD-GOING- ***
      *** CURRENT.                                       ***
      ******************************************************
       8580-WRITE-ATE01D08. 
           MOVE WSH-CNTY-CASE-NBR      TO ATE01D08-CASE-NBR.
           MOVE WSH-RECORD-TYPE        TO ATE01D08-REC-TYPE.
R069       MOVE  WSH-CDE-CATEGORY   TO  ATE01D08-CAT.   
R069       MOVE  WSH-NBR-GROUP-GRANT  TO  ATE01D08-GG.  
           PERFORM 8880-DET-WRITE-ATE01D08       THRU 8880-EXIT.

       8580-EXIT.   
           EXIT.

      ******************************************************
      *** WRITE ATE01D09 FILE                            ***
      *** THIS PROCESS WILL BE INVOKED FOR EACH BUDGET   ***
      *** ACTIVITY THAT MAY CAUSE TSA TO BE DELETED.     ***
      *** THIS PROCESS WILL FILL IN KEY FIELDS ONLY,     ***
      *** OTHER DETAIL FIELDS REQD FOR EACH REC TYPE     ***
      *** WUD COME PREFORMATTED TO THIS PROCESS.         ***
      ******************************************************
       8590-WRITE-ATE01D09. 
           MOVE R666-NBR-CASE          TO ATE01D09-NBR-CASE.
           MOVE R249-CDE-CATEGORY      TO ATE01D09-CDE-CATEGORY.
           MOVE R249-NBR-GROUP-GRANT   TO ATE01D09-NBR-GROUP-GRANT. 
           PERFORM 8885-DET-WRITE-ATE01D09       THRU 8885-EXIT.

       8590-EXIT.   
           EXIT.


R053   8592-WRITE-ATE01D10. 
R053       WRITE ATE01D10-RECORD.   
R053       MOVE SPACES                 TO ATE01D10-RECORD.  
R053       ADD 1                       TO WSA-ATE01D10-REC-CNT. 
R053   8592-EXIT.   
R053       EXIT.
R053
R053   8594-WRITE-ATE01D11. 
R053       WRITE ATE01D11-RECORD.   
R053       MOVE SPACES                 TO ATE01D11-RECORD.  
R053       ADD 1                       TO WSA-ATE01D11-REC-CNT. 
R053   8594-EXIT.   
R053       EXIT.
R053
R053   8596-WRITE-ATE01D12. 
R053       WRITE ATE01D12-RECORD.   
R053       MOVE SPACES                 TO ATE01D12-RECORD.  
R053       ADD 1                       TO WSA-ATE01D12-REC-CNT. 
R053   8596-EXIT.   
R053       EXIT.
R053
R053   8598-INITIALIZE. 
R053       MOVE ZEROS        TO CDE-COUNTY  
R053                            NBR-CSLD
R053                            DTE-ALERT   
R053                            TME-ALERT   
R053                            DTE-CHANGE-LAST 
R053                            TME-CHANGE-LAST 
R053                            DTE-DUE-ALERT   
R053                            NBR-ALERT   
R053                            DTE-DISPN-ALERT 
R053                            NBR-RECORD  
R053                            CDE-STATUS-PROGRAM  
R053                            NBR-LINE-INDIV  
R053                            NBR-INDIV   
R053                            NBR-OPTR-DSPO   
R053                            NBR-IMW-DSPO
R053                            CDE-COUNTY-SENDING  
R053                            NBR-IMW-SENDING 
R053                            CNT-LINES-ADDNL 
R053                            D11-CDE-COUNTY  
R053                            D11-NBR-RECORD  
R053                            D11-CDE-RSN-NOTICE  
R053                            BNFT-NBR-RCPT   
R053                            BNFT-PAY-RCPT-NBR   
R053                            BNFT-CC 
R053                            BNFT-RCD-NBR
R053                            BNFT-PGM-STATUS 
R053                            BNFT-CHECK-DATE 
R053                            BNFT-CHECK-AMT  
R053                            BNFT-CHECK-NBR  
R053                            BNFT-SPEC-REASON (1)
R053                            BNFT-SPEC-REASON (2)
R053                            BNFT-SPEC-REASON (3)
R053                            BNFT-START-DTE  
R053                            BNFT-END-DTE
R053                            BNFT-NBR-DAYS   
R053                            RPLD-BNFT-CDE-REAS. 
R053       MOVE SPACES       TO BNFT-CDE-DISPN  
R053                            BNFT-PAY-NAME   
R053                            BNFT-CDE-AMR
R053                            RPLD-BNFT-CDE-DISPN 
R053                            BNFT-TYPE-BENEFIT   
R053                            BNFT-CATEGORY   
R053                            BNFT-GRANT-GROUP
R053                            CDE-DIST
R053                            CDE-TYPE-ALERT  
R053                            CDE-MODE-DISPN  
R053                            CDE-DISPN-ALERT 
R053                            CDE-CATEGORY OF ATE01D10-RECORD 
R053                            NBR-GROUP-GRANT 
R053                            NAM-CASE
R053                            GRP-NAM-INDIV   
R053                            CDE-DIST-SENDING
R053                            TXT-1-MSG-ALERT 
R053                            TXT-MSG-ADDNL (1)   
R053                            TXT-MSG-ADDNL (2)   
R053                            TXT-MSG-ADDNL (3)   
R053                            TXT-MSG-ADDNL (4)   
R053                            TXT-MSG-ADDNL (5)   
R053                            TXT-MSG-ADDNL (6)   
R053                            ATE01D10-RECORD 
R053                            ATE01D11-RECORD 
R053                            ATE01D12-RECORD 
R053                            D11-CDE-CATEGORY
R053                            D11-NBR-GG  
R053                            D11-CDE-TYPE-NOTICE 
R053                            D11-CDE-OPTION-NOTICE.  
R053   8598-EXIT.   
R053       EXIT.
R056
R056   8600-WRITE-ATE01D13. 
R056       WRITE ATE01D13-RECORD.   
R056       MOVE SPACES                 TO ATE01D13-RECORD.  
R056       ADD 1                       TO WSA-ATE01D13-REC-CNT. 
R056   8600-EXIT.   
R056       EXIT.
R056
R056   8602-WRITE-ATE01D14. 
R056       WRITE ATE01D14-RECORD.   
R056       MOVE SPACES                 TO ATE01D14-RECORD.  
R056       ADD 1                       TO WSA-ATE01D14-REC-CNT. 
R056   8602-EXIT.   
R056       EXIT.
R056
R056   8604-WRITE-ATE01D15. 
R056       WRITE ATE01D15-RECORD.   
R056       MOVE SPACES                 TO ATE01D15-RECORD.  
R056       ADD 1                       TO WSA-ATE01D15-REC-CNT. 
R056   8604-EXIT.   
R056       EXIT.
R056
R056   8606-WRITE-ATE01D16. 
R056       WRITE ATE01D16-RECORD.   
R056       MOVE SPACES                 TO ATE01D16-RECORD.  
R056       ADD 1                       TO WSA-ATE01D16-REC-CNT. 
R056   8606-EXIT.   
R056       EXIT.
R056
R080  * 8610-WRITE-ATE01D17.
R080  *     MOVE  R666-NBR-CASE  TO  EOSSI-NBR-CASE.
R080  *     MOVE  R249-CDE-CATEGORY  TO  EOSSI-CATEGORY.
R080  *     MOVE  R249-NBR-GROUP-GRANT  TO  EOSSI-GRANT-GROUP.  
R080  *     MOVE  R634-CDE-STUS-PROG    TO  EOSSI-PROGRAM-STUS. 
R080  *     MOVE  R672-CDE-DIST         TO  EOSSI-DISTRICT. 
R080  *     MOVE  R672-NBR-CSLD         TO  EOSSI-CSLD. 
R080  *     MOVE  25.00                 TO  EOSSI-AMT.  
R080  *     MOVE  WSH-PAYMENT-DATE      TO  EOSSI-BEG-DATE. 
R080  *     MOVE  WSH-2-PAYDATE         TO  EOSSI-END-DATE. 
R080  *     MOVE  690                   TO  EOSSI-REAS-CODE.
R080  *     MOVE  R248-NAM-PMT          TO  EOSSI-NAME. 
R080  *     MOVE  R247-ADR-LINE-1-CASE  TO  EOSSI-ADR-1.
R080  *     MOVE  R247-ADR-LINE-2-CASE  TO  EOSSI-ADR-2.
R080  *     MOVE  R247-ADR-CITY-CASE    TO  EOSSI-CITY. 
R080  *     MOVE  R247-ADR-STATE-CASE   TO  EOSSI-ST.   
R080  *     MOVE  R247-ADR-ZIP-CODE-MAIN  TO  EOSSI-ZIP-MAIN.   
R080  *     MOVE  R247-ADR-ZIP-CODE-EXTN  TO  EOSSI-ZIP-EXTN.   
R080  *     IF  WSH-R268-FIRST-RCPT  NOT  =  ZEROES 
R080  *         MOVE  WSH-R268-FIRST-RCPT  TO  EOSSI-NBR-RCPT   
R080  *     ELSE
R080  *         MOVE  R268-NBR-INDIV         TO  EOSSI-NBR-RCPT.
R080  *     MOVE  ZEROES                         TO EOSSI-NBR-VALDN.
R080  *     MOVE  ZEROES                 TO  EOSSI-NBR-SSN. 
R080  *     WRITE  ATE01D17-RECORD. 
R080  *     ADD  1  TO  WSA-ATE01D17-REC-CNT.   
R080  * 8610-EXIT.    EXIT. 
      *******************************************************   
      *** DB RECORD MOVE TO WS RECORD SECTION.            ***   
      *** SECTION 8700.                                   ***   
      ***                                                 ***   
      *** INDIVIDUAL PARA MODULES ARE INVOKED AND ARE     ***   
      *** ORGANISED AS PER THEIR ENTRY PT RECORD.         ***   
      ***                                                 ***   
      *** THE FOLLOWING IS COMMON FOR ALL RECORDS :       ***   
      ***    . SORT KEY IS HARD CODED IN PROC.            ***   
      ***    . REC TYPE IS MOVED IN PROG AS PER SPECS.    ***   
      ***    . CASE NBR IS 666-NBR-CASE.                  ***   
      ***    . CDE-CATEGORY & NBR-GROUP-GRANT ARE FROM    ***   
      ***      249 CORRESPONDING REC.                     ***   
      *******************************************************   
       8700-DB-REC-MOVE-TO-WS-REC SECTION.  

      *******************************************************   
      *** MOVE R672.                                      ***   
      *******************************************************   
       8712-MOVE-R672.  
           MOVE SPACES                 TO B672-CASE-ATTRIBS         .   
           MOVE 'C1'
                                       TO B672-SORT-KEY             .   
           MOVE 'R672'  
                                       TO B672-REC-CDE              .   
           MOVE R666-NBR-CASE   
                                       TO B672-NBR-CASE             .   
           MOVE R249-CDE-CATEGORY   
                                       TO B672-CDE-CATEGORY         .   
           MOVE R249-NBR-GROUP-GRANT
                                       TO B672-NBR-GROUP-GRANT      .   
R025       MOVE 'R' 
R025                                   TO B672-CDE-PRCS             .   
R025       MOVE 01  
R025                                   TO B672-CNTR-PRCS            .   
R025       MOVE SPACES  
R025                                   TO B672-REC-INDCTR           .   
           MOVE R672-DTE-BGN-EFFV   
                                       TO B672-DTE-BGN-EFFV         .   
           MOVE R672-DTE-END-EFFV   
                                       TO B672-DTE-END-EFFV         .   
           MOVE R672-DTE-CHNG   
                                       TO B672-DTE-CHNG             .   
R025       MOVE R672-TME-ACTN   
R025                                   TO B672-TME-ACTN             .   
           MOVE R672-NBR-IMW
                                       TO B672-NBR-IMW              .   
           MOVE R672-CDE-DIST   
                                       TO B672-CDE-DIST             .   
           MOVE R672-CDE-DIST-SCOL  
                                       TO B672-CDE-DIST-SCOL        .   
           MOVE R672-CDE-SUBDIVN-CIVIL  
                                       TO B672-CDE-SUBDIVN-CIVIL    .   
R025       MOVE R666-CNT-BUDGETS-ACT-CM 
R025                                   TO B672-CNT-BUDGETS-ACT-CM   .   
R025       MOVE R666-CNT-BUDGETS-ACT-FS 
R025                                   TO B672-CNT-BUDGETS-ACT-FS   .   
           MOVE R672-NBR-CSLD   
                                       TO B672-NBR-CSLD             .   
R026       MOVE R666-CDE-STUS-MC
R026                                   TO B672-CDE-STUS-MC          .   
           MOVE R672-COM-NBR-APPLN  
                                       TO B672-COM-NBR-APPLN        .   
R026       MOVE R666-CDE-STUS-CASE  
R026                                   TO B672-CDE-STUS-CASE        .   
R025       MOVE R666-CDE-SI            TO B672-CDE-SI               .   
R026       MOVE R666-DTE-CNVSN         TO B672-DTE-CNVSN            .   
R046       MOVE R672-CDE-FMLY-VLNC     TO B672-CDE-FMLY-VLNC.   
R046       MOVE R672-DTE-BGN-FMLY-VLNC-INDCTR   
R046                         TO B672-DTE-BGN-FMLY-VLNC-INDCTR.  
MD01       MOVE R672-DTE-DUE-REAPPLN-MEDICAL TO 
MD01                             B672-DTE-DUE-REAPPLN-MEDICAL.  
MD01       MOVE R666-CDE-STATUS-UPDTD     TO B672-CDE-STATUS-UPDTD. 
MD01       MOVE R666-CNT-BUDGET-ACTIVE-CC TO B672-CNT-BUDGET-ACTIVE-CC. 
CC37       MOVE R672-IND-EXPLOR-SLMB-QI1  TO B672-IND-EXPLOR-SLMB-QI1.  

CC40       MOVE R672-DTE-RCVD-APPLN        TO B672-DTE-RCVD-APPLN.  
CC40       MOVE R672-IND-ALLOW-SHLTR-EMERG TO   
CC40                                       B672-IND-ALLOW-SHLTR-EMERG.  
CC40       MOVE R672-IND-APPLN-COMPASS     TO B672-IND-APPLN-COMPASS.   
CC40       MOVE R672-NBR-APPLN-COMPASS     TO B672-NBR-APPLN-COMPASS.   
CC44       MOVE  R672-CDE-REFL-FFM    TO  B672-CDE-REFL-FFM.
CC45       MOVE  R672-TXT-GUID-RESP-FFM   TO  B672-TXT-GUID-RESP-FFM.   
CC44       MOVE  R672-IND-RULE-RIVERSIDE  TO
CC44                                  B672-IND-RULE-RIVERSIDE.  
CC46       MOVE  R672-IND-CASE-ABAWD TO B672-IND-CASE-ABAWD.
CC44       MOVE  R672-FILLER          TO  B672-FILLER.  
CC40
       8712-EXIT.   
           EXIT.

      ***************************************************** 
      *** MOVE R247                                     *** 
      ***************************************************** 
       8714-MOVE-R247.  
           MOVE SPACES                 TO B247-CASE-ADDRESS          .  
           MOVE 'C3'
                                       TO B247-SORT-KEY              .  
           MOVE 'R247'  
                                       TO B247-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B247-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B247-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B247-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B247-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B247-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B247-REC-INDCTR            .  
           MOVE R247-DTE-BGN-EFFV   
                                       TO B247-DTE-BGN-EFFV          .  
           MOVE R247-DTE-END-EFFV   
                                       TO B247-DTE-END-EFFV          .  
           MOVE R247-DTE-CHNG   
                                       TO B247-DTE-CHNG              .  
R025       MOVE R247-TME-ACTN   
R025                                   TO B247-TME-ACTN              .  
           MOVE R247-ADR-LINE-1-CASE
                                       TO B247-ADR-LINE-1-CASE       .  
           MOVE R247-ADR-LINE-2-CASE
                                       TO B247-ADR-LINE-2-CASE       .  
           MOVE R247-ADR-CITY-CASE  
                                       TO B247-ADR-CITY-CASE         .  
           MOVE R247-ADR-ZIP-CODE-CASE  
                                       TO B247-ADR-ZIP-CODE-CASE     .  
           MOVE R247-ADR-ZIP-CODE-MAIN  
                                       TO B247-ADR-ZIP-CODE-MAIN     .  
           MOVE R247-ADR-ZIP-CODE-EXTN  
                                       TO B247-ADR-ZIP-CODE-EXTN     .  
           MOVE R247-ADR-STATE-CASE 
                                       TO B247-ADR-STATE-CASE        .  
           MOVE R247-CDE-VERIF-ADR-CASE 
                                       TO B247-CDE-VERIF-ADR-CASE    .  
R041       MOVE R247-NBR-TEL           TO B247-NBR-TEL. 
R041       MOVE R247-NBR-IMW           TO B247-NBR-IMW. 
R041       MOVE R247-CDE-STUS-AIMS     TO B247-CDE-STUS-AIMS.   
MD01       MOVE R247-NBR-PHONE-WORK    TO B247-NBR-PHONE-WORK.  
MD01       MOVE R247-NBR-PHONE-EXTN-WORK TO B247-NBR-PHONE-EXTN-WORK.   
MD01       MOVE R247-TME-CALL-BEST     TO B247-TME-CALL-BEST.   
MD01       MOVE R247-ADR-LATD          TO B247-ADR-LATD.
CC40  *    MOVE R247-ADR-LNGTD         TO B247-ADR-LNGTD.   
CC37       MOVE R247-ADR-EMAIL         TO B247-ADR-EMAIL.   
CC40
CC40       MOVE R247-IND-HH-HOMLS      TO B247-IND-HH-HOMLS.
CC40       MOVE R247-IND-RENT-HH-HOMLS TO B247-IND-RENT-HH-HOMLS.   
CC40       MOVE R247-DTE-START-HOMLS   TO B247-DTE-START-HOMLS. 
CC40       MOVE R247-IND-SHLTR-HH-HOMLS TO B247-IND-SHLTR-HH-HOMLS. 
CC40       MOVE R247-CDE-RES-COUNTY    TO B247-CDE-RES-COUNTY.  
CC40       MOVE R247-CDE-RES-DIST      TO B247-CDE-RES-DIST.
CC40       MOVE R247-IND-VALDN-ADR     TO B247-IND-VALDN-ADR.   
CC40
       8714-EXIT.   
           EXIT.

      *******************************************************   
      *** MOVE R248                                       ***   
      *******************************************************   
       8716-MOVE-R248.  
           MOVE SPACES                 TO B248-CASE-NAME             .  
           MOVE 'C2'
                                       TO B248-SORT-KEY              .  
           MOVE 'R248'  
                                       TO B248-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B248-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B248-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B248-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B248-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B248-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B248-REC-INDCTR            .  
           MOVE R248-DTE-BGN-EFFV   
                                       TO B248-DTE-BGN-EFFV          .  
           MOVE R248-DTE-END-EFFV   
                                       TO B248-DTE-END-EFFV          .  
           MOVE R248-DTE-CHNG   
                                       TO B248-DTE-CHNG              .  
           MOVE R248-TME-ACTN   
                                       TO B248-TME-ACTN              .  
           MOVE R248-NAM-PMT
                                       TO B248-NAM-PMT               .  
           MOVE R248-NBR-SSN
                                       TO B248-NBR-SSN               .  
           MOVE R248-CDE-LANG-PAYMENT   
                                       TO B248-CDE-LANG-PAYMENT      .  
           MOVE R248-NBR-ID-PHOTO   
                                       TO B248-NBR-ID-PHOTO          .  
           MOVE R248-CDE-STATUS-ID-PHOTO
                                       TO B248-CDE-STATUS-ID-PHOTO   .  
           MOVE R248-DTE-ID-PHOTO   
                                       TO B248-DTE-ID-PHOTO          .  
           MOVE R248-CDE-VERIF-NAM-PMT  
                                       TO B248-CDE-VERIF-NAM-PMT     .  
           MOVE R248-CDE-ID-PHOTO   
                                       TO B248-CDE-ID-PHOTO          .  
           MOVE R248-NBR-IMW
                                       TO B248-NBR-IMW               .  
R036       MOVE R248-NBR-RCPT-NAM-PMT   
R036                                   TO B248-NBR-RCPT-NAM-PMT.
R036       MOVE R248-NBR-VALDN-DIGIT-RCPT-PNAM  
R036                                TO B248-NBR-VALDN-DIGIT-RCPT-PNAM.  
MD01       MOVE R248-NBR-LINE-HH-CM    TO B248-NBR-LINE-HH-CM.  
MD01       MOVE R248-NBR-LINE-HH-FS    TO B248-NBR-LINE-HH-FS.  
CC47       MOVE  R248-NBR-PHONE-CELL  TO  B248-NBR-PHONE-CELL.  

       8716-EXIT.   
           EXIT.

      *******************************************************   
      *** MOVE R254                                       ***   
      *******************************************************   
       8718-MOVE-R254.  
           MOVE SPACES                 TO B254-SECOND-CASE-NAME      .  
           MOVE 'C3'
                                       TO B254-SORT-KEY              .  
           MOVE 'R254'  
                                       TO B254-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B254-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B254-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B254-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B254-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B254-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B254-REC-INDCTR            .  
           MOVE R254-DTE-BGN-EFFV   
                                       TO B254-DTE-BGN-EFFV          .  
           MOVE R254-DTE-END-EFFV   
                                       TO B254-DTE-END-EFFV          .  
           MOVE R254-DTE-CHNG   
                                       TO B254-DTE-CHNG              .  
R025       MOVE R254-TME-ACTN   
R025                                   TO B254-TME-ACTN              .  
           MOVE R254-NAM-PAYMENT-LINE-2 
                                       TO B254-NAM-PAYMENT-LINE-2    .  
           MOVE R254-CDE-NAM-PAYMENT-LINE-2 
                                       TO B254-CDE-NAM-PAYMENT-LINE-2.  

       8718-EXIT.   
           EXIT.

      *******************************************************   
      *** MOVE R634.                                      ***   
      *******************************************************   
       8734-MOVE-R634.  
           MOVE SPACES                 TO B634-CM-BUDGET-INFO        .  
           MOVE 'H1'
                                       TO B634-SORT-KEY              .  
           MOVE 'R634'  
                                       TO B634-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B634-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B634-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B634-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B634-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B634-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B634-REC-INDCTR            .  
           MOVE R634-DTE-BGN-EFFV   
                                       TO B634-DTE-BGN-EFFV          .  
           MOVE R634-DTE-END-EFFV   
                                       TO B634-DTE-END-EFFV          .  
M129       MOVE R634-DTE-CHNG   
M129                                   TO B634-DTE-CHNG 
R025       MOVE R634-TME-ACTN   
R025                                   TO B634-TME-ACTN              .  
           MOVE R634-CDE-STUS-PROG  
                                       TO B634-CDE-STUS-PROG         .  
           MOVE R634-CTL-GEN-HIST-BDGT  
                                       TO B634-CTL-GEN-HIST-BDGT     .  
           MOVE R634-DTE-OPENED-BDGT
                                       TO B634-DTE-OPENED-BDGT       .  
           MOVE R634-DTE-CLOSED-BDGT
                                       TO B634-DTE-CLOSED-BDGT       .  
           MOVE R634-DTE-APPLN-BDGT 
                                       TO B634-DTE-APPLN-BDGT        .  
           MOVE R634-DTE-DUE-REDET  
                                       TO B634-DTE-DUE-REDET         .  
           MOVE R634-DTE-REDET-LAST 
                                       TO B634-DTE-REDET-LAST        .  
           MOVE R634-CDE-AUTH-CHG-BDGT  
                                       TO B634-CDE-AUTH-CHG-BDGT     .  
           MOVE R634-CDE-RCOUPMT-VENDOR 
                                       TO B634-CDE-RCOUPMT-VENDOR    .  
           MOVE R634-CDE-REASON-STUS
                                       TO B634-CDE-REASON-STUS       .  
           MOVE R634-CNT-MEM-ACT
                                       TO B634-CNT-MEM-ACT           .  
           MOVE R634-CDE-RPTNG-MTHLY
                                       TO B634-CDE-RPTNG-MTHLY       .  
           MOVE R634-CDE-30-1-3 
                                       TO B634-CDE-30-1-3            .  
           MOVE R634-CNT-MON-RMNG   
                                       TO B634-CNT-MON-RMNG          .  
           MOVE R634-CDE-TYPE-NOTICE
                                       TO B634-CDE-TYPE-NOTICE       .  
           MOVE R634-CDE-OPTION-NOTICE  
                                       TO B634-CDE-OPTION-NOTICE     .  
           MOVE R634-CDE-DISTN-MAIL 
                                       TO B634-CDE-DISTN-MAIL        .  
           MOVE R634-CDE-ACTN-BDGT  
                                       TO B634-CDE-ACTN-BDGT         .  
           MOVE R634-CDE-STUS-NOTICE
                                       TO B634-CDE-STUS-NOTICE       .  
           MOVE R634-CDE-STUS-BDGT  
                                       TO B634-CDE-STUS-BDGT         .  
           MOVE R634-CDE-STUS-OVRD  
                                       TO B634-CDE-STUS-OVRD         .  
           MOVE R634-CDE-ETP
                                       TO B634-CDE-ETP               .  
           MOVE R634-CDE-4D 
                                       TO B634-CDE-4D                .  
           MOVE R249-CTL-DIGIT  
                                       TO B634-CTL-DIGIT             .  
R026       MOVE R634-CDE-TFR-CO        TO B634-CDE-TFR-CO.  
R026       MOVE R634-CDE-TFR-DIST      TO B634-CDE-TFR-DIST.
R040       MOVE R634-CDE-AMR-PRESENT   TO B634-CDE-AMR-PRESENT. 
R044       MOVE R634-NBR-CASE-OCYF     TO B634-NBR-CASE-OCYF.   
R044       MOVE R634-CDE-ASST-HOUSE    TO B634-CDE-ASST-HOUSE.  
R044       MOVE R634-IND-MA-AUTO       TO B634-IND-MA-AUTO. 
M322       MOVE R634-DTE-TFR-OCYF      TO B634-DTE-TFR-OCYF.
M322       MOVE R634-CDE-STUS-TFR-OCYF TO B634-CDE-STUS-TFR-OCYF.   
M322       MOVE R634-IND-FPIG-TEST     TO B634-IND-FPIG-TEST.   
MD01       MOVE R634-CDE-TYPE-TARGET   TO B634-CDE-TYPE-TARGET. 
CC40
CC40       MOVE R634-IND-INCOME-VERIF  TO B634-IND-INCOME-VERIF.
CC44       MOVE  R634-FILLER          TO  B634-FILLER.  
CC40
       8734-EXIT.   
           EXIT.

      *******************************************************   
      *** MOVE R252.                                      ***   
      *** HOWEVER REC TYPE IS TO BE R247                  ***   
      *******************************************************   
       8736-MOVE-R252.  
           MOVE SPACES                 TO B252-ALTERNATE-ADDRESS     .  
           MOVE 'H3'
                                       TO B252-SORT-KEY              .  
           MOVE 'R247'  
                                       TO B252-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B252-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B252-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B252-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B252-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B252-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B252-REC-INDCTR            .  
           MOVE R252-DTE-BGN-EFFV   
                                       TO B252-DTE-BGN-EFFV          .  
           MOVE R252-DTE-END-EFFV   
                                       TO B252-DTE-END-EFFV          .  
           MOVE R252-DTE-CHNG   
                                       TO B252-DTE-CHNG              .  
R025       MOVE R252-TME-ACTN   
R025                                   TO B252-TME-ACTN              .  
           MOVE R252-ADR-LINE-1-ALT 
                                       TO B252-ADR-LINE-1-ALT        .  
           MOVE R252-ADR-LINE-2-ALT 
                                       TO B252-ADR-LINE-2-ALT        .  
           MOVE R252-ADR-CITY-ALT   
                                       TO B252-ADR-CITY-ALT          .  
           MOVE R252-ADR-ZIP-CODE-ALT   
                                       TO B252-ADR-ZIP-CODE-ALT      .  
           MOVE R252-ADR-ZIP-CODE-MAIN  
                                       TO B252-ADR-ZIP-CODE-MAIN     .  
           MOVE R252-ADR-ZIP-CODE-EXTN  
                                       TO B252-ADR-ZIP-CODE-EXTN     .  
           MOVE R252-ADR-STATE-ALT  
                                       TO B252-ADR-STATE-ALT         .  
           MOVE R252-CDE-VERIF-ADR-PMT-ALT  
                                       TO B252-CDE-VERIF-ADR-PMT-ALT .  
CC40       MOVE R252-IND-VALDN-ADR  
CC40                                   TO B252-IND-VALDN-ADR.   

       8736-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R253                                       ***  
      *** HOWEVER REC TYPE IS TO BE R248                   ***  
      ********************************************************  
       8738-MOVE-R253.  
R006       MOVE SPACES                 TO B248-CASE-NAME             .  
           MOVE 'H3'
R006                                   TO B248-SORT-KEY              .  
           MOVE 'R248'  
R006                                   TO B248-REC-CDE                 .
           MOVE R666-NBR-CASE   
R006                                   TO B248-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
R006                                   TO B248-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
R006                                   TO B248-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B248-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B248-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B248-REC-INDCTR            .  
           MOVE R253-DTE-BGN-EFFV   
R006                                   TO B248-DTE-BGN-EFFV            .
           MOVE R253-DTE-END-EFFV   
R006                                   TO B248-DTE-END-EFFV            .
           MOVE R253-DTE-CHNG   
R006                                   TO B248-DTE-CHNG                .
R025       MOVE R253-TME-ACTN   
R025                                   TO B253-TME-ACTN              .  
           MOVE R253-NAM-PMT-ALT
R006                                   TO B248-NAM-PMT                 .
           MOVE R253-NBR-SSN-ALT
R006                                   TO B248-NBR-SSN                 .
           MOVE R253-CDE-LANG-PAYMENT-ALT   
R006                                   TO B248-CDE-LANG-PAYMENT        .
           MOVE R253-NBR-ID-PHOTO-ALT   
R006                                   TO B248-NBR-ID-PHOTO            .
           MOVE R253-CDE-STATUS-ID-PHOTO-ALT
R006                                   TO B248-CDE-STATUS-ID-PHOTO     .
           MOVE R253-DTE-ID-PHOTO-ALT   
R006                                   TO B248-DTE-ID-PHOTO            .
           MOVE R253-CDE-VERIF-NAM-PMT-ALT  
R006                                   TO B248-CDE-VERIF-NAM-PMT       .
           MOVE R253-CDE-ID-PHOTO-ALT   
R006                                   TO B248-CDE-ID-PHOTO            .
R006       MOVE ZEROS   
R006                                   TO B248-NBR-IMW                 .
R036       MOVE R253-NBR-RCPT-NAM-PMT   
R042                                   TO B248-NBR-RCPT-NAM-PMT.
R036       MOVE R253-NBR-VALDN-DIGIT-RCPT-PNAM  
R042                                TO B248-NBR-VALDN-DIGIT-RCPT-PNAM.  

       8738-EXIT.   
           EXIT.

      ******************************************************
      *** MOVE R255.                                     ***
      ******************************************************
       8740-MOVE-R255.  
           MOVE SPACES                 TO B255-CASH-GRANT              .
R064       MOVE  R255-CASH-GRANT  TO  WSH-R255-REC. 
CC40       MOVE  WSH-R255-OTI     TO  B255-IND-PMT-WER. 
           MOVE 'H3'
                                       TO B255-SORT-KEY                .
           MOVE 'R255'  
                                       TO B255-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B255-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B255-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B255-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B255-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B255-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B255-REC-INDCTR            .  
           MOVE R255-DTE-BGN-EFFV   
                                       TO B255-DTE-BGN-EFFV            .
           MOVE R255-DTE-END-EFFV   
                                       TO B255-DTE-END-EFFV            .
           MOVE R255-DTE-CHNG   
                                       TO B255-DTE-CHNG                .
R025       MOVE R255-TME-ACTN   
R025                                   TO B255-TME-ACTN              .  
           MOVE R255-NBR-BANK-DD
                                       TO B255-NBR-BANK-DD             .
           MOVE R255-GRP-COMPSN 
                                       TO B255-GRP-COMPSN              .
           MOVE R255-CNT-PERSONS
                                       TO B255-CNT-PERSONS             .
           MOVE R255-CNT-CHLDRN 
                                       TO B255-CNT-CHLDRN              .
           MOVE R255-CNT-ADULTS 
                                       TO B255-CNT-ADULTS              .
           MOVE R255-AMT-ALLOW-SIZE-FAMILY  
                                       TO B255-AMT-ALLOW-SIZE-FAMILY   .
           MOVE R255-AMT-GRANT-CASH 
                                       TO B255-AMT-GRANT-CASH          .
           MOVE R255-CDE-RCOUPMT-VENDOR 
                                       TO B255-CDE-RCOUPMT-VENDOR      .
           MOVE R255-DTE-EFFV-CHNG-GRANT-CASH   
                                       TO B255-DTE-EFFV-CHNG-GRANT-CASH.
           MOVE R255-CDE-AUTH-CHNG-GRANT-CASH   
                                       TO B255-CDE-AUTH-CHNG-GRANT-CASH.
           MOVE R255-CDE-REASON-CHANGE-GRANT
                                       TO B255-CDE-REASON-CHANGE-GRANT .
           MOVE R255-NBR-SEQ
                                       TO B255-NBR-SEQ                 .
           MOVE R255-CDE-STUS-FAIR-HEARING  
                                       TO B255-CDE-STUS-FAIR-HEARING   .
           MOVE R255-DTE-STUS-HEARING   
                                       TO B255-DTE-STUS-HEARING        .
           MOVE R255-CDE-STUS-BDGT-HEARING  
                                       TO B255-CDE-STUS-BDGT-HEARING   .
           MOVE R255-AMT-FSA-SHARE  
                                       TO B255-AMT-FSA-SHARE           .
R040       MOVE R255-AMT-ADJD-DISQUAL-SANC  
R040                                   TO B255-AMT-ADJD-DISQUAL-SANC.   
CC40
CC40       MOVE R255-IND-PMT-WER       TO B255-IND-PMT-WER. 
CC44       MOVE  R255-AMT-SANC-SUPP-PCT-25  TO  
CC44                            B255-AMT-SANC-SUPP-PCT-25.  
CC44       MOVE  R255-AMT-SANC-ETP  TO  B255-AMT-SANC-ETP.  
CC40
       8740-EXIT.   
           EXIT.


      ********************************************************  
      *** MOVE  R269                                       ***  
      *** HOWEVER REC TYPE IS TO BE R254.                  ***  
      ********************************************************  
       8742-MOVE-R269.  
           MOVE SPACES                 TO B269-ALT-PAYEE-NAME2         .
           MOVE 'H3'
                                       TO B269-SORT-KEY                .
           MOVE 'R254'  
                                       TO B269-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B269-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B269-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B269-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B269-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B269-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B269-REC-INDCTR            .  
           MOVE R269-DTE-BGN-EFFV   
                                       TO B269-DTE-BGN-EFFV            .
           MOVE R269-DTE-END-EFFV   
                                       TO B269-DTE-END-EFFV            .
           MOVE R269-DTE-CHNG   
                                       TO B269-DTE-CHNG                .
R025       MOVE R269-TME-ACTN   
R025                                   TO B269-TME-ACTN              .  
           MOVE R269-NAM-PAYMENT-LINE-2-ALT 
                                       TO B269-NAM-PAYMENT-LINE-2-ALT  .
           MOVE R269-CDE-ALT-PAYEE  
                                       TO B269-CDE-ALT-PAYEE           .

       8742-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R251                                       ***  
      ********************************************************  
       8744-MOVE-R251.  
           MOVE SPACES                 TO B251-SUSPENSION              .
           MOVE 'H3'
                                       TO B251-SORT-KEY                .
           MOVE 'R251'  
                                       TO B251-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B251-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B251-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B251-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B251-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B251-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B251-REC-INDCTR            .  
           MOVE R251-DTE-BGN-EFFV   
                                       TO B251-DTE-BGN-EFFV            .
           MOVE R251-DTE-END-EFFV   
                                       TO B251-DTE-END-EFFV            .
           MOVE R251-DTE-CHNG   
                                       TO B251-DTE-CHNG                .
R025       MOVE R251-TME-ACTN   
R025                                   TO B251-TME-ACTN              .  
           MOVE R251-DTE-INACT-SPNSN
                                       TO B251-DTE-INACT-SPNSN         .
           MOVE R251-CDE-REASON-SPNSN   
                                       TO B251-CDE-REASON-SPNSN        .

       8744-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R256                                       ***  
      ********************************************************  
       8746-MOVE-R256.  
           MOVE SPACES                 TO B256-SPECIAL-ALLOWANCE       .
           MOVE 'H3'
                                       TO B256-SORT-KEY.
           MOVE 'R256'  
                                       TO B256-REC-CDE. 
           MOVE R666-NBR-CASE   
                                       TO B256-NBR-CASE.
           MOVE R249-CDE-CATEGORY   
                                       TO B256-CDE-CATEGORY.
           MOVE R249-NBR-GROUP-GRANT
                                       TO B256-NBR-GROUP-GRANT. 
R025       MOVE 'R' 
R025                                   TO B256-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B256-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B256-REC-INDCTR            .  
           MOVE R256-DTE-BGN-EFFV   
                                       TO B256-DTE-BGN-EFFV            .
           MOVE R256-DTE-END-EFFV   
                                       TO B256-DTE-END-EFFV            .
M129       MOVE R256-DTE-CHNG          TO B256-DTE-CHNG.
R025       MOVE R256-TME-ACTN   
R025                                   TO B256-TME-ACTN              .  
M129       MOVE R256-CNT-SPECIAL       TO B256-CNT-SPECIAL. 
M129       PERFORM 8746-1-LOOP-GRP-DESC VARYING WSI-I   
M129             FROM 1 BY 1 UNTIL  
M129                  WSI-I >  B256-CNT-SPECIAL.

       8746-EXIT.   
           EXIT.

M129   8746-1-LOOP-GRP-DESC.
M129       MOVE R256-CDE-ALLOW-SPECIAL (WSI-I)  
M129                                TO B256-CDE-ALLOW-SPECIAL (WSI-I).  
M129       MOVE R256-AMT-ALLOW-SPECIAL (WSI-I)  
M129                                TO B256-AMT-ALLOW-SPECIAL (WSI-I).  
           MOVE R256-TXT-DESC-SPECIAL (WSI-I)   
                                       TO B256-TXT-DESC-SPECIAL (WSI-I).

      ********************************************************  
      *** MOVE  R257                                       ***  
      ********************************************************  
       8748-MOVE-R257.  
           MOVE SPACES                 TO B257-NET-INCOME              .
           MOVE 'H3'
                                       TO B257-SORT-KEY                .
           MOVE 'R257'  
                                       TO B257-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B257-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B257-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B257-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B257-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B257-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B257-REC-INDCTR            .  
           MOVE R257-DTE-BGN-EFFV   
                                       TO B257-DTE-BGN-EFFV            .
           MOVE R257-DTE-END-EFFV   
                                       TO B257-DTE-END-EFFV            .
           MOVE R257-DTE-CHNG   
                                       TO B257-DTE-CHNG                .
R025       MOVE R257-TME-ACTN   
R025                                   TO B257-TME-ACTN              .  
           MOVE R257-CDE-INCOME-EARNED-NET (1)  
                                      TO B257-CDE-INCOME-EARNED-NET (1).
           MOVE R257-CDE-INCOME-EARNED-NET (2)  
                                      TO B257-CDE-INCOME-EARNED-NET (2).
           MOVE R257-CDE-INCOME-EARNED-NET (3)  
                                      TO B257-CDE-INCOME-EARNED-NET (3).
           MOVE R257-CDE-INCOME-UNERND-NET (1)  
                                      TO B257-CDE-INCOME-UNERND-NET (1).
           MOVE R257-CDE-INCOME-UNERND-NET (2)  
                                      TO B257-CDE-INCOME-UNERND-NET (2).
           MOVE R257-CDE-INCOME-UNERND-NET (3)  
                                      TO B257-CDE-INCOME-UNERND-NET (3).
           MOVE R257-AMT-INCOME-EARNED-NET  
                                       TO B257-AMT-INCOME-EARNED-NET   .
           MOVE R257-AMT-INCOME-UNERND-NET  
                                       TO B257-AMT-INCOME-UNERND-NET   .

       8748-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R258
      ********************************************************  
       8750-MOVE-R258.  
           MOVE SPACES                 TO B258-RECOUPMENT-REFERRAL     .
           MOVE 'H3'
                                       TO B258-SORT-KEY                .
           MOVE 'R258'  
                                       TO B258-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B258-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B258-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B258-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B258-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B258-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B258-REC-INDCTR            .  
           MOVE R258-DTE-BGN-EFFV   
                                       TO B258-DTE-BGN-EFFV            .
           MOVE R258-DTE-END-EFFV   
                                       TO B258-DTE-END-EFFV            .
           MOVE R258-DTE-CHNG   
                                       TO B258-DTE-CHNG                .
R025       MOVE R258-TME-ACTN   
R025                                   TO B258-TME-ACTN              .  
           MOVE R258-NBR-REFL   
                                       TO B258-NBR-REFL                .
           MOVE R258-CDE-STATUS-RCOUPMT 
                                       TO B258-CDE-STATUS-RCOUPMT      .
           MOVE R258-CDE-PROJECT-REFL   
                                       TO B258-CDE-PROJECT-REFL        .
           MOVE R258-CDE-INDCTR-PCTG-RCOUPMT
                                       TO B258-CDE-INDCTR-PCTG-RCOUPMT .

       8750-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R259
      ********************************************************  
       8752-MOVE-R259.  
           MOVE SPACES                 TO B259-VENDOR-PAYMENT          .
           MOVE 'H3'
                                       TO B259-SORT-KEY                .
           MOVE 'R259'  
                                       TO B259-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B259-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B259-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B259-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B259-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B259-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B259-REC-INDCTR            .  
           MOVE R259-DTE-BGN-EFFV   
                                       TO B259-DTE-BGN-EFFV            .
           MOVE R259-DTE-END-EFFV   
                                       TO B259-DTE-END-EFFV            .
           MOVE R259-DTE-CHNG   
                                       TO B259-DTE-CHNG                .
R025       MOVE R259-TME-ACTN   
R025                                   TO B259-TME-ACTN              .  
           MOVE R259-GRP-NBR-VENDOR 
                                       TO B259-GRP-NBR-VENDOR          .
           MOVE R259-CDE-VENDOR-PREF
                                       TO B259-CDE-VENDOR-PREF         .
           MOVE R259-NBR-VENDOR 
                                       TO B259-NBR-VENDOR              .
           MOVE R259-AMT-ARREARS-OSTNDG 
                                       TO B259-AMT-ARREARS-OSTNDG      .
           MOVE R259-AMT-RENT-MONTHLY   
                                       TO B259-AMT-RENT-MONTHLY        .
           MOVE R259-AMT-PAYMENT-VENDOR 
                                       TO B259-AMT-PAYMENT-VENDOR      .

       8752-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R268
      ********************************************************  
       8756-MOVE-R268.  
           MOVE SPACES                 TO B268-BUDGET-MEMBER-RELATION.  
           MOVE 'H4'
                                       TO B268-SORT-KEY              .  
           MOVE 'R268'  
                                       TO B268-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B268-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B268-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B268-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B268-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B268-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B268-REC-INDCTR            .  
           MOVE R268-NBR-INDIV  
                                       TO B268-NBR-INDIV             .  
           MOVE R268-NBR-LINE-INDIV 
                                       TO B268-NBR-LINE-INDIV        .  
           MOVE R268-DTE-BGN-EFFV   
                                       TO B268-DTE-BGN-EFFV          .  
           MOVE R268-DTE-END-EFFV   
                                       TO B268-DTE-END-EFFV          .  
           MOVE R268-DTE-CHNG   
                                       TO B268-DTE-CHNG              .  
R025       MOVE R268-TME-ACTN   
R025                                   TO B268-TME-ACTN              .  

       8756-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R260
      ********************************************************  
       8758-MOVE-R260.  
           MOVE SPACES                 TO B260-BULK-MAILING          .  
           MOVE 'H3'
                                       TO B260-SORT-KEY              .  
           MOVE 'R260'  
                                       TO B260-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B260-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B260-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B260-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B260-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B260-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B260-REC-INDCTR            .  
           MOVE R260-DTE-BGN-EFFV   
                                       TO B260-DTE-BGN-EFFV          .  
           MOVE R260-DTE-END-EFFV   
                                       TO B260-DTE-END-EFFV          .  
           MOVE R260-DTE-CHNG   
                                       TO B260-DTE-CHNG              .  
R025       MOVE R260-TME-ACTN   
R025                                   TO B260-TME-ACTN              .  
           MOVE R260-CDE-MAIL-BULK  
                                       TO B260-CDE-MAIL-BULK         .  

       8758-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R954
      ********************************************************  
       8770-MOVE-R954.  
           MOVE SPACES                 TO B954-SECD-ACTN             .  
           MOVE LOW-VALUES  
                                       TO B954-SECD-ACTN             .  
           MOVE 'A1'
                                       TO B954-SORT-KEY              .  
           MOVE 'R954'  
                                       TO B954-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B954-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B954-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B954-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B954-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B954-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B954-REC-INDCTR            .  
           MOVE WSH-PAYMENT-DATE
                                       TO B954-DTE-BGN-EFFV          .  
           MOVE ZEROS   
                                       TO B954-DTE-END-EFFV          .  
R033       MOVE ZEROS   
R033                                   TO B954-CDE-REFL-HIPP         .  
           MOVE ZEROS   
                                       TO B954-DTE-FUT-EFFV          .  
M307       MOVE WSH-CPF-CYCLE-JUL   
                                       TO B954-DTE-CHNG              .  
           MOVE R672-NBR-IMW
                                       TO B954-NBR-IMW               .  
M307       MOVE WSH-CPF-CYCLE-JUL   
                                       TO B954-DTE-AUZD-CASE         .  
           MOVE 'A' 
                                       TO B954-CDE-STUS              .  
           MOVE SPACES  
                                       TO B954-CDE-DOC-REDET         .  
           MOVE SPACES  
                                       TO B954-CDE-CAT-EXCESS        .  
           MOVE R672-NBR-CSLD   
                                       TO B954-NBR-CSLD              .  
           MOVE '1' 
                                       TO B954-CDE-MODE-PRCS         .  
           MOVE SPACES  
                                       TO B954-CDE-STUS-RECUR-CLER, 
                                          B954-CDE-STUS-NON-RECUR-CLER, 
                                          B954-CDE-STUS-SCH-CCBALT, 
MD01                                      B954-CDE-MODE-SECOND, 
                                          B954-CDE-STUS-EDBC         .  
           MOVE ZEROS   
                                       TO B954-DTE-EDBC-START,  
                                          B954-AMT-FSA-SHARE.   
           MOVE ZEROS   
                                       TO B954-COM-NBR-APPLN         .  
           MOVE ZEROS   
                                       TO B954-DTE-RCVD-APPLN        .  
           MOVE SPACES  
                                       TO B954-CDE-ACTN-AECM         .  
           MOVE SPACES  
                                       TO B954-CDE-ACTN-EDBC         .  
           MOVE R634-CDE-RCOUPMT-VENDOR 
                                       TO B954-CDE-RCOUPMT-VENDOR    .  
           MOVE R634-CNT-MEM-ACT
                                       TO B954-CNT-PERS-BEFORE       .  
           MOVE R634-CNT-MEM-ACT
                                       TO B954-CNT-PERS-AFTER        .  

           IF WSS-R654-REC-ON   
              MOVE R654-AMT-GR-CASH    TO B954-AMT-GRANT-BEFORE 
              MOVE R654-AMT-GR-CASH    TO B954-AMT-GRANT-AFTER  
           ELSE 
              MOVE R255-AMT-GRANT-CASH TO B954-AMT-GRANT-BEFORE 
              MOVE R255-AMT-GRANT-CASH TO B954-AMT-GRANT-AFTER       .  

           MOVE R634-CDE-STUS-PROG  
                                       TO B954-CDE-STUS-PROG         .  
           MOVE SPACES  
                                       TO B954-CDE-STUS-RECUR        .  
           MOVE SPACES  
                                       TO B954-CDE-STUS-NON-RECUR    .  
           MOVE WSH-PMT-DATE-MMYY-R 
                                       TO B954-DTE-PMT-MO            .  
           MOVE SPACES  
                                       TO B954-CDE-STUS-SLCT         .  
           MOVE ZEROS   
                                       TO B954-CDE-RSN               .  
           MOVE SPACES  
                                       TO B954-CDE-NCE               .  
           MOVE SPACES  
                                       TO B954-CDE-FS-EXPD-AECM      .  
R025       MOVE SPACES  
R025                                   TO B954-CDE-SCH-INCOME        .  
           MOVE R634-CDE-ETP
                                       TO B954-CDE-ETP               .  
           MOVE R634-CDE-4D 
                                       TO B954-CDE-4D                .  
R025       ACCEPT WS-SYSTEM-TIME       FROM TIME                     .  
R025       MOVE WS-SYSTEM-HHMMSS       TO B954-TME-ACTN              .  
           MOVE R634-CDE-STUS-BDGT     TO B954-CDE-STUS-BEFORE       .  
           MOVE R634-CDE-STUS-BDGT     TO B954-CDE-STUS-AFTER        .  
           MOVE ZEROS                  TO B954-AMT-GRANT-CHNG        .  
R025       MOVE SPACES                 TO B954-CDE-TYPE-OTG          .  
           MOVE SPACES                 TO B954-CDE-CAT-AP            .  
           MOVE SPACES                 TO B954-NBR-GG-AP             .  
           MOVE SPACES                 TO B954-CDE-DISPN-APPLN-AP    .  
           MOVE SPACES                 TO B954-CDE-FS-EXPD-AP        .  
           MOVE ZEROS                  TO B954-DTE-TRKG-AP           .  
R004       MOVE WSH-PAYDAY-NBR         TO B954-NBR-PDY               .  
R024       MOVE CPF-CYCLEDATE-JUL      TO B954-DTE-ACTN-LAST         .  
           MOVE ZEROS                  TO B954-TME-ACTN-LAST         .  
           MOVE SPACES                 TO B954-CDE-DIST-BEFORE       .  
           MOVE ZEROS                  TO B954-NBR-CSLD-BEFORE       .  

       8770-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R654
      ********************************************************  
       8774-MOVE-R654.  
           MOVE SPACES                 TO B654-CM-OVRD                 .
           MOVE 'H3'
                                       TO B654-SORT-KEY                .
           MOVE 'R654'  
                                       TO B654-REC-CDE                 .
           MOVE R666-NBR-CASE   
                                       TO B654-NBR-CASE                .
           MOVE R249-CDE-CATEGORY   
                                       TO B654-CDE-CATEGORY            .
           MOVE R249-NBR-GROUP-GRANT
                                       TO B654-NBR-GROUP-GRANT         .
R025       MOVE 'R' 
R025                                   TO B654-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B654-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B654-REC-INDCTR            .  
           MOVE R654-DTE-BGN-PER-BNFT   
                                       TO B654-DTE-BGN-EFFV            .
           MOVE R654-DTE-END-PER-BNFT   
                                       TO B654-DTE-END-EFFV            .
           MOVE ZEROS   
                                       TO B654-DTE-CHNG                .
R025       MOVE R653-TME-ACTN   
R025                                   TO B654-TME-ACTN              .  
           MOVE R654-NBR-OPRTR  
                                       TO B654-NBR-OPRTR               .
           MOVE R654-NBR-IMW
                                       TO B654-NBR-IMW                 .
           MOVE R654-DTE-BGN-PER-BNFT   
                                       TO B654-DTE-BGN-PER-BNFT        .
           MOVE R654-DTE-END-PER-BNFT   
                                       TO B654-DTE-END-PER-BNFT        .
           MOVE R654-DTE-OPENED-BDGT
                                       TO B654-DTE-OPENED-BDGT         .
           MOVE R654-DTE-CLSD-BDGT  
                                       TO B654-DTE-CLSD-BDGT           .
           MOVE R654-AMT-GR-CASH
                                       TO B654-AMT-GR-CASH             .
           MOVE R654-NBR-SUPVR-IMW  
                                       TO B654-NBR-SUPVR-IMW           .
           MOVE R654-CDE-EDBC-OVRD-NF   
                                       TO B654-CDE-EDBC-OVRD-NF        .
           MOVE R654-CDE-RSN-OVRD-NF
                                       TO B654-CDE-RSN-OVRD-NF         .
           MOVE R654-CDE-EDBC-OVRD-RESRC
                                       TO B654-CDE-EDBC-OVRD-RESRC     .
           MOVE R654-CDE-RSN-OVRD-RESRC 
                                       TO B654-CDE-RSN-OVRD-RESRC      .
           MOVE R654-CDE-EDBC-OVRD-INC  
                                       TO B654-CDE-EDBC-OVRD-INC       .
           MOVE R654-CDE-RSN-OVRD-INC   
                                       TO B654-CDE-RSN-OVRD-INC        .
           MOVE R654-AMT-INIT-CASH  
                                       TO B654-AMT-INIT-CASH           .

       8774-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R271
      ********************************************************  
       8780-MOVE-R271.  
           MOVE SPACES                 TO B271-RECOUPMENT            .  
           MOVE 'H3'
                                       TO B271-SORT-KEY              .  
           MOVE 'R271'  
                                       TO B271-REC-CDE               .  
           MOVE R666-NBR-CASE   
                                       TO B271-NBR-CASE              .  
           MOVE R249-CDE-CATEGORY   
                                       TO B271-CDE-CATEGORY          .  
           MOVE R249-NBR-GROUP-GRANT
                                       TO B271-NBR-GROUP-GRANT       .  
R025       MOVE 'R' 
R025                                   TO B271-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B271-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B271-REC-INDCTR            .  
LOOK       MOVE ZEROS   
LOOK                                   TO B258-DTE-BGN-EFFV          .  
LOOK       MOVE ZEROS   
LOOK                                   TO B258-DTE-END-EFFV          .  
LOOK       MOVE ZEROS   
LOOK                                   TO B258-DTE-CHNG              .  
R025       MOVE ZEROS   
R025                                   TO B271-TME-ACTN              .  
           MOVE R271-NBR-REFL   
                                       TO B271-NBR-REFL              .  
           MOVE R271-CDE-TYPE-REFL  
                                       TO B271-CDE-TYPE-REFL         .  
           MOVE R271-CDE-INDCTR-PCTG-RCOUPMT
                                       TO B271-CDE-INDCTR-PCTG-RCOUPMT .
           MOVE R271-DTE-BEGIN-RCOUPMT  
                                       TO B271-DTE-BEGIN-RCOUPMT     .  
           MOVE R271-CDE-PROJECT-REFL   
                                       TO B271-CDE-PROJECT-REFL      .  
           MOVE R271-AMT-CLAIM-RCOUPMT  
                                       TO B271-AMT-CLAIM-RCOUPMT     .  
           MOVE R271-AMT-INSTMT 
                                       TO B271-AMT-INSTMT            .  
           MOVE R271-AMT-RCOUPMT-OSTNDG 
                                       TO B271-AMT-RCOUPMT-OSTNDG    .  
           MOVE R271-DTE-EFFV-STATUS-RCOUPMT
                                       TO B271-DTE-EFFV-STATUS-RCOUPMT .
           MOVE R271-CDE-STATUS-RCOUPMT 
                                       TO B271-CDE-STATUS-RCOUPMT    .  

       8780-EXIT.   
           EXIT.

      ********************************************************  
      *** MOVE  R291
      ********************************************************  
       8790-MOVE-R291.  
           MOVE SPACES                 TO B291-BENEFIT                 .
           MOVE ' ' 
                            TO B291-SORT-KEY                           .
           MOVE 'R291'  
                            TO B291-REC-CDE                            .
           MOVE R666-NBR-CASE   
                            TO B291-NBR-CASE                           .
           MOVE R249-CDE-CATEGORY   
                            TO B291-CDE-CATEGORY                       .
           MOVE R249-NBR-GROUP-GRANT
                            TO B291-NBR-GROUP-GRANT                    .
R025       MOVE 'R' 
R025                                   TO B291-CDE-PRCS              .  
R025       MOVE 01  
R025                                   TO B291-CNTR-PRCS             .  
R025       MOVE SPACES  
R025                                   TO B291-REC-INDCTR            .  
           MOVE ZEROS   
                            TO B291-DTE-BGN-EFFV                       .
           MOVE ZEROS   
                            TO B291-DTE-END-EFFV                       .
           MOVE ZEROS   
                            TO B291-DTE-CHNG                           .
R025       MOVE ZEROS   
R025                                   TO B291-TME-ACTN              .  
R069       IF  WSS-BDGT-PRORATED-CLOSE-ON   
R069           MOVE  5  TO  B291-CDE-TYPE-BENEFIT   
R069           MOVE  WSH-DTE-CLOSED-BDGT TO B291-DTE-END-PERIOD-BENEFIT 
R069       ELSE 
R069           MOVE  3  TO  B291-CDE-TYPE-BENEFIT   
R069           IF  WST-CAT-TYPE (WSI-CAT-IDX)  =  2  OR  3  
R069               MOVE  WSH-3-PAYDATE  TO  
R069                   B291-DTE-END-PERIOD-BENEFIT  
R069           ELSE 
R069               MOVE  WSH-2-PAYDATE  TO  
R069                   B291-DTE-END-PERIOD-BENEFIT. 
R069       MOVE  WSH-PAYMENT-DATE  TO  B291-DTE-BENEFIT 
R069                                   B291-DTE-BEGIN-PERIOD-BENEFIT.   

       8790-EXIT.   
           EXIT.

R075A  2111F-GET-REAPP. 
R076       DISPLAY 'BEFORE W634-DTE-DUE-REDET :' W634-DTE-DUE-REDET 
R076          UPON PRINTER. 
R076       IF W634-REDET-GRG-MM > 24
R076          SUBTRACT 24 FROM W634-REDET-GRG-MM
R076          ADD 2 TO W634-REDET-GRG-YY
R076          GO TO 211FG-CALC. 
R075A      IF W634-REDET-GRG-MM > 12
R075A         SUBTRACT 12 FROM W634-REDET-GRG-MM
R076          ADD 1 TO W634-REDET-GRG-YY
R076          GO TO 211FG-CALC. 
R076   211FG-CALC.  
R075A      DIVIDE W634-REDET-GRG-YY BY 4 GIVING WS-LEAP-YEAR
R075A                                 REMAINDER WS-REMAINDER.   
R075A      MOVE WS-EOM (W634-REDET-GRG-MM) TO  W634-REDET-GRG-DD.   
R076       DISPLAY 'W634-DTE-DUE-REDET :' W634-DTE-DUE-REDET
R076          UPON PRINTER. 
R075A      IF WS-REMAINDER = 0 AND W634-REDET-GRG-MM = 2
R075A         ADD 1 TO W634-REDET-GRG-DD.   
R075A  2111F-EXIT.  
R075A        EXIT.  
CC47A   
CC47A  2111G-CALC-EXTN. 
CC47A      COMPUTE WS-OPEN-REAPP-GAP
CC47A       = ((12 * W634-REDET-GRG-YY) + W634-REDET-GRG-MM) -  
CC47A         ((12 * W634-DTE-OPENED-YY) + W634-DTE-OPENED-MM)  
CC47A   
CC47A      IF WS-OPEN-REAPP-GAP < 13
CC47A         MOVE 0 TO WS-NO-OF-AUTO-EXTNS 
CC47A      ELSE 
CC47A         IF WS-OPEN-REAPP-GAP < 25 
CC47A            MOVE 1 TO WS-NO-OF-AUTO-EXTNS  
CC47A         ELSE  
CC47A            IF WS-OPEN-REAPP-GAP < 37  
CC47A               MOVE 2 TO WS-NO-OF-AUTO-EXTNS   
CC47A            ELSE   
CC47A               IF WS-OPEN-REAPP-GAP < 49   
CC47A                  MOVE 3 TO WS-NO-OF-AUTO-EXTNS
CC47A               ELSE
CC47A                  IF WS-OPEN-REAPP-GAP < 61
CC47A                     MOVE 4 TO WS-NO-OF-AUTO-EXTNS 
CC47A                  ELSE 
CC47A                     IF WS-OPEN-REAPP-GAP < 73 
CC47A                        MOVE 5 TO WS-NO-OF-AUTO-EXTNS  
CC47A                     ELSE  
CC47A                        IF WS-OPEN-REAPP-GAP < 85  
CC47A *                          MOVE 6 TO WS-NO-OF-AUTO-EXTNS. 
R079                      MOVE 6 TO WS-NO-OF-AUTO-EXTNS 
R079                 ELSE   
R079                      IF WS-OPEN-REAPP-GAP < 97 
R079                      MOVE 7 TO WS-NO-OF-AUTO-EXTNS 
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 109
R079                      MOVE 8 TO WS-NO-OF-AUTO-EXTNS 
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 121
R079                      MOVE 9 TO WS-NO-OF-AUTO-EXTNS 
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 133
R079                      MOVE 10 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 145
R079                      MOVE 11 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 157
R079                      MOVE 12 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 169
R079                      MOVE 13 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 181
R079                      MOVE 14 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 193
R079                      MOVE 15 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 205
R079                      MOVE 16 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 217
R079                      MOVE 17 TO WS-NO-OF-AUTO-EXTNS
R079                   ELSE 
R079                      IF WS-OPEN-REAPP-GAP < 229
R079                      MOVE 18 TO WS-NO-OF-AUTO-EXTNS.   
CC47A  2111G-EXIT.  
CC47A        EXIT.  
CC47A   
R075A  2111E-CLOSE-MG99.
R075A      IF WS-NO-OF-AUTO-EXTNS = 0   
R075A         ADD 13  TO W634-REDET-GRG-MM  
R075A      ELSE 
R075A         ADD 12  TO W634-REDET-GRG-MM. 
R075A      PERFORM 2111F-GET-REAPP THRU 2111F-EXIT. 
R075A      FIND CURRENT R634-CM-BUDGET-INFO RECORD. 
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A      MOVE WSH-TODAYS-DATE  TO   R634-DTE-END-EFFV 
R075A                                 R634-DTE-CHANGE-HIPAA.
R075A      MODIFY R634-CM-BUDGET-INFO RECORD.   
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R078       MOVE 'R634' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R075A      MOVE 'Y'               TO   WSS-UPDATE-FLAG. 
R075A      FIND CURRENT R249-CASH-MEDICAL-BUDGET RECORD.
R075A      IF ERROR-CODE IS EQUAL TO '00'   
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         DISPLAY ' INVALID R249 FIND ==>  '
R075A                R246-NBR-CASE UPON PRINTER 
R075A         PERFORM 7995-DB-ERROR.
R075A      MOVE WSH-TODAYS-DATE       TO   R634-DTE-BGN-EFFV
R075A                                      R634-DTE-CHANGE-HIPAA
R075A                                      R634-DTE-CHNG.   
R079       ACCEPT WS-SYSTEM-TIME      FROM TIME.
R076       MOVE WS-SYSTEM-HHMMSS      TO   R634-TME-ACTN.   
R075A      MOVE ZEROES                TO   R634-DTE-END-EFFV.   
R075A      MOVE 'N'                   TO   R634-IND-MA-AUTO.
R075A      MOVE 'F'                   TO   R634-CDE-ACTN-BDGT.  
R075A      MOVE 'O'                   TO   R634-CDE-STUS-BDGT.  
R075A      MOVE  W634-DTE-DUE-REDET   TO   M2K-GREGORIAN-DATE.  
R075A      PERFORM  6520-GRG-TO-JUL.
R075A      MOVE  M2K-JULIAN-DATE      TO   R634-DTE-DUE-REDET.  
R075A      MOVE 86986                 TO   R634-CDE-AUTH-CHG-BDGT.  
R075A      MOVE SPACE                 TO   R634-CDE-STUS-NOTICE 
R075A                                      R634-CDE-TYPE-NOTICE 
R075A                                      R634-CDE-OPTION-NOTICE.  
R075A      MOVE 446                   TO  R634-CDE-REASON-STUS. 
R075A      MOVE ZEROS                 TO  R634-CDE-RSN-NOTICE.  
R075A   
R075A      STORE R634-CM-BUDGET-INFO.   
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R078       MOVE 'R634' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R075A      MOVE 'Y'                   TO   WSS-UPDATE-FLAG. 
R075A      MOVE R246-NBR-CASE    TO   R355-MED-CASE 
R075A                                 LINK-NBR-CASE.
R075A   
R075A      CALL 'DBPA20' USING LINK-GET-CASE-AREAS. 
R075A      IF  LINK-CALL-STUS = 0   
R075A          NEXT SENTENCE
R075A      ELSE 
R075A          DISPLAY  'DBPA20 CALL ERROR :' R355-MED-CASE 
R075A             UPON PRINTER  
R075A          PERFORM 7995-DB-ERROR.   
R075A   
R075A      MOVE LINK-R355-AN             TO CALCR355-AN.
R075A      OPEN CALCR355-AN  USAGE-MODE  IS UPDATE  
R075A        ON ERROR GO TO 2112X-ERROR.
R075A  2112X-ERROR. 
R075A      IF ERROR-CODE = '00' OR '28' 
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A   
R075A      FIND R355-MED-CASE RECORD.   
R075A      IF ERROR-CODE IS EQUAL TO '00'   
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A          PERFORM 7995-DB-ERROR.   
R075A   
R075A      MOVE R249-CDE-CATEGORY     TO R356-CDE-CAT.  
R075A      MOVE R249-NBR-GROUP-GRANT  TO R356-NBR-GROUP-GRANT.  
R075A   
R075A      FETCH R356-MABDGT-EP 
R075A        VIA S355-MED-CASE-BDGT 
R075A          USING R356-CDE-CAT, R356-NBR-GROUP-GRANT.
R075A      IF ERROR-CODE IS EQUAL TO '00'   
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A   
R075A      FETCH FIRST R357-MEDICAL-BUDGET  
R075A      WITHIN S164-MA-RESULT SET.   
R075A   
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A   
R075A      MOVE R634-DTE-DUE-REDET          TO R357-DTE-DUE-REDET.  
R075A      MOVE WSH-TODAYS-DATE             TO R357-DTE-CHNG.   
R075A      MOVE WSH-SYS-TIME-SEC            TO R357-TME-ACTN.   
R075A   
R075A      MODIFY R357-MEDICAL-BUDGET RECORD.   
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R078       MOVE 'R357' TO D18-REC-CDE.  
R078       PERFORM 2065-PROCESS-ASB04B THRU 2065-EXIT.  
R075A   
R075A      FIND CURRENT R249-CASH-MEDICAL-BUDGET RECORD.
R075A      IF ERROR-CODE IS EQUAL TO '00'   
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         DISPLAY ' INVALID R249 FIND ==>  '
R075A                R246-NBR-CASE UPON PRINTER 
R075A         PERFORM 7995-DB-ERROR.
R075A   
R075A      FETCH FIRST R268-BUDGET-MEMBER-RELATION  
R075A      WITHIN S104-CM-BDGT-MBR-RLTN SET.
R075A      IF ERROR-NUM = '0000'
R075A         NEXT SENTENCE 
R075A      ELSE 
R075A         PERFORM 7995-DB-ERROR.
R075A   
R075A      MOVE R268-NBR-INDIV         TO ATE01D16-RECIPIENT.   
R075A      MOVE R246-CM-CASE           TO ATE01D16-NBR-CASE.
R075A      MOVE R249-CDE-CATEGORY      TO ATE01D16-CDE-CAT. 
R075A      MOVE R249-NBR-GROUP-GRANT   TO ATE01D16-NBR-GG.  
R075A      MOVE R249-CTL-DIGIT         TO ATE01D16-CTL-DIGIT.   
R075A      MOVE 'MARCDV'               TO ATE01D16-NBR-TRANS.   
R075A      MOVE WSH-TODAYS-DATE        TO ATE01D16-DTE-BGN-EFFV.
R075A      MOVE ZEROS                  TO ATE01D16-DTE-END-EFFV.
R075A      MOVE WSH-TODAYS-DATE        TO ATE01D16-DTE-CHNG.
R075A      MOVE WS-SYSTEM-TIME         TO ATE01D16-TIME-ACTN.   
R075A      PERFORM 8606-WRITE-ATE01D16      THRU 8606-EXIT. 
R075A   
R075A      MOVE S634-DTE-DUE-REDET      TO ATE01D21-REAPP-OLD   
R075A      MOVE R634-DTE-DUE-REDET      TO ATE01D21-REAPP-NEW   
R075A      MOVE R246-NBR-CASE           TO ATE01D21-CASE
R075A      MOVE R249-CDE-CATEGORY       TO ATE01D21-CAT 
R075A      MOVE R249-NBR-GROUP-GRANT    TO ATE01D21-GG  
R075A      MOVE R634-CDE-STUS-PROG      TO ATE01D21-PS  
R075A      WRITE ATE01D21-RECORD
R075A      MOVE SPACES                  TO ATE01D21-RECORD  
R075A      ADD 1                        TO WSA-ATE01D21-REC-CNT 
R075A      ADD 1                        TO WS-MG99-AUTO-RENEW.  
R075A   
R075A  2111E-EXIT.  
R075A        EXIT.  
R077   2321XX-DECIDE-NOTICE.
R077       IF (CIS014-DD-IND = 'Y') 
R077          IF (R249-CDE-CATEGORY = 'D')  
R077            MOVE  3            TO D11-CDE-OPTION-NOTICE 
R077          ELSE  
R077            IF (R249-CDE-CATEGORY = 'PD')   
R077               MOVE  'A'       TO D11-CDE-OPTION-NOTICE.
R077
R077       IF (CIS014-DA-IND = 'Y') 
R077          IF (R249-CDE-CATEGORY = 'D')  
R077            MOVE  5            TO D11-CDE-OPTION-NOTICE 
R077          ELSE  
R077            IF (R249-CDE-CATEGORY = 'PD')   
R077               MOVE  'B'       TO D11-CDE-OPTION-NOTICE.
R077
R077       IF (CIS014-DV-IND = 'Y') 
R077          IF (R249-CDE-CATEGORY = 'D')  
R077            MOVE  7            TO D11-CDE-OPTION-NOTICE 
R077          ELSE  
R077            IF (R249-CDE-CATEGORY = 'PD')   
R077               MOVE  'C'       TO D11-CDE-OPTION-NOTICE.
R077   2321XX-EXIT. 
R077          EXIT. 
      *******************************************************   
      *** DETAILED FILE WRITE SECTION.                    ***   
      *** SECTION 8800.                                   ***   
      *** FOLLOWING ENTRY POINTS ARE DEFINED :            ***   
      ***    . 8850     ATE01D05.                         ***   
      ***    . 8860     ATE01D06.                         ***   
      ***    . 8880     ATE01D08.                         ***   
      ***    . 8885     ATE01D09.                         ***   
      ***    . 8890     ATE20D01.                         ***   
      *******************************************************   
       8800-DET-WRITE-OUT-FILES SECTION.

      *******************************************************   
      ***       8850.    ATE01D05.                        ***   
      *******************************************************   
       8850-DET-WRITE-ATE01D05. 
           WRITE ATE01D05-REC.  
R077       IF ATE01D05-CDE-CATEGORY = 'D  ' 
R077          MOVE 'PD '  TO ATE01D05-CDE-CATEGORY  
R077          WRITE ATE01D05-REC
R077       ELSE 
R077          IF ATE01D05-CDE-CATEGORY = 'PD '  
R077            MOVE 'D  '  TO ATE01D05-CDE-CATEGORY
R077            WRITE ATE01D05-REC. 
           MOVE SPACES                 TO ATE01D05-REC         .
           ADD 1                       TO WSA-ATE01D05-REC-CNT .

       8850-EXIT.   
           EXIT.

      *******************************************************   
      ***       8860.    ATE01D06.                        ***   
      *******************************************************   
R069A *8860-DET-WRITE-ATE01D06. 
R069A *    WRITE ATE01D06-RECORD.   
R069A *    MOVE SPACES                 TO ATE01D06-RECORD      .
R069A *    ADD 1                       TO WSA-ATE01D06-REC-CNT .
R069A * 
R069A *8860-EXIT.   
R069A *    EXIT.

      *******************************************************   
      ***       8880.    ATE01D08.                        ***   
      *******************************************************   
       8880-DET-WRITE-ATE01D08. 
           WRITE ATE01D08-RECORD.   
           MOVE SPACES                 TO ATE01D08-RECORD      .
           ADD 1                       TO WSA-ATE01D08-REC-CNT .

       8880-EXIT.   
           EXIT.

      *******************************************************   
      ***       8885.    ATE01D09.                        ***   
      *******************************************************   
       8885-DET-WRITE-ATE01D09. 
           WRITE ATE01D09-RECORD.   
           MOVE SPACES                 TO ATE01D09-RECORD      .
           ADD 1                       TO WSA-ATE01D09-REC-CNT .

       8885-EXIT.   
           EXIT.

      *******************************************************   
      ***       8890.    ATE20D01.                        ***   
      *******************************************************   
       8890-DET-WRITE-ATE20D01. 
R069       IF  WSH-RUN-FLAG  =  'A80'   
R069           REWRITE PAYDAY-REC.  

       8890-EXIT.   
           EXIT.

      *******************************************************   
      ***       8895.    ATE01DCKPT.                      ***   
      *******************************************************   
       8895-DET-WRITE-ATE01DCKPT.   
           WRITE ATE01DCKPT-RECORD. 

       8895-EXIT.   
           EXIT.

      ******************************************************
      *** GENERAL DB ERROR AND ROLLBACK ERROR SECTION.   ***
      ******************************************************
       9000-GENERAL-DB-ROLLBACK-ERROR SECTION.  
R069       COPY APD809P 
                REPLACING 0300-CLOSING BY 3000-CLOSING. 
           DISPLAY 'ERROR OCCURED IN PARA NO '   WSH-ERR-PARA-NO
                                                 UPON PRINTER.  
R060       DISPLAY  'ERROR CASE = '  R666-NBR-CASE  UPON  PRINTER.  
           SET SW-FATAL-ERROR-FLAG     TO ON.   



