000100 IDENTIFICATION DIVISION.
000200* RP0326 TRANSLATED ON 880310
000300* TRANSLATED BY BATCH CONVERSION UNIT USING
000400* TRANSIT SOFTWARE BY UCCEL, INC.
000500 PROGRAM-ID.
000600     RP0326.
000700*
000800*AUTHOR         CAL OKAMOTO ASSEMBLY 5-18-76.
000900*AUTHOR         KENT CAMPBELL 68 COBOL 8-5-80.
001000*AUTHOR         PARK CORTELL 74 COBOL 3-9-86.
001100*AUTHOR         KAREN SHEPHERD  COBOL II 7/90.
001100*AUTHOR         MARK SAGE DB2 & MERGED RP0226 7/2012.
001100*AUTHOR         NICK NAGGAR
001100*AUTHOR         ALBERT AGUILAR FROM DB2 TO BATCH DRIVER 6/2021.
001200*
001300*MAINTENANCE:   AMINIE D. ELSBERRY   7/94.
001400*MAINTENANCE:   SHERRY MADRIGAL11/97.
001400*MAINTENANCE:   MWNMN - Nick Naggar
001500*DATE-COMPILED .
001600*
001700*TITLE          POTENTIAL VALIDATION.
001800*
001900*    PROCEDURE  RP01.
002000*    NARRATIVE:
002100*                 THE POTENIAL (POT) VALIDATION PROGRAM TAKES
002200*              POT INDEX RECORDS EXTRACTED FROM THE VR SHADOW
002200*              BY RP012E.  THE FIRST RECORD OF THE FILE IS A
002200*              HEADER RECORD WITH THE BATCH ID AND AN INDICATOR
002200*              OF THE TYPE OF RECORDS TO PROCESS (I.E. DPP, PFR,
002200*              OHV, ETC...).  THE REMAINING RECORDS CONTAIN AN
002200*              INDEX THAT IS USED TO DO A DIRECT CALL TO THE
002200*              VR MASTER DATA BASE TO RETREIVE THE RECORDS TO
002200*              BE PROCESSED.  ONCE EVERY TWO YEARS THE HEADER
002200*              RECORD WILL CONTAIN THE DISABLED PALCARD
002200*              INDICATOR "DPP" TO PROCESS THE DPP'S.
002200*
002200*              ALSO IT TAKES THE COMPRESSED VR RECORDS
002200*              EXTRACTED WITH THE 407 RUN AND PROCESSES THEM.
002300*              IT USES OF6012 TO EXPLODE THE COMPRESSED RECORD
002400*              AND OF6512 TO VALIDATE THE LICENSE NUMBER.
      *              IT VALIDATES ALL DATA ITEMS FOR REG REQUIREMENTS
002600*              AND THEN ASSIGNS PAPER CODES AND SPECIAL HANDLE
002700*              CODES.
002800*
002900*              RECORDS ARE RATED BY CALLED MODULE RP032F.
003000*
003100*              A COURT NAME TABLE IS PASSED TO THE PROGRAM
003200*              VIA A CALL TO PROGRAM UP2396 AT THE
003300*              BEGINNING OF PROCESSING.
003400*
003500*              OUTPUTS CREATED ARE:
003600*              (1) AN ITT FILE FOR UPDATING PARKING CITATIONS
003700*                  ITEMS AND DELETE FOR E-62 REASON CODE 7.
003800*              (2) A PFR FILE FOR DOWNSTREAM PROCESSING IN THE
003900*                  FLEET REG. SYSTEM
004000*              (3) A POTENTIALS FILE FOR DOWNSTREAM PROCESSING
004100*                  BY POTS SORT/SHRED AND PRINT PROGRAMS
004200*              (4) A REPORT FILE CONTAINING AN ERROR LIST AND POTS
004300*                  COUNTS BY EXP-DATE AND BY PAPER CODES
004400*              (5) A REPORT FILE CONTAINING BYPASSED RECORD COUNTS
004500*              (6) A SYSOUT LISTING WITH INPUT AND OUTPUT COUNTS
004500*
rd1722*              Calls to External Modules:
rd1722*                 - CALL OF601C          - EXPLOSION MODULE
rd1722*                 - CALL OF651C       - Call Translate - License
rd1722*                 - CALL OR1582          - GET CENTURY
rd1722*                 - CALL C01FCALL/OR1F82 - RTC VR Rec Dates
rd1722*                 - CALL RP032F          - Rate Module
rd1722*                 - CALL UP2396          - COURT NAME TABLE
rd1722*                 - CALL USPCBM01    - FINALIST County Code Gen.
rd1722*                 - CALL UC0196      - CONNECT TO DB2 DATA BASE.
LDS   *                 - CALL OM6996      - READ USING BATCH DRIVER
LDS   *                                      REMOVE DIRECT DB2 LOGIC
RD1722*
RD1722/***************************************************************
RD1722***    CHANGES LOG  /  MODIFICATIONS
RD1722****************************************************************
RD1722* DATE       VV.LL PROGRAMMER / DESCRIPTION
RD1722* ---------- ----- ----------------------------------
RD1722*
      * XX/XX/XXXX 01.99 XXXXXXXXXXXXXXXXXXXXXXX
      *                  XXXXXXXXXXXXX
      *                  XXXXXXXXXXXXX
      *
R3366 * 01/24/2022 01.23 ROD-2021-3366 SUSPENSION OF PNO INVITATION
R3366 *                  TO RENEW NOTICES
R3366 *                  ADD END-IF STATEMENTS
R3366 *                  MWWXM3 - WADE MALANCHUK
      *
R2882 * 11/11/2021 01.22 ROD-2020-2882 AUTONOMOUS D REQUEST
R2882 *                  AVB NEEDS TO MARK ALL DEPLOYMENT AUTONOMOUS D
R2882 *                  VEH. TO SEPARATE FROM AUTONOMOUS TESTING VEH.
R2882 *                  MWWXM3 - WADE MALANCHUK
R2882 *
R31280* 06/06/2021 01.21 CR #31280 CONVERT PROGRAM FROM DIRECT DB2
R31280*                  READ OF VR MASTER TO BATCH DRIVER READ USING
LDS   *                  MODULE OM6996 FOR RANDOM READ OF VR MASTER
LDS   *                  FOR EACH INPUT RECORD
LDS   *                  MWWXM3 - WADE MALANCHUK
LDS   *                  MWACA4 - ALBERT AGUILAR
      *
R20192* 10/09/2020 01.20 MWWXM3 - WADE MALANCHUK
R20192*                  ROD2020192 ALL POW PLATES TO ACCEPT ANY
R20192*                  VALID EXPIRATION DATE. BEFORE ONLY 12/31
R20192*                  WERE VALID.
      *
RDC355* 07/26/2019 01.19 MWWXM3 - WADE MALANCHUK
RDC355*                  RDC-3558 MOTIVE POWER 'Y' DIESEL HYBRID
RDC355*                  GVW <= 14,000 LBS ( ALREADY CODED)
RDC355*                  INCLUDE BUILT > 01-01-1998 (NO CODE HERE)
RDC355*                  TYPE VEHICLE (04, 09, 11, 12, 13, 17, 18,
RDC355*    19, 21, 22, 23, 26, 28, 29, 31, 32, 33, 37, 38, 39, 51,
RDC355*    53, 61, 62, 63, 64, 65, 68, 69, 81, 82, 83)
      *
RAR709* 07/16/2019 01.18 MWWXM3 - WADE MALANCHUK
RAR709*                  RAR-0709 IN-USE HEAVY DUTY DIESEL REGS AND
RAR709*                  DENY REGISTRATION AS APPLICABLE
RAR709*                  IF RCC 85 AND REASON CODE=02 SET PRINT FLAG
      *
RB1948* 12/10/2018 01.17 MWWXM3 - WADE MALANCHUK
RB1948*                  RBY-1948 ADD LOGIC TO REMOVE EXEMPTION FROM
RB1948*                  CVRA & CVRA FEES($3) FOR ELECTRIC COMMERICAL
RB1948*                  VEHICLE
RB1948*                  -INITIALIZE 3RD ROW IN COUNT TABLE
RB1948*                   CTR-BYP-ROW (3) AND INCREASE 47 > 54 TIMES
RB1948*                  -INITIALIZE USING INITIALIZE VERB
RB1948*                  -INCREASE INDEX 47 > 54 FOR SUBTOTALS
RB1948*
RA1108* 08/02/2018 01.16 MWWXM3 - WADE MALANCHUK
RA1108*                  RBA-1108 CHANGES FOR ELECTRIC OHV, ADD CODES
RA1108*                  IN W-S, ADD LOGIC FOR ELECTRIC EXEMPT STATUS,
RA1108*                  TYPE LIC & TYPE VEH COMBO MSG
RA0088*                  RAA-0088 RECOMPILE FOR POTREC COPYBOOK UPDATE
RA0088*
RW3557* 05/21/2017 01.15 MWWXM3 - WADE MALANCHUK
RW3557*                  RCW-3557 PFR PROGRAM EXPANSION
RW3557*                  INCREASE THE NUMBER OF ACCOUNT NUMBERS
RW3557*                  THAT PFR CAN USE; Q000-Q999, 000Q-999Q,
RW3557*                  000W-999W, 000X-999X, 000Y-999Y, 000Z-999Z
RW3557*
RB1097* 10/13/2017 01.14 MWACA4 - ALBERT AGUILAR
RB1097*                  RBI-1097 BREAST CANCER AWARENESS (SLP)
RB1097*                  ADD NEW TLC TO CVRA: QB QF QJ QN
RB1097*                  ADD NEW TYPE PLATE CODE: BC
RB1097*
RB1616* 03/17/2017 01.13 MWACA4 - ALBERT AGUILAR
RB1616*                  RBP-1616 TLC FOR NON-COMP ROV
RB1616*                  ADD NEW TLC 2X 2Y
RB1616*                  BYPASS BRM=RO AND TLC NOT 2X OR 2Y
RB1616*
DPPFIX* 02/15/2017 01.12 MWACA4 - ALBERT AGUILAR
DPPFIX*                  FIX DPP COUNTER
DPPFIX*
RC3435* 03/10/2016 01.11 MWACA4 - ALBERT AGUILAR
RC3435*                  RCHA-3435 CA MUSEUM ELP
RC3435*                  ADD NEW TLC TO CVRA: YB YF YK YP
RC3435*                  ADD NEW TYPE PLATE CODE: SN
RC3435*
RAY634* 05/22/2015 01.10 MWNMN - Nick Naggar
RAY634*                1. RAY-0634 Add RCCs to Ineligible Renewal List.
RAY634*                   Disallow registration renewal when SUB-E
RAY634*                   of the vehicle record contains
RAY634*                   RCC:49 RSN:03 (Salvage Retention)
RAY634*                2. DPP extract check: curr-Yr+TL N1+N3 skip N2
RAY634*                3. Validation totals: don't add skipped to TOT
ray634*
RC1994*
RC1994* 03/10/2015 01.09 MWNMN  - Nick Naggar
RC1994*                  RCRb-1994 Legacy Special Interest Plate
RC1994*                  Add new commercial TLC to CVRA: LB LF LJ LN
      *
VRMDCK* 01/07/2015 01.08 MWNMN  - Nick Naggar
VRMDCK*                  VR MASTER Expiration/Due DATE CHECK.
VRMDCK*                  Production issue batch 05-2015 Delinquent
VRMDCK*                  records updated on VRM after the Extract.
      *
EHCVRA* 10/03/2014 01.08 MWWLW3 - WARREN WEBER
EHCVRA*                  PREVENT ELECTRIC AND HYDROGEN POWERED
EHCVRA*                  VEHICLES FROM PROCESSING AS CVRA/CTIP
      *
RB0714* 07/22/2014 01.07 MWNMN - Nick Naggar
RB0714*                  RBFa-0714 Legislative Plate Fee Changes
RB0714*                  TLC New:  L0 L1 L2 L3
RB0714*                  TLC Discontinued/obsolete: 10 L5 L6 L7 L8
      *
MPCR  * 07/22/2014 01.06 MWNMN - Nick Naggar
MPCR  *                  RCKb-1623 Motive Power Code "R" for
MPCR  *                  Hydrogen Fuel Cell Vehicles
      *
RF3543* 05/29/2014 01.05 MWNMN - Nick Naggar
RF3543*                  RFF-3543 VLT STOP E-5 RC-94 FOR TEST VEHICLES
RF3543*
PFRFIX*
PFRFIX* 05/06/2014 01.04 MWNMN - NICK NAGGAR
PFRFIX*                  NO LONGER PFR   BYPASS.
PFRFIX*                  EXCEPTION RELEASE / FAST-TRACK TO GO BEFORE
PFRFIX*                  VLTS E-5-94.
RF3543*
RF3543* 04/25/2014 01.04 MWNMN - Nick Naggar
RF3543*                  RFF-3543 VLT STP E-5 RC 94 FOR TEST VEHICLES
RF3543*
RE3253* 02/13/2014 01.03 MWNMN - Nick Naggar
RE3253*                  REW-3253 Title Branding Autonomous Vehicles
RE3253*
RE3253* 11/19/2013 01.02 MWMBS2-Mark Sage - AMIS report
RE3253*
RB0933*
RB0933* 08/01/2013 01.01 MWNMN - Nick Naggar
RB0933*                  RBC-0933 Pet Lovers Special Interest License
RB0933*                  Plate. New Type License Code (TLC) FOR CVRA:
RB0933*                  AB AF AJ AN
RB0933*
RB0933* 07/19/2013 01.00 MWMBS2-Mark Sage - DB2 version 0100
RB0933*                  SRT-201102 AMIS Log Image Conversion/DB2.
RB0933*
RD1912* 02/05/2013 01.55 MWNMN - Nick Naggar
RD1912*                  RDIb-1912 "CalAg Special Interest License
CALAG *                             PLATE".
RD1912*                  New "Type License Code (TLC)" for Sequential
RD1912*                  and ELP Personalized, each for regular and
RD1912*                  Non-transferable (Goldenrod).
RD1912*                  New "Plate Type" "AG" "PT".
RD1722*
RE2511* 12/19/2012 01.54 MWNMN - Nick Naggar
RE2511*                  REZB-2511 "ARB-EMISSION RECALL PROGRAM
RE2511*                           FOR OHV, MOTOR CYCLES, VESSELS".
RE2511*                  IN ADDITION TO THE CURRENT E-74 FOR
RE2511*                  AUTOMOBILES AND COMMERCIAL VEHICLES,
RE2511*                  WITHHOLD REGISTRATION TO REGISTERED OWNERS
RE2511*                  WHO DO NOT RESPOND TO THE MANUFACTURER'S
RE2511*                  EMISSION RECALL, RECORD CONDITION CODE 74
RE2511*                  RCC 74 (SUB RECORD E - I.E. E-74).
RE2511*                  NEW CERTICATES ARE ALSO ADDED TO RC9171
RE2511*                  BASED ON THE SCANLINE DOCUMENT:
re2511*                  Certificate required code 13 ARB Boat 120
re2511*                  Certificate received code 17 ARB Boat 120
re2511*
rd1722* 07/25/2012 01.53 MWNMN - Nick Naggar
rd1722*                  "RDD-1722 Replace ZIPMOD (Zip Code Module)
rd1722*                  with FINALIST".
rd1722*                  Replace the County Code Generation module
rd1722*                  UP2596 (zipmod) with USPCBM01 (FINALIST)
rd1722*                  keeping all parms as is.
rd1722*                  < changes marked with RD1722 >
rd1722*
rd1722*
GLDSTR* 09/2010  RBMD-0810 ADD NEW GOLD STAR TYPE LIC
DPEXE * 03/2010  RBTe0447  ADD NEW DP TYPE LIC K6/K7, CVRA APPLICABLE
OHVITR* 06/2009  RBR-0979  MODIFIED PGM TO EXTRACT OHV PNO BASED UPON
OHVITR*                    THEIR RENEWAL YEAR (EXP YR EVEN THEN EXTRACT
OHVITR*                    ON EVEN YEAR:EXP YR ODD THEN EXTRACT ODD YR)
SB1500* 06/2006            - WHEN E-62 RSN 7 ON FILE DELETE ITT
SB1500* 03/2006            - WHEN E-83 ON FILE MOVE S TO PO-EFR-REQUIRED
scanln* 07/2005            - remove fee calculation calls and process
scanln*                      fees will be calcd in rp0826
DPPWGT* 06/2005  RFLB-3070 - RAISE THE THRESHOLD FOR THE WEIGHT
      *                     FEE EXEMPTION ON COMMERICIAL VEHICLES
      *                     ASSIGNED A DPP LICENSE PLATES FROM 6,000
      *                     LBS TO 8,000 LBS.
LIVERY* 05/2005  RAV-0405B- AMENDED- PUT IT TO AN ERROR FILE
      *                     IF TL 1W OR 1X AND BTM IS NOT LM
      *                     OR TL A0 OR A6 AND SPECIAL PLATE
      *                     TYPE CODE IN SUB E IS L AND BTM IS NOT LM
POWPRD* 04/2005  PROD CHG - MODIFY TO COMPUTE FEES INSTEAD OF ERROR
      *                     FOR POW THAT DO NOT HAVE A RCC 36 ON THE
      *                     RECORD PER LEAH KELLY IN RAD AND PARK
NDRPRO* 01/2004  PROD CHG - BYPASS ALL EXPIRED VEHICLES WITH NO E69
      *                     PRIOR TO 01/29/2004
CVRAPK* 03/3002  PROD CHG - IF COMMERCIAL AND IT IS A PICKUP GO
      *          TO UNLADEN WEIGHT ELSE CHECK CERTIFICATION CODE
      *          C OR D AND MOVE Y TO CVRA INDICATOR.
NONCOM* 03/2003  NON-COMPLYING, LIMITED USE, MOTORCYCLES AND ATV
      *          PROVIDE VALIDATION FOR THE TYPE LICENSE 2T, 2U
      *          2V OR 2W.  IF RCC 49-12 IS PRESENT TYPE LICENSE
      *          MUST BE 2T,2U,2V OR 2W. IF NOT PUT IT TO THE ERROR
      *          FILE. IF RCC 49-12 IS NOT PRESENT AND TYPE LICENSE
      *          IS 2T,2U,2V OR 2W PUT IT TO THE ERROR FILE.
ADDRSP* 02/2003  PROD CHG - ADD CODE TO CHECK FOR SPACES IF MORE
      *          THEN ONE SPACE IS DETECTED PUT IT TO ERROR FILE.
ADDRPR* 12/2002  PROD CHG - ADD ADDRESS AND CITY VALIDATION CHAR
      *          IF INVALID CHAR IS DETECTED WILL PUT IT TO ERROR
      *          FILE.
CVRAPR* 09/2002  PROD CHG - IF A VEHICLE CVRA WEIGHT IS ZERO DO NOT
      *          PUT IT TO ERROR WITH THE EXCEPTION OF PICKUPS
      *          PER PARK AND JUDY
CVRAPR* 07/2002  PROD CHG - IF A VEHICLE UNLADEN WEIGHT IS GREATER
      *          THEN CVRA WEIGHT AND THE CVRA WEIGHT IS LESS THEN
      *          80000 PUT IT TO ERROR PER PARK AND JUDY
VLF=MA* 03/2002  PROD CHG - SHOULD A VEHICLE HAVE A 'MA' VALUE WITH
VLF=MA*          NO SUBRECORD E55 CONTAINING A PURCHASE PRICE,
VLF=MA*          PUT IT TO ERROR PER PARK AND JUDY
POWWGT*          PROD CHG - SHOULD A PRISONER OF WAR PLATE BE ASSIGNED
POWWGT*          TO COMMERCIAL VEHICLE WITH WEIGHT GREATER THAN 8000#,
POWWGT*          PUT IT TO ERROR PER PARK AND JUDY
POWE36*          PROD CHG - SHOULD A PRISONER OF WAR PLATE BE ASSIGNED
POWE36*          TO A VEHICLE AND THERE IS NO SUBRECORD E36 ON FILE,
POWE36*          PUT IT TO ERROR PER PARK AND JUDY
DPWGT *          PROD FIX - SHOULD A DISABLE PERSON PLATE BE ASSIGNED
DPWGT *          TO COMMERCIAL VEHICLE WITH WEIGHT GREATER THAN 6000#,
DPWGT *          PUT IT TO ERROR PER PARK AND JUDY
FHVUT * 12/2001  OUTGOING POT BILLING NOTICE WILL MARK A FHVUT POT
FHVUT *          WITH AN 'X' (CERTIFIED WEIGHT => 54000 LBS OR IF
FHVUT *          DEFAULTED). THE 'F' (UNLADEN WGT > 8000 LBS) WILL
FHVUT *          NO LONGER BE GENERATED.
CVRA  * 09/2001  CVRA - COMMERCIAL VEHICLE REGISTRATION ACT
CVRA  *          ESTABLISH A COMMERCIAL VEHICLE WEIGHT BASED ON A
CVRA  *          DECLARED GROSS OR COMBINED GROSS WEIGHT GREATER
CVRA  *          THAN 10,000 #'S (PICKUPS ARE EXCLUDED).  RECOVERY
CVRA  *          OF REGISTRATION AND WEIGHT FEE IN THE LATTER.
PTI   *          PTI  - PERMANENT TRAILER INDICIA
PTI   *          REMOVE TRAILERS AND SEMITRAILERS FROM THE VEHICLE
PTI   *          FEE, BY ELIMINATING THE ANNUAL REG FEE (EXCEPT FOR
PTI   *          TRAILER COACHES & PARK TRAILERS).  A $20 CONVERSION
PTI   *          FEE WILL BE CHARGED INITIALLY THEN A $10 FIVE YEAR
PTI   *          SERVICE (RENEWAL) FEE.
CTIP  *          CTIP - CARGO THEFT INTERDICTION PROGRAM
CTIP  *          PREVIOUSLY COLLECTED UNDER MCP AS OF JAN 1, 2001
CTIP  *          COLLECTION CHANGED TO A FLAT 3.00 FEE FOR THOSE
CTIP  *          VEHICLES THAT FALL IN THIS CATAGORY, BACKBILLING
CTIP  *          WILL NEED TO BE APPLIED
JC0501* 05/2001  PRODUCTION CORRECTION:  INCREASE SUBW RECORD
JC0201* 02/2001  PRODUCTION CORRECTION:  ADD CENTURY TO DATE FIELD FOR
JC0201*          SUBRECORD E64.
JC0101* 01/2001  PRODUCTION CORRECTION:  ADD AN INVALIDATION EXPIRATION
JC0101*          DATE OF THE '27'TH.
JC0900* 09/2000  NEW VLT REASON CODES ADDED TO RCC (05), BYPASS RECORD
JC0900*          WHEN ENCOUNTERED. PM# RBS-1389 (REASON CODE 04 THRU 11)
JC0900*          PM# RCR-1660 (REASON CODE 67) PM# RFD-3279 (REASON CODE
JC0900*          68).
004700* 09/29/99 CHANGE PAPER CODE "U" (POT WITH CITATIONS) TO "C"
004700* IMMEDIATELY BEFORE WRITING POTREC. PM RBQ-1349
004700*05/04/99 ADD LOGIC FOR E36-02 (POW RECORDS)
004800*12/21/98 WRITE ERROR MSG WHEN ASTERISK CC = 18
004900*12/11/98 REMOVED CODE FOR FUTURE DATE CHECK ON AUTOS (EXTRACT
005000*NO LONGER EXTRACTS AUTOS WITH FUTURE DATES) CORRECTION IS
005100*NEEDED TO CORRECT BATCH 1 PROCESSING
005200*9/30/98 TEMP CHNG REPLACE RP032F-RP032G; FEELINK2-FEELINKG
005300*08/98 CHANGES FOR VLF OFFSET
005400*      PREVENT BACK BILLING FOR VEHICLES SOLD IN 1999
005500*06/98 CHANGES FOR SMOG ABATEMENT
005600*03/98 CHANGES FOR Y2K
005700*11/97     REMOVE SMOG DONATION LOGIC AND FIX LOGIC FOR
005800*          COMPUTING POTREC EXPIRATION DATE WHEN AN OHV
005900*          AN E69 SUBRECORD FOR OHV PNO
006000*08/01/95  ADE  ADDITIONAL BYPASS CODE TO E20 SUBRECORD
006100*  THE FOLLOWING TI/TO FILE CODE CHANGE IS COMMENTED OUT UNTIL
006200*  CALVIN COMPLETES TESTING.  PNO CHANGES PUT INTO PRODUCTION
006300*11/22/94  ADE  MODIFIED TITLE/TRANSFER ONLY LOGIC-PROCESS JUST
006400*               LIKE PNO-EXCEPT MOVE 'I' TO FILE CODE
006500*               ADDED TABLE TO ALLOW TESTING OF DIFFERENT RUN
006600*               DATES.  BY CREATING A DUMMY 1ST RECORD THAT IS
006700*               NOT A 407 RECORD THE SYSTEM DATE CAN BE CHANGED
006800*               ACCORDING TO THE RID NUMBER CREATED.
006900*               THE FIRST TWO BYTES OF THE DUMMY RECORD RID =
007000*               THE YEAR.  THE SECOND TWO BYTES OF THE DUMMY
007100*               RECORD RID = MONTH.  IF YOU WANT TO RUN ON THE
007200*               END OF THE MONTH/ADD 12 TO THE MONTH IE, EOM
007300*               JULY 94 THE RID = 9419
007400*               BEGINNING OF THE MONTH FOR AUGUST 95
007500*               RID = 9508
007600*07/26/94  ADE  ADDED E46 RSN CODE 04 SMOG CHANGES
007700*TYPE LIC PLATE TABLE ADDED                          KES 07/15/94
007800*ELIMINATE CHANGING OF 'NEW' TV TO OLD               KES 07/12/94
007900*FIX PROCESSING FOR TL 'J6' 'J7' 'U6' 'U7' 'X6' 'X7' KES 05/26/94
008000*REPLACE COURT ABBREV TABLE EXTERNAL FILE WITH CALL
008100*   TO UP2396                                         KES 05/17/94
008200*UPDATE E-20 RECORD FORMAT AND BYPASS LOGIC           KES 03/15/94
008300*
008400*  SEE ENDEVOR FOR HISTORY OF CHANGES
008400*  ------------------------------------------------------------
008500/*********************************************************
008600*         E N V I R O N M E N T   D I V I S I O N        *
008700**********************************************************
008800 ENVIRONMENT DIVISION.
008900 CONFIGURATION SECTION.
009000 SOURCE-COMPUTER.
009100     IBM-Z.
009100*    IBM-Z WITH DEBUGGING MODE.
009200 OBJECT-COMPUTER.
009300     IBM-Z.
009400*
009500*
009600 SPECIAL-NAMES.
009700*
009800 INPUT-OUTPUT SECTION.
009900*
010000 FILE-CONTROL.
010100*******************************************
010200*         INPUT  FILES  AND TABLES        *
010300*******************************************
010400     SELECT POTIN1
010500              ASSIGN POTIN1.
010400     SELECT OEXTRACT
010500              ASSIGN OEXTRACT.
010600     SELECT TLTABLE
010700              ASSIGN TYPELIC
010800              ORGANIZATION INDEXED
010900              ACCESS SEQUENTIAL
011000              RECORD KEY TL-TBL-KEY.
011100*******************************************
011200*  OUTPUT FILES, REPORTS AND              *
011300*******************************************
011400     SELECT PTOUT1
011500              ASSIGN PTOUT1.
011600     SELECT ITTOUT
011700              ASSIGN ITTOUT.
SB1500     SELECT ITTOUT2
SB1500              ASSIGN ITTOUT2.
011800     SELECT EXTOUT
011900              ASSIGN EXTOUT.
012000     SELECT PFR
012100              ASSIGN PFR.
012200     SELECT RPORT
012300              ASSIGN RPORT.
012400     SELECT BYPASS
012500              ASSIGN BYPASS.
012600 I-O-CONTROL.
012700/*********************************************************
012800*                D A T A   D I V I S I O N               *
012900**********************************************************
013000 DATA DIVISION.
013100 FILE SECTION.
013200********************************************
013300*         I N P U T   R E C O R D          *
013400********************************************
013500 FD  POTIN1
013600         LABEL RECORDS STANDARD
013700         BLOCK CONTAINS 0 RECORDS
013800         RECORDING MODE IS V.
013900 01  POT-IN1.
014000     05  FILLER                  PIC X(3742).
      *
013500 FD  OEXTRACT
013600         LABEL RECORDS STANDARD
013700         BLOCK CONTAINS 0 RECORDS
013800         RECORDING MODE IS F.
013900 01  O-EXT.
         COPY POTEXT.

      ********************************************
      *** COPY POTEXT  End         ***************
      ********************************************

014100********************************************
014200*         I N P U T   T A B L E S          *
014300********************************************
014400 FD  TLTABLE.
014500 01  TL-TBL-REC.
014600     05  TL-TBL-KEY              PIC X(04).
014700     05  FILLER                  PIC X(96).
014800
014900/*******************************************
015000*        O U T P U T   R E C O R D S       *
015100********************************************
015200 FD  PTOUT1
015300         LABEL RECORDS STANDARD
015400         BLOCK CONTAINS 0 RECORDS
015500         RECORDING MODE IS V.
015600 01  POT-OUT-1.
015700     05  FILLER                  PIC X(863).
015800     05  FILLER                  PIC X(47) OCCURS 0 TO 12
015900         DEPENDING ON PO-CITLST.
016000
016100 FD  ITTOUT
016200         LABEL RECORDS STANDARD
016300         BLOCK CONTAINS 0 RECORDS
016400         RECORDING MODE IS V.
016500 01  ITT-OUT.
016600     05  FILLER                  PIC X(37).
SB1500
016100 FD  ITTOUT2
016200         LABEL RECORDS STANDARD
016300         BLOCK CONTAINS 0 RECORDS
016400         RECORDING MODE IS V.
016500 01  ITT-OUT2.
016600     05  FILLER                  PIC X(57).
016700*
016800 FD  PFR
016900         LABEL RECORDS STANDARD
017000         BLOCK CONTAINS 0 RECORDS
017100         RECORDING MODE IS V.
017200 01  PFR-OUT.
017300     05  FILLER             PIC X(57).
017400     05  FILLER             PIC X(01) OCCURS 1 TO 9942
017500         DEPENDING ON PFR-REC-SIZE.
017600 FD  EXTOUT
017700         LABEL RECORDS STANDARD
017800         BLOCK CONTAINS 0 RECORDS
017900         RECORDING MODE IS V.
018000 01  EXTOUT-REC.
017300     05  FILLER             PIC X(57).
017400     05  FILLER             PIC X(01) OCCURS 1 TO 9942
017500         DEPENDING ON EXT-REC-SIZE.
018300*********************************
018400*  O U T P U T   R E P O R T S  *
018500*********************************
018600 FD  RPORT
018700         LABEL RECORDS OMITTED
018800         BLOCK CONTAINS 0 RECORDS
018900         RECORDING MODE IS F.
019000 01  REPORT-LINE.
019100     05  FILLER                  PIC X(133).
019200*
019300 FD  BYPASS
019400         LABEL RECORDS OMITTED
019500         BLOCK CONTAINS 0 RECORDS
019600         RECORDING MODE IS F.
019700 01  BYPASS-LINE.
019800     05  FILLER                  PIC X(133).
019900
020000/*************************************************************
020100*        W O R K I N G   S T O R A G E   S E C T I O N       *
020200**************************************************************
020300 WORKING-STORAGE SECTION.
020400 01  FILLER.
020500     05  FILLER                  PIC X(34) VALUE
020600                          '** BEGIN WORKING STORAGE RP0326 **'.

020700****************************
020800*   FILE STATUS INDICATORS *
020900****************************
021000*********************************************************
021100*              I  N  P  U  T     A  R  E  A             *
021200*********************************************************
021300 01  EXT-EXTRACT-RECORD.
021400     05  FILLER                  PIC X(01) VALUE SPACE.
021500     05  FILLER                  PIC X(03) VALUE SPACE.
021600         88  EXT-UD407-RECORD              VALUE '407'.
021700         88  EXT-TEST-CENTURY              VALUE '519' '520'.
021800         88  EXT-TEST-CC-19                VALUE '519'.
021900     05  EXT-RID                 PIC X(04) VALUE SPACE.
022000         88  EXT-MSTR-RID                  VALUE '8516' '8515'
022100                                      '4401' '4405' '8519' '8520'.
022200         88  EXT-STAT-RID                  VALUE '8518'.
022300         88  EXT-RID-4401                  VALUE '4401'.
022400         88  EXT-RID-4405                  VALUE '4405'.
022500         88  EXT-RID-8515                  VALUE '8515'.
022600         88  EXT-RID-8516                  VALUE '8516'.
022700         88  EXT-RID-8520                  VALUE '8520'.
022800         88  DELINQUENT-REG                VALUE '8520' '4405'.
022900         88  407-REC                       VALUE '4401' '4405'
023000                                                 '8515' '8519'.
023100         88  DMVA-REC                      VALUE '8519'.
023200         88  DESTROYED-BILLING             VALUE '4401' '4405'.
023300     05  EXT-RID-N REDEFINES EXT-RID.
023400         10  EXT-TEST-YY         PIC 9(02).
023500         10  EXT-TEST-MM         PIC 9(02).
023600     05  EXT-PLATE-LIC-NBR.
023700         10  FILLER              PIC X(01) VALUE SPACE.
023800         10  FILLER              PIC X(03) VALUE SPACE.
023900             88  EXT-RENT-LIMO             VALUE 'ZZZ'.
024000         10  FILLER              PIC X(03) VALUE SPACE.
024100             88  EXT-REV-RENT-LIMO         VALUE 'ZZZ'.
024200     05  EXT-PLATE-LIC-NBR-R REDEFINES EXT-PLATE-LIC-NBR.
024300         10  LICENSE-1ST-BYTE    PIC X(01).
024400         10  EXT-LIC-1ST-2       PIC X(02).
024500             88  EXT-CC-LIC                VALUE 'CC'.
024600         10  FILLER              PIC X(04).
024700     05  EXT-PLATE-LIC-NBR-R2 REDEFINES EXT-PLATE-LIC-NBR.
024800         10  LICENSE-BYTES1-3    PIC X(03).
024900             88  POW-PREFIX                VALUE 'POW'.
025000         10  LICENSE-BYTES4-7    PIC X(04).
025100     05  FILLER                  PIC X(06) VALUE SPACE.
025200     05  GTS-APPEND-DIGITS       PIC X(02) VALUE SPACE.
025300         88  GTS-APPEND-PARTYR             VALUE '09'.
025400*    05  FILLER                  PIC X(25) VALUE SPACE.
025400     05  FILLER                  PIC X(07) VALUE SPACE.
025400     05  EXT-PROGRAM             PIC X(06) VALUE SPACE.
025300         88  EXT-RC8271                    VALUE 'RC8271'.
025400     05  EXT-SUFFIX              PIC X(01) VALUE SPACE.
025300         88  EXT-R66                       VALUE 'A'.
025300         88  EXT-RIN                       VALUE 'B'.
025400     05  FILLER                  PIC X(11) VALUE SPACE.
025500     05  EXT-COMPRESSED-LTH-IN   PIC 9(04)    COMP VALUE ZERO.
025600     05  FILLER                  PIC X(09) VALUE SPACE.
025700     05  EXT-MASTER-RECORD-IN.
025800         10  EXT-TYPE-RECORD     PIC X(01) VALUE SPACE.
025900             88  TYPE-RECORD-0-OR-5        VALUE '0' '5'.
026000             88  TYPE-RECORD-4             VALUE '4'.
026100             88  TYPE-RECORD-5             VALUE '5'.
026200             88  TYPE-RECORD-7             VALUE '7'.
026300         10  FILLER              PIC X(4028) VALUE SPACE.
026400*
026500 01  STATISTICS-REC-R        REDEFINES EXT-EXTRACT-RECORD.
026600     05  STATISTICS-RECORD       PIC X(1064).
026700     05  FILLER                  PIC X(3024).
026800*
026900 01  CR-COMPRESSED-RECORD.
027000     05  CR-RECORD-KEY.
027100         10  FILLER              PIC X(07) VALUE SPACE.
027200     05  CR-COMPRESSED-LTH       PIC 9(04)    COMP VALUE ZERO.
027300     05  FILLER                  PIC X(01) VALUE SPACE.
027400     05  CR-COMPRESSED-MASTER.
027500         10  FILLER              PIC X(03) VALUE SPACE.
027600         10  CR-TYPE-LIC.
027700             15  FILLER          PIC X(01) VALUE SPACE.
027800                 88  CR-IRP-TYPE-LIC       VALUE '8'.
027900             15  FILLER          PIC X(01) VALUE SPACE.
028000         10  FILLER              PIC X(4024) VALUE SPACE.

       01  MS-ERROR.
           05 MS-TITLE                 PIC X(30).
           05 MS-POT2                  PIC X(80).

LDS   *----------------------------
LDS   * B A T C H   D R I V E R
LDS   *----------------------------
       01 BATCH-DRIVER.
          02 BD-CALL-PARAMETERS.
             15 BD-FUNCTION            PIC X(08).
                88 BD-FUNCTION-OPEN    VALUE 'OPEN    '.
                88 BD-FUNCTION-READ    VALUE 'READ    '.
                88 BD-FUNCTION-RANDOM  VALUE 'RANDOM  '.
                88 BD-FUNCTION-CLOSE   VALUE 'CLOSE   '.
             15 BD-RET-CODE            PIC X(04).
                88 BD-RET-CODE-GOOD    VALUE '0000'.
                88 BD-RET-CODE-EOF     VALUE '0004'.
                88 BD-RET-CODE-REC-NOT-FOUND VALUE '0004'.
                88 BD-RET-CODE-INVALID-KEY   VALUE '0610'.
             15 BD-FILE-CODE           PIC X(01).
                88 BD-FILE-CODE-C      VALUE 'C'.
                88 BD-FILE-CODE-U      VALUE 'U'.
             15 BD-KEY                 PIC X(30).
          02 BD-VR-MASTER.
LDS            05  BD-VRM-HEADER       PIC X(10).
LDS            05  BD-VRM-REC          PIC X(10000).

028100/********************************************************
028200*              E X P L O S I O N   A R E A              *
028300*********************************************************
028400 01  DB2-EXPLOSION-AREA.
028900     05  FILLER                  PIC X(02).
028500     05  DB2-REC                 PIC X(10000).
028400 01  EA-EXPLOSION-AREA.
028500     05  EA-REC.
028600         10  EA-BYTE             PIC X(01) OCCURS 10000
028700         INDEXED BY IDX-EA.
028800     05  EA-REC-R            REDEFINES EA-REC.
028900         10  EA-LICENSE-NUM      PIC X(07).
028900         10  FILLER              PIC X(03).
028900         10  EA-TYPE-RECORD      PIC X(01).
025900             88  EA-TYPE-RECORD-0-OR-5     VALUE '0' '5'.
026000             88  EA-TYPE-RECORD-4          VALUE '4'.
026100             88  EA-TYPE-RECORD-5          VALUE '5'.
026200             88  EA-TYPE-RECORD-7          VALUE '7'.
028900         10  FILLER              PIC X(02).
029000         10  EA-TB               PIC X(01).
CTIP               88  EA-CTIP-EXEMPT            VALUE 'B' 'X' 'P'.
CTIP               88  EA-CTIP-AMBULANCE         VALUE 'A'.
CTIP               88  EA-CTIP-TOWTRUCK          VALUE 'Y'.
029100             88  EA-HOUSE-TRLR-TB          VALUE 'T'.
CVRA               88  EA-PICKUP-TB              VALUE 'P'.
029200         10  EA-TL               PIC X(02).
RB0714             88  EA-TL-Obsolete            VALUE '10' 'L5' 'L6'
RB0714                                                 'L7' 'L8'.
LIVERY             88  EA-TL-LIMO                VALUE '1W' '1X'.
LIVERY             88  EA-TL-CVRA-LIMO           VALUE 'A0' 'A6'.
NONCOM             88  EA-TL-NON-COMP            VALUE '2T' '2U'
RB1616                                                 '2X' '2Y'
NONCOM                                            '2V' '2W'.
RB1616             88  EA-TL-VAL-RO              VALUE '2X' '2Y'
RB1616                                                 'F2' 'F5' 'F8'.
029300             88  EA-TL-HAM-5X              VALUE '58' '59'.
029400             88  EA-TL-V3-4                VALUE 'V3' 'V4'.
029500             88  EA-TL-COM-EXP-DT          VALUE 'H1' 'H2' 'H3'
029600                                            'H4' '11' '21' '31'
029799                                            '40' '41' '70' '71'
029800                                            '75' '79' 'K2' 'K3'
029900                                            'H8' 'H9'.
030000             88  EA-TL-C0-C7               VALUE 'C0' THRU 'C7'.
DPWGT              88  EA-TL-COM-DP              VALUE 'K2' 'K3'.
CVRA               88  EA-TL-CVRA                VALUE 'U2' 'U3' '1W'
RB0714                                            '1X' 'L2' '2C' '2D'
CVRA                                              '3C' '3D' '3S' '5C'
CVRA                                              '5D' '7C' '7D' 'RE'
GLDSTR                                            '7M' '7S'
CVRA                                              'RF' 'RR' 'RS' '5S'
CVRA                                              '5T' '9E' '9F' '31'
CVRA                                              '93' 'A0' '06' 'X2'
CVRA                                              'X3' '63' '67' 'B2'
CVRA                                              'B3' 'G2' 'G3' 'J2'
DPEXE                                   'K6' 'K7' 'J3' 'K2' 'K3' 'M4'
CVRA                                              'M5' 'R2' 'R3' 'S2'
CVRA                                              'S3' 'T1' 'T6' 'Y2'
CVRA                                              'Y7' '64' '68' '53'
CVRA                                              '57' 'A0' 'A6' 'C4'
RD1912                                            'C5'
RD1912***--- RD1912 - CalAg CVRA
RD1912                                            'BC' 'BD' 'FC' 'FD'
RB0933***--- RB0933 - CVRA PET LOVERS
RB0933                                            'AB' 'AF' 'AJ' 'AN'
RC1994***--- RCRb-1994 - CVRA Legacy special Interest Plate
RC1994                                            'LB' 'LF' 'LJ' 'LN'
RC3435***--- RCHA-3435 - CVRA CA MUSEUM
RC3435                                            'YB' 'YF' 'YK' 'YP'
RB1097***--- RBI-1097  - CVRA BREAST CANCER AWRNESS
RB1097                                            'QB' 'QF' 'QJ' 'QN'
RB0933                                            .
RB0933***------------------------------------------------------------
RD1912***
030100         10  EA-TL-R         REDEFINES EA-TL.
030200             15  FILLER          PIC X(01).
030300                 88  EA-TL-7X              VALUE '7'.
030400                 88  EA-TL-6X              VALUE '6'.
030500                 88  EA-TL-COM-EXP-DT1     VALUE 'A' 'J' 'K' '5'
030600                                            '6' '9'.
030700             15  FILLER          PIC X(01).
030800         10  EA-VLF-CL           PIC X(02).
030900         10  FILLER              PIC X(03).
031000         10  EA-EXP-DT.
031100             15  EA-EXP-YR.
031200                 20  FILLER      PIC 9(01).
031300                 20  EA-EXP-YR2  PIC 9(01).
OHVITR                     88  EA-EXP-YR-EVEN    VALUE 0 2 4 6 8.
031400                     88  EA-EXP-YR-ODD     VALUE 1 3 5 7 9.
031500             15  EA-EXP-MODA.
031600                 20  EA-EXP-MO   PIC 9(02).
031700                     88  EA-EXP-MO-JAN-MAR VALUE 01 02 03.
PTIPRO                     88  EA-EXP-MO-JAN-FEB VALUE 01 02.
031800                     88  MO-11THRU03       VALUE 11 12 01 02 03.
031900                 20  EA-EXP-DA   PIC 9(02).
032000                     88  EA-BAD-DAY        VALUE 1 3 4 5 6 7 9 11
032100                                         13 15 17 19 21 23 25 27.
032200         10  EA-TV.
032300             15  FILLER          PIC X(01).
032400                 88  EA-TV-MC              VALUE '2'.
032500                 88  EA-TV-COML            VALUE '3'.
032700             15  FILLER          PIC X(01).
032800         10  EA-TV-R         REDEFINES EA-TV.
032900             15  FILLER          PIC X(02).
SPCIAL                 88  EA-TV-SPECIAL         VALUE '01' '02' '03'
FARM                                                   '09'.
033000                 88  EA-TV-HISTORICAL      VALUE '10'.
033100                 88  EA-TV-HISTORICAL-MC   VALUE '20'.
033200                 88  EA-TV-HISTORICAL-TRLR VALUE '40'.
OHVERR                 88  EA-TV-OHV             VALUE '61' '62' '63'
OHVERR                                                 '64' '68' '69'.
RA1108                 88  EA-TV-OHV-ELEC        VALUE '54' '55' '56'
RA1108                                                 '57' '58'.
033300                 88  EA-TV-VESSEL          VALUE '81' '82'.
033300                 88  EA-TV-VSL-NON-RES     VALUE '83'.
033400                 88  EA-TV-REMAN           VALUE '18' '19' '28'
033500                                            '29' '38' '39' '48'
033600                                            '49' '68' '69'.
033700                 88  EA-TV-ELEC-COML       VALUE '34' '35' '36'.
033800                 88  EA-TV-ELEC            VALUE '14' '15' '16'
033900                                            '24' '25' '27'.
034000                 88  EA-TV-10-39-INS-REQ   VALUE '10' THRU '39'.
IRPTRL                 88  EA-TV-IRP-TRL         VALUE '52'.
032600                 88  EA-TV-TRLR            VALUE '40' THRU '49'
IRPTRL                                                 '52'.
GLDROD                 88  EA-TV-GOLDROD         VALUE '13' '17' '23'
GLDROD                                                 '27' '33' '37'
GLDROD                                                 '43' '47'.
DPP                    88  EA-TV-DPP             VALUE '91' '92'.
RDC355                 88  EA-TV-DIESEL-HYBRID   VALUE '04' '09' '11'
RDC355                   '12' '13' '17' '18' '19' '21' '22' '23' '26'
RDC355                   '28' '29' '31' '32' '33' '37' '38' '39' '51'
RDC355                   '53' '61' '62' '63' '64' '65' '68' '69' '81'
RDC355                   '82' '83' .
034200         10  EA-REG-CO.
034300             15  EA-REG-CO-9     PIC 9(02).
034400                 88  EA-VALID-REG-CO       VALUE 1 THRU 58 60.
034500         10  EA-RO-ZIP           PIC 9(05).
034600             88  EA-NO-RO-ZIP              VALUE 00000.
034700         10  EA-YFS              PIC 9(02).
034800         10  EA-DFS-M            PIC X(02).
034900         10  EA-DFS-D            PIC X(02).
035000         10  FILLER              PIC X(04).
035100         10  EA-YM               PIC X(02).
035200         10  FILLER              PIC X(20).
035300         10  EA-NA-INDS          PIC X(02).
035400         10  FILLER              PIC X(01).
035500*        10  FILLER              PIC X(05).
KIOSK          10  EA-LO-NA-1          PIC X(01).
KIOSK          10  EA-LO-NA-2          PIC X(01).
KIOSK          10  FILLER              PIC X(03).
035600         10  EA-VIN-L            PIC X(01).
035700*            88  EA-MAX-VIN-LTH            VALUE = '1D'.
035800             88  EA-MAX-VIN-LTH            VALUE  '_'.
035900         10  EA-VIN              PIC X(30).
036000         10  FILLER              PIC X(01).
036100         10  EA-BTM.
CTIP               88  EA-BTM-TOW      VALUE
CTIP                       'TOW'       'TWCAR'    'WK'     'WRECKER'
CTIP                       'TOWCAR'    'TWCR'     'WKR'    'WRK'
CTIP                       'TOWCR'     'TWTRK'    'WR'     'WRKER'
CTIP                       'TOWTRK'    'TOWTRUCK' 'WRCK'   'WRKR'.
LIVERY             88  EA-BTM-LIMO     VALUE
                           'LM'.
RB1616             88  EA-BTM-ROV      VALUE
RB1616                     'RO'.
036200                 20  EA-BTM1-5   pic X(05).
036600                 20  FILLER      PIC X(07).
036700         10  FILLER              PIC X(01).
036800         10  EA-MAKE             PIC X(12).
036900         10  FILLER              PIC X(01).
037000         10  EA-RON.
037100             15  EA-RONM5.
037200                 20  EA-RONM3.
037300                     25  EA-RON2 PIC X(02).
037400                        88  EA-P           VALUE 'P ' 'PA' 'PG'.
037500                     25  FILLER  PIC X(01).
037600                 20  FILLER      PIC X(02).
037700             15  FILLER          PIC X(25).
037800         10  EA-RO2-L            PIC X(01).
037900         10  EA-RO2.
038000             15  EA-RO2-BYTE1    PIC X(01).
038100             15  FILLER          PIC X(29).
ADDRPR         10  EA-RO-ADDR-ARRAY    REDEFINES EA-RO2.
ADDRPR             15  EA-RO-ADDR-CHAR  PIC X(01) OCCURS 30
ADDRPR         INDEXED BY IDX-ADD3.
038200         10  FILLER              PIC X(01).
038300         10  EA-ROCITY.
038400             15  EA-ROCITY-BYTE  PIC X(01) OCCURS 13
038500         INDEXED BY IDX-ROCITY.
038600             15  FILLER          PIC X(17).
038700         10  EA-VIN3             PIC X(03).
038800         10  EA-NBR-E            PIC 9(03)    COMP-3.
038900         10  EA-NBR-F            PIC 9(03)    COMP-3.
039000         10  EA-NBR-G            PIC 9(03)    COMP-3.
039100         10  EA-NBR-H            PIC 9(03)    COMP-3.
039200         10  EA-NBR-J            PIC 9(03)    COMP-3.
039300         10  EA-NBR-K            PIC 9(03)    COMP-3.
039400         10  EA-NBR-L            PIC 9(03)    COMP-3.
039500         10  EA-NBR-M            PIC 9(03)    COMP-3.
039600         10  EA-NBR-N            PIC 9(03)    COMP-3.
039700         10  EA-NBR-P            PIC 9(03)    COMP-3.
039800         10  EA-NBR-R            PIC 9(03)    COMP-3.
039900         10  EA-NBR-S            PIC 9(03)    COMP-3.
040000         10  EA-NBR-T            PIC 9(03)    COMP-3.
040100         10  EA-NBR-U            PIC 9(03)    COMP-3.
040200         10  EA-NBR-V            PIC 9(03)    COMP-3.
040300         10  EA-NBR-W            PIC 9(03)    COMP-3.
040400         10  FILLER              PIC X(07).
040500*        10  FILLER              PIC X(19).
040600/**    SUB RECORD B    **
040700         10  EA-AXLE             PIC X(01).
040800             88  EA-NO-AX-WGT              VALUE HIGH-VALUE.
040900         10  EA-WGT              PIC 9(05).
041000         10  EA-MP               PIC X(01).
041100             88  EA-NO-MP                  VALUE HIGH-VALUE.
MPCR               88  EA-ELEC-MP                VALUE 'E' 'R'.
RDC355             88  EA-DIESEL-HYBRID          VALUE 'Y' .
041300* THE PROJECT THAT WOULD HAVE ALLOWED ACCT NUMBERS STARTING WITH
041400* "1" WAS NEVER IMPLEMENTED, BUT THE IS MAINTAINED BECAUSE
041500* TEST RECORDS RESIDE IN SYSTEM TEST DB.
041600         10  EA-ACCT-NBR.
041700             88  EA-VALID-ACCT          VALUE '1001' THRU '1003'.
RW3557             15  FILLER          PIC X(04).
RW3557                 88  EA-PFR-MSTR      VALUE '9000' THRU '9999',
RW3557                                            'Q000' THRU 'Q999',
RW3557                                            '000Q' THRU '999Q',
RW3557                                            '000W' THRU '999W',
RW3557                                            '000X' THRU '999X',
RW3557                                            '000Y' THRU '999Y',
RW3557                                            '000Z' THRU '999Z'.
042000                 88  EA-NO-ACCT-NBR    VALUE HIGH-VALUE.
042100*            15  FILLER          PIC X(03).
042200         10  FILLER              PIC X(05).
042300         10  FILLER              PIC X(01).
042400             88  EA-NO-RO3                 VALUE HIGH-VALUE.
042500         10  EA-RO3              PIC X(30).
042600         10  FILLER              PIC X(01).
042700             88  EA-NO-RO4                 VALUE HIGH-VALUE.
042800         10  EA-RO4              PIC X(30).
042900         10  FILLER              PIC X(01).
043000         10  EA-EQUIP-NBR        PIC X(07).
043100         10  EA-VES-HULL-MAT     PIC X(01).
043200         10  EA-VES-PROP         PIC X(01).
CVRA           10  EA-CVRA-CERT-CODE REDEFINES EA-VES-PROP.
CVRA               15  FILLER      PIC X(01).
043300         10  EA-VES-LENGTH       PIC X(05).
CVRA           10  EA-CVRA-WEIGHT REDEFINES EA-VES-LENGTH.
CVRA                   15  FILLER      PIC X(05).
043400         10  FILLER              PIC X(05).
043500**   SUB RECORD C   **
043600         10  EA-ALCO.
043700             15  EA-ALCO-9       PIC 9(02).
043800                 88  EA-VALID-ALLOC-CO     VALUE 1 THRU 58 60.
043900         10  EA-ALCO-R       REDEFINES EA-ALCO.
044000             15  FILLER          PIC X(01).
044100                 88  EA-NO-ALLOC-CO        VALUE HIGH-VALUE.
044200             15  FILLER          PIC X(01).
044300         10  EA-CYL.
044400             15  FILLER          PIC X(01).
044500                 88  EA-NO-CYL             VALUE HIGH-VALUE.
044600             15  FILLER          PIC X(01).
044700         10  FILLER              PIC X(06).
044800         10  EA-AST-YR           PIC 9(02).
044900         10  EA-AST-YR-R     REDEFINES EA-AST-YR.
045000             15  FILLER          PIC X(01).
045100                 88  EA-NO-AST-YR          VALUE HIGH-VALUE.
045200             15  FILLER          PIC X(01).
045300         10  FILLER              PIC X(01).
045400             88  EA-NO-ENG-NBR             VALUE HIGH-VALUE.
045500             88  EA-MAX-ENG-LTH-1D         VALUE  '_'.
045600         10  EA-ENG.
045700             15  FILLER          PIC X(01).
045800                 88  EA-ENG-EQUALS-VIN-55  VALUE  '?'.
045900             15  FILLER          PIC X(29).
046000***      10  FILLER              PIC X(81).
CVRA           10  FILLER              PIC X(48).
CVRA           10  EA-CVRA-CERT-DATE.
CVRA               15 EA-CVRA-CERT-CC  pic 9(02).
CVRA               15 EA-CVRA-CERT-YY  pic 9(02).
CVRA               15 EA-CVRA-CERT-MM  PIC 9(02).
CVRA               15 EA-CVRA-CERT-DD  PIC 9(02).
CVRA           10  FILLER              PIC X(25).
046100/**   SUB RECORD D   **
046200         10  FILLER              PIC X(01).
046300             88  EA-NO-LO                  VALUE HIGH-VALUE.
046400         10  EA-LON              PIC X(30).
KIOSK          10  EA-LON-R       REDEFINES EA-LON.
044000             15  EA-LON1         PIC X(27).
                   15  FILLER          PIC X(03).
046500         10  FILLER              PIC X(01).
046600             88  EA-NO-LO2                 VALUE HIGH-VALUE.
046700         10  EA-LO2              PIC X(30).
KIOSK          10  EA-LO2-R       REDEFINES EA-LO2.
044000             15  EA-LON2         PIC X(27).
                   15  FILLER          PIC X(03).
046800         10  FILLER              PIC X(01).
046900         10  EA-LOCITY           PIC X(30).
047000         10  FILLER              PIC X(01).
047100             88  EA-NO-LO3                 VALUE HIGH-VALUE.
047200         10  EA-LO3              PIC X(30).
KIOSK          10  EA-LO3-R       REDEFINES EA-LO3.
044000             15  EA-LON3         PIC X(27).
                   15  FILLER          PIC X(03).
047300         10  FILLER              PIC X(01).
047400             88  EA-NO-LO4                 VALUE HIGH-VALUE.
047500         10  EA-LO4              PIC X(30).
047600         10  FILLER              PIC X(41).
047700**   SUB RECORD E AND ON  **
047800         10  EA-SUBE OCCURS 89 INDEXED BY IDX-E.
047900             15  E-SUB-CODE      PIC X(01).
048000             15  FILLER          PIC X(02).
048100             15  E-COND-CODE     PIC X(02).
048200             15  E-COND-DATE.
048300                 20  E-COND-DT-YY PIC X(02).
048400                 20  E-COND-DT-MM PIC X(02).
048500                 20  E-COND-DT-DD PIC X(02).
048600             15  E-RSN-CODE      PIC 9(02).
048700             15  E-RSN-CODE-R REDEFINES E-RSN-CODE.
048800                 20  FILLER      PIC X(01).
048900                 20  E-PRIOR-HST PIC X(01).
049000             15  E-UNIT-CODE     PIC X(02).
049100             15  E-SMOG-DUE-DATE.
049200                 20  E-SMOG-DUE-DATE-YY PIC 9(02).
049300                 20  E-SMOG-DUE-DATE-MM PIC 9(02).
049400                 20  E-SMOG-DUE-DATE-DD PIC 9(02).
049500             15  E-SMOG-TYPE     PIC X(02).
049600             15  E-ADDL-DATA     PIC X(81).
049700             15  E-20-ADDL-DATA  REDEFINES E-ADDL-DATA.
049800                 20  E-20-ADDL-DATA-LTH  PIC X(01).
049900                 20  E-20-MAIL-CODES   OCCURS 6
050000                                       INDEXED BY IDX-E20.
050100                     25  E-20-RETURN-MAIL-CD PIC X(02).
050200                     25  E-20-RETURN-MAIL-DT PIC 9(06).
050300                 20  FILLER         PIC X(32).
050400             15  E-36-ADDL-DATA  REDEFINES E-ADDL-DATA.
050500                 20  E-ADDL-DATA-L  PIC X(01).
050600                 20  E-VLF-EXMPT    PIC 9(03).
050700                 20  FILLER         PIC X(77).
050800             15  E-46-ADDL-DATA REDEFINES E-ADDL-DATA.
050900                 20  E-ADDL-DATA-LTH      PIC X(01).
051000                 20  E-DATE-SMOG-CERT-EXP.
051100                     25  E-DATE-SMOG-CERT-EXP-YY PIC 9(02).
051200                     25  E-DATE-SMOG-CERT-EXP-MM PIC 9(02).
051300                     25  E-DATE-SMOG-CERT-EXP-DD PIC 9(02).
051400                 20  E-SMOG-CERT-NUM      PIC X(09).
051500                 20  E-STATION-NUM        PIC X(08).
051600                 20  E-LIC-RCVD           PIC X(07).
051700                 20  FILLER               PIC X(50).
051800             15  E-55-ADDL-DATA  REDEFINES E-ADDL-DATA.
051900                 20  E-DOLLAR-VALUE PIC X(08).
052000                 20  FILLER         PIC X(73).
052100             15  E-64-ADDL-DATA  REDEFINES E-ADDL-DATA.
052200                 20  FILLER         PIC X(01).
052300                 20  E-MAIL-ADDR1   PIC X(27).
052400                 20  E-MAIL-ADDR2   PIC X(27).
052500                 20  E-MAIL-CITY    PIC X(13).
052600                 20  E-MAIL-CC      PIC X(02).
052700                 20  E-MAIL-ZIP-CD  PIC X(05).
052800                 20  FILLER         PIC X(06).
052900             15  E-69-ADDL-DATA  REDEFINES E-ADDL-DATA.
053000                 20  FILLER         PIC X(01).
053100                 20  PNO-MM         PIC 9(02).
053200                 20  PNO-DD         PIC 9(02).
053300                 20  PNO-ORIG-YYYY  PIC 9(04).
053400                 20  FILLER         PIC X(01).
053500                 20  PNO-EXP-YR     PIC 9(02).
053600                 20  FILLER         PIC X(69).
053700             15  E-74-ADDL-DATA  REDEFINES E-ADDL-DATA.
053800                 20  FILLER         PIC X(07).
053900                 20  RECALL-DATE    PIC X(08).
054000                 20  FILLER         PIC X(01).
054100                 20  RECALL-NBR     PIC X(06).
054200                 20  FILLER         PIC X(59).
054300         10  FILLER              PIC X(58).
054400/*******************************************
054500*        STAT INPUT RECORD RID 8518        *
054600********************************************
054700 01  SI-STAT-INPUT-RECORD.
054800     05  FILLER                  PIC X(23) VALUE SPACE.
054900     05  SI-STOP-HR              PIC X(02) VALUE 'XX'.
055000     05  SI-STOP-MIN             PIC X(02) VALUE 'XX'.
055100     05  FILLER                  PIC X(13) VALUE SPACE.
055200     05  SI-NDR-CNT              PIC S9(09) COMP-3 VALUE ZERO.
055300     05  FILLER                  PIC X(01) VALUE SPACE.
055400     05  SI-START-HR             PIC X(02) VALUE 'XX'.
055500     05  SI-START-MIN            PIC X(02) VALUE 'XX'.
055600     05  SI-THIS-STRT-CC         PIC X(02) VALUE 'XX'.
055700     05  SI-THIS-STRT-YR         PIC X(02) VALUE 'XX'.
055800     05  SI-THIS-STRT-MO         PIC X(02) VALUE 'XX'.
055900     05  SI-THIS-STRT-DA         PIC X(02) VALUE 'XX'.
056000     05  FILLER                  PIC X(01) VALUE SPACE.
056100     05  SI-THIS-STOP-CC         PIC X(02) VALUE 'XX'.
056200     05  SI-THIS-STOP-YR         PIC X(02) VALUE 'XX'.
056300     05  SI-THIS-STOP-MO         PIC X(02) VALUE 'XX'.
056400     05  SI-THIS-STOP-DA         PIC X(02) VALUE 'XX'.
056500     05  FILLER                  PIC X(01) VALUE 'X'.
056600         88  SI-CARD-EXTRACT               VALUE 'C'.
056700         88  SI-TABLE-EXTRACT              VALUE 'T'.
056800     05  SI-MSTRS-NOT-SEL        PIC S9(05)   COMP VALUE ZERO.
056900     05  SI-INV-FILE-IDS         PIC S9(05)   COMP VALUE ZERO.
057000     05  SI-STAT-RUN-DATE.
057100         10  SI-STAT-RUN-CC      PIC X(02) VALUE 'XX'.
057200         10  SI-STAT-RUN-YEAR    PIC X(02) VALUE 'XX'.
057300         10  SI-STAT-RUN-MONTH   PIC X(02) VALUE 'XX'.
057400         10  SI-STAT-RUN-DAY     PIC X(02) VALUE 'XX'.
057500     05  FILLER                  PIC X(06) VALUE SPACE.
057600     05  SI-THIS-SEL             PIC 9(07)    COMP-3 VALUE ZERO.
057700     05  SI-THIS-BYP             PIC 9(07)    COMP-3 VALUE ZERO.
057800     05  FILLER                  PIC X(61) VALUE SPACE.
057900     05  SI-WK2-SEL-TBL OCCURS 15 INDEXED BY IDX-WK2-SI.
058000         10  SI-WK2-SEL-CC       PIC X(02).
058100         10  SI-WK2-SEL-DT       PIC X(06).
058200         10  SI-WK2-SEL-CNT      PIC 9(07)    COMP-3.
058300     05  FILLER                  PIC X(61) VALUE SPACE.
058400     05  SI-WK3-SEL-TBL OCCURS 15 INDEXED BY IDX-WK3-SI.
058500         10  SI-WK3-SEL-CC       PIC X(02).
058600         10  SI-WK3-SEL-DT       PIC X(06).
058700         10  SI-WK3-SEL-CNT      PIC 9(07)    COMP-3.
058800     05  FILLER                  PIC X(61) VALUE SPACE.
058900     05  SI-WK4-SEL-TBL OCCURS 15 INDEXED BY IDX-WK4-SI.
059000         10  SI-WK4-SEL-CC       PIC X(02).
059100         10  SI-WK4-SEL-DT       PIC X(06).
059200         10  SI-WK4-SEL-CNT      PIC 9(07)    COMP-3.
059300     05  FILLER                  PIC X(61) VALUE SPACE.
059400/
059500     05  SI-WK5-SEL-TBL OCCURS 15 INDEXED BY IDX-WK5-SI.
059600         10  SI-WK5-SEL-CC       PIC X(02).
059700         10  SI-WK5-SEL-DT       PIC X(06).
059800         10  SI-WK5-SEL-CNT      PIC 9(07)    COMP-3.
059900     05  SI-TYPE-REC-MISC        PIC X(01) VALUE SPACE.
060000         88  SI-DPP                        VALUE 'D'.
060100         88  SI-OHV                        VALUE 'O'.
060200         88  SI-FARM                       VALUE 'F'.
060300     05  SI-TYPE-REC-VSL         PIC X(01) VALUE SPACE.
060400 01  SI-STAT-INPUT-RECORD-R  REDEFINES SI-STAT-INPUT-RECORD.
060500     05  FILLER                  PIC X(98).
060600     05  SI-WEEK OCCURS 4 INDEXED BY IDX-WK.
060700         10  SI-STRT-DATE.
060800             15  SI-STRT-CC      PIC X(02).
060900             15  SI-STRT-YR      PIC X(02).
061000             15  SI-STRT-MO      PIC X(02).
061100             15  SI-STRT-DA      PIC X(02).
061200         10  FILLER              PIC X(01).
061300         10  SI-STOP-DATE.
061400             15  SI-STOP-CC      PIC X(02).
061500             15  SI-STOP-YR      PIC X(02).
061600             15  SI-STOP-MO      PIC X(02).
061700             15  SI-STOP-DA      PIC X(02).
061800         10  SI-CNTR OCCURS 11 INDEXED BY IDX-SI.
061900             15  SI-CNT          PIC 9(07)    COMP-3.
062000         10  SI-SEL-TBL OCCURS 15 INDEXED BY IDX-SEL.
062100             15  SI-SEL-DT       PIC X(08).
062200             15  SI-SEL-CNT      PIC 9(07)    COMP-3.
062300     05  FILLER                  PIC X(02).
062400/*******************************************************
062500*            O U T P U T     R E C O R D S             *
062600********************************************************

      ********************************************************
      ***  COPY POTREC  START   ******************************
      ********************************************************

062700     COPY POTREC.

      ********************************************************
      ***  COPY POTREC  End     ******************************
      ********************************************************

062900/**********************************************************
063000*   TYPE LICENSE TABLE STORAGE AREAS
063100***********************************************************
063200 01  TYPE-LIC-TABLE.
063300     05 TYPE-LIC-TBL-REC        OCCURS 500
063400                                ASCENDING KEY TL-TYPE-LIC
063500                                INDEXED BY IDX-TL.
063600       10  TL-TYPE-LIC                PIC X(02).
063700       10  FILLER                     PIC X(98).
063800***********************************************************
063900*   EXP DATE CODES: 1 = 8 THRU 28 (EVEN DAYS, ONLY)
064000*                   2 = END-OF-MONTH
064100*                   3 = 6/30 ONLY
064200*                   4 = 12/31 ONLY
064300*                   5 = NO EXP. (12/31/99 OR 00/00)
064400*                   6 = ANY
064500*
064600*   TYPE VEHICLE CODES: A = AUTO, M = MOTORCYCLE, T = TRUCK,
064700*                       R = TRAILER, P = MOPED
064800*                       SPACE = OTHER
064900*
065000*   TYPE PLATE CODES: SPACE = REGULAR
RD1912*                     AG = CalAg-Calif Dept of Food+Agriculture
065100*                     AN = ANTIQUE
065200*                     AO = APPORTIONED TITLE ONLY
065300*                     AR = AMATEUR RADIO/HAM
065400*                     AT = ARTS
065500*                     AX = ANNUAL EXEMPT
RB1097*                     BC = BREAST CANCER AWARENESS
065600*                     BI = BILL OF RIGHTS
065700*                     CB = CITIZEN'S BAND
065800*                     CC = CONSULAR CORP
065900*                     CO = COLLEGIATE
066000*                     CN = CONSTABLE   OR
066100*                          OLYMPIC TRAINING CNTR (CHECK E44)
066200*                     DP = DISABLED PERSON
066300*                     DV = DISABLED VETERAN
066400*                     EP = ELP
066500*                     FA = FARM/SPECIAL EQUIPMENT
gldstr*                     GS = GOLD STAR
066600*                     HC = HORSELESS CARRIAGE
066700*                     HI = HISTORICAL VEHICLE
066800*                     IR = IRP
066900*                     KD = KIDS
067000*                     LG = LEGISLATOR
067100*                     LV = LEGION OF VALOR
067200*                     OH = OFF-HIGHWAY VEHICLE
067300*                     OL = OLYMPIC
067400*                     OT = OLYMPIC TRAINING CENTER
067500*                     PH = PEARL HARBOR
067600*                     PL = DP PLACARD
067700*                     PP = PRESS PHOTOGRAPHER
067800*                     PR = PRORATE ID
RD1912*                     PT = CalAg - Permanent Trailer ID
067900*                     PU = PURPLE HEART
068000*                     PX = PERMANENT EXEMPT
RC3435*                     SN = CA MUSEUM (SNOOPY)
068100*                     TI = TITLE ONLY
068200*                     TO = TRANSFER ONLY
068300*                     TP = TEMP PERMIT
068400*                     VS = VESSEL
068500*                     VT = VETERANS
068600*                     YM = YOM
068700*                     YO = YOSEMITE
068800*
068900*    ALL OTHER VALUES EITHER 'Y' FOR YES, OR 'N' FOR NO
069000************************************************************
069100 01  TYPE-LIC-TBL-DETAIL.
069200     05  TL-TYPE-LICENSE              PIC X(02).
069300         88  TL-FARM-EQUIP              VALUE 'E0' 'E4' 'E9'.
069400         88  TL-CMOH-EXEMPT             VALUE '1R' '2R' '3R' '4R'
                                               '19' '29' '39' '49'.
RB0714         88  TL-TBL-Det-TL-Obsolete     VALUE '10' 'L5' 'L6' 'L7'
RB0714                                              'L8'.
RB0714
069600     05  FILLER                       PIC X(02).
069700     05  TL-FILE-CODE                 PIC X(01).
069800     05  TL-EXP-DATE-CODE             PIC X(01).
069900         88  TL-VAL-8-28                VALUE '1'.
070000         88  TL-VAL-ENDMO               VALUE '2'.
070100         88  TL-VAL-0630                VALUE '3'.
070200         88  TL-VAL-1231                VALUE '4'.
070300         88  TL-VAL-NONE                VALUE '5'.
070400         88  TL-VAL-ANY                 VALUE '6'.
070500     05  TL-COMMERCIAL                PIC X(01).
070600         88  TL-COML-VEH                VALUE 'Y'.
070700     05  TL-SMOG-TYPE                 PIC X(01).
070800     05  TL-POTS-ENHAN-RENEWL-TYPE    PIC X(01).
070900         88  TL-POTS-TYPE               VALUE 'Y'.
071000     05  TL-WT-FEE-TYPE               PIC X(01).
071100         88  TL-NO-WGT-FEE              VALUE 'N'.
071200         88  TL-WGT-FEE-TYPE            VALUE 'Y'.
071300     05  TL-FHVUT-TYPE                PIC X(01).
071400         88  TL-HEAVY-VEH               VALUE 'Y'.
071500     05  TL-CA-TITLE                  PIC X(01).
071600         88  TL-GOLDENROD               VALUE 'N'.
071700     05  TL-TYPE-VEH-CODE             PIC X(01).
071800         88  TL-AUTO                    VALUE 'A'.
071900         88  TL-TRUCK                   VALUE 'T'.
072000         88  TL-MOTORCYCLE              VALUE 'M'.
072100         88  TL-TRLR                    VALUE 'R'.
072200     05  TL-TYPE-PLATE-CODE           PIC X(02).
072300         88  TL-REGULAR                  VALUE '  '.
072400         88  TL-CB                       VALUE 'CB'.
072500         88  TL-HAM-CB                   VALUE 'AR' 'CB'.
072600         88  TL-ELP                      VALUE 'EP'.
072700         88  TL-DISABLED-VET             VALUE 'DV'.
072800         88  TL-HORSELESS-CAR            VALUE 'HC'.
072900         88  TL-HISTORICAL-VEH           VALUE 'HI'.
073000         88  TL-HIST-VEH-ALL             VALUE 'AN' 'HI' 'HC'.
073100         88  TL-SPEC-EQUIP               VALUE 'FA'.
073200         88  TL-OHV                      VALUE 'OH'.
073300         88  TL-DPP                      VALUE 'PL'.
073400         88  TL-DP                       VALUE 'DP' 'DV'.
073500         88  TL-PRORATE-ID               VALUE 'PR'.
073600         88  TL-ANNUAL-EXEMPT            VALUE 'AX' 'DV'.
073700         88  TL-VESSEL                   VALUE 'VS'.
073800         88  TL-LEGIS-FEE-PD             VALUE 'LG'.
073900*        88  TL-CONSTABLE                VALUE 'CN'.
074000         88  TL-TITLE-TRANS              VALUE 'TI' 'TO'.
PTI            88  TL-PTI                      VALUE 'PT'.
LIVERY         88  TL-LIMO                     VALUE 'LL'.
074100     05  FILLER                       PIC X(85).
074200/*************************
074300*   P F R  OUTPUT RECORD *
074400**************************
074500 01  PFR-RECORD.
075300     05  PFR-MSTR-REC.
075400         10  FILLER              PIC X(08) VALUE SPACE.
075500         10  PFR-REC-SIZE        PIC 9(04)    COMP VALUE ZERO.
075600         10  FILLER              PIC X(9991) VALUE SPACE.
074200/*************************
074300*   E X T  OUTPUT RECORD *
074400**************************
074500 01  EXT-RECORD.
075300     05  EXT-MSTR-REC.
075400         10  FILLER              PIC X(08) VALUE SPACE.
075500         10  EXT-REC-SIZE        PIC 9(04)    COMP VALUE ZERO.
075600         10  FILLER              PIC X(9991) VALUE SPACE.
075700*****************************
075800*    I T T   O U T P U T    *
075900*****************************
076000 01  ITT-OUTPUT.
076100     05  FILLER                  PIC X(06) VALUE   'R3___A'.
076200     05  ITT-MLN                 PIC S9(07)   COMP-3 VALUE ZERO.
076300     05  FILLER                  PIC X(09) VALUE
076400                                            '?
076500     05  ITT-TL                  PIC X(02) VALUE SPACE.
076600     05  ITT-LIC-NBR             PIC X(07) VALUE SPACE.
076700     05  ITT-RONM5               PIC X(05) VALUE SPACE.
076800     05  ITT-VIN3                PIC X(03) VALUE SPACE.
076900     05  FILLER                  PIC X(01) VALUE  ']'.
077000
SB1500**********************************
SB1500*    I T T   O U T P U T 2       *
SB1500*    DELETE E-62 RSN-07 FROM ITT *
SB1500**********************************
SB1500 01  ITT-OUTPUT2.
SB1500     05  ITT2-APPEND             PIC X(06) VALUE
                                             'R__
SB1500     05  ITT2-MLN                PIC 9(07) COMP-3 VALUE ZERO.
SB1500     05  ITT2-LITERAL            PIC X(06) VALUE
                                         '?
SB1500     05  ITT2-TRANS-CODE         PIC X(03) VALUE 'R99'.
SB1500     05  ITT2-OPER-CODE          PIC X(03) VALUE 'POT'.
SB1500     05  ITT2-BATCH-ID           PIC X(03) VALUE SPACES.
SB1500     05  ITT2-UNIT-CODE          PIC 9(02) VALUE 28.
SB1500     05  ITT2-PREV-MSG           PIC X(04) VALUE 'TAPE'.
SB1500     05  ITT2-TL                 PIC X(02) VALUE SPACES.
SB1500     05  ITT2-LIC-NBR            PIC X(07) VALUE SPACES.
SB1500     05  ITT2-VIN3               PIC X(03) VALUE SPACES.
SB1500     05  ITT2-FIELD-ID           PIC 9(02) VALUE 7.
SB1500     05  ITT2-ACTION-CD          PIC X(01) VALUE SPACES.
SB1500     05  ITT2-RECORD-CD          PIC 9(02) VALUE 62.
SB1500     05  ITT2-RECORD-DATE        PIC X(06) VALUE SPACES.
SB1500     05  ITT2-REASON-CD          PIC X(02) VALUE SPACES.
SB1500     05  ITT2-END-MGS            PIC X(01) VALUE SPACES.
077000
077100/***************************************
077200*  R E P O R T   O U T P U T  A R E A  *
077300****************************************
077400**********************
077500*    ERROR  REPORT   *
077600**********************
077700 01  ERR-HEAD-1.
077800     05  FILLER                  PIC X(01) VALUE  '1'.
077900     05  FILLER                  PIC X(16) VALUE SPACE.
078000     05  FILLER                  PIC X(16) VALUE
078100                                          'RP0326 - BATCH #'.
078200     05  ERR-BATCH               PIC 9(02) VALUE ZERO.
078300     05  FILLER                  PIC X(09) VALUE SPACE.
078400     05  FILLER                  PIC X(24) VALUE
078500                                       'YRR POTENTIAL ERROR LIST'.
078600     05  FILLER                  PIC X(10) VALUE SPACE.
078700     05  ERR-DATE                PIC X(08) VALUE SPACE.
078800     05  FILLER                  PIC X(24) VALUE SPACE.
078900     05  FILLER                  PIC X(05) VALUE 'PAGE'.
079000     05  ERR-PAGE-NBR            PIC 9(04) VALUE ZERO.
079100     05  FILLER                  PIC X(14) VALUE SPACE.
079200 01  ERR-HEAD-2.
079300     05  FILLER                  PIC X(95) VALUE SPACE.
079400     05  FILLER                  PIC X(37) VALUE
079500                          'NOTE: * MEANS RECORD HAS MULTI ERRORS'.
079600     05  FILLER                  PIC X(01) VALUE SPACE.
079700 01  ERR-HEAD-3.
079800     05  FILLER                  PIC X(01) VALUE   '0'.
079900     05  FILLER                  PIC X(49) VALUE
080000              ' EXP YR   LIC NO   VIN   TL   NAME  ERROR MESSAGE'.
080100     05  FILLER                  PIC X(16) VALUE SPACE.
080200     05  FILLER                  PIC X(56) VALUE
080300              ' EXP YR   LIC NO   VIN   TL   NAME  ERROR MESSAGE'.
080400 01  ERR-DETAIL.
080500     05  FILLER                  PIC X(01) VALUE   ' '.
080600     05  FILLER                  PIC X(03) VALUE SPACE.
080700     05  ERR-EXP-YR-1            PIC X(02) VALUE SPACE.
080800     05  FILLER                  PIC X(04) VALUE SPACE.
080900     05  ERR-LIC-NBR-1           PIC X(07) VALUE SPACE.
081000     05  ERR-ASK-1               PIC X(01) VALUE SPACE.
081100     05  FILLER                  PIC X(02) VALUE SPACE.
081200     05  ERR-VIN3-1              PIC X(03) VALUE SPACE.
081300     05  FILLER                  PIC X(03) VALUE SPACE.
081400     05  ERR-TL-1                PIC X(02) VALUE SPACE.
081500     05  FILLER                  PIC X(03) VALUE SPACE.
081600     05  ERR-RONM3-1             PIC X(03) VALUE SPACE.
081700     05  FILLER                  PIC X(03) VALUE SPACE.
081800     05  ERR-MSG-1               PIC X(28) VALUE SPACE.
081900     05  FILLER                  PIC X(05) VALUE SPACE.
082000     05  ERR-EXP-YR-2            PIC X(02) VALUE SPACE.
082100     05  FILLER                  PIC X(04) VALUE SPACE.
082200     05  ERR-LIC-NBR-2           PIC X(07) VALUE SPACE.
082300     05  ERR-ASK-2               PIC X(01) VALUE SPACE.
082400     05  FILLER                  PIC X(02) VALUE SPACE.
082500     05  ERR-VIN3-2              PIC X(03) VALUE SPACE.
082600     05  FILLER                  PIC X(03) VALUE SPACE.
082700     05  ERR-TL-2                PIC X(02) VALUE SPACE.
082800     05  FILLER                  PIC X(03) VALUE SPACE.
082900     05  ERR-RONM3-2             PIC X(03) VALUE SPACE.
083000     05  FILLER                  PIC X(03) VALUE SPACE.
083100     05  ERR-MSG-2               PIC X(28) VALUE SPACE.
083200     05  FILLER                  PIC X(02) VALUE SPACE.
083300**********************
083400*   BYPASS  REPORT   *
083500**********************
083600 01  BYP-HEAD-1.
083700     05  FILLER                  PIC X(01) VALUE  '1'.
083800     05  FILLER                  PIC X(23) VALUE SPACE.
083900     05  FILLER                  PIC X(06) VALUE 'RP0326'.
084000     05  FILLER                  PIC X(14) VALUE SPACE.
084100     05  FILLER                  PIC X(24) VALUE
084200                                       'YRR BYPASS REASON LIST  '.
084300     05  FILLER                  PIC X(10) VALUE SPACE.
084400     05  BYP-DATE                PIC X(08) VALUE SPACE.
084500     05  FILLER                  PIC X(24) VALUE SPACE.
084600     05  FILLER                  PIC X(05) VALUE 'PAGE'.
084700     05  BYP-PAGE-NBR            PIC 9(04) VALUE ZERO.
084800     05  FILLER                  PIC X(14) VALUE SPACE.
084900 01  BYP-HEAD-3.
085000     05  FILLER                  PIC X(01) VALUE   '0'.
085100     05  FILLER                  PIC X(43) VALUE
085200            'REASON FOR BYPASS                          '.
085300     05  FILLER                  PIC X(28) VALUE
085400                          '  CURRENT       EXPIRED-DELQ'.
085500     05  FILLER                  PIC X(61) VALUE
085600                                  '    EXPIRED-OTHER'.
085700 01  BYP-DETAIL-1.
085800     05  BYP-DET-CC              PIC X(01) VALUE ZERO.
085900     05  FILLER                  PIC X(01) VALUE SPACE.
086000     05  BYP-REASON              PIC X(28) VALUE SPACE.
086100     05  BYP-TOTAL-X.
086200         10  BYP-TOTAL           PIC Z,ZZZ,ZZ9.
086300     05  FILLER                  PIC X(04) VALUE SPACE.
086400     05  BYP-DET-NBR-CUR-X.
086500         10  BYP-DET-NBR-CUR     PIC Z,ZZZ,ZZ9.
086600     05  FILLER                  PIC X(07) VALUE SPACE.
086700     05  BYP-DET-NBR-NDR-X.
086800         10  BYP-DET-NBR-NDR     PIC Z,ZZZ,ZZ9.
086900     05  FILLER                  PIC X(07) VALUE SPACE.
087000     05  BYP-DET-NBR-EXP-X.
087100         10  BYP-DET-NBR-EXP     PIC Z,ZZZ,ZZ9.
RF3543**   05  FILLER                  PIC X(49) VALUE SPACE.
RF3543     05  FILLER                  PIC X(02) VALUE SPACE.
RF3543     05  BYP-DET-VLTS94-TEXT     PIC X(28) VALUE SPACE.
RF3543     05  FILLER                  PIC X(01) VALUE SPACE.
RF3543     05  BYP-DET-VLTS94          PIC Z,ZZZ,ZZZ VALUE space.
RF3543     05  FILLER                  PIC X(09) VALUE SPACE.
RF3543**


087300 01  BYP-LICENSE-1.
087400     05  BYP-LIC-CC              PIC X(01) VALUE   '0'.
087500     05  BYP-LIC-RPT OCCURS 12 INDEXED BY IDX-BYP-LIC.
087600         10  BYP-LIC-SP-1        PIC X(01).
087700         10  BYP-TL              PIC X(02).
087800         10  BYP-LIC-SP-2        PIC X(01).
087900         10  BYP-LIC-NBR         PIC X(07).
088000 01  BYP-BATCH-NBR.
088100     05  BYP-CC                  PIC X(01) VALUE '0'.
088200     05  FILLER                  PIC X(09) VALUE ' BATCH # '.
088300     05  BYP-BATCH               PIC ZZ9.
088400     05  FILLER                  PIC X(120) VALUE SPACE.
088500 01  BYP-SPACE-LINE.
088600     05  BYP-CC                  PIC X(01) VALUE '0'.
088700     05  FILLER                  PIC X(132) VALUE SPACE.
088800 01  BYP-MISC-COUNT1.
088900     05  FILLER                  PIC X(01) VALUE '0'.
089000     05  FILLER                  PIC X(46) VALUE
089100         ' *BYPASSED DELINQUENT RECORDS TYPE RECORD 5 - '.
089200     05  CTR-MISC                PIC ZZZZ9.
089300 01  BYP-LICENSES-DETAIL.
089400     05  BYP-LIC-DET-CC          PIC X(01) VALUE '0'.
089500     05  BYP-LIC-DET-LINE        PIC X(132) VALUE SPACE.
089600 01  BYP-LICENSE-DISPLAY.
089700     05  BYP-LICENSE-LINE1      PIC X(130) VALUE SPACE.
089800     05  BYP-LICENSE-LINE2      PIC X(130) VALUE SPACE.
089900     05  BYP-LICENSE-LINE3      PIC X(130) VALUE SPACE.
090000     05  BYP-LICENSE-LINE4      PIC X(130) VALUE SPACE.
090100     05  BYP-LICENSE-LINE5      PIC X(130) VALUE SPACE.
090200     05  BYP-LICENSE-LINE6      PIC X(130) VALUE SPACE.
090300     05  BYP-LICENSE-LINE7      PIC X(130) VALUE SPACE.
090400     05  BYP-LICENSE-LINE8      PIC X(130) VALUE SPACE.
090500 01  BYP-LICENSE-DISPLAY-R  REDEFINES  BYP-LICENSE-DISPLAY.
090600     05  BYP-LICENSE               OCCURS 104.
090700         10  FILLER              PIC X(03).
090800         10  LICENSE-DISPLAY     PIC X(07).
090900/***********************************
091000*      S T A T   R E P O R T       *
091100************************************
091200 01  STAT-HEAD-1.
091300     05  FILLER                  PIC X(01) VALUE  '1'.
091400     05  FILLER                  PIC X(16) VALUE SPACE.
091500     05  FILLER                  PIC X(21) VALUE
091600                                          'RP0326 POT VALIDATION'.
078300     05  FILLER                  PIC X(06) VALUE SPACE.
091700     05  FILLER                  PIC X(25) VALUE
091800                                   '         OUTPUT          '.
092000     05  FILLER                  PIC X(09) VALUE SPACE.
091900     05  STAT-DATE               PIC X(08) VALUE SPACE.
078800     05  FILLER                  PIC X(24) VALUE SPACE.
078900     05  FILLER                  PIC X(05) VALUE 'PAGE'.
092200     05  STAT-PAGE               PIC 9(04) VALUE ZERO.
092300     05  FILLER                  PIC X(14) VALUE SPACE.
092400 01  STAT-HEAD-A-2.
092500     05  FILLER                  PIC X(01) VALUE   '0'.
092600     05  FILLER                  PIC X(43) VALUE SPACE.
092700     05  FILLER                  PIC X(42) VALUE
092800                 'SELECTED AND BYPASSED STATISTICS - BATCH# '.
092900     05  STAT-BATCH              PIC 9(02) VALUE ZERO.
093000     05  FILLER                  PIC X(45) VALUE SPACE.
093100 01  STAT-HEAD-A-3.
093200     05  FILLER                  PIC X(01) VALUE   '0'.
093300     05  FILLER                  PIC X(26) VALUE SPACE.
093400     05  FILLER                  PIC X(21) VALUE 'THIS WEEK'.
093500*    05  FILLER                  PIC X(21) VALUE 'WEEK 2'.
093600*    05  FILLER                  PIC X(21) VALUE 'WEEK 3'.
093700*    05  FILLER                  PIC X(21) VALUE 'WEEK 4'.
093800*    05  FILLER                  PIC X(22) VALUE 'WEEK 5'.
093900 01  STAT-HEAD-A-4.
094000     05  FILLER                  PIC X(01) VALUE SPACE.
094100     05  FILLER                  PIC X(02) VALUE SPACE.
094200     05  FILLER                  PIC X(10) VALUE 'RUN DATE'.
094300     05  STAT-PRT-RUN-MONTH      PIC X(02) VALUE SPACE.
094400     05  FILLER                  PIC X(01) VALUE '/'.
094500     05  STAT-PRT-RUN-DAY        PIC X(02) VALUE SPACE.
094600     05  FILLER                  PIC X(01) VALUE '/'.
094700     05  STAT-PRT-RUN-YEAR       PIC X(02) VALUE SPACE.
094800     05  FILLER                  PIC X(112) VALUE SPACE.
094900 01  STAT-HEAD-A-5.
095000     05  FILLER                  PIC X(01) VALUE   '0'.
095100     05  FILLER                  PIC X(02) VALUE SPACE.
095200     05  FILLER                  PIC X(24) VALUE 'EXPIRATION DATE'
095300                                           .
095400     05  FILLER                  PIC X(21) VALUE 'VOLUME'.
096300/
096400 01  STAT-DET-A-1.
096500     05  STAT-DET-A1-CC          PIC X(01) VALUE   '0'.
096600     05  FILLER                  PIC X(02) VALUE SPACE.
096700     05  STAT-SEL-TAG.
096800         10  STAT-SEL-DT-PRT-1.
096900             15  STAT-SEL-MO-PRT-1  PIC X(02) VALUE SPACE.
097000             15  FILLER             PIC X(01) VALUE SPACE.
097100             15  STAT-SEL-DA-PRT-1  PIC X(02) VALUE SPACE.
097200             15  FILLER             PIC X(01) VALUE SPACE.
097300             15  STAT-SEL-YR-PRT-1  PIC X(02) VALUE SPACE.
097400         10  FILLER                 PIC X(02) VALUE SPACE.
097500         10  STAT-SEL-1             PIC X(09) VALUE SPACE.
097600         10  FILLER                 PIC X(04) VALUE SPACE.
097700     05  STAT-PRT-FIL-1          PIC X(09) VALUE SPACE.
097800     05  STAT-SEL-CNT-PRT-1  REDEFINES STAT-PRT-FIL-1
097900                                 PIC Z,ZZZ,ZZ9.
098000     05  FILLER                  PIC X(13) VALUE SPACE.
102500 01  STAT-DET-A-2.
102600     05  FILLER                  PIC X(01) VALUE   '0'.
102700     05  FILLER                  PIC X(02) VALUE SPACE.
102800     05  STAT-DET                PIC X(04) VALUE 'RID '.
102900     05  STAT-DET-RID            PIC X(04) VALUE '4401'.
103000     05  FILLER                  PIC X(15) VALUE '   SELECTED'.
103100     05  STAT-DET-PRT            PIC Z,ZZZ,ZZ9.
103200     05  FILLER                  PIC X(98) VALUE SPACE.
103300 01  STAT-DET-A-3.
103400     05  FILLER                  PIC X(01) VALUE SPACE.
103500     05  FILLER                  PIC X(04) VALUE SPACE.
102800     05  STAT-DET3               PIC X(06) VALUE 'TCODE '.
102900     05  STAT-DET-TCODE          PIC X(04) VALUE SPACE.
103000     05  FILLER                  PIC X(14) VALUE '  SELECTED'.
103800     05  STAT-DET3-PRT           PIC Z,ZZZ,ZZ9.
103900     05  FILLER                  PIC X(95) VALUE SPACE.
104000 01  STAT-DET-A-4.
104100     05  FILLER                  PIC X(01) VALUE   '0'.
104200     05  FILLER                  PIC X(02) VALUE SPACE.
104300     05  FILLER                  PIC X(23) VALUE 'TOTAL SELECTED'.
104400     05  STAT-TOT-SEL-PRT-1      PIC Z,ZZZ,ZZ9.
104500     05  FILLER                  PIC X(13) VALUE SPACE.
105800/
105900 01  STAT-DET-A-5.
106000     05  FILLER                  PIC X(01) VALUE   '0'.
106100     05  FILLER                  PIC X(02) VALUE SPACE.
106200     05  FILLER                  PIC X(23) VALUE
106300                                            'RID 8516   BYPASSED'.
106400     05  STAT-8516-BYP-PRT       PIC Z,ZZZ,ZZ9.
106500     05  FILLER                  PIC X(98) VALUE SPACE.
106600 01  STAT-DET-A-6.
106700     05  FILLER                  PIC X(01) VALUE SPACE.
106800     05  FILLER                  PIC X(02) VALUE SPACE.
106900     05  FILLER                  PIC X(23) VALUE
107000                                            'RID 4401   BYPASSED'.
107100     05  STAT-4401-BYP-PRT       PIC Z,ZZZ,ZZ9.
107200     05  FILLER                  PIC X(98) VALUE SPACE.
107300 01  STAT-DET-A-7.
107400     05  FILLER                  PIC X(01) VALUE SPACE.
107500     05  FILLER                  PIC X(02) VALUE SPACE.
107600     05  FILLER                  PIC X(23) VALUE
107700                                            'RID 8515   BYPASSED'.
107800     05  STAT-8515-BYP-PRT       PIC Z,ZZZ,ZZ9.
107900     05  FILLER                  PIC X(98) VALUE SPACE.
108000 01  STAT-DET-A-8.
108100     05  FILLER                  PIC X(01) VALUE   '0'.
108200     05  FILLER                  PIC X(02) VALUE SPACE.
108300     05  FILLER                  PIC X(23) VALUE 'TOTAL BYPASSED'.
108400     05  STAT-TOT-BYP-PRT        PIC Z,ZZZ,ZZ9.
108500     05  FILLER                  PIC X(98) VALUE SPACE.
108600 01  STAT-HDR-N-1.
108700     05  FILLER                  PIC X(01) VALUE   '0'.
108800     05  FILLER                  PIC X(25)
108900                                 VALUE '******************'.
109000     05  FILLER                  PIC X(106) VALUE SPACE.
109100 01  STAT-HDR-N-2.
109200     05  FILLER                  PIC X(01) VALUE SPACE.
109300     05  FILLER                  PIC X(25)
109400                                 VALUE '* DELINQUENT REG *'.
109500     05  FILLER                  PIC X(106) VALUE SPACE.
109600 01  STAT-HDR-N-3.
109700     05  FILLER                  PIC X(01) VALUE SPACE.
109800     05  FILLER                  PIC X(25)
109900                                 VALUE '******************'.
110000     05  FILLER                  PIC X(106) VALUE SPACE.
110100 01  STAT-HDR-N-4.
110200     05  FILLER                  PIC X(01) VALUE   '0'.
110300     05  FILLER                  PIC X(02) VALUE SPACE.
110400     05  FILLER                 PIC X(24) VALUE 'EXPIRATION DATE'.
110500     05  FILLER                  PIC X(106) VALUE SPACE.
110600 01  STAT-DET-N-2.
110700     05  FILLER                  PIC X(01) VALUE   '0'.
110800     05  FILLER                  PIC X(02) VALUE SPACE.
110900     05  FILLER                  PIC X(23) VALUE
111000                                            'RID 4405   SELECTED'.
111100     05  STAT-4405-SEL           PIC Z,ZZZ,ZZ9.
111200     05  FILLER                  PIC X(98) VALUE SPACE.
111300 01  STAT-DET-N-3.
111400     05  FILLER                  PIC X(01) VALUE   '0'.
111500     05  FILLER                  PIC X(02) VALUE SPACE.
111600     05  FILLER                  PIC X(23) VALUE 'TOTAL SELECTED'.
111700     05  STAT-TOT-NDR-SEL        PIC Z,ZZZ,ZZ9.
111800     05  FILLER                  PIC X(98) VALUE SPACE.
111900 01  STAT-DET-N-4.
112000     05  FILLER                  PIC X(01) VALUE   '0'.
112100     05  FILLER                  PIC X(02) VALUE SPACE.
112200     05  FILLER                  PIC X(23) VALUE 'TOTAL BYPASSED'.
112300     05  STAT-TOT-NDR-BYP        PIC Z,ZZZ,ZZ9.
112400     05  FILLER                  PIC X(98) VALUE SPACE.
112500/
112600 01  PRT-HEAD-B-2.
112700     05  FILLER                  PIC X(01) VALUE   ' '.
112800     05  FILLER                  PIC X(45) VALUE SPACE.
112900     05  FILLER                  PIC X(77) VALUE
113000                                     'TOTAL COUNTS BY TYPE'.
113100 01  PRT-HEAD-B-3.
113200     05  FILLER                  PIC X(01) VALUE   '0'.
113300     05  FILLER                  PIC X(37) VALUE SPACE.
113400     05  FILLER                  PIC X(31) VALUE 'THIS WEEK'.
113500*    05  FILLER                  PIC X(16) VALUE 'WEEK 2'.
113600*    05  FILLER                  PIC X(16) VALUE 'WEEK 3'.
113700*    05  FILLER                  PIC X(16) VALUE 'WEEK 4'.
113800*    05  FILLER                  PIC X(16) VALUE 'WEEK 5'.
113900 01  PRT-HEAD-B-4.
114000     05  FILLER                  PIC X(09) VALUE SPACE.
114100     05  FILLER                  PIC X(29) VALUE 'DESCRIPTION'.
114200     05  FILLER                  PIC X(31) VALUE 'VOLUME'.
114700 01  PRT-HEAD-B-5.
114800     05  FILLER                  PIC X(01) VALUE   '0'.
114900     05  FILLER                  PIC X(08) VALUE SPACE.
115000     05  FILLER                  PIC X(30) VALUE
115100                                     '* * * ACTUAL CURRENT * * *'.
115200     05  FILLER                  PIC X(31) VALUE
115300                                     '* * * ACTUAL EXPIRED * * *'.
115400*    05  FILLER.
115500*        10  FILLER              PIC X(50) VALUE
115600*            '* * * * *          PROJECTED REGULAR        * * * '.
115700*        10  FILLER              PIC X(03) VALUE '* *'.
115800*        10  FILLER              PIC X(10) VALUE SPACE.
115900 01  PRT-DET-B-1.
116000     05  FILLER                  PIC X(01) VALUE   '0'.
116100     05  FILLER                  PIC X(08) VALUE SPACE.
116200     05  PRT-TITLE               PIC X(19) VALUE SPACE.
116300     05  PRT-REG-COUNT           PIC Z,ZZZ,ZZ9.
116400     05  FILLER                  PIC X(10) VALUE SPACE.
116500     05  PRT-EXP-COUNT           PIC Z,ZZZ,ZZ9.
116600     05  FILLER                  PIC X(11) VALUE SPACE.
116700*    05  PRT-LINE-REMAIN.
116800*        10  PRT-COUNT       OCCURS 4 INDEXED BY IDX-PRT.
116900*            15  PRT-CNT         PIC Z,ZZZ,ZZ9.
117000*            15  PRT-SPACE       PIC X(07).
117100*        10  FILLER              PIC X(02) VALUE SPACE.
117200/
117300 01  PRT-DET-B-7.
117400     05  PRT-FINAL-CC            PIC X(01) VALUE   '0'.
117500     05  PRT-FINAL               PIC X(08) VALUE SPACE.
117600     05  FILLER                  PIC X(19) VALUE 'TOTAL'.
117700     05  PRT-REG-TOT-CNT         PIC Z,ZZZ,ZZ9.
117800     05  FILLER                  PIC X(10) VALUE SPACE.
117900     05  PRT-EXP-TOT-CNT         PIC Z,ZZZ,ZZ9.
118000     05  FILLER                  PIC X(11) VALUE SPACE.
118100*    05  PRT-TOT-REMAIN.
118200*        10  PRT-TOT-COUNT   OCCURS 4 INDEXED BY IDX-TOT.
118300*            15  PRT-TOT-CNT     PIC Z,ZZZ,ZZ9.
118400*            15  PRT-TOT-SPACE   PIC X(07).
118500*        10  FILLER              PIC X(02) VALUE SPACE.
118600 01  PRT-DET-B-8.
118700     05  FILLER                  PIC X(01) VALUE   '-'.
118800     05  FILLER                  PIC X(08) VALUE SPACE.
118900     05  FILLER                  PIC X(30) VALUE
119000                                     '* ACTUAL CURRENT W/CITS* *'.
119100     05  FILLER                  PIC X(31) VALUE
119200                                     '* ACTUAL EXPIRED W/CITS* *'.
119300*    05  FILLER.
119400*        10  FILLER              PIC X(50) VALUE
119500*            '* * * * *     PROJECTED PARKING CITATION     * * *'.
119600*        10  FILLER              PIC X(04) VALUE ' * *'.
119700*        10  FILLER              PIC X(09) VALUE SPACE.
122600/
122700 01  PRT-DET-B-12.
122800     05  FILLER                  PIC X(24) VALUE SPACE.
122900     05  FILLER                  PIC X(31) VALUE
123000                                  '* * *   RP0326 START TIME WAS'.
123100     05  PRT-START-TIME-HR       PIC X(02) VALUE SPACE.
123200     05  FILLER                  PIC X(01) VALUE ':'.
123300     05  PRT-START-TIME-MIN      PIC X(02) VALUE SPACE.
123400     05  FILLER                  PIC X(19) VALUE
123500                                            '    STOP TIME WAS'.
123600     05  PRT-STOP-TIME-HR        PIC X(02) VALUE SPACE.
123700     05  FILLER                  PIC X(01) VALUE ':'.
123800     05  PRT-STOP-TIME-MIN       PIC X(02) VALUE SPACE.
123900     05  FILLER                  PIC X(49) VALUE SPACE.
124000 01  PRT-DET-B-13.
124100     05  PRT-DET-B-13-1.
124200         10  FILLER              PIC X(24) VALUE SPACE.
124300         10  FILLER              PIC X(31) VALUE
124400                                 '* * *   THIS WEEK''S RANGE IS '.
124500         10  PRT-THIS-STRT-MO    PIC X(02) VALUE SPACE.
124600         10  FILLER              PIC X(01) VALUE '/'.
124700         10  PRT-THIS-STRT-DA    PIC X(02) VALUE SPACE.
124800         10  FILLER              PIC X(01) VALUE '/'.
124900         10  PRT-THIS-STRT-YR    PIC X(02) VALUE SPACE.
125000         10  FILLER              PIC X(01) VALUE '-'.
125100         10  PRT-THIS-STOP-MO    PIC X(02) VALUE SPACE.
125200         10  FILLER              PIC X(01) VALUE '/'.
125300         10  PRT-THIS-STOP-DA    PIC X(02) VALUE SPACE.
125400         10  FILLER              PIC X(01) VALUE '/'.
125500         10  PRT-THIS-STOP-YR    PIC X(02) VALUE SPACE.
125600**   05  FILLER                  PIC X(07) VALUE '  WEEK '.
125700**   05  PRT-WEEK-NR             PIC 9(01) VALUE 2.
125800**   05  FILLER                  PIC X(10) VALUE ' RANGE IS '.
125900**   05  PRT-STRT-MO             PIC X(02) VALUE SPACE.
126000**   05  FILLER                  PIC X(01) VALUE '/'.
126100**   05  PRT-STRT-DA             PIC X(02) VALUE SPACE.
126200**   05  FILLER                  PIC X(01) VALUE '/'.
126300**   05  PRT-STRT-YR             PIC X(02) VALUE SPACE.
126400**   05  FILLER                  PIC X(01) VALUE '-'.
126500**   05  PRT-STOP-MO             PIC X(02) VALUE SPACE.
126600**   05  FILLER                  PIC X(01) VALUE '/'.
126700**   05  PRT-STOP-DA             PIC X(02) VALUE SPACE.
126800**   05  FILLER                  PIC X(01) VALUE '/'.
126900**   05  PRT-STOP-YR             PIC X(02) VALUE SPACE.
127000**   05  FILLER                  PIC X(26) VALUE SPACE.
127000     05  FILLER                  PIC X(61) VALUE SPACE.
128700/************************************************************
128800*               W  O  R  K      A  R  E  A                  *
128900*************************************************************
019000 01  WA-DISPLAY-LINE.
019100     05  FILLER                  PIC X(133).
129000*************************************
129100*      INDICATORS AND SWITCHES      *
129200*************************************
129300***********************
129400*  END OF FILE INDIC  *
153100 01 WS-FILE-CODE                      PIC X(01).
153200 01 WS-KEY                            PIC X(30).
151500***********************
       01 WS-HOLD-KEY.
153400    05 WS-FILE-CODE-AR         PIC X(01) OCCURS 10 TIMES.
153500    05 WS-KEY-AR               PIC X(30) OCCURS 10 TIMES.

129600 01  EOF-COURT-INDICATOR         PIC 9(01) VALUE ZERO.
129700     88  EOF-COURTS                        VALUE 1.
129800 01  EOF-POT-INDICATOR           PIC 9(01) VALUE ZERO.
129900     88  EOF-POTIN1                        VALUE 1.
129900     88  EOF-OEXTRACT                      VALUE 2.
129800 01  SW-EOF-VRM-INDICATOR      PIC X(01) VALUE 'N'.
129900     88 SW-EOF-VRM                       VALUE 'Y'.
       01 SW-FILE-SWITCHES.
130900     05  SW-PFR                  PIC X(01) VALUE 'N'.
131100     05  SW-ITT                  PIC X(01) VALUE 'N'.
SB1500     05  SW-ITT2                 PIC X(01) VALUE 'N'.
131000     05  SW-EXTOUT               PIC X(01) VALUE 'N'.
131000         88 SW-EXTOUT-OPENED               VALUE 'Y'.
131000         88 SW-EXTOUT-CLOSED               VALUE 'N'.
130200     05  SW-IND                  PIC X(01) VALUE 'N'.
130300         88  SW-IND-DPP                    VALUE 'Y'.
131700     05  SW-SEL                  PIC X(01) VALUE 'N'.
130000
130100 01  SWITCHES.
130200     05  SW-END-OF-TABLE         PIC X(01) VALUE 'N'.
130300         88  NO-MORE-TABLE-RECS            VALUE 'Y'.
130400     05  SW-MAIL-RETURNED        PIC X(01) VALUE 'N'.
130500     05  SW-MAIL-ADDRESS         PIC X(01) VALUE 'N'.
130600     05  SW-WEEK1-COUNTS         PIC X(01) VALUE 'N'.
130700         88  WEEK1-COUNTS-ONLY             VALUE 'Y'.
130800     05  SW-NDR-DATES            PIC X(01) VALUE 'N'.
ADDRSP     05  SW-ADD-FLAG             PIC X(01) VALUE 'N'.
ADDRSP     05  SW-CITY-FLAG            PIC X(01) VALUE 'N'.
131200     05  SW-VALID-DATA           PIC X(01) VALUE 'N'.
131300     05  SW-BYPASS-REC           PIC X(01) VALUE 'N'.
131400     05  SW-ERR-COUNTED          PIC X(01) VALUE 'N'.
131500         88  ERROR-IS-COUNTED              VALUE 'Y'.
131600     05  SW-ERROR                PIC X(01) VALUE 'N'.
131800     05  SW-EXP                  PIC X(01) VALUE 'N'.
131900     05  SW-VESSEL-TAX-DUE       PIC X(01) VALUE 'N'.
132000         88  VESSEL-TAX-DUE                VALUE 'Y'.
132100     05  SW-SI-COUNT             PIC X(01) VALUE 'N'.
132200         88  NO-SI-COUNT                   VALUE 'N'.
132300     05  SW-CIT                  PIC X(01) VALUE 'N'.
132400     05  SW-QUIT                 PIC X(01) VALUE 'N'.
NONCOM     05  SW-REASON-12            PIC X(01) VALUE 'N'.
NONCOM         88 REASON-12-FOUND                VALUE 'Y'.
132500     05  SW-REASON-72            PIC X(01) VALUE 'N'.
132600     05  PNO-STATUS-INDICATOR    PIC X(01) VALUE SPACE.
132700         88  DELINQ-PNO-02                 VALUE 'Q'.
132800         88  PNO-02                        VALUE 'P'.
132900         88  CURRENT-PNO-ISSUED            VALUE 'C'.
133000         88  PNO-DUE-FOR-RENEWAL           VALUE 'D'.
133100         88  PNO-EXPIRED                   VALUE 'E'.
133200         88  NO-E69                        VALUE SPACE.
133300         88  INTERIM-PNO                   VALUE 'T'.
133400     05  SW-VET-OWN-RETENTN-FEE  PIC X(01) VALUE 'N'.
133500         88  DV-SPECIAL-PLT                VALUE 'Y'.
NONCOM     05  SW-SUBRECORD-E49        PIC X(01) VALUE 'N'.
NONCOM         88  SUBRECORD-E49-FOUND           VALUE 'Y'.
LIVERY     05  SW-SUBRECORD-E44-L      PIC X(01) VALUE 'N'.
LIVERY         88  SUBRECORD-E44-L-FOUND         VALUE 'Y'.
133600
       01 WA-TL                            PIC X(02).
          88 WA-TL-IRP           VALUE '81' '83' '85' '87' '89'.
          88 WA-TL-IRP-TRK                 VALUE '83'.
          88 WA-TL-IRP-TRL                 VALUE '87'.
          88 WA-TL-IRP-ITK                 VALUE '81'.
          88 WA-TL-IRP-ITR                 VALUE '85'.
          88 WA-TL-IRP-FTR                 VALUE '89'.

159400 01 WA-ERRORS.
159500    05 WA-ERROR-FILE                 PIC X(10).
159600       88 WA-POTIN                   VALUE 'POTIN'.
159700       88 WA-POTKEYIN                VALUE 'POTKEYIN'.
159800    05 WA-ERROR-PRM                  PIC X(30).
159900    05 WA-RETURN-CODE                PIC 9(04).
160000    05 WA-REC-UNAVAILABLE-CNT        PIC 9(02).
160100    05 WA-ERROR-RECORD               PIC X(80).
160200    05 WA-ERROR-RECORD-CNT           PIC ZZ,ZZZ,ZZ9.
160300    05 WA-RETURN-CODE-MSG            PIC X(50).
164000    05 WA-RETURN-CODE-RSN            PIC X(50).
164100       88 WA-RETURN-CODE-RSN-20
160600       VALUE
164200         'DB2-RECORD OR FILE UNAVAILABLE                    '.
164300       88 WA-RETURN-CODE-RSN-21
160600       VALUE
164400         'DB2-END OF FILE OR RECORD NOT FOUND               '.
164500       88 WA-RETURN-CODE-RSN-22
160600       VALUE
164600         'DB2-FILE OPEN ERROR                               '.
164700       88 WA-RETURN-CODE-RSN-23
160600       VALUE
164800         'DB2-INVALID BDSYSIN PARM                          '.
164900       88 WA-RETURN-CODE-RSN-24
160600       VALUE
165000         'DB2-INVALID PROGRAM CALL PARAMETER PASSED         '.
165100       88 WA-RETURN-CODE-RSN-25
160600       VALUE
165200         'DB2-UNABLE TO LOAD A PROGRAM USED BY OM6996       '.
165300       88 WA-RETURN-CODE-RSN-26
160600       VALUE
165400         'DB2-INVALID KEY PASSED TO OM6996                  '.
165500       88 WA-RETURN-CODE-RSN-27
160600       VALUE
165600         'DB2-EXPLOSION ERROR OF RECORD ON AMIS             '.
165700       88 WA-RETURN-CODE-RSN-28
160600       VALUE
165800         'DB2-SQL ERROR OCCURED                             '.
165900       88 WA-RETURN-CODE-RSN-29
160600       VALUE
166000         'DB2-CONNECT ERROR                                 '.
166100       88 WA-RETURN-CODE-RSN-30
160600       VALUE
166200         'DB2-UNKNOWN ERROR                                 '.
166300       88 WA-RETURN-CODE-RSN-31
160600       VALUE
166400         'DB2-UNKNOWN RETURN CODE                           '.
166500
133700/************************************************************
133800*                    C  O  U  N  T  E  R  S                 *
133900*************************************************************
134000***************************
134100*    SYSOUT COUNTS        *
134200***************************
134300 01  COUNTER-AREA.
134400     05  FILLER                  PIC X(21)
134500                                  VALUE '**INPUT RECORD  NBR**'.
134600     05  CTR-IN                  PIC 9(07)    COMP-3 VALUE ZERO.
134400     05  FILLER                  PIC X(21)
134500                                  VALUE '**INPUT RECORD1 NBR**'.
134600     05  CTR-IN1                 PIC 9(07)    COMP-3 VALUE ZERO.
134700     05  FILLER                  PIC X(05) VALUE '*****'.
134400     05  FILLER                  PIC X(21)
134500                                  VALUE '**INPUT RECORD2 NBR**'.
134600     05  CTR-EXT                 PIC 9(07)    COMP-3 VALUE ZERO.
134700     05  FILLER                  PIC X(05) VALUE '*****'.
134800 01  PROGRAM-COUNTERS.
134900     05  CTR-IN1-EXPIRED         PIC 9(07) COMP-3 VALUE ZERO.
135000     05  CTR-ERR-BYP             PIC 9(07) COMP-3 VALUE ZERO.
135000     05  CTR-ERROR               PIC 9(07) COMP-3 VALUE ZERO.
135100     05  CTR-ERROR-EXPIRED       PIC 9(07) COMP-3 VALUE ZERO.
135200     05  CTR-BYP-DUPS            PIC 9(07) COMP-3 VALUE ZERO.
135300     05  CTR-ERROR-DUPS          PIC 9(07) COMP-3 VALUE ZERO.
135400     05  CTR-TOTAL-DUPS          PIC 9(07) COMP-3 VALUE ZERO.
135500     05  CTR-BYP-REG             PIC 9(07) COMP-3 VALUE ZERO.
135600     05  CTR-BYP-EXPIRED         PIC 9(07) COMP-3 VALUE ZERO.
135700     05  CTR-POTS-REG            PIC 9(07) COMP-3 VALUE ZERO.
135800     05  CTR-POTS-PNO            PIC 9(07) COMP-3 VALUE ZERO.
135900     05  CTR-NDR                 PIC 9(07) COMP-3 VALUE ZERO.
136000     05  CTR-PFR                 PIC 9(07) COMP-3 VALUE ZERO.
136100     05  CTR-TYPE4               PIC 9(07) COMP-3 VALUE ZERO.
136100     05  CTR-DPP                 PIC 9(07) COMP-3 VALUE ZERO.
136200     05  CTR-NON-POT             PIC 9(07) COMP-3 VALUE ZERO.
136300     05  CTR-TOTAL               PIC 9(07) COMP-3 VALUE ZERO.
136400     05  CTR-ITT                 PIC 9(07) COMP-3 VALUE ZERO.
SB1500     05  CTR-ITT2                PIC 9(07) COMP-3 VALUE ZERO.
136500     05  CTR-OTHER-DATES         PIC 9(07) COMP-3 VALUE ZERO.
136600     05  CTR-OLD-DATES           PIC 9(07) COMP-3 VALUE ZERO.
136700     05  CTR-FHVUT               PIC 9(06) VALUE ZERO.
136800     05  CTR-407                 PIC 9(06) VALUE ZERO.
136900     05  CTR-BYP-TYP5-NDR        PIC 9(03) VALUE ZERO.
137000     05  CTR-BYP-TL-TRANS        PIC 9(03) VALUE ZERO.
137100     05  SW-SUBREC-9             PIC X(01) VALUE 'N'.
137200*************************
137300*  REPORT TOTALS COUNT  *
137400*************************
137500     05  CTR-STAT-4401           PIC 9(07)    COMP-3 VALUE ZERO.
137600     05  CTR-STAT-8515           PIC 9(07)    COMP-3 VALUE ZERO.
137600     05  CTR-STAT-RA5            PIC 9(07)    COMP-3 VALUE ZERO.
137600     05  CTR-STAT-R66            PIC 9(07)    COMP-3 VALUE ZERO.
137700     05  CTR-STAT-4405           PIC 9(07)    COMP-3 VALUE ZERO.
137800     05  CTR-STAT-8519           PIC 9(07)    COMP-3 VALUE ZERO.
137900     05  CTR-STAT-TOT-SELECTED   PIC 9(07)    COMP-3 VALUE ZERO.
138000     05  CTR-STAT-TOT-SEL-2      PIC 9(07)    COMP-3 VALUE ZERO.
138100     05  CTR-STAT-TOT-SEL-3      PIC 9(07)    COMP-3 VALUE ZERO.
138200     05  CTR-STAT-TOT-SEL-4      PIC 9(07)    COMP-3 VALUE ZERO.
138300     05  CTR-STAT-TOT-SEL-5      PIC 9(07)    COMP-3 VALUE ZERO.
138400     05  CTR-STAT-8516-BYP       PIC 9(07)    COMP-3 VALUE ZERO.
138500     05  CTR-STAT-4401-BYP       PIC 9(07)    COMP-3 VALUE ZERO.
138600     05  CTR-STAT-8515-BYP       PIC 9(07)    COMP-3 VALUE ZERO.
137600     05  CTR-STAT-RA5-BYP        PIC 9(07)    COMP-3 VALUE ZERO.
137600     05  CTR-STAT-R66-BYP        PIC 9(07)    COMP-3 VALUE ZERO.
138700     05  CTR-STAT-NDR-BYP        PIC 9(07)    COMP-3 VALUE ZERO.
138800     05  CTR-STAT-8519-BYP       PIC 9(07)    COMP-3 VALUE ZERO.
138900     05  CTR-STAT-TOT-BYP        PIC 9(07)    COMP-3 VALUE ZERO.
139000     05  CTR-ACT-TOT-1           PIC 9(07)    COMP-3 VALUE ZERO.
139100     05  CTR-ACT-TOT-2           PIC 9(07)    COMP-3 VALUE ZERO.
139200     05  CTR-PROJ-TOT            PIC 9(07) COMP-3  OCCURS 4
139300                                        INDEXED BY IDX-PROJ.
139100     05  WS-TOT-OM6996-RC300-CNTR PIC 9(07)   COMP-3 VALUE ZERO.
139400*************************************************
139500*BYPASS REPORT COUNTERS
139600* 1ST SET OF COUNTERS - REGULAR RENEWAL BYPASSED
139700* 2ND SET OF COUNTERS - DELINQUENT BYPASSED
139800* 3RD SET OF COUNTERS - PNO RENEWAL BYPASSED
139900*************************************************
140000 01  BYPASS-COUNT-ARRAY.
140100     05  CTR-BYPASS              OCCURS 3 INDEXED BY IDX-BYP.
140200         10  FILLER.
140300             15  CTR-BYP-TLN     PIC 9(07)    COMP-3.
140400             15  CTR-BYP-IRP     PIC 9(07)    COMP-3.
140500             15  CTR-BYP-PFR     PIC 9(07)    COMP-3.
140600             15  CTR-BYP-PNO     PIC 9(07)    COMP-3.
140700             15  CTR-BYP-EXP     PIC 9(07)    COMP-3.
140800             15  CTR-BYP-CCP     PIC 9(07)    COMP-3.
140900             15  CTR-BYP-CCH     PIC 9(07)    COMP-3.
141000             15  CTR-BYP-SBJ     PIC 9(07)    COMP-3.
141100             15  CTR-BYP-SBE01   PIC 9(07)    COMP-3.
141200             15  CTR-BYP-SBE02   PIC 9(07)    COMP-3.
141300             15  CTR-BYP-SBE03   PIC 9(07)    COMP-3.
141400             15  CTR-BYP-SBE04   PIC 9(07)    COMP-3.
141500             15  CTR-BYP-SBE07   PIC 9(07)    COMP-3.
141600             15  CTR-BYP-SBE11   PIC 9(07)    COMP-3.
141700             15  CTR-BYP-SBE12   PIC 9(07)    COMP-3.
141800             15  CTR-BYP-SBE13   PIC 9(07)    COMP-3.
141900             15  CTR-BYP-SBE18   PIC 9(07)    COMP-3.
142000             15  CTR-BYP-SBE20   PIC 9(07)    COMP-3.
142100             15  CTR-BYP-SBE27   PIC 9(07)    COMP-3.
142200             15  CTR-BYP-SBE28   PIC 9(07)    COMP-3.
142300             15  CTR-BYP-SBE30   PIC 9(07)    COMP-3.
142400             15  CTR-BYP-SBE33   PIC 9(07)    COMP-3.
142500             15  CTR-BYP-SBE34   PIC 9(07)    COMP-3.
142600             15  CTR-BYP-SBE37   PIC 9(07)    COMP-3.
142700             15  CTR-BYP-SBE41   PIC 9(07)    COMP-3.
142800             15  CTR-BYP-SBE42   PIC 9(07)    COMP-3.
142900             15  CTR-BYP-SBE50   PIC 9(07)    COMP-3.
143000             15  CTR-BYP-SBE58   PIC 9(07)    COMP-3.
143100             15  CTR-BYP-SBE61   PIC 9(07)    COMP-3.
143200             15  CTR-BYP-SBE62   PIC 9(07)    COMP-3.
143300             15  CTR-BYP-SBE63   PIC 9(07)    COMP-3.
143400             15  CTR-BYP-SBE70   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-SBE71   PIC 9(07)    COMP-3.
143600             15  CTR-BYP-SBE76   PIC 9(07)    COMP-3.
143700             15  CTR-BYP-SBE78   PIC 9(07)    COMP-3.
143800             15  CTR-BYP-SBE81   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-IRPTK   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-IRPTL   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-IRPIK   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-IRPIR   PIC 9(07)    COMP-3.
143500             15  CTR-BYP-IRPFR   PIC 9(07)    COMP-3.
143900             15  CTR-BYP-VLT     PIC 9(07)    COMP-3.
144000             15  CTR-BYP-DOJ     PIC 9(07)    COMP-3.
144100             15  CTR-BYP-PYR     PIC 9(07)    COMP-3.
144200             15  CTR-BYP-REV     PIC 9(07)    COMP-3.
144300             15  CTR-BYP-CIT     PIC 9(07)    COMP-3.
144400             15  CTR-BYP-TBQ     PIC 9(07)    COMP-3.
144500             15  CTR-BYP-DPL     PIC 9(07)    COMP-3.
144600             15  CTR-BYP-VSL     PIC 9(07)    COMP-3.
144700             15  CTR-BYP-NPNO    PIC 9(07)    COMP-3.
144800             15  CTR-BYP-TIT     PIC 9(07)    COMP-3.
144900             15  CTR-BYP-TYP7    PIC 9(07)    COMP-3.
145000             15  CTR-BYP-FUTDUE  PIC 9(07)    COMP-3.
145100             15  CTR-BYP-COMPMC  PIC 9(07)    COMP-3.
145200 01  BYPASS-COUNT-ARRAY-R  REDEFINES BYPASS-COUNT-ARRAY.
145300     05  CTR-BYP-COL         OCCURS 3  INDEXED BY IDX-COL.
145400         10  CTR-BYP-ROW         OCCURS 54  INDEXED BY IDX-ROW
145500                                 PIC 9(07)    COMP-3.
RF3543**
RF3543 01  CTR-BYP-VLTS94              PIC 9(07)        VALUE 0.
RF3543**


RAY634 01  CTR-IR-DISALLOW             PIC 9(07)        VALUE 0.
RAY634 01  CTR-IR-DISALLOW-PRT         PIC Z,ZZZ,ZZ9    VALUE ZERO.
RAY634
145600 01  BYPASS-TOTALS.
145700     05  CTR-BYP-SUB1            PIC 9(07)    COMP-3 VALUE ZERO.
145800     05  CTR-BYP-SUB2            PIC 9(07)    COMP-3 VALUE ZERO.
145900     05  CTR-BYP-SUB3            PIC 9(07)    COMP-3 VALUE ZERO.
146000     05  CTR-BYP-TOT             PIC 9(07)    COMP-3 VALUE ZERO.
146100*************************
146200*     MISC COUNTERS     *
146300*************************
146400     05  CTR-ERR-LINE            PIC 9(03)    COMP-3 VALUE ZERO.
146500 01  ERR-MSG-CNT                 PIC 9(02) VALUE ZERO.
146600 01  CTR-BYP-LINE                PIC 9(02) VALUE ZERO.
146700 01  CTR-BYP-PAGE                PIC 9(02) VALUE ZERO.
146800/*******************************************************
146900*            M I S C    W O R K   A R E A              *
147000********************************************************
147200 01  PREVIOUS-LICENSE            PIC X(07) VALUE SPACE.
147300 01  PREVIOUS-VIN                PIC X(30) VALUE SPACE.
147400 01  WA-RCC33-REASON.
147500     05  FILLER                  PIC 9(01) VALUE 0.
147600     05  WA-FLAG-RCC33           PIC 9(01) VALUE 0.
147700         88  SW-INVALID-RCC33-07           VALUE 7.
147800         88  SW-INVALID-RCC33-08           VALUE 8.
147900 01  WA-DUP-NBR                  PIC 9(01) VALUE ZERO.
148000 01  WA-BATCH-ID                 PIC 9(02) VALUE ZERO.
JC0201*Y2K E64-MAIL-ADDR-DATE IS USED TO STORE RETURNED OR1582 VALUE.
JC0201 01  E64-MAIL-ADDR-DATE          PIC 9(08) VALUE ZERO.
148100*Y2K E69-PNO-DATE IS USED TO STORE RETURNED OR1582 VALUE.
148200 01  E69-PNO-DATE.
148300     05  E69-PNO-CCYY            PIC 9(04) VALUE ZERO.
148400     05  FILLER                  PIC 9(04) VALUE ZERO.
148500 01  WA-SEL-DATE.
148600     05  WA-SEL-YR               PIC 9(04) VALUE ZERO.
148700 01  WA-ADJ-SIGNED-DT            PIC 9(06) VALUE ZERO.
148800 01  WA-OR-FEE                   PIC 9(03)    COMP-3 VALUE ZERO.
148900 01  WA-SVC-FEE                  PIC 9(03)    COMP-3 VALUE ZERO.
149000 01  WA-REG-FEE                  PIC 9(03)    COMP-3 VALUE ZERO.
149100 01  WA-ESF-FEE                  PIC 9(03)    COMP-3 VALUE ZERO.
149200 01  WA-AQ-FEE                   PIC 9(03)    COMP-3 VALUE ZERO.
149300 01  WA-TALLY                    PIC 9(07)    COMP-3 VALUE ZERO.
LDS   *************
LDS    01  WA-LDS.
LDS        05  C-BATCH-DRIVER            PIC  X(08) VALUE 'OM6996  '.
LDS   *************
149400 01  WA-STAT-RPT-COUNTS.
149500     05  WA-STAT-TOT             PIC 9(07) COMP-3 OCCURS 4
149600                                      INDEXED BY IDX-STAT.
149700     05  WA-STAT-TOT-1           PIC 9(07)    COMP-3 VALUE ZERO.
149800     05  WA-STAT-TOT-2           PIC 9(07)    COMP-3 VALUE ZERO.
149900*
149900*01  WA-ERROR-MSG                PIC X(28) VALUE SPACE.
149900 01  WA-ERROR-MSG.
149900   05  WA-ERROR-MSG-TEXT         PIC X(15) VALUE SPACE.
149900   05  WA-ERROR-MSG-NUM          PIC 9(13) VALUE ZEROS.
RB0714
RB0714 01  wa-error-msg1.
RB0714   05  wa-error-msg1-TLC         pic x(02) value space.
RB0714   05  wa-error-msg1-text        pic x(26) value
RB0714      ' Obsolete Typ Lic on Table'.
RB0714
RB0714 01  wa-error-msg2.
RB0714   05  wa-error-msg2-TLC         pic x(02) value space.
RB0714   05  wa-error-msg2-text        pic x(26) value
RB0714      ' Obsolete Typ Lic on Mastr'.
RB0714
VRMDCK***
VRMDCK***********************************************************
VRMDCK 01  WA-Error-Msg3.
VRMDCK   10  filler                    pic x(24) value
VRMDCK     '>>>RP0326 Bypassed Lic# '.
VRMDCK   10  wa-error-msg3-license     pic x(08) value spaces.
VRMDCK   10  filler                    pic x(15) value
VRMDCK     ' Exp Date VRM= '.
VRMDCK   10  wa-error-msg3-mexpdate.
VRMDCK     20 wa-error-msg3-mccyy.
VRMDCK**      30 wa-error-msg3-mcc        pic 9(2)  value spaces.
VRMDCK        30 wa-error-msg3-mYY        pic 9(2)  value zeros.
VRMDCK     20 filler                   pic x(1)  value '/'.
VRMDCK     20 wa-error-msg3-mmm        pic 9(2)  value zeros.
VRMDCK     20 filler                   pic x(1)  value '/'.
VRMDCK     20 wa-error-msg3-mdd        pic 9(2)  value zeros.
VRMDCK   10  filler                    pic x(06) value
VRMDCK     ' VRS= '.
VRMDCK   10  wa-error-msg3-sexpdate.
VRMDCK     20 wa-error-msg3-sccyy.
VRMDCK        30 wa-error-msg3-scc     pic 9(2)  value zeros.
VRMDCK        30 wa-error-msg3-syy     pic 9(2)  value zeros.
VRMDCK     20 filler                   pic x(1)  value space.
VRMDCK     20 wa-error-msg3-smm        pic 9(2)  value zeros.
VRMDCK     20 filler                   pic x(1)  value space.
VRMDCK     20 wa-error-msg3-sdd        pic 9(2)  value zeros.
VRMDCK   10   filler                   pic x(07) value ' count='.
VRMDCK   10   wa-error-msg3-count      pic               zzz,z99.
VRMDCK** 10   wa-error-msg3-count      pic             z,zzz,z99.
VRMDCK   10  filler                    pic x(10)  value
VRMDCK       ' <<<<<<<<<'.
VRMDCK 01  wa-error-msg3-counter       pic 9(7)   value zeros.
VRMDCK***********************************************************


150000 01  WA-LIC-NBR                  PIC X(07) VALUE SPACE.
150100 01  WA-ELP-LIC-PTN              PIC X(07) VALUE SPACE.
150200     88  VALID-ELP-PATTERN                 VALUE 'XX*****'
150300                                            'XXX****' 'XXXX***'
150400                                            'XXXXX**' 'XXXXXX*'
150500                                            'XXXXXXX'.
150600 01  WA-VALIDATION-CHAR          PIC X(01) VALUE SPACE.
150700 01  WA-SITUS-CNTY-CD            PIC X(02) VALUE SPACE.
150800 01  WA-SITUS-CNTY-NUM REDEFINES WA-SITUS-CNTY-CD
150900                                 PIC 9(02).
151000 01  WA-INVALID-REASON-CD.
151100     05  FILLER                  PIC X(26) VALUE
151200                                 'INVALID RSN CD ON SUBREC E'.
151300     05  WA-E-CODE               PIC X(02).
151400 01  WA-INVALID-YR-SOLD.
151500     05  FILLER                  PIC X(16) VALUE 'INVALID YR SOLD'
151600                                           .
151700     05  FILLER                  PIC X(01) VALUE QUOTE.
151800     05  FILLER                  PIC X(02) VALUE '00'.
151900     05  FILLER                  PIC X(01) VALUE QUOTE.
152000     05  FILLER                  PIC X(08) VALUE ' NO * YR'.
152100 01  WA-INSPECT-EXEMPT-DATE      PIC 9(06) VALUE ZERO.
ADDRSP 01  WA-LENGTH                   PIC S9(04) BINARY VALUE +0.
ADDRSP 01  WA-LENGTH-R REDEFINES WA-LENGTH.
ADDRSP     05  FILLER                  PIC X(01).
ADDRSP     05  WA-LENGTH-BYTE          PIC X(01).
ADDRSP 01  WA-NAME-ADDR-CHKLGTH        PIC X(27) VALUE SPACE.
ADDRSP 01  WA-ADDCTR                   PIC 9(02) VALUE ZERO.
ADDRSP 01  WA-LENGTH-CITY              PIC S9(04) BINARY VALUE +0.
ADDRSP 01  WA-LENGTH-CITY-R REDEFINES WA-LENGTH-CITY.
ADDRSP     05  FILLER                  PIC X(01).
ADDRSP     05  WA-LENGTH-CIT-BYTE      PIC X(01).
ADDRSP 01  WA-NAME-CITY-CHKLGTH        PIC X(13) VALUE SPACE.
ADDRSP 01  WA-CITYCTR                  PIC 9(02) VALUE ZERO.
152200 01  WA-RO-NAME.
152300     05  WA-RO-NAME-27.
152400         10 WA-RO-NAME-3         PIC X(03) VALUE SPACE.
152500         10 FILLER               PIC X(24) VALUE SPACE.
152600     05  FILLER                  PIC X(03) VALUE SPACE.
152700 01  WA-RO-NAME-ARRAY    REDEFINES WA-RO-NAME.
152800     05  WA-RO-NAME-CHAR         PIC X(01) OCCURS 30
152900                                           INDEXED BY IDX-NAME.
153000 01  WA-CITY                     PIC X(13) VALUE SPACE.
153100 01  WA-CITY-R           REDEFINES WA-CITY.
153200     05 WA-CITY-BYTE             PIC X(01) OCCURS 13
153300                                           INDEXED BY IDX-CITY.
153400 01  WA-MAIL-ADDRESS.
153500     05  FILLER         PIC X(01).
153600     05  WA-MAIL-ADDR1  PIC X(27).
ADDRPR     05  WA-RO-ADDR1-ARRAY    REDEFINES WA-MAIL-ADDR1.
152800         10  WA-RO-ADDR1-CHAR      PIC X(01) OCCURS 27
152900                                           INDEXED BY IDX-ADD1.
153700     05  WA-MAIL-ADDR2  PIC X(27).
ADDRPR     05  WA-RO-ADDR2-ARRAY    REDEFINES WA-MAIL-ADDR2.
152800         10  WA-RO-ADDR2-CHAR      PIC X(01) OCCURS 27
152900                                           INDEXED BY IDX-ADD2.
153800     05  WA-MAIL-CITY   PIC X(13).
ADDRPR     05  WA-MAIL-CITY-ARRAY  REDEFINES WA-MAIL-CITY.
ADDRPR         10  WA-MAIL-CITY-CHAR     PIC X(01) OCCURS 13
ADDRPR                                           INDEXED BY IDX-CIT1.
153900     05  WA-MAIL-CC     PIC X(02).
154000     05  WA-MAIL-ZIP-CD PIC X(05).
154100         88  WA-ZIP-ZEROS          VALUE '00000'.
154200     05  FILLER         PIC X(06).
154300 01  WA-P-ADDRESS.
154400     05  WA-P-CNTY-CD            PIC 9(02).
154500     05  WA-P-CITY               PIC X(13).
154600     05  WA-P-STATE              PIC X(02).
154700 01  WA-TV-SRCH-KEY.
154800     05  WA-SRCH-TV              PIC X(02) VALUE SPACE.
154900     05  WA-SRCH-VEH-CL          PIC X(01) VALUE SPACE.
155000 01  WA-NA-PARAM.
155100     05  WA-NA-INDS              PIC X(02) VALUE SPACE.
155200     05  WA-RO3-IND              PIC X(01) VALUE SPACE.
155300     05  WA-RO4-IND              PIC X(01) VALUE SPACE.
155400 01  WA-CNTL-CODE-INDS.
155500     05  WA-INDS.
155600         10  WA-IND-L            PIC X(01) VALUE SPACE.
155700         10  WA-IND-H            PIC X(01) VALUE SPACE.
155800         10  WA-IND-F            PIC X(01) VALUE SPACE.
155900         10  WA-IND-E            PIC X(01) VALUE SPACE.
156000     05  WA-INDS-R           REDEFINES WA-INDS OCCURS 4
156100         INDEXED BY IDX-IND-WA.
156200         10  WA-IND              PIC X(01).
156300 01  WS-WORK-AREA.
SB1500     05  WS-WORK-BI.
SB1500         10  WS-ITT-DD1          PIC S9(4) COMP VALUE 106.
SB1500     05  WS-WORK-FIX REDEFINES WS-WORK-BI.
SB1500         10  FILLER              PIC X.
SB1500         10  WS-BYTE-2           PIC X.
SB1500     05  WS-WORK-BI-2.
SB1500         10  WS-ITT-ENDMSG       PIC S9(4) COMP VALUE 189.
SB1500     05  WS-WORK-F REDEFINES WS-WORK-BI-2.
SB1500         10  FILLER              PIC X.
SB1500         10  WS-BYTE-2A          PIC X.
156400/*************************************
156500*        DATE TIME WORK AREA         *
156600**************************************
156700 01  WA-START-TIME.
156800     05  WA-START-TIME-HR        PIC X(02) VALUE SPACE.
156900     05  WA-START-TIME-MIN       PIC X(02) VALUE SPACE.
157000     05  FILLER                  PIC X(04) VALUE SPACE.
157100 01  WA-STOP-TIME.
157200     05  WA-STOP-TIME-HR         PIC X(02) VALUE SPACE.
157300     05  WA-STOP-TIME-MIN        PIC X(02) VALUE SPACE.
157400     05  FILLER                  PIC X(04) VALUE SPACE.
157500 01  WA-RENEW-DATE.
157600     05  WA-RENEW-CCYY           PIC 9(04) VALUE ZERO.
157700     05  WA-RENEW-MO             PIC 9(02) VALUE ZERO.
157800     05  WA-RENEW-DA             PIC 9(02) VALUE ZERO.
157900 01  WA-RPT-DATE.
158000     05  WA-RPT-MO               PIC 9(02) VALUE ZERO.
158100     05  FILLER                  PIC X(01) VALUE '/'.
158200     05  WA-RPT-DA               PIC 9(02) VALUE ZERO.
158300     05  FILLER                  PIC X(01) VALUE '/'.
158400     05  WA-RPT-YR               PIC 9(02) VALUE ZERO.
158500 01  WA-JDATE-ALL.
158600     05  FILLER                  PIC 9(02).
158700     05  WA-JDATE                PIC 9(05).
158800 01  WA-JDATE-R REDEFINES WA-JDATE-ALL.
158900     05  WA-JDATE-CC             PIC 9(02).
159000     05  WA-JDATE-YY             PIC 9(02).
159100     05  WA-JDATE-DDD            PIC 9(03).
159200 01  WA-NEXT-YR                  PIC 9(04) VALUE ZERO.
159300 01  WA-LAST-YR                  PIC 9(04) VALUE ZERO.
159400 01  DATE-TIME-LITERALS.
159500     05  L-19                    PIC X(02) VALUE '19'.
159600     05  L-20                    PIC X(02) VALUE '20'.
159700/&*************************************************
159800*  CODE ADDED FOR TEST ONLY - CHANGE SYSTEM DATE  *
159900*  FORMAT FOR PARAM IS: YYJJJ YYMMDD              *
160000***************************************************
160100 01  DATE-PARAM.
160200     05  DATE-PARAM1.
160300         10  DATE-PARAM1-YY      PIC 9(02) VALUE ZERO.
160400         10  DATE-PARAM1-JJJ     PIC 9(03) VALUE ZERO.
160500     05  FILLER                  PIC X(01) VALUE SPACE.
160600     05  DATE-PARAM2.
160700         10  DATE-PARAM2-YY      PIC 9(02) VALUE ZERO.
160800         10  DATE-PARAM2-MMDD    PIC 9(04) VALUE ZERO.
160900     05  TEST-DATE-PARAM.
161000         10  TEST-YR             PIC 9(02) VALUE ZERO.
161100         10  TEST-MM             PIC 9(02) VALUE ZERO.
161200*******************************************************
161300*           T E S T  D A T E  T A B L E               *
161400*******************************************************
161500  01  TEST-DATE-TABLE.
161600      05  TST-DT-TBL.
161700          10  FILLER             PIC X(07) VALUE '0010101'.
161800          10  FILLER             PIC X(07) VALUE '0320201'.
161900          10  FILLER             PIC X(07) VALUE '0600301'.
162000          10  FILLER             PIC X(07) VALUE '0910401'.
162100          10  FILLER             PIC X(07) VALUE '1210501'.
162200          10  FILLER             PIC X(07) VALUE '1520601'.
162300          10  FILLER             PIC X(07) VALUE '1820701'.
162400          10  FILLER             PIC X(07) VALUE '2130801'.
162500          10  FILLER             PIC X(07) VALUE '2440901'.
162600          10  FILLER             PIC X(07) VALUE '2741001'.
162700          10  FILLER             PIC X(07) VALUE '3051101'.
162800          10  FILLER             PIC X(07) VALUE '3351201'.
162900*
163000          10  FILLER             PIC X(07) VALUE '0310131'.
163100          10  FILLER             PIC X(07) VALUE '0590228'.
163200          10  FILLER             PIC X(07) VALUE '0900331'.
163300          10  FILLER             PIC X(07) VALUE '1200430'.
163400          10  FILLER             PIC X(07) VALUE '1510531'.
163500          10  FILLER             PIC X(07) VALUE '1810630'.
163600          10  FILLER             PIC X(07) VALUE '2120731'.
163700          10  FILLER             PIC X(07) VALUE '2430831'.
163800          10  FILLER             PIC X(07) VALUE '2730930'.
163900          10  FILLER             PIC X(07) VALUE '3041031'.
164000          10  FILLER             PIC X(07) VALUE '3341130'.
164100          10  FILLER             PIC X(07) VALUE '3651231'.
164200      05  TEST-DATE REDEFINES TST-DT-TBL OCCURS 24 TIMES.
164300          10  TEST-DT-JJJ        PIC 9(03).
164400          10  TEST-DT-MM         PIC 9(02).
164500          10  TEST-DT-DD       PIC 9(02).
164600
164700/******************
164800*   SAVE INDEX    *
164900*******************
165000 01  IDX-SAVE                                 INDEX.
165100 01  ARRAY-SIZE                  PIC 9(03) VALUE ZERO.
165200****************
165300*   LITERALS   *
165400****************
165500 01  L-ZERO                      PIC 9(01) VALUE ZERO.
165600 01  L-SITUS-SAME-AS             PIC X(23) VALUE
165700                               'SAME AS MAILING ADDRESS'.
165800 01  DISPLAY-LINES.
165900     05  CTR-TOT-IN-LINE.
166000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166100         10  FILLER              PIC X(31) VALUE
166200                                   'INPUT RECS (ALL)  - '.
166300         10  TOT-IN              PIC Z,ZZZ,ZZ9.
165900     05  CTR-TOT-IN1-LINE.
166000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166100         10  FILLER              PIC X(22) VALUE
166200                                   'INPUT1 RECS       - '.
166300         10  TOT-IN1             PIC Z,ZZZ,ZZ9.
165900     05  CTR-TOT-EXT-LINE.
166000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166100         10  FILLER              PIC X(22) VALUE
166200                                   'EXTRACT RECS      - '.
166300         10  TOT-EXT             PIC Z,ZZZ,ZZ9.
165900     05  CTR-TOT-DPP-LINE.
166000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166100         10  FILLER              PIC X(22) VALUE
166200                                   'DPP RECS          - '.
166300         10  TOT-DPP             PIC Z,ZZZ,ZZ9.
166400     05  CTR-EXP-IN-LINE .
166500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166600         10  FILLER              PIC X(22) VALUE
166700                                   'INPUT EXPIRED     - '.
166800         10  EXP-IN              PIC Z,ZZZ,ZZ9.
166900     05  CTR-TOT-OUT-LINE.
167000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
167100         10  FILLER              PIC X(22) VALUE
167200                                   'CONTROL TOTAL     - '.
167300         10  TOT-OUT             PIC Z,ZZZ,ZZ9.
165900     05  CTR-TOT-ERR-BYP-LINE.
166000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
166100         10  FILLER              PIC X(31) VALUE
166200                                   'ERR/BYP (ONCE)    - '.
166300         10  TOT-ERR-BYP         PIC Z,ZZZ,ZZ9.
167400     05  CTR-TOT-ERR-LINE.
167500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
167600         10  FILLER              PIC X(22) VALUE
167700                                   'ERROR RECS        - '.
167800         10  TOT-ERR             PIC Z,ZZZ,ZZ9.
167900     05  CTR-REG-BYP-LINE.
168000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
168100         10  FILLER              PIC X(22) VALUE
168200                                   'REGULAR BYPASSED  - '.
168300         10  TOT-REG-BYP         PIC Z,ZZZ,ZZ9.
168400     05  CTR-EXP-BYP-LINE.
168500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
168600         10  FILLER              PIC X(22) VALUE
168700                                   'EXPIRED BYPASSED  - '.
168800         10  TOT-PNO-BYP         PIC Z,ZZZ,ZZ9.
168900     05  CTR-EXP-ERR-LINE.
169000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
169100         10  FILLER              PIC X(32) VALUE
169200                         'EXPIRED WITH ERRORS         - '.
169300         10  TOT-ERR-EXP         PIC Z,ZZZ,ZZ9.
169400     05  CTR-TOT-POT-LINE.
169500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
169600         10  FILLER              PIC X(31) VALUE
169700                                   'POTS CREATED (ALL)- '.
169800         10  TOT-POT             PIC Z,ZZZ,ZZ9.
169900     05  CTR-REG-POT-LINE.
170000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
170100         10  FILLER              PIC X(22) VALUE
170200                                   'REG POTS CREATED  - '.
170300         10  TOT-REG-POT         PIC Z,ZZZ,ZZ9.
170400     05  CTR-PNO-POT-LINE.
170500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
170600         10  FILLER              PIC X(22) VALUE
R3366 *                                  'PNO POTS CREATED  - '.
R3366                                    'PNO POTS BYPASSED - '.
170800         10  TOT-PNO-POT         PIC Z,ZZZ,ZZ9.
170900     05  CTR-DUP-ERR-LINE.
171000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
171100         10  FILLER              PIC X(22) VALUE
171200                                   'DUP ERROR RECS    - '.
171300         10  TOT-DUP-ERROR       PIC Z,ZZZ,ZZ9.
171400     05  CTR-DUP-BYP-LINE.
171500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
171600         10  FILLER              PIC X(22) VALUE
171700                                   'DUP BYP RECS      - '.
171800         10  TOT-BYP-ERROR       PIC Z,ZZZ,ZZ9.
171900     05  CTR-ADJUST-LINE.
172000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
172100         10  FILLER              PIC X(22) VALUE
172200                                   'ADJUSTED OUTPUT   - '.
172300         10  TOT-ADJUSTED        PIC Z,ZZZ,ZZ9.
172400     05  CTR-TOT-NDR-LINE.
172500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
172600         10  FILLER              PIC X(22) VALUE
172700                                   'DELINQUENT NOTICES- '.
172800         10  TOT-NDR             PIC Z,ZZZ,ZZ9.
172900     05  CTR-TOT-PFR-LINE.
173000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
173100         10  FILLER              PIC X(22) VALUE
173200                                   'PFR RECORDS       - '.
173300         10  TOT-PFR             PIC Z,ZZZ,ZZ9.
173400     05  CTR-TOT-TYPE4-LINE.
173500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
173600         10  FILLER              PIC X(22) VALUE
173700                                   'TYPE4 RECORDS     - '.
173800         10  TOT-TYPE4           PIC Z,ZZZ,ZZ9.
173900     05  CTR-NON-POT-LINE.
174000         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
174100         10  FILLER              PIC X(22) VALUE
174200                                   'NON-POT RECORDS   - '.
174300         10  TOT-NON-POT         PIC Z,ZZZ,ZZ9.
174400     05  CTR-TOT-ITT-LINE.
174500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
174600         10  FILLER              PIC X(22) VALUE
174700                                   'ITT RECORDS       - '.
174800         10  TOT-ITT             PIC Z,ZZZ,ZZ9.
174400     05  CTR-TOT-ITT2-LINE.
174500         10  FILLER              PIC X(15) VALUE '  **RP0326**'.
174600         10  FILLER              PIC X(22) VALUE
174700                                   'ITT2 RECORDS      - '.
174800         10  TOT-ITT2            PIC Z,ZZZ,ZZ9.
174900/******************************************
175000*      TYPE LICENSE PARAM WORK AREA       *
175100*******************************************
175200 01  TLP-PARAMS.
175300     05  TLP-VEH-CL-PARAM            PIC X(01).
175400         88  TLP-COML-VEH                      VALUE 'C'.
175500     05  TLP-CONSOLIDATED-FLAG       PIC X(01) VALUE 'Y'.
175600         88  TLP-CONSOLIDATED                  VALUE 'Y'.
175700     05  TLP-CITATIONS-FLAG          PIC X(01) VALUE 'Y'.
175800         88  TLP-CITATIONS-NA                  VALUE 'N'.
175900     05  TLP-EXEMPT-FLAG             PIC X(01) VALUE 'Y'.
176000         88  TLP-NOT-EXEMPT                    VALUE 'N'.
176100/**************************
176200*  STAT REPORT WORK AREA  *
176300***************************
176400 01  W-WORK-WEEK.
           05  W-STAT-SEL-ENTRY OCCURS 40 INDEXED BY IDX-WRK.
176600         10  W-STAT-SEL-DT       PIC X(06).
176700         10  W-STAT-SEL-CNT      PIC 9(07)    COMP-3.
176800 01  W-WORK-WEEK-NDR.
176900     05  W-STAT-SEL-NDR-ENTRY OCCURS 15 INDEXED BY IDX-NDR.
177000         10  W-STAT-SEL-NDR-DT   PIC X(06).
177100         10  W-STAT-SEL-NDR-CNT  PIC 9(07)    COMP-3.
177200 01  W-WEEK1.
           05  W-WEEK1-1 OCCURS 40 INDEXED BY IDX-WK1.
177400         10  W-STAT-SEL-DT-1.
177500             15  W-STAT-SEL-YR-1 PIC X(02).
177600             15  W-STAT-SEL-MO-1 PIC X(02).
177700             15  W-STAT-SEL-DA-1 PIC X(02).
177800         10  W-STAT-SEL-CNT-1    PIC 9(07)    COMP-3.
177900 01  DUEDT-DATE-TBL REDEFINES W-WEEK1.
           05  DUEDT-DATE-ENTRY           OCCURS 40
178100                                    INDEXED BY IDX-DTE.
178200         10  FILLER              PIC X(02).
178300         10  DUEDT-EXP-MMDD.
178400             15  DUEDT-EXP-MO    PIC X(02).
178500             15  DUEDT-EXP-DA    PIC X(02).
178600         10  FILLER              PIC X(04).
178700 01  W-WEEK2.
           05  W-WEEK2-2 OCCURS 40 INDEXED BY IDX-WK2.
178900         10  W-STAT-SEL-DT-2.
179000             15  W-STAT-SEL-YR-2 PIC X(02).
179100             15  W-STAT-SEL-MO-2 PIC X(02).
179200             15  W-STAT-SEL-DA-2 PIC X(02).
179300         10  W-STAT-SEL-CNT-2    PIC 9(07)    COMP-3.
179400 01  W-WEEK3.
           05  W-WEEK3-3 OCCURS 40 INDEXED BY IDX-WK3.
179600         10  W-STAT-SEL-DT-3.
179700             15  W-STAT-SEL-YR-3 PIC X(02).
179800             15  W-STAT-SEL-MO-3 PIC X(02).
179900             15  W-STAT-SEL-DA-3 PIC X(02).
180000         10  W-STAT-SEL-CNT-3    PIC 9(07)    COMP-3.
180100 01  W-WEEK4.
           05  W-WEEK4-4 OCCURS 40 INDEXED BY IDX-WK4.
180300         10  W-STAT-SEL-DT-4.
180400             15  W-STAT-SEL-YR-4 PIC X(02).
180500             15  W-STAT-SEL-MO-4 PIC X(02).
180600             15  W-STAT-SEL-DA-4 PIC X(02).
180700         10  W-STAT-SEL-CNT-4    PIC 9(07)    COMP-3.
180800 01  W-WEEK5.
           05  W-WEEK5-5 OCCURS 40 INDEXED BY IDX-WK5.
181000         10  W-STAT-SEL-DT-5.
181100             15  W-STAT-SEL-YR-5 PIC X(02).
181200             15  W-STAT-SEL-MO-5 PIC X(02).
181300             15  W-STAT-SEL-DA-5 PIC X(02).
181400         10  W-STAT-SEL-CNT-5    PIC 9(07)    COMP-3.
181500 01  W-SORT-WEEK.
           05  W-ENTRY-SORT OCCURS 40 INDEXED BY IDX-SORT.
181700         10  W-DATE-SORT         PIC X(06).
181800         10  W-COUNT-SORT        PIC 9(07)    COMP-3.
181900 01  W-WORK-DATE.
182000     05  W-SIGNED-DT             PIC 9(07)    COMP-3 VALUE ZERO.
182100     05  W-SIGNED-DT-R       REDEFINES W-SIGNED-DT.
182200         10  W-UNSIGNED-DT       PIC X(03).
182300         10  FILLER              PIC X(01).
rd1722/*******************************************************
rd1722*         S U B R E C O R D   W O R K  A R E A         *
rd1722********************************************************
182700*************************
182800* SUBRECORD E WORK AREA *
182900*************************
183000*
183100 01  E-MASK.
183200     05  E-BIT-1                 PIC 9(01) VALUE ZERO.
183300         88  E-CANT-HANDLE-ITEM            VALUE 1.
183400     05  FILLER                  PIC 9(01) VALUE ZERO.
183500     05  E-BIT-3                 PIC 9(01) VALUE ZERO.
183600         88  E-VIN-IS-TOO-LONG             VALUE 1.
183700     05  E-BIT-4                 PIC 9(01) VALUE ZERO.
183800         88  E-RO-IS-TOO-LONG              VALUE 1.
183900     05  E-BIT-5                 PIC 9(01) VALUE ZERO.
184000         88  E-LO-IS-TOO-LONG              VALUE 1.
184100     05  E-BIT-6                 PIC 9(01) VALUE ZERO.
184200         88  E-ENG-IS-TOO-LONG             VALUE 1.
184300     05  FILLER                  PIC 9(01) VALUE ZERO.
184400     05  FILLER                  PIC 9(01) VALUE ZERO.
184500*************************
184600* SUBRECORD K WORK AREA *
184700*************************
184800 01  K-SITUS-ADDRESS.
184900     05  K-REC.
185000         10  K-BYTES             PIC X(01) OCCURS 88
185100         INDEXED BY IDX-K.
185200     05  K-REC-R             REDEFINES K-REC.
185300         10  FILLER              PIC X(09).
185400         10  K-SITUS-CNTY-CD     PIC 9(02).
185500             88  K-VALID-SITUS-CNTY-CD     VALUE 1 THRU 58.
185600             88  K-OUT-OF-STATE-CNTY       VALUE 60.
185700         10  FILLER              PIC X(01).
185800         10  K-SITUS-ADDR        PIC X(47).
185900         10  FILLER              PIC X(14).
186000         10  K-SITUS-CITY        PIC X(13).
186100         10  FILLER              PIC X(02).
186200*
186300 01  K-FIRST                     PIC 9(05)    COMP-3 VALUE ZERO.
186400/************************
186500* SUBRECORD G WORK AREA *
186600*************************
186700 01  G-CITATION.
186800     05  G-RECS.
186900         10  G-BYTE              PIC X(01) OCCURS 4650
187000         INDEXED BY IDX-G.
187100     05  G-RECS-R            REDEFINES G-RECS OCCURS 75
187200         INDEXED BY IDX-G-R.
187300         10  FILLER              PIC X(03).
187400         10  G-DATE-ADDED        PIC 9(06).
187500         10  G-VIOL-YR           PIC 9(02).
187600         10  G-VIOL-MO           PIC 9(02).
187700         10  G-VIOL-DA           PIC 9(02).
187800         10  G-BAIL              PIC 9(03).
187900         10  G-COURT-CD          PIC X(05).
188000         10  FILLER              PIC X(01).
188100         10  G-CIT-NBR           PIC X(15).
188200         10  G-POT-PRINT-IND     PIC X(01).
188300             88  G-NO-POT-PRINTED          VALUE HIGH-VALUE.
188400         10  FILLER              PIC X(08).
188500         10  G-DISPOSITION-CODE  PIC X(01).
188600             88  G-NO-DISPOSITION          VALUE HIGH-VALUE.
188700             88  G-DISP-1-9                VALUE '1' '2' '3' '4'
188800                                            '5' '6' '7' '8' '9'.
188900         10  FILLER              PIC 9(06).
189000         10  G-BILL-PRINT-IND    PIC X(01).
189100             88  G-NO-BILL-PRINTED         VALUE HIGH-VALUE.
189200         10  G-OVERFL            PIC X(06).
189300*
189400 01  G-FIRST                     PIC 9(05)    COMP-3 VALUE ZERO.
189500 01  G-LENGTH                    PIC 9(05)    COMP-3 VALUE ZERO.
189600*************************
189700* SUBRECORD P WORK AREA *
189800*************************
189900 01  P-LESSE.
190000     05  P-REC.
190100         10  P-BYTES             PIC X(01) OCCURS 166
190200                                    INDEXED BY IDX-P.
190300     05  P-REC-R             REDEFINES P-REC.
190400         10  FILLER              PIC X(15).
190500         10  P-CNTY-CD           PIC 9(02).
190600             88  P-VALID-CNTY-CD           VALUE 1 THRU 58 60.
190700         10  P-ZIP-CODE          PIC 9(05).
190800         10  P-ZIP-R REDEFINES P-ZIP-CODE.
190900             15  FILLER          PIC X(01).
191000             15  P-ZIP-FILL      PIC X(04).
191100                 88  P-ZIP-LOW-VALUES      VALUE LOW-VALUE.
191200         10  FILLER              PIC X(03).
191300         10  P-NAME              PIC X(30).
191400         10  P-ADDR2-IND         PIC X(01).
191500         10  P-ADDR2             PIC X(30).
191600         10  FILLER              PIC X(01).
191700         10  P-CITY              PIC X(13).
191800         10  P-ADDR3-IND         PIC X(01).
191900         10  P-ADDR3             PIC X(30).
192000         10  P-ADDR4-IND         PIC X(01).
192100         10  P-ADDR4             PIC X(30).
192200         10  P-STATE             PIC X(02).
192300         10  P-REMOVAL-DATE      PIC X(01).
192400             88  P-REMOVAL-HIGH            VALUE HIGH-VALUE.
192500         10  FILLER              PIC X(01).
192600 01  P-FIRST                     PIC 9(05)    COMP-3 VALUE ZERO.
192700*************************
192800* SUBRECORD W WORK AREA *   UPDATE IF THERE IS AN INCREASE
192900*************************
193000 01  W-MULTI-PURPOSE.
193100     05  W-REC.
JC0501         10  W-BYTES             PIC X(01) OCCURS 3795
193300                                    INDEXED BY IDX-W.
JC0501     05  W-REC-R             REDEFINES W-REC OCCURS 15
193500                                    INDEXED BY IDX-W-R.
193600         10  W-OCCURENCES.
193700             15  W-SUBCODE-W     PIC X(01).
193800             15  W-VARLEN        PIC 9(01).
193900             15  W-FOVO          PIC 9(04).
194000             15  W-MULT-CODE     PIC X(03).
194100             15  FILLER          PIC X(17).
194200             15  W-ODOMETER-YR   PIC X(04).
194300             15  W-ODOMETER-MMDD PIC X(04).
194400             15  FILLER          PIC X(02).
194500             15  W-TTC           PIC X(03).
194600             15  FILLER          PIC X(214).
194700 01  W-FIRST                     PIC 9(05)    COMP-3 VALUE ZERO.
194800 01  W-LENGTH                    PIC 9(05)    COMP-3 VALUE ZERO.
194900/*************************************************
195000*              T   A   B   L   E   S             *
195100**************************************************
195200 01  VALID-CHARACTER-TABLE.
195300     05  FILLER                 PIC X(38)  VALUE
195400                  ' /ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'.
195500 01  TBL-VALID-CHAR  REDEFINES  VALID-CHARACTER-TABLE.
195600     05  TBL-VALID-CHAR-ENTRY   PIC X(01) OCCURS 38 TIMES
195700                                          INDEXED BY IDX-CHAR.
195800 01  INVALID-CHARACTER-TABLE.
195900     05  FILLER                  PIC X(17)  VALUE
196000                                            '*#/&.0123456789MV'.
196100 01  TBL-INVALID-CHAR  REDEFINES  INVALID-CHARACTER-TABLE.
196200     05  TBL-INVALID-CHAR-ENTRY  PIC X(01) OCCURS 17 TIMES
196300                                          INDEXED BY IDX-INV.
ADDRPR 01  INVALID-CHAR-ADDR-TABLE.
ADDRPR     05  FILLER                  PIC X(24)  VALUE
ADDRPR                '&.,!@$?()=_+{}??:";<>\?%'.
ADDRPR 01  TBL-INV-ADDR-CHAR  REDEFINES  INVALID-CHAR-ADDR-TABLE.
ADDRPR     05  TBL-INVALID-ADDR-CHAR   PIC X(01) OCCURS 24 TIMES
196400                                          INDEXED BY IDX-ADD.
ADDRPR 01  INVALID-CHAR-CITY-TABLE.
ADDRPR     05  FILLER                  PIC X(27)  VALUE
ADDRPR                '&.,!@$?()-=_+{}??:";<>\?%*#'.
ADDRPR 01  TBL-INV-CITY-CHAR  REDEFINES  INVALID-CHAR-CITY-TABLE.
ADDRPR     05  TBL-INVALID-CITY-CHAR   PIC X(01) OCCURS 27 TIMES
                                               INDEXED BY IDX-CIT.
196500 01  TBL-BYPASS-LIC-DETAIL.
196600     05  TBL-BYPASS-LIC           PIC X(07) OCCURS 104.
196700
196800********************
196900* COURT NAME TABLE *
197000********************
197100 01  COURT-TABLE-STORAGE.
197200     05  FILLER                     PIC X(04) VALUE 'DDDD'.
197300     05  COURT-TABLE-RETURN-CODE    PIC 9(04) VALUE ZERO.
197400     05  FILLER                     PIC X(08).
197500     05  COURT-TABLE.
197600         10  COURT-ENTRIES    OCCURS 2000
197700                              ASCENDING KEY IS COURT-CODE
197800             INDEXED BY IDX-COURT.
197900             15  COURT-CODE          PIC X(05).
198000             15  COURT-NAME          PIC X(14).
198100*********************
198200* HIST VEH TL TABLE *
198300*********************
198400 01  HIST-TABLE.
198500     05  HIST-TLS.
198600         10  FILLER              PIC X(42) VALUE
198700                     'A0H1H31011515561656971759199A6315357636793'.
198800     05  HIST-TLS-R          REDEFINES HIST-TLS OCCURS 21
198900         INDEXED BY IDX-HIST.
199000         10  HIST-TL             PIC X(02).
199100**********************
199200* END OF MONTH TABLE *
199300**********************
199400 01  END-MONTH-TABLE.
199500     05  END-MO.
199600         10  FILLER              PIC X(44) VALUE
199700                   '01310228033104300531063007310831093010311130'.
199800     05  END-MO-R            REDEFINES END-MO OCCURS 11
199900         INDEXED BY IDX-MO.
200000         10  END-MODA            PIC X(04).
200100/***************************
200200* OLD NEW TYPE VEHICLE TBL *
200300****************************
200400 01  TV-CLASS-TABLE.
200500     05  TV-CLASS-CONSTANTS.
200600         10  TV-FARM-VEHICLE     PIC X(05) VALUE '01E01'.
200700         10  TV-SPECIAL-MOBILE   PIC X(05) VALUE '02M01'.
200800         10  TV-SPECIAL-VEH      PIC X(05) VALUE '03S01'.
200900         10  TV-PR-ID-COML       PIC X(05) VALUE '04I04'.
201000         10  TV-PR-ID-TRLR       PIC X(05) VALUE '05J05'.
201100         10  TV-FARM-VEHICLE     PIC X(05) VALUE '08F08'.
201200         10  TV-FARM-VEHICLE     PIC X(05) VALUE '09G09'.
201300         10  TV-HC-ANTIQ-MC      PIC X(05) VALUE '10H10'.
201400         10  TV-AUTO-NEW         PIC X(05) VALUE '11A12'.
201500         10  TV-AUTO-OLD         PIC X(05) VALUE '12A12'.
201600         10  TV-AUTO-NON-RES     PIC X(05) VALUE '13A17'.
201700         10  TV-AUTO-ELEC-NEW    PIC X(05) VALUE '14A15'.
201800         10  TV-AUTO-ELEC-OLD    PIC X(05) VALUE '15A15'.
201900         10  TV-AUTO-ELEC-NRES   PIC X(05) VALUE '16A16'.
202000         10  TV-AUTO-OLD-NON-RES PIC X(05) VALUE '17A17'.
202100         10  TV-AUTO-NEW-REMAN   PIC X(05) VALUE '18A19'.
202200         10  TV-AUTO-OLD-REMAN   PIC X(05) VALUE '19A19'.
202300         10  TV-MC-HIST          PIC X(05) VALUE '20H20'.
202400         10  TV-MC-NEW           PIC X(05) VALUE '21M22'.
202500         10  TV-MC-OLD           PIC X(05) VALUE '22M22'.
202600         10  TV-MC-NON-RES-NEW   PIC X(05) VALUE '23M26'.
202700         10  TV-MC-ELEC-NEW      PIC X(05) VALUE '24M25'.
202800         10  TV-MC-ELEC-OLD      PIC X(05) VALUE '25M25'.
202900         10  TV-MC-NON-RES-OLD   PIC X(05) VALUE '26M26'.
203000         10  TV-MC-CML-EC-NW-OLD PIC X(05) VALUE '27M27'.
203100         10  TV-MC-NEW-REMAN     PIC X(05) VALUE '28M29'.
203200         10  TV-MC-OLD-REMAN     PIC X(05) VALUE '29M29'.
203300         10  TV-COML-NEW         PIC X(05) VALUE '31C32'.
203400         10  TV-COML-OLD         PIC X(05) VALUE '32C32'.
203500         10  TV-COML-NON-RES     PIC X(05) VALUE '33C37'.
203600         10  TV-COML-ELEC-NEW    PIC X(05) VALUE '34C35'.
203700         10  TV-COML-ELEC-OLD    PIC X(05) VALUE '35C35'.
203800         10  TV-CML-ELEC-NRES    PIC X(05) VALUE '36C36'.
203900         10  TV-COML-OLD-NON-RES PIC X(05) VALUE '37C37'.
204000         10  TV-COML-NEW-REMAN   PIC X(05) VALUE '38C39'.
204100         10  TV-COML-OLD-REMAN   PIC X(05) VALUE '39C39'.
204200         10  TV-TRLR-HIST        PIC X(05) VALUE '40T40'.
204300         10  TV-TRLR-NEW         PIC X(05) VALUE '41T42'.
204400         10  TV-TRLR-OLD         PIC X(05) VALUE '42T42'.
204500         10  TV-TRLR-NON-RES-NEW PIC X(05) VALUE '43T47'.
204600         10  TV-TRLR-NON-RES-OLD PIC X(05) VALUE '47T47'.
204700         10  TV-TRLR-NEW-REMAN   PIC X(05) VALUE '48T49'.
204800         10  TV-TRLR-OLD-REMAN   PIC X(05) VALUE '49T49'.
204900/
RA1108         10  TV-OHV-NEW-ELEC     PIC X(05) VALUE '54O55'.
RA1108         10  TV-OHV-OLD-ELEC     PIC X(05) VALUE '55O55'.
RA1108         10  TV-OHV-N-O-NON-RES-ELEC  PIC X(05) VALUE '56O56'.
RA1108         10  TV-OHV-NEW-REMAN-ELEC PIC X(05) VALUE '57O58'.
RA1108         10  TV-OHV-OLD-REMAN-ELEC PIC X(05) VALUE '58O58'.
205000         10  TV-OHV-NEW          PIC X(05) VALUE '61O62'.
205100         10  TV-OHV-OLD          PIC X(05) VALUE '62O62'.
205200         10  TV-OHV-NEW-NON-RES  PIC X(05) VALUE '63O64'.
205300         10  TV-OHV-OLD-NON-RES  PIC X(05) VALUE '64O64'.
205400         10  TV-OHV-NEW-REMAN    PIC X(05) VALUE '68O69'.
205500         10  TV-OHV-OLD-REMAN    PIC X(05) VALUE '69O69'.
205600         10  TV-VESSEL-NEW       PIC X(05) VALUE '81V82'.
205700         10  TV-VESSEL-OLD       PIC X(05) VALUE '82V82'.
205800         10  TV-VESSEL-NON-RES   PIC X(05) VALUE '83V82'.
205900         10  TV-DISBLD-PLCRD-NEW PIC X(05) VALUE '91P92'.
206000         10  TV-DISBLD-PLCRD-OLD PIC X(05) VALUE '92P92'.
206100     05  TV-CLASS-CONSTANTS-R REDEFINES TV-CLASS-CONSTANTS.
RA1108         10  TV-ENTRIES OCCURS 59 ASCENDING KEY IS TV-CLASS
206300         INDEXED BY IDX-TV.
206400             15  TV-CLASS        PIC X(03).
206500             15  TV-OLD          PIC X(02).
206600/***************************
206700* OUT OF STATE NAME TABLE  *
206800****************************
206900 01  NON-FOREIGN-TABLE.
207000     05  NON-FOREIGN-CONSTANTS.
207100         10  FILLER              PIC X(16) VALUE '04ALA'.
207200         10  FILLER              PIC X(16) VALUE '03AL'.
207300         10  FILLER              PIC X(16) VALUE '07ALASKA'.
207400         10  FILLER              PIC X(16) VALUE '03AK'.
207500         10  FILLER              PIC X(16) VALUE '05ARIZ'.
207600         10  FILLER              PIC X(16) VALUE '03AZ'.
207700         10  FILLER              PIC X(16) VALUE '04ARK'.
207800         10  FILLER              PIC X(16) VALUE '03AR'.
207900         10  FILLER              PIC X(16) VALUE '06CALIF'.
208000         10  FILLER              PIC X(16) VALUE '03CA'.
208100         10  FILLER              PIC X(16) VALUE '05COLO'.
208200         10  FILLER              PIC X(16) VALUE '03CO'.
208300         10  FILLER              PIC X(16) VALUE '12DENVER COLO'.
208400         10  FILLER              PIC X(16) VALUE '05CONN'.
208500         10  FILLER              PIC X(16) VALUE '03CT'.
208600         10  FILLER              PIC X(16) VALUE '04DEL'.
208700         10  FILLER              PIC X(16) VALUE '03DE'.
208800         10  FILLER              PIC X(16) VALUE '03DC'.
208900         10  FILLER              PIC X(16) VALUE '04FLA'.
209000         10  FILLER              PIC X(16) VALUE '03FL'.
209100         10  FILLER              PIC X(16) VALUE '03GA'.
209200         10  FILLER              PIC X(16) VALUE '07HAWAII'.
209300         10  FILLER              PIC X(16) VALUE '03HI'.
209400         10  FILLER              PIC X(16) VALUE '06IDAHO'.
209500         10  FILLER              PIC X(16) VALUE '03ID'.
209600         10  FILLER              PIC X(16) VALUE '04ILL'.
209700         10  FILLER              PIC X(16) VALUE '03IL'.
209800         10  FILLER              PIC X(16) VALUE '04IND'.
209900         10  FILLER              PIC X(16) VALUE '03IN'.
210000         10  FILLER              PIC X(16) VALUE '05IOWA'.
210100         10  FILLER              PIC X(16) VALUE '03IA'.
210200         10  FILLER              PIC X(16) VALUE '05KANS'.
210300         10  FILLER              PIC X(16) VALUE '03KS'.
210400         10  FILLER              PIC X(16) VALUE '03KY'.
210500         10  FILLER              PIC X(16) VALUE '03LA'.
210600/
210700         10  FILLER              PIC X(16) VALUE '06MAINE'.
210800         10  FILLER              PIC X(16) VALUE '03ME'.
210900         10  FILLER              PIC X(16) VALUE '03MD'.
211000         10  FILLER              PIC X(16) VALUE '05MASS'.
211100         10  FILLER              PIC X(16) VALUE '03MA'.
211200         10  FILLER              PIC X(16) VALUE '05MICH'.
211300         10  FILLER              PIC X(16) VALUE '03MI'.
211400         10  FILLER              PIC X(16) VALUE '05MINN'.
211500         10  FILLER              PIC X(16) VALUE '03MN'.
211600         10  FILLER              PIC X(16) VALUE '05MISS'.
211700         10  FILLER              PIC X(16) VALUE '03MS'.
211800         10  FILLER              PIC X(16) VALUE '03MO'.
211900         10  FILLER              PIC X(16) VALUE '05MONT'.
212000         10  FILLER              PIC X(16) VALUE '03MT'.
212100         10  FILLER              PIC X(16) VALUE '05NEBR'.
212200         10  FILLER              PIC X(16) VALUE '03NE'.
212300         10  FILLER              PIC X(16) VALUE '04NEV'.
212400         10  FILLER              PIC X(16) VALUE '03NV'.
212500         10  FILLER              PIC X(16) VALUE '04N H'.
212600         10  FILLER              PIC X(16) VALUE '03NH'.
212700         10  FILLER              PIC X(16) VALUE '04N J'.
212800         10  FILLER              PIC X(16) VALUE '03NJ'.
212900         10  FILLER              PIC X(16) VALUE '06N MEX'.
213000         10  FILLER              PIC X(16) VALUE '03NM'.
213100         10  FILLER              PIC X(16) VALUE '04N Y'.
213200         10  FILLER              PIC X(16) VALUE '03NY'.
213300         10  FILLER              PIC X(16) VALUE '13NEW YORK N Y'.
213400         10  FILLER              PIC X(16) VALUE '12NEW YORK NY'.
213500         10  FILLER              PIC X(16) VALUE '04N C'.
213600         10  FILLER              PIC X(16) VALUE '03NC'.
213700         10  FILLER              PIC X(16) VALUE '06N DAK'.
213800         10  FILLER              PIC X(16) VALUE '03ND'.
213900         10  FILLER              PIC X(16) VALUE '05OHIO'.
214000         10  FILLER              PIC X(16) VALUE '03OH'.
214100         10  FILLER              PIC X(16) VALUE '05OKLA'.
214200         10  FILLER              PIC X(16) VALUE '03OK'.
214300         10  FILLER              PIC X(16) VALUE '05OREG'.
214400         10  FILLER              PIC X(16) VALUE '03OR'.
214500         10  FILLER              PIC X(16) VALUE '14PORTLAND OREG'
214600                                           .
214700         10  FILLER              PIC X(16) VALUE '03PA'.
214800         10  FILLER              PIC X(16) VALUE '04R I'.
214900         10  FILLER              PIC X(16) VALUE '03RI'.
215000         10  FILLER              PIC X(16) VALUE '04S C'.
215100         10  FILLER              PIC X(16) VALUE '03SC'.
215200         10  FILLER              PIC X(16) VALUE '06S DAK'.
215300         10  FILLER              PIC X(16) VALUE '03SD'.
215400/
215500         10  FILLER              PIC X(16) VALUE '05TENN'.
215600         10  FILLER              PIC X(16) VALUE '03TN'.
215700         10  FILLER              PIC X(16) VALUE '04TEX'.
215800         10  FILLER              PIC X(16) VALUE '03TX'.
215900         10  FILLER              PIC X(16) VALUE '05UTAH'.
216000         10  FILLER              PIC X(16) VALUE '03UT'.
216100         10  FILLER              PIC X(16) VALUE '03VT'.
216200         10  FILLER              PIC X(16) VALUE '03VA'.
216300         10  FILLER              PIC X(16) VALUE '05WASH'.
216400         10  FILLER              PIC X(16) VALUE '03WA'.
216500         10  FILLER              PIC X(16) VALUE '05W VA'.
216600         10  FILLER              PIC X(16) VALUE '03WV'.
216700         10  FILLER              PIC X(16) VALUE '04WIS'.
216800         10  FILLER              PIC X(16) VALUE '03WI'.
216900         10  FILLER              PIC X(16) VALUE '04WYO'.
217000         10  FILLER              PIC X(16) VALUE '03WY'.
217100     05  NON-FOREIGN-CONSTANTS-R REDEFINES NON-FOREIGN-CONSTANTS.
217200         10  NON-FOREIGN-ENTRIES OCCURS 97 INDEXED BY IDX-NON.
217300             15  NON-NBR-BYTES   PIC 9(02).
217400             15  NON-FORGN-BYTE  PIC X(01) OCCURS 14
217500         INDEXED BY IDX-NON-2.
217600 01  TBL-PGE-TABLE.
217700     05  TBL-PGE-CONSTANTS.
217800         10  FILLER              PIC X(27) VALUE 'PGE'.
217900         10  FILLER              PIC X(27) VALUE 'PG E'.
218000         10  FILLER              PIC X(27) VALUE 'P GE'.
218100         10  FILLER              PIC X(27) VALUE 'P G E'.
218200         10  FILLER              PIC X(27) VALUE 'PGE CO'.
218300         10  FILLER              PIC X(27) VALUE 'PG E CO'.
218400         10  FILLER              PIC X(27) VALUE 'P GE CO'.
218500         10  FILLER              PIC X(27) VALUE 'PG AND E'.
218600         10  FILLER              PIC X(27) VALUE 'P G E CO'.
218700         10  FILLER              PIC X(27) VALUE 'PG AND E CO'.
218800         10  FILLER              PIC X(27) VALUE 'PAC GAS EL CO'.
218900         10  FILLER              PIC X(27) VALUE
219000                                               'PAC GAS ELECT CO'.
219100         10  FILLER              PIC X(27) VALUE
219200                                           'PAC GAS ELECTRIC CO'.
219300         10  FILLER              PIC X(27) VALUE
219400                                           'PAC GAS AND ELECT CO'.
219500         10  FILLER              PIC X(27) VALUE
219600                                        'PAC GAS AND ELECTRIC CO'.
219700         10  FILLER              PIC X(27) VALUE
219800                                          'PACIFIC GAS ELECT CO'.
219900         10  FILLER              PIC X(27) VALUE
220000                                      'PACIFIC GAS AND ELECT CO'.
220100         10  FILLER              PIC X(27) VALUE
220200                                        'PACIFIC GAS ELECTRIC CO'.
220300         10  FILLER              PIC X(27) VALUE
220400                                    'PACIFIC GAS AND ELECTRIC CO'.
220500     05  TBL-PGE-CONSTANTS-R REDEFINES TBL-PGE-CONSTANTS.
220600         10  TBL-PGE-ENTRIES OCCURS 19 INDEXED BY IDX-PGE.
220700             15  TBL-PGE-NAME  PIC X(27).
220800/***************************
220900*  PAPER CODE COUNT TABLE  *
221000****************************
221100 01  ACTUAL-POTS-COUNTS.
221200     05  ACTUAL-COUNTS.
               10  ACT-REGULAR.
221400             15  FILLER          PIC X(01) VALUE 'C'.
221500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
221600             15  FILLER          PIC X(01) VALUE SPACE.
                   15  ACT-REG-EXP     PIC 9(07) COMP-3 VALUE ZERO.
221800         10  ACT-SMOG.
221900             15  FILLER          PIC X(01) VALUE 'B'.
222000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
222100             15  FILLER          PIC X(01) VALUE SPACE.
222200             15  ACT-SMOG-EXP    PIC 9(07) COMP-3 VALUE ZERO.
222300         10  ACT-TRAILER-GOLD.
222400             15  FILLER          PIC X(01) VALUE 'G'.
222500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
222600             15  FILLER          PIC X(01) VALUE SPACE.
222700             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
222800         10  ACT-TRAILER.
222900             15  FILLER          PIC X(01) VALUE 'H'.
223000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
223100             15  FILLER          PIC X(01) VALUE SPACE.
223200             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
223300         10  ACT-GOLDENROD.
223400             15  FILLER          PIC X(01) VALUE 'F'.
223500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
223600             15  FILLER          PIC X(01) VALUE SPACE.
223700             15  ACT-GOLD-EXP    PIC 9(07) COMP-3 VALUE ZERO.
223800         10  ACT-GOLDENROD-SMOG.
223900             15  FILLER          PIC X(01) VALUE 'D'.
224000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
224100             15  FILLER          PIC X(01) VALUE SPACE.
224200             15  ACT-G-SMOG-EXP  PIC 9(07) COMP-3 VALUE ZERO.
224300         10  ACT-VESSEL.
224400             15  FILLER          PIC X(01) VALUE 'S'.
224500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
224600             15  FILLER          PIC X(01) VALUE SPACE.
224700             15  ACT-VSL-EXP     PIC 9(07) COMP-3 VALUE ZERO.
224800         10  ACT-OHV.
224900             15  FILLER          PIC X(01) VALUE 'Q'.
225000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
225100             15  FILLER          PIC X(01) VALUE SPACE.
225200             15  ACT-OHV-EXP     PIC 9(07) COMP-3 VALUE ZERO.
225300         10  ACT-SPECIAL.
225400             15  FILLER          PIC X(01) VALUE 'R'.
225500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
225600             15  FILLER          PIC X(01) VALUE SPACE.
225700             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
225800         10  ACT-DPP.
225900             15  FILLER          PIC X(01) VALUE 'J'.
226000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
226100             15  FILLER          PIC X(01) VALUE SPACE.
226200             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
226300         10  ACT-CONS-PARKING.
226400             15  FILLER          PIC X(01) VALUE 'U'.
226500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
226600             15  FILLER          PIC X(01) VALUE SPACE.
226700             15  ACT-CONS-P-EXP  PIC 9(07) COMP-3 VALUE ZERO.
226800         10  ACT-CONS-SMOG-PARKING.
226900             15  FILLER          PIC X(01) VALUE 'N'.
227000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
227100             15  FILLER          PIC X(01) VALUE SPACE.
227200             15  ACT-SMOG-P-EXP  PIC 9(07) COMP-3 VALUE ZERO.
227300         10  ACT-TRLR-G-PARKING.
227400             15  FILLER          PIC X(01) VALUE 'Y'.
227500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
227600             15  FILLER          PIC X(01) VALUE SPACE.
227700             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
227800         10  ACT-TRLR-PARKING.
227900             15  FILLER          PIC X(01) VALUE 'W'.
228000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
228100             15  FILLER          PIC X(01) VALUE SPACE.
228200             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
228300         10  ACT-GOLDENROD-PARKING.
228400             15  FILLER          PIC X(01) VALUE 'V'.
228500             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
228600             15  FILLER          PIC X(01) VALUE SPACE.
228700             15  ACT-GOLD-P-EXP  PIC 9(07) COMP-3 VALUE ZERO.
228800         10  ACT-SMOG-G-PARKING.
228900             15  FILLER          PIC X(01) VALUE 'P'.
229000             15  FILLER          PIC 9(07) COMP-3 VALUE ZERO.
229100             15  FILLER          PIC X(01) VALUE SPACE.
229200             15  ACT-SMOG-G-P-EXP PIC 9(07) COMP-3 VALUE ZERO.
229300     05  ACTUAL-COUNTS-R     REDEFINES ACTUAL-COUNTS
229400                                 OCCURS 32
229500                                 INDEXED BY IDX-CNT.
229600         10  ACT-PAPER           PIC X(01).
229700         10  ACT-CNT             PIC 9(07) COMP-3.
229800
229900 01  TAG-TABLE.
230000     05  RPT-TAGNAMES.
               10  FILLER              PIC X(19) VALUE 'REGULAR     '.
230900         10  FILLER              PIC X(19) VALUE 'VESSEL'.
231000         10  FILLER              PIC X(19) VALUE 'OHV'.
231100         10  FILLER              PIC X(19) VALUE 'FARM/SPECIAL'.
231200         10  FILLER              PIC X(19) VALUE 'DP PLACARD'.
231300     05  REPORT-TAG  REDEFINES RPT-TAGNAMES
                                       PIC X(19)  OCCURS 5.
231500**********************
231600*   SUBSCRIPTS       *
231700**********************
231800 01  SUB-1                       PIC 9(02)  VALUE ZERO.
231900 01  SUB-2                       PIC 9(03)  VALUE ZERO.
232000
232100/***************************
232200*    COUNTY NAME TABLE     *
232300****************************
232400 01  COUNTY-CODE-NAME-TABLE.
232500     05  COUNTY-CODE-NAMES.
232600         10  FILLER              PIC X(13) VALUE 'ALAMEDA'.
232700         10  FILLER              PIC X(13) VALUE 'ALPINE'.
232800         10  FILLER              PIC X(13) VALUE 'AMADOR'.
232900         10  FILLER              PIC X(13) VALUE 'BUTTE'.
233000         10  FILLER              PIC X(13) VALUE 'CALAVERAS'.
233100         10  FILLER              PIC X(13) VALUE 'COLUSA'.
233200         10  FILLER              PIC X(13) VALUE 'CONTRA COSTA'.
233300         10  FILLER              PIC X(13) VALUE 'DEL NORTE'.
233400         10  FILLER              PIC X(13) VALUE 'EL DORADO'.
233500         10  FILLER              PIC X(13) VALUE 'FRESNO'.
233600         10  FILLER              PIC X(13) VALUE 'GLENN'.
233700         10  FILLER              PIC X(13) VALUE 'HUMBOLDT'.
233800         10  FILLER              PIC X(13) VALUE 'IMPERIAL'.
233900         10  FILLER              PIC X(13) VALUE 'INYO'.
234000         10  FILLER              PIC X(13) VALUE 'KERN'.
234100         10  FILLER              PIC X(13) VALUE 'KINGS'.
234200         10  FILLER              PIC X(13) VALUE 'LAKE'.
234300         10  FILLER              PIC X(13) VALUE 'LASSEN'.
234400         10  FILLER              PIC X(13) VALUE 'LOS ANGELES'.
234500         10  FILLER              PIC X(13) VALUE 'MADERA'.
234600         10  FILLER              PIC X(13) VALUE 'MARIN'.
234700         10  FILLER              PIC X(13) VALUE 'MARIPOSA'.
234800         10  FILLER              PIC X(13) VALUE 'MENDOCINO'.
234900         10  FILLER              PIC X(13) VALUE 'MERCED'.
235000         10  FILLER              PIC X(13) VALUE 'MODOC'.
235100         10  FILLER              PIC X(13) VALUE 'MONO'.
235200         10  FILLER              PIC X(13) VALUE 'MONTEREY'.
235300         10  FILLER              PIC X(13) VALUE 'NAPA'.
235400         10  FILLER              PIC X(13) VALUE 'NEVADA'.
235500         10  FILLER              PIC X(13) VALUE 'ORANGE'.
235600         10  FILLER              PIC X(13) VALUE 'PLACER'.
235700         10  FILLER              PIC X(13) VALUE 'PLUMAS'.
235800         10  FILLER              PIC X(13) VALUE 'RIVERSIDE'.
235900/
236000         10  FILLER              PIC X(13) VALUE 'SACRAMENTO'.
236100         10  FILLER              PIC X(13) VALUE 'SAN BENITO'.
236200         10  FILLER              PIC X(13) VALUE 'SN BERNARDINO'.
236300         10  FILLER              PIC X(13) VALUE 'SAN DIEGO'.
236400         10  FILLER              PIC X(13) VALUE 'SAN FRANCISCO'.
236500         10  FILLER              PIC X(13) VALUE 'SAN JOAQUIN'.
236600         10  FILLER              PIC X(13) VALUE 'S LUIS OBISPO'.
236700         10  FILLER              PIC X(13) VALUE 'SAN MATEO'.
236800         10  FILLER              PIC X(13) VALUE 'SANTA BARBARA'.
236900         10  FILLER              PIC X(13) VALUE 'SANTA CLARA'.
237000         10  FILLER              PIC X(13) VALUE 'SANTA CRUZ'.
237100         10  FILLER              PIC X(13) VALUE 'SHASTA'.
237200         10  FILLER              PIC X(13) VALUE 'SIERRA'.
237300         10  FILLER              PIC X(13) VALUE 'SISKIYOU'.
237400         10  FILLER              PIC X(13) VALUE 'SOLANO'.
237500         10  FILLER              PIC X(13) VALUE 'SONOMA'.
237600         10  FILLER              PIC X(13) VALUE 'STANISLAUS'.
237700         10  FILLER              PIC X(13) VALUE 'SUTTER'.
237800         10  FILLER              PIC X(13) VALUE 'TEHAMA'.
237900         10  FILLER              PIC X(13) VALUE 'TRINITY'.
238000         10  FILLER              PIC X(13) VALUE 'TULARE'.
238100         10  FILLER              PIC X(13) VALUE 'TUOLUMNE'.
238200         10  FILLER              PIC X(13) VALUE 'VENTURA'.
238300         10  FILLER              PIC X(13) VALUE 'YOLO'.
238400         10  FILLER              PIC X(13) VALUE 'YUBA'.
238500     05  COUNTY-CODE-NAMES-R REDEFINES COUNTY-CODE-NAMES OCCURS 58
238600         INDEXED BY IDX-COUNTY.
238700         10  COUNTY-SITUS-NAME   PIC X(13).
238800
238900/************************************************************
239000*            L I N K A G E   W O R K   A R E A              *
239100*************************************************************
239200************************
239300*  OF6012 EXPLODE LINK *
239400************************
239500 01  OF6012-COBOL-LINKAGE.
239600     05  FILLER                  PIC X(01) VALUE 'E'.
239700     05  OF6012-COB-LINK-FILE-ID.
239800         10  OF6012-FILE-ID-1    PIC X(01) VALUE '0'.
239900         10  OF6012-FILE-ID-2    PIC X(01) VALUE '1'.
240000     05  FILLER                  PIC X(02) VALUE '07'.
240100 01  OF6012-COMPRESSED-REC-LTH   PIC 9(08)    COMP VALUE ZERO.
240200 01  OF6012-DOLLAR-SIGN          PIC 9(08)    COMP VALUE ZERO.
240300 01  OF6012-RETURN-CODE          PIC 9(01) VALUE ZERO.
240400     88  OF6012-BAD-EXPLOSION              VALUE 1.
240500*****************************
240600*  OF6512 VALIDATE LIC LINK *
240700*****************************
240800 01  OF6512-RETURN-CODE-V        PIC 9(01) VALUE ZERO.
240900     88  OF6512-LIC-NOT-VALID              VALUE 6 7.
241000 01  OF6512-VALIDATION-LINKAGE.
241100     05  FILLER                  PIC X(01) VALUE '1'.
241200     05  OF6512-VAL-TL           PIC X(02) VALUE SPACE.
241300 01  OF6512-KEY-AREA.
241400     05  OF6512-VAL-LIC-NBR      PIC X(07) VALUE SPACE.
241500     05  FILLER                  PIC X(09) VALUE SPACE.
241600     05  OF6512-FILE-CODE        PIC X(02).
241700         88  OF6512-REG-AUTO-0101          VALUE   '__'.
241800         88  OF6512-REV-AUTO-0110          VALUE   '__'.
241900         88  OF6512-REG-TRLR-0202          VALUE   '__'.
242000         88  OF6512-REG-MC-0303            VALUE   '__'.
242100         88  OF6512-REV-MC-0330            VALUE   '__'.
242200         88  OF6512-REG-COML-0404          VALUE   '__'.
242300         88  OF6512-REV-COML-0440          VALUE   '_ '.
242400         88  OF6512-DP-0A0A                VALUE   '__'.
242500     05  FILLER                  PIC X(01) VALUE SPACE.
242600
242700/**********************
242800*  RP032G RATING LINK *
242900***********************
243000     COPY FEELINKG.
245200
      ********************************************
      *** COPY FEELINKG  End       ***************
      ********************************************

rd1722/***************************************************************
rd1722*** COUNTY CODE GENERATOR
rd1722*** FINALIST-USPCBM01-PARMS =
rd1722***    New FINALIST 'USPCBM01' CALL parms replacing ZIPMOD
rd1722/***************************************************************
RD1722
RD1722 01  FINALIST-CALL-PGM-ID            PIC X(08) VALUE 'USPCBM01'.
RD1722
RD1722 01  FINALIST-USPCBM01-PARMS.
rd1722     05  FInalist-lk-buffer              PIC X(01) VALUE SPACE.
rd1722     05  FINALIst-LK-FUNC-CODE           PIC 9(02) VALUE 0.
rd1722       88 FINALIST-CITY-COUNTY-SEARCH              VALUE 03.
rd1722***          01 = 1 BYTE HEX CITY CODE SEARCH
rd1722***          02 = 3 BYTE ABBREVATED CITY CODE SEARCH
rd1722***          03 = 13 BYTE CITY NAME, 2 BYTE COUNTY CODE SEARCH
rd1722
RD1722     05  FINALIST-LK-CITY                PIC X(13) VALUE SPACE.
RD1722     05  FINALIST-LK-COUNTY              PIC X(02) VALUE SPACE.
RD1722     05  FINALIST-LK-ADDR.
rd1722***               FOR FINALIST  LK-ADDR size = 70  ------------
RD1722         10  FINALIST-LK-ADDR1           PIC X(27) VALUE SPACE.
RD1722           88  FINALIST-LAST-CALL                  VALUE 'EOF '.
rd1722         10  FINALIST-LK-ADDR2           PIC X(27) VALUE SPACE.
RD1722         10  FINALIST-LK-ADDR3           PIC X(16) VALUE SPACE.
RD1722*
RD1722 01  FINALIST-RETURN-RECORD.
RD1722     05  FINALIST-RET-AREA-1.
RD1722         10  FINALIST-RETURN-CODE        PIC 9(02) VALUE 0.
RD1722           88 FINALIST-RC-Good                     VALUE 00.
RD1722           88 FINALIST-INVALID-SEARCH-CODE         VALUE 03.
RD1722           88 FINALIST-KEY-NOTE-FOUND              VALUE 05.
RD1722           88 FINALIST-RECFOUND-County-diff        VALUE 06.
RD1722           88 FINALIST-RECFOUND-city-duplic        VALUE 07.
RD1722
RD1722         10  FINALIST-RET1-ALCO          PIC 9(02) VALUE 0.
RD1722         10  FINALIST-RET1-ZIPCODE-Last4 PIC X(04) value space.
RD1722         10  FIller-RET1-DUP-city        PIC 9(02) value 0.
RD1722*********    duplicate city = not used, always zeros
RD1722
RD1722     05  FINALIST-RET-AREA-2.
RD1722***                                 --- size = 30 ------
RD1722         10  FILLER                      PIC X(20) VALUE SPACE.
RD1722         10  FINALIST-RET2-ROCC          PIC 9(02) VALUE 0.
RD1722         10  FILLER                      PIC X(08) VALUE SPACE.
RD1722
RD1722
245300**************************************************************
245400*  1/98 THE FOLLOWING COPY MODULE ADDED FOR RETRIEVAL OF
245500*  VR YEAR 2000 CENTURIES
245600**************************************************************
245700     COPY C01FLINK.
245800
      ********************************************
      ***  COPY C01FLINK  End      ***************
      ********************************************

245900     COPY BDTPARM.
246000
      ********************************************
      ***  COPY BDTPARM   End      ***************
      ********************************************

246100/**************************
246200*  IBM ADDED INFORMATION  *
246300***************************
246400 01  PROGRAM-VERSION.
246500     05  FILLER                  PIC X(30) VALUE
246600         '** RP0326 (COBOL II) VERSION: '.
246700     05  PROGRAM-COMPILE-DATE.
246800         10  PGM-COMPILE-DATE    PIC X(08).
246900         10  FILLER              PIC X(02) VALUE SPACE.
247000         10  PGM-COMPILE-TIME    PIC X(08).
247100     05  FILLER                  PIC X(03) VALUE ' **'.
247200 01  WA-COMPILE-DATE-TIME.
247300     05  WA-COMPILE-DATE         PIC X(08).
247400     05  WA-COMPILE-TIME         PIC X(08).
247500 01  WA-CURR-DATE-IN.
247600     05  WA-CDI-CC               PIC 9(02) VALUE ZERO.
247700     05  WA-CDI-YY               PIC 9(02) VALUE ZERO.
OHVITR     05  WA-CDI-YY-R REDEFINES WA-CDI-YY.
OHVITR         10  FILLER              PIC 9(01).
OHVITR         10  WA-CDI-LAST-DIGIT   PIC 9(01).
OHVITR             88  WA-CDI-YY-EVEN  VALUE 0 2 4 6 8.
OHVITR             88  WA-CDI-YY-ODD   VALUE 1 3 5 7 9.
247800     05  WA-CDI-MM               PIC 9(02) VALUE ZERO.
247900         88  CURR-MO-OCT-NOV-DEC  VALUE 10 THRU 12.
248000         88  CURR-MO-JAN-FEB      VALUE 01 THRU 02.
248100     05  WA-CDI-DD               PIC 9(02) VALUE ZERO.
248200 01  WA-DATE REDEFINES WA-CURR-DATE-IN.
248300     05  WA-YR                   PIC 9(04).
248400     05  WA-MO                   PIC 9(02).
248500     05  WA-DA                   PIC 9(02).
248600 01  WA-CURR-TIME-IN.
248700     05  WA-CTI-HH               PIC 9(02) VALUE ZERO.
248800     05  WA-CTI-MM               PIC 9(02) VALUE ZERO.
248900     05  WA-CTI-SS               PIC 9(02) VALUE ZERO.
249000     05  WA-CTI-100              PIC 9(02) VALUE ZERO.
249100 01  TODAYS-DATE-IN.
249200     05  TDI-MM                  PIC 9(02) VALUE ZERO.
249300     05  FILLER                  PIC X(01) VALUE '/'.
249400     05  TDI-DD                  PIC 9(02) VALUE ZERO.
249500     05  FILLER                  PIC X(01) VALUE '/'.
249600     05  TDI-YY                  PIC 9(02) VALUE ZERO.
249700     05  FILLER                  PIC X(02) VALUE SPACE.
249800     05  TDI-HH                  PIC 9(02) VALUE ZERO.
249900     05  FILLER                  PIC X(01) VALUE ':'.
250000     05  TDI-MI                  PIC 9(02) VALUE ZERO.
250100     05  FILLER                  PIC X(01) VALUE ':'.
250200     05  TDI-SS                  PIC 9(02) VALUE ZERO.
250300     05  FILLER                  PIC X(01) VALUE '.'.
250400     05  TDI-100                 PIC 9(02) VALUE ZERO.

       01  WS-UC0196-DATA.
           COPY DBCONPRM.

      ********************************************
      ***  COPY DBCONPRM  End      ***************
      ********************************************

      **** start delete for lds change
      *01  WS-SQLCODE                       PIC -999.
      *
      *01   WS-DB2-PARMS.
      *     05 WS-PLAN-ID                   PIC X(08) VALUE SPACES.
      *        88 WS-PLAN-ID-VALID
      *         VALUE 'RP0326PU' 'RP0326PI' 'RP0326PS' 'RP0326PR'.
      *        88 WS-PLAN-ID-UNIT-TEST               VALUE 'RP0326PU'.
      *        88 WS-PLAN-ID-INTEG-TEST              VALUE 'RP0326PI'.
      *        88 WS-PLAN-ID-SYS-TEST                VALUE 'RP0326PS'.
      *        88 WS-PLAN-ID-PROD                    VALUE 'RP0326PR'.
      *
      *     05 WS-SYSTEM-CODE               PIC X(01) VALUE SPACES.
      *        88 WS-SYSTEM-CODE-VALID                VALUE 'T' 'P'.
      *        88 WS-SYSTEM-CODE-TEST                 VALUE 'T'.
      *        88 WS-SYSTEM-CODE-PROD                 VALUE 'P'.
      *
      ************************************************************
      ***    S Q L C A
      ************************************************************
      *    EXEC SQL
      *         INCLUDE SQLCA
      *    END-EXEC.
      *
      ************************************************************
      ***    S Q L d A
      ************************************************************
      *    EXEC SQL
      *         INCLUDE SQLDA
      *    END-EXEC.
      *
      ****************************************************************
      ***    WS  DCLGEN VVRM001A  TABLE(VRM001_AMIS_MASTT)
      ****************************************************************
      *    EXEC SQL
      *         INCLUDE  VVVRM01A
      *    END-EXEC.
      *
      ************************************************************
      ***    D P P   C U R S O R
      ************************************************************
      *    EXEC SQL
      *      DECLARE DPPCURSOR CURSOR FOR
      *         SELECT   FILE_CD,
      *                  LIC_PLT_FMT_NBR,
      *                  AMIS_DATA
      *
      *         FROM     VVRM001U_AMIS_MAST
      **
      *         WHERE    FILE_CD         =
      **                 :DCLVVRM001U-AMIS-MAST.FILE-CD
      *           AND
      *                  LIC_PLT_FMT_NBR ^=
      *                  :DCLVVRM001U-AMIS-MAST.LIC-PLT-FMT-NBR
      *    END-EXEC
      **** end delete for lds change

251200/*********************************************************
251300*           P R O C E D U R E   D I V I S I O N          *
251400**********************************************************
251500 PROCEDURE DIVISION.
251600 PROCEDURE-DIVISION-ENTRY SECTION.
251700 PROCEDURE-DIV-ENTRY.
265700D    DISPLAY 'PROCEDURE-DIV-ENTRY.'.
265700     MOVE    'PROCEDURE-DIV-ENTRY.' TO WA-ERROR-PRM.

251800     MOVE WHEN-COMPILED TO WA-COMPILE-DATE-TIME.
251900     MOVE WA-COMPILE-DATE TO PGM-COMPILE-DATE.
252000     MOVE WA-COMPILE-TIME TO PGM-COMPILE-TIME.
252100     DISPLAY PROGRAM-VERSION.
252200     ACCEPT WA-JDATE FROM DAY.
252300     MOVE FUNCTION CURRENT-DATE(1:8) TO WA-CURR-DATE-IN.
252400     MOVE WA-CDI-MM TO TDI-MM     WA-RPT-MO.
252500     MOVE WA-CDI-DD TO TDI-DD     WA-RPT-DA.
252600     MOVE WA-CDI-YY TO TDI-YY     WA-RPT-YR.
252700     MOVE WA-CDI-CC TO WA-JDATE-CC.
252800     ACCEPT WA-CURR-TIME-IN FROM TIME.
252900     MOVE WA-CTI-HH TO TDI-HH.
253000     MOVE WA-CTI-MM TO TDI-MI.
253100     MOVE WA-CTI-SS TO TDI-SS.
253200     MOVE WA-CTI-100 TO TDI-100.

258800     OPEN INPUT OEXTRACT.
           PERFORM 0410-READ-RECORD.
266200
253300     MOVE POTEXT-BATCH-ID TO WA-BATCH-ID
253400                             ERR-BATCH
253500                             STAT-BATCH
253600                             BYP-BATCH.
253800     DISPLAY ' '.
253900     DISPLAY ' '.
254000     DISPLAY '      **RP0326**  R U N   D A T E  ' TODAYS-DATE-IN
254100                    '      B A T C H   I D - ' WA-BATCH-ID.
254200     DISPLAY ' '.
254300     DISPLAY ' '.
254400
254500     ACCEPT WA-START-TIME FROM TIME.
254600     COMPUTE WA-NEXT-YR = WA-YR + 1.
254700     COMPUTE WA-LAST-YR = WA-YR - 1.
254800     COMPUTE WA-SEL-YR = WA-YR - 5.
254900     IF CURR-MO-OCT-NOV-DEC
255000         ADD 1 TO WA-SEL-YR
255100     END-IF.
255200     SET IDX-WK TO 1.
255300     PERFORM 0120-INIT-STAT-REC 4 TIMES.
520000/***************************
520100 0500-PROCESS-ERROR.
520200****************************
337900D    DISPLAY '0500-PROCESS-ERROR.' EA-LICENSE-NUM
338100
520300     MOVE 'Y' TO SW-ERROR
268400     ADD 1 TO CTR-ERROR

           DISPLAY '***********************************************'
                   '********************'
           DISPLAY '***** ERROR PARAGRAPH: ' WA-ERROR-PRM
           DISPLAY '***** ERROR CODE:      ' WA-RETURN-CODE-MSG
           DISPLAY '***** REASON FOR ERROR:'
           DISPLAY '***** ' WA-RETURN-CODE-RSN
           IF EA-LICENSE-NUM = SPACE
             DISPLAY '***** OEXTRACT'
             DISPLAY '***** LICENSE NUMBER:  ' POTEXT-LICENSE-PFN
             DISPLAY '***** VIN NUMBER:      ' POTEXT-VEH-ID
           ELSE
             DISPLAY '***** VRM'
             DISPLAY '***** LICENSE NUMBER:  ' EA-LICENSE-NUM
             DISPLAY '***** VIN NUMBER:      ' EA-VIN
           END-IF
           DISPLAY '***********************************************'
                   '********************'
           .
255400/***********************
255500 0010-LOAD-COURT-TABLE.
255600************************
265700D    DISPLAY '0010-LOAD-COURT-TABLE.'.
265700     MOVE    '0010-LOAD-COURT-TABLE.' TO WA-ERROR-PRM.

255700     MOVE ZERO TO COURT-TABLE-RETURN-CODE
255800     MOVE HIGH-VALUE TO COURT-TABLE.
255900     CALL 'UP2396' USING COURT-TABLE-STORAGE
256000     EVALUATE COURT-TABLE-RETURN-CODE
256100        WHEN   0
256200            CONTINUE
256300        WHEN   8
256400            DISPLAY '***RP0326 - COURT ABBREV. TABLE '
256500                              ' EXCEEDS SPACE'
256600            DIVIDE L-ZERO INTO L-ZERO
256700        WHEN   OTHER
256800            DISPLAY '***RP0326 - ERROR LOADING COURT TABLE'
256900            DIVIDE L-ZERO INTO L-ZERO
257000     END-EVALUATE.
257100************************
257200 0020-LOAD-TYPE-LIC-TABLE.
257300************************
265700D    DISPLAY '0020-LOAD-TYPE-LIC-TABLE.'.
265700     MOVE    '0020-LOAD-TYPE-LIC-TABLE.' TO WA-ERROR-PRM.

257400     OPEN INPUT TLTABLE
257500     MOVE HIGH-VALUE TO TYPE-LIC-TABLE
257600     MOVE 'N' TO SW-END-OF-TABLE
257700     SET IDX-TL TO 1
257800     PERFORM UNTIL NO-MORE-TABLE-RECS
257900         READ TLTABLE NEXT INTO TYPE-LIC-TBL-REC (IDX-TL)
258000             AT END MOVE 'Y' TO SW-END-OF-TABLE
258100         END-READ
258200         SET IDX-TL UP BY 1
258300     END-PERFORM
258400     CLOSE TLTABLE.
258500************************
258600 0100-MAIN-LOGIC.
258700************************
265700D    DISPLAY '0100-MAIN-LOGIC.'.
265700     MOVE    '0100-MAIN-LOGIC.' TO WA-ERROR-PRM.

258800     OPEN INPUT POTIN1.
258900     OPEN OUTPUT RPORT.
259000     OPEN OUTPUT PTOUT1.
259100     SET IDX-BYP-LIC TO 1.
259200     INITIALIZE CTR-IN1
259200*               CTR-EXT
RB1948                BYPASS-COUNT-ARRAY
259300                PROGRAM-COUNTERS.
RB1948* COMMENT OUT THIS INITIALIZATION AND USE INITIALIZE ABOVE
259400*    SET IDX-ROW TO 1.
259500*    PERFORM 47 TIMES
RB1948*    PERFORM 54 TIMES
259600*        MOVE ZERO TO  CTR-BYP-ROW (1 IDX-ROW)
259700*                      CTR-BYP-ROW (2 IDX-ROW)
RB1948*                      CTR-BYP-ROW (3 IDX-ROW)
259800*        SET IDX-ROW UP BY 1
259900*    END-PERFORM.
260000
260100     PERFORM 0300-PROCESS-RECORD THRU 0399-EXIT
260200              UNTIL EOF-POTIN1.
260300     CLOSE POTIN1.
260000
      ***** start delete for lds change
      *    ACCEPT WS-DB2-PARMS
      *    EVALUATE TRUE
      *    WHEN WS-PLAN-ID-VALID
      *       AND WS-SYSTEM-CODE-VALID
      *      PERFORM 0400-DB2-CONNECT
      *    WHEN NOT WS-PLAN-ID-VALID
523100*      MOVE  WS-PLAN-ID            TO WA-RETURN-CODE-MSG
523400*      MOVE 'PLAN ID IS NOT VALID' TO WA-RETURN-CODE-RSN
      *      PERFORM 0500-PROCESS-ERROR
      *    WHEN NOT WS-SYSTEM-CODE-VALID
523100*      MOVE  WS-SYSTEM-CODE            TO WA-RETURN-CODE-MSG
523400*      MOVE 'SYSTEM CODE IS NOT VALID' TO WA-RETURN-CODE-RSN
      *      PERFORM 0500-PROCESS-ERROR
      *    END-EVALUATE.
      ***** end delete for lds change
      *****
LDS   ***** OPEN CONNECTION TO THE BATCH DRIVER
LDS        PERFORM 0400-DB2-CONNECT.

260100     PERFORM 0410-READ-RECORD
260200       UNTIL EOF-OEXTRACT.

260300     CLOSE OEXTRACT.
260500     PERFORM 6000-PRINT-STAT-1.
260600     PERFORM 6010-PRINT-STAT-2.
260700     PERFORM 6080-PRINT-BYPASS-RPT.
260800
260900     CLOSE RPORT.
261000     CLOSE BYPASS.
261100     CLOSE PTOUT1.
261200     IF SW-EXTOUT-OPENED
261300         CLOSE EXTOUT.
261400     IF SW-PFR = 'Y'
261500         CLOSE PFR.
261600     IF SW-ITT = 'Y'
261700         CLOSE ITTOUT.
261600     IF SW-ITT2 = 'Y'
261700         CLOSE ITTOUT2.
261800     PERFORM 6100-FINAL-COUNTS.
262200
RD1722***  END FINALIST
RD1722     SET      FINALIST-LAST-CALL  TO TRUE
RD1722     PERFORM  8100-CALL-FINALIST-USPCBM01

262100     GO TO PROGRAM-STOP-RETURN.
260400
262300/*********************
262400 0120-INIT-STAT-REC.
262500**********************
265700D    DISPLAY '0120-INIT-STAT-REC. '.
265700     MOVE    '0120-INIT-STAT-REC.' TO WA-ERROR-PRM.

262600     SET IDX-SEL TO 1.
262700     SET IDX-SI TO 1.
262800     SET IDX-WRK TO 1.
262900     PERFORM 0150-INIT-SEL 15 TIMES.
           PERFORM 0155-INIT-SEL 40 TIMES.
263100     PERFORM 0160-INIT-PROJ 11 TIMES.
263200     MOVE 'XXXXXXXX' TO SI-STRT-DATE (IDX-WK)
263300                      SI-STOP-DATE (IDX-WK).
263400     SET IDX-WK UP BY 1.
263500
263600**********************
263700 0150-INIT-SEL.
263800**********************
265700D    DISPLAY '0150-INIT-SEL. '.
265700     MOVE    '0150-INIT-SEL.' TO WA-ERROR-PRM.

263900     MOVE ZERO TO SI-SEL-CNT (IDX-WK IDX-SEL).
264000     SET IDX-SEL UP BY 1.
264100
264200**********************
264300 0155-INIT-SEL.
264400**********************
265700D    DISPLAY '0155-INIT-SEL. '.
265700     MOVE    '0155-INIT-SEL.' TO WA-ERROR-PRM.

264500     MOVE ZERO TO W-STAT-SEL-CNT (IDX-WRK).
264600     SET IDX-WRK UP BY 1.
264700
264800**********************
264900 0160-INIT-PROJ.
265000**********************
265700D    DISPLAY '0160-INIT-PROJ. '.
265700     MOVE    '0160-INIT-PROJ.' TO WA-ERROR-PRM.

265100     MOVE ZERO TO SI-CNT (IDX-WK IDX-SI).
265200     SET IDX-SI UP BY 1.
265400
265500****************************
265600 0300-PROCESS-RECORD.
265700****************************
265700D    DISPLAY '0300-PROCESS-RECORD.'.
265700     MOVE    '0300-PROCESS-RECORD.' TO WA-ERROR-PRM.

265800     READ POTIN1 INTO EXT-EXTRACT-RECORD
265900          AT END
266000         MOVE 1 TO EOF-POT-INDICATOR
266100         GO TO 0399-EXIT.
266200
266300     ADD 1 TO CTR-IN1.
266400     MOVE SPACE TO WA-CNTL-CODE-INDS.
266500     IF NOT EXT-UD407-RECORD
266600         ADD 1 TO CTR-NON-POT
266700         IF EXT-TEST-CENTURY
266800            PERFORM 9999-USE-TEST-DATE
266900         END-IF
267000         GO TO 0399-EXIT
267100     END-IF.
267200
267300     MOVE SPACE TO EA-EXPLOSION-AREA.
267400
267500     IF EXT-MSTR-RID
267600         PERFORM 1000-PROCESS-MSTR THRU 1099-EXIT
267700     ELSE
267800         IF EXT-STAT-RID
267900             ADD 1 TO CTR-NON-POT
268000             MOVE STATISTICS-RECORD TO SI-STAT-INPUT-RECORD
268100         ELSE
268200             MOVE 'INVALID RID' TO WA-ERROR-MSG
268300             PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
268400             ADD 1 TO CTR-ERROR
268500                      CTR-STAT-8516-BYP.
268600 0399-EXIT.
267300     MOVE SPACE TO EXT-EXTRACT-RECORD
131300     IF SW-BYPASS-REC = 'Y'
131400     OR ERROR-IS-COUNTED
131600     OR SW-ERROR = 'Y'
             ADD 1 TO CTR-ERR-BYP
131300       MOVE 'N' TO SW-BYPASS-REC
131300       MOVE 'N' TO SW-ERR-COUNTED
131600       MOVE 'N' TO SW-ERROR
           END-IF.
268700     EXIT.
311500
      * start delete for lds change
265500****************************
       0400-DB2-CONNECT.
265700****************************
265700*D   DISPLAY '0400-DB2-CONNECT.'.
265700*    MOVE    '0400-DB2-CONNECT.' TO WA-ERROR-PRM.
      *
      *    INITIALIZE              WS-UC0196-DATA
      *    SET  CONNECT            TO  TRUE
      *
      *    MOVE WS-SYSTEM-CODE     TO  ARG-SYSTEM-CD
      *    MOVE WS-PLAN-ID         TO  ARG-PLAN-ID
      *
      *    DISPLAY 'WS-UC0196-DATE = ' WS-UC0196-DATA
      *    CALL 'UC0196'
      *      USING  WS-UC0196-DATA
      *    END-CALL
      *
      *    IF ARG-RETURN-CD = '00'
      *      CONTINUE
      *    ELSE
523100*      MOVE ARG-RETURN-CD          TO WA-RETURN-CODE-MSG
523400*      MOVE 'RETURN CODE NOT ZERO' TO WA-RETURN-CODE-RSN
      *      PERFORM 0500-PROCESS-ERROR
      *    END-IF
      *    .
      * end delete for lds change

LDS   ****************************************************************
LDS   * FUNCTION: OPENS THE DB2 DATA BASE USING THE BATCH DRIVER     *
LDS   *           (OM6996)                                           *
LDS   * ENTRY DATA ELEMENTS: NONE                                    *
LDS   * EXIT DATA ELEMENTS:  NONE                                    *
LDS   *---*----------------------------------------------------------*
LDS   D    DISPLAY '0400-DB2-CONNECT.'.
LDS        MOVE    '0400-DB2-CONNECT.' TO WA-ERROR-PRM.
LDS
LDS        MOVE ZEROS           TO BD-RET-CODE
LDS        SET  BD-FUNCTION-OPEN TO TRUE
LDS   D    DISPLAY ' BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.
LDS
LDS        CALL C-BATCH-DRIVER
LDS          USING BY REFERENCE
LDS            BD-FUNCTION,
LDS            BD-RET-CODE
LDS          ON EXCEPTION
LDS            MOVE 9 TO BD-RET-CODE
LDS        END-CALL
LDS   D    DISPLAY ' BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.
LDS
LDS        IF  NOT BD-RET-CODE-GOOD
LDS   D    DISPLAY 'BD-RET-CODE: ' BD-RET-CODE
LDS   ***
LDS   *** DISPLAY DB2 ERROR AND ABEND PROCESSING
LDS   ***
LDS          MOVE BD-RET-CODE            TO WA-RETURN-CODE-MSG
LDS          MOVE 'RETURN CODE NOT ZERO' TO WA-RETURN-CODE-RSN
LDS          PERFORM 0500-PROCESS-ERROR
LDS        END-IF
LDS   D    DISPLAY ' IF01:END:BD-RET-CODE: ' BD-RET-CODE
LDS
LDS        .
LDS   *** END 0400-DB2-CONNECT.

265500****************************
265600 0410-READ-RECORD.
265700****************************
265700D    DISPLAY '0410-READ-RECORD.'
265700     MOVE    '0410-READ-RECORD.' TO WA-ERROR-PRM

265800     READ OEXTRACT
265900       AT END
267600         PERFORM 0430-PROCESS-END-OF-FILE
265900       NOT AT END
267600         PERFORM 0420-PROCESS-RECORD
           END-READ
           .
311500
268900*************************
269000 0420-PROCESS-RECORD.
269100*************************
265700D    DISPLAY '0420-PROCESS-RECORD. '
265700D    DISPLAY 'POT EXTRACT RECORD. ' POTEXT-HEADER
265700     MOVE    '0420-PROCESS-RECORD.' TO WA-ERROR-PRM

318900     ADD 1             TO CTR-EXT
           EVALUATE TRUE
           WHEN POTEXT-IND-DPP
             SET  SW-IND-DPP TO TRUE
           WHEN CTR-EXT = 1
             CONTINUE
           WHEN OTHER
      *      INITIALIZE SWITCHES
267300       MOVE SPACE      TO EA-EXPLOSION-AREA
269900                          DB2-EXPLOSION-AREA
269900                          PNO-STATUS-INDICATOR
269900                          PFR-MSTR-REC
269900                          EXT-MSTR-REC
269800       MOVE 'N'        TO SW-VET-OWN-RETENTN-FEE
269900                          SW-MAIL-ADDRESS
269200                          SW-ERROR
269200                          SW-BYPASS-REC
269400                          SW-ERR-COUNTED
NONCOM                          SW-SUBRECORD-E49
LIVERY                          SW-SUBRECORD-E44-L
scanln                          PO-FLAG-REF-PLATE
scanln                          PO-FLAG-MEDAL
270000       SET  IDX-BYP    TO 1

             IF POTEXT-SORT-DLQ
               SET EXT-RID-8520       TO TRUE
             ELSE
               SET EXT-RID-8516       TO TRUE
             END-IF
272300       EVALUATE TRUE
272300       WHEN POTEXT-TYPE-RECORD-0-OR-5
               MOVE POTEXT-LIC-TYP-CD TO WA-TL
               IF WA-TL-IRP
                 EVALUATE TRUE
                 WHEN WA-TL-IRP-TRK
                   EVALUATE TRUE
                   WHEN POTEXT-SORT-DLQ
                     ADD 1 TO CTR-BYP-IRPTK (2)
                   WHEN POTEXT-E69-PNO-YES
                     ADD 1 TO CTR-BYP-IRPTK (3)
                   WHEN OTHER
                     ADD 1 TO CTR-BYP-IRPTK (1)
                   END-EVALUATE
                 WHEN WA-TL-IRP-TRL
                   EVALUATE TRUE
                   WHEN POTEXT-SORT-DLQ
                     ADD 1 TO CTR-BYP-IRPTL (2)
                   WHEN POTEXT-E69-PNO-YES
                     ADD 1 TO CTR-BYP-IRPTL (3)
                   WHEN OTHER
                     ADD 1 TO CTR-BYP-IRPTL (1)
                   END-EVALUATE
                 WHEN WA-TL-IRP-ITK
                   EVALUATE TRUE
                   WHEN POTEXT-SORT-DLQ
                     ADD 1 TO CTR-BYP-IRPIK (2)
                   WHEN POTEXT-E69-PNO-YES
                     ADD 1 TO CTR-BYP-IRPIK (3)
                   WHEN OTHER
                     ADD 1 TO CTR-BYP-IRPIK (1)
                   END-EVALUATE
                 WHEN WA-TL-IRP-ITR
                   EVALUATE TRUE
                   WHEN POTEXT-SORT-DLQ
                     ADD 1 TO CTR-BYP-IRPIR (2)
                   WHEN POTEXT-E69-PNO-YES
                     ADD 1 TO CTR-BYP-IRPIR (3)
                   WHEN OTHER
                     ADD 1 TO CTR-BYP-IRPIR (1)
                   END-EVALUATE
                 WHEN WA-TL-IRP-FTR
                   EVALUATE TRUE
                   WHEN POTEXT-SORT-DLQ
                     ADD 1 TO CTR-BYP-IRPFR (2)
                   WHEN POTEXT-E69-PNO-YES
                     ADD 1 TO CTR-BYP-IRPFR (3)
                   WHEN OTHER
                     ADD 1 TO CTR-BYP-IRPFR (1)
                   END-EVALUATE
                 END-EVALUATE
               ELSE
269000           PERFORM 0425-RETRIEVE-TYPE-LIC
                 IF SW-ERROR = 'N'
275900             IF TL-DPP OR TL-PRORATE-ID OR TL-SPEC-EQUIP
276100               MOVE 'N' TO TLP-CONSOLIDATED-FLAG
276200             ELSE
276300               MOVE 'Y' TO TLP-CONSOLIDATED-FLAG
                   END-IF
275900             IF TL-OHV OR TL-VESSEL OR TL-DPP OR TL-PRORATE-ID
276600               MOVE 'N' TO TLP-CITATIONS-FLAG
276200             ELSE
276800               MOVE 'Y' TO TLP-CITATIONS-FLAG
                   END-IF
276900
                   EVALUATE TRUE
277000             WHEN TL-ANNUAL-EXEMPT OR TL-PRORATE-ID
277100               MOVE 'Y' TO TLP-EXEMPT-FLAG
277300             WHEN DV-SPECIAL-PLT
277400               MOVE 'Y' TO TLP-EXEMPT-FLAG
277500             WHEN NOT DV-SPECIAL-PLT
277600               MOVE 'N' TO TLP-EXEMPT-FLAG
277800             END-EVALUATE
281100           END-IF
               END-IF

270900       WHEN POTEXT-TYPE-RECORD-4
271000         IF SW-EXTOUT-CLOSED
271100           OPEN OUTPUT EXTOUT
271200           SET SW-EXTOUT-OPENED TO TRUE
271500         END-IF

272700       WHEN OTHER
272800         MOVE 'NOT REC TYPE 0, 4, OR 5' TO WA-ERROR-MSG
272900         PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
273000         PERFORM 4300-COUNT-ERRORS
281100       END-EVALUATE
             IF SW-ERROR = 'N'
319200         PERFORM 0440-READ-VRM-DATABASE
               IF BD-RET-CODE-GOOD
270900           IF POTEXT-TYPE-RECORD-4
284500             MOVE EA-EXPLOSION-AREA TO EXT-MSTR-REC
284700             MOVE EXT-RECORD TO EXTOUT-REC
271800             WRITE EXTOUT-REC
271900             ADD 1 TO CTR-TYPE4
                 ELSE
                   IF POTEXT-VEH-ID = EA-VIN
                     EVALUATE TRUE
                     WHEN EA-TV-TRLR
                       MOVE 'H' TO ACT-PAPER (07)
                       ADD 1  TO ACT-CNT   (07)
                     WHEN EA-TV-GOLDROD
                       MOVE 'F' TO ACT-PAPER (09)
                       ADD 1  TO ACT-CNT   (09)
                     WHEN EA-TV-VESSEL
                       MOVE 'S' TO ACT-PAPER (13)
                       ADD 1  TO ACT-CNT   (13)
                     WHEN EA-TV-OHV
                       MOVE 'Q' TO ACT-PAPER (15)
                       ADD 1  TO ACT-CNT   (15)
                     WHEN EA-TV-SPECIAL
                       MOVE 'R' TO ACT-PAPER (17)
                       ADD 1  TO ACT-CNT   (17)
                     END-EVALUATE

                     PERFORM 1030-PROCESS-PFR THRU 1099-EXIT
RC3435             ELSE
RC3435               MOVE 'Y' TO SW-BYPASS-REC
RC3435               ADD 1    TO CTR-ERROR
RC3435               DISPLAY '***** VIN MIS-MATCH *****'
RC3435               DISPLAY 'EA-LICENSE-NUM = ' EA-LICENSE-NUM
RC3435               DISPLAY 'POTEXT-VEH-ID =  ' POTEXT-VEH-ID
RC3435               DISPLAY 'EA-VIN =         ' EA-VIN
RC3435               DISPLAY '***** END MIS-MATCH *****'
                   END-IF
                 END-IF
               END-IF
             END-IF
131300       IF SW-BYPASS-REC = 'Y'
131400       OR ERROR-IS-COUNTED
131600       OR SW-ERROR = 'Y'
               ADD 1 TO CTR-ERR-BYP
131300         MOVE 'N' TO SW-BYPASS-REC
131300         MOVE 'N' TO SW-ERR-COUNTED
131600         MOVE 'N' TO SW-ERROR
             END-IF
           END-EVALUATE
324200     .
344900
268900*************************
269000 0425-RETRIEVE-TYPE-LIC.
269100*************************
265700D    DISPLAY '0425-RETRIEVE-TYPE-LIC.'
265700     MOVE    '0425-RETRIEVE-TYPE-LIC.' TO WA-ERROR-PRM

274300     SET IDX-TL TO 1
274400     SEARCH ALL TYPE-LIC-TBL-REC
274500       AT END
               MOVE POTEXT-LICENSE-PFN        TO EA-LICENSE-NUM
               MOVE POTEXT-LIC-TYP-CD         TO EA-TL
               MOVE POTEXT-REG-EXPR-DT(3:2)   TO EA-EXP-YR
               MOVE POTEXT-REG-EXPR-DT(6:2)   TO EA-EXP-MO
               MOVE POTEXT-REG-EXPR-DT(9:2)   TO EA-EXP-DA
               MOVE POTEXT-REC-TYP-CD         TO EA-RONM3
               IF POTEXT-LICENSE-PFN (1:3) = 'POW'
                 CONTINUE
               ELSE
274600           PERFORM 4010-INVALID-TL
               END-IF
274800       WHEN TL-TYPE-LIC (IDX-TL) = WA-TL
274900         MOVE TYPE-LIC-TBL-REC (IDX-TL)
275000           TO TYPE-LIC-TBL-DETAIL
275100     END-SEARCH
275200     IF TL-POTS-TYPE
275300       CONTINUE
275400     ELSE
             MOVE POTEXT-LICENSE-PFN          TO EA-LICENSE-NUM
             MOVE POTEXT-LIC-TYP-CD           TO EA-TL
             MOVE POTEXT-REG-EXPR-DT(3:2)     TO EA-EXP-YR
             MOVE POTEXT-REG-EXPR-DT(6:2)     TO EA-EXP-MO
             MOVE POTEXT-REG-EXPR-DT(9:2)     TO EA-EXP-DA
             MOVE POTEXT-REC-TYP-CD           TO EA-RONM3
275500       PERFORM 4010-INVALID-TL
275700     END-IF
           .
RB0714***      obsolete Type License on TL-Table
RB0714     if  TL-TBL-Det-TL-Obsolete
               MOVE POTEXT-LICENSE-PFN          TO EA-LICENSE-NUM
               MOVE POTEXT-LIC-TYP-CD           TO EA-TL
               MOVE POTEXT-REG-EXPR-DT(3:2)     TO EA-EXP-YR
               MOVE POTEXT-REG-EXPR-DT(6:2)     TO EA-EXP-MO
               MOVE POTEXT-REG-EXPR-DT(9:2)     TO EA-EXP-DA
               MOVE POTEXT-REC-TYP-CD           TO EA-RONM3
RB0714         move  TL-TYPE-License            to  WA-Error-MSG1-TLC
RB0714         PERFORM  4011-Obsolete-Type-License-TBL
RB0714     End-If
RB0714     .
275800
265500****************************
265600 0430-PROCESS-END-OF-FILE.
265700****************************
265700D    DISPLAY '0430-PROCESS-END-OF-FILE.'
265700     MOVE    '0430-PROCESS-END-OF-FILE.' TO WA-ERROR-PRM

266200
266000     SET EOF-OEXTRACT TO   TRUE
318900     SUBTRACT 1       FROM CTR-EXT
           IF SW-IND-DPP
      *      MOVE 'S'
271900*        TO FILE-CD       OF DCLVVRM001U-AMIS-MAST
      *      MOVE SPACE
271900*        TO LIC-PLT-FMT-NBR OF DCLVVRM001U-AMIS-MAST
      *      PERFORM 0450-OPEN-DPP-CURSOR
      *      IF SQLCODE = 0
               PERFORM 0460-READ-VRM-DPP
                 UNTIL BD-RET-CODE-EOF
      *          UNTIL SW-EOF-VRM
      *        PERFORM 0470-CLOSE-DPP-CURSOR
      *      END-IF
           END-IF
           PERFORM 0480-DB2-DISCONNECT
           .
321700
321800************************
321900 0440-READ-VRM-DATABASE.
322000************************
      *** START DELETE FOR LDS CHANGE
322100D    DISPLAY '0440-READ-VRM-DATABASE.'
322200     MOVE '0440-READ-VRM-DATABASE.' TO WA-ERROR-PRM
322300*
      *      MOVE POTEXT-FILE-CODE
271900*        TO FILE-CD         OF DCLVVRM001U-AMIS-MAST
      *      MOVE POTEXT-LICENSE-PFN
271900*        TO LIC-PLT-FMT-NBR OF DCLVVRM001U-AMIS-MAST
      *      MOVE SPACE
271900*        TO AMIS-DATA       OF DCLVVRM001U-AMIS-MAST
      *
      *    EXEC SQL
      *         SELECT   FILE_CD,
      *                  LIC_PLT_FMT_NBR,
      *                  AMIS_DATA
      *
      *         INTO     :DCLVVRM001U-AMIS-MAST.FILE-CD,
      *                  :DCLVVRM001U-AMIS-MAST.LIC-PLT-FMT-NBR,
      *                  :DCLVVRM001U-AMIS-MAST.AMIS-DATA
      *
      *         FROM     VVRM001U_AMIS_MAST
      *
      *         WHERE    FILE_CD         =
      *                  :DCLVVRM001U-AMIS-MAST.FILE-CD
      *           AND
      *                  LIC_PLT_FMT_NBR =
      *                  :DCLVVRM001U-AMIS-MAST.LIC-PLT-FMT-NBR
      *    END-EXEC
      *
      *    IF SQLCODE = 0
271900*      MOVE AMIS-DATA      OF DCLVVRM001U-AMIS-MAST
      *        TO DB2-EXPLOSION-AREA
271900*      MOVE DB2-REC        TO EA-EXPLOSION-AREA
271900**     MOVE EA-LICENSE-NUM TO EXT-PLATE-LIC-NBR
      *    ELSE
      ***      IF SQLCODE NOT EQUAL   +100
      *           MOVE  SQLCODE               TO WA-RETURN-CODE-MSG
      *           MOVE 'SQLCODE NOT 0 '       TO WA-RETURN-CODE-RSN
      *           PERFORM 0500-PROCESS-ERROR
      *           SET  SW-EOF-VRM             TO  TRUE
      **       end-if
      *    END-IF
324200*    .
324300*

      *** END DELETE FOR LDS CHANGE

LDS   *** ************************************************************
LDS   * PARAGRAPH NAME: RANDOM DB2                                   *
LDS   * FUNCTION: PERFORMS A RANDOM READ OF THE DB2 DATA BASE USING  *
LDS   *           THE BATCH DRIVER (OM6996)
      * ENTRY DATA ELEMENTS: WORK AREA                               *
      * EXIT DATA ELEMENTS:  DB2 DATA                                *
      *---*----------------------------------------------------------*

           MOVE POTEXT-FILE-CODE         TO BD-FILE-CODE
           MOVE POTEXT-LICENSE-PFN       TO BD-KEY
           MOVE ZEROS                    TO BD-RET-CODE
           MOVE SPACES                   TO BD-VR-MASTER
           SET  BD-FUNCTION-RANDOM       TO TRUE

      D    DISPLAY ' BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.
           CALL C-BATCH-DRIVER
             USING BY REFERENCE
               BD-FUNCTION,
               BD-RET-CODE,
               BD-FILE-CODE,
               BD-VR-MASTER,
               BD-KEY
             ON EXCEPTION
               MOVE 9    TO BD-RET-CODE
           END-CALL

      D    DISPLAY ' BD-RET-CODE: ' BD-RET-CODE
      D            ' BD-FILE-CODE: ' BD-FILE-CODE
      D            ' BD-KEY: ' BD-KEY
EVAL1      EVALUATE TRUE
EVAL1      WHEN BD-RET-CODE-GOOD
      D    DISPLAY '   EVAL1:1:BD-RET-CODE: ' BD-RET-CODE
      *      MOVE BD-VRM-REC     TO DB2-EXPLOSION-AREA
             MOVE BD-VR-MASTER   TO EA-EXPLOSION-AREA
      *      MOVE EA-LICENSE-NUM TO EXT-PLATE-LIC-NBR

EVAL1      WHEN BD-RET-CODE-INVALID-KEY
      D    DISPLAY '   EVAL1:2:BD-RET-CODE: ' BD-RET-CODE
             MOVE BD-RET-CODE           TO WA-RETURN-CODE-MSG
             MOVE 'BD RC INVALID KEY '   TO WA-RETURN-CODE-RSN
             PERFORM 0500-PROCESS-ERROR
      *      ADD  1           TO CT-DB2-INV-KEY OF WS-COUNTERS
      ***

EVAL1      WHEN BD-RET-CODE-REC-NOT-FOUND
      D    DISPLAY '   EVAL1:2:BD-RET-CODE: ' BD-RET-CODE
             MOVE BD-RET-CODE           TO WA-RETURN-CODE-MSG
             MOVE 'BD RC REC NOT FOUND ' TO WA-RETURN-CODE-RSN
             PERFORM 0500-PROCESS-ERROR
      *      ADD  1           TO CT-DB2-NOT-FND OF WS-COUNTERS
      ***

EVAL1      WHEN OTHER
      D    DISPLAY '   EVAL2:4:BD-RET-CODE: ' BD-RET-CODE
             MOVE BD-RET-CODE           TO WA-RETURN-CODE-MSG
             MOVE 'BAD BD RETURN CODE  ' TO WA-RETURN-CODE-RSN
             PERFORM 0500-PROCESS-ERROR
      ***

EVAL1      END-EVALUATE
      D    DISPLAY '   EVAL2:END:BD-RET-CODE: ' BD-RET-CODE

           .
337600************************
337700**450-OPEN-DPP-CURSOR.
337800************************
337900*    DISPLAY '0450-OPEN-DPP-CURSOR.'
338000*    MOVE '0450-OPEN-DPP-CURSOR.' TO WA-ERROR-PRM
338100*
      *    EXEC SQL
      *      OPEN DPPCURSOR
      *    END-EXEC
283400**               OPEN OUTPUT PFR
324200*    .
324300
337600************************
337700 0460-READ-VRM-DPP.
337800************************
337900D    DISPLAY '0460-READ-VRM-DPP.'
338000     MOVE '0460-READ-VRM-DPP.' TO WA-ERROR-PRM
338100
           SET  BD-FUNCTION-READ   TO TRUE
           MOVE ZEROS              TO BD-RET-CODE
           MOVE SPACES             TO BD-VR-MASTER

      D    DISPLAY 'BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.
           CALL    C-BATCH-DRIVER
             USING
               BY REFERENCE
                  BD-FUNCTION,
                  BD-RET-CODE,
                  BD-FILE-CODE,
                  BD-VR-MASTER
               ON EXCEPTION
                  MOVE 9    TO BD-RET-CODE
           END-CALL

      D    DISPLAY 'BD-RET-CODE: ' BD-RET-CODE
      D                ' BD-FILE-CODE: ' BD-FILE-CODE
      D                ' BD-KEY: ' BD-KEY
LDS        IF BD-RET-CODE-GOOD
LDS          MOVE BD-VRM-REC     TO EA-EXPLOSION-AREA
             IF EA-TV-DPP
DPPFIX*        ADD 1 TO CTR-DPP

269200         MOVE 'N'    TO SW-ERROR
269300                        TLP-EXEMPT-FLAG
269300                        SW-MAIL-ADDRESS
269400                        SW-ERR-COUNTED
269500                        SW-BYPASS-REC
scanln                        PO-FLAG-REF-PLATE
scanln                        PO-FLAG-MEDAL
269800                        SW-VET-OWN-RETENTN-FEE
POWE36*                       SW-SUBRECORD-E36
NONCOM                        SW-SUBRECORD-E49
LIVERY                        SW-SUBRECORD-E44-L
269900         MOVE SPACE  TO PNO-STATUS-INDICATOR
270000         SET IDX-BYP TO 1
               MOVE EA-TL  TO WA-TL
               SET EXT-RID-8516       TO TRUE
DPPFIX         MOVE EA-TL           TO CR-TYPE-LIC
DPPFIX         MOVE EA-LICENSE-NUM  TO POTEXT-LICENSE-PFN
DPPFIX         MOVE EA-TL           TO POTEXT-LIC-TYP-CD
DPPFIX         MOVE EA-EXP-YR       TO POTEXT-REG-EXPR-DT(3:2)
DPPFIX         MOVE EA-EXP-MO       TO POTEXT-REG-EXPR-DT(6:2)
DPPFIX         MOVE EA-EXP-DA       TO POTEXT-REG-EXPR-DT(9:2)
DPPFIX         MOVE EA-RONM3        TO POTEXT-REC-TYP-CD
ray634***
ray634*** DPP: only for curr yr + TL=N1 N3 skip N2
ray634         IF  EA-EXP-YR = WA-RPT-YR
ray634*            IF  TL-TYPE-LICENSE =  'N1'
ray634*             or TL-TYPE-LICENSE =  'N3'
DPPFIX             IF  WA-TL           =  'N1'
DPPFIX              OR WA-TL           =  'N3'
DPPFIX                  PERFORM 0425-RETRIEVE-TYPE-LIC
DPPFIX                  ADD 1 TO CTR-DPP
                        PERFORM 1030-PROCESS-PFR THRU 1099-EXIT
131300                  IF  SW-BYPASS-REC = 'Y'
131400                   OR ERROR-IS-COUNTED
131600                   OR SW-ERROR = 'Y'
                             ADD 1 TO CTR-ERR-BYP
131300                       MOVE 'N' TO SW-BYPASS-REC
131300                       MOVE 'N' TO SW-ERR-COUNTED
131600                       MOVE 'N' TO SW-ERROR
                        END-IF
ray634             END-IF
ray634         END-IF
             END-IF
RAY634***            end DPP processing
           ELSE
             IF  BD-RET-CODE NOT = '0610'
               MOVE BD-RET-CODE          TO WA-RETURN-CODE-MSG
               MOVE 'BAD BD RET-CODE '   TO WA-RETURN-CODE-RSN
               PERFORM 0500-PROCESS-ERROR
               DISPLAY 'BD-RET-CODE: ' BD-RET-CODE
                       ' BD-FILE-CODE: ' BD-FILE-CODE
                       ' BD-KEY: ' BD-KEY
             END-IF
           END-IF

LDS        .
324300
      *START DELETE FOR LDS CHANGE
337600************************
337700*0470-CLOSE-DPP-CURSOR.
337800************************
337900*D   DISPLAY '0470-CLOSE-DPP-CURSOR.'
338000*    MOVE '0470-CLOSE-DPP-CURSOR.' TO WA-ERROR-PRM
338100*
      *    EXEC SQL
      *      CLOSE DPPCURSOR
      *    END-EXEC
      *    IF SQLCODE = 0
      *      CONTINUE
      *    ELSE
523100*      MOVE  SQLCODE               TO WA-RETURN-CODE-MSG
523400*      MOVE 'SQLCODE NOT 0 '       TO WA-RETURN-CODE-RSN
      *      PERFORM 0500-PROCESS-ERROR
      *    END-IF
324200*    .
      *
      *END DELETE FOR LDS CHANGE

265500****************************
       0480-DB2-DISCONNECT.
265700****************************
265700D    DISPLAY '0480-DB2-DISCONNECT.'
265700     MOVE    '0480-DB2-DISCONNECT.' TO WA-ERROR-PRM


           MOVE ZEROS            TO BD-RET-CODE
           SET BD-FUNCTION-CLOSE TO TRUE

      D    DISPLAY ' BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.
           CALL C-BATCH-DRIVER
             USING BY REFERENCE
               BD-FUNCTION,
               BD-RET-CODE
             ON EXCEPTION
               MOVE 9 TO BD-RET-CODE
           END-CALL
      D    DISPLAY ' BD-CALL-PARAMETERS: ' BD-CALL-PARAMETERS.

IF01       IF  NOT BD-RET-CODE-GOOD
      D    DISPLAY ' IF01:YES:BD-RET-CODE: ' BD-RET-CODE
      ***
      *** DISPLAY DB2 ERROR
      ***
               MOVE BD-RET-CODE          TO WA-RETURN-CODE-MSG
               MOVE 'BAD BD RET-CODE '   TO WA-RETURN-CODE-RSN
               PERFORM 0500-PROCESS-ERROR
IF01       END-IF
      D    DISPLAY ' IF01:END:BD-RET-CODE: ' BD-RET-CODE

           .

344900
520000****************************
520100 0900-PROCESS-ABEND.
520200****************************
337900     DISPLAY '0900-PROCESS-ABEND.'
338100
           PERFORM 0480-DB2-DISCONNECT
339400     PERFORM 0500-PROCESS-ERROR
344600     SET EOF-OEXTRACT TO TRUE
           .
268800/
268900*************************
269000 1000-PROCESS-MSTR.
269100*************************
265700D    DISPLAY '1000-PROCESS-MSTR.'.
265700     MOVE    '1000-PROCESS-MSTR.' TO WA-ERROR-PRM.

269200     MOVE 'N'    TO SW-ERROR
269300                    SW-MAIL-ADDRESS
269400                    SW-ERR-COUNTED
269500                    SW-BYPASS-REC.
scanln     MOVE 'N'    TO PO-FLAG-REF-PLATE
scanln                    PO-FLAG-MEDAL
269800     MOVE 'N'    TO SW-VET-OWN-RETENTN-FEE
POWE36*                   SW-SUBRECORD-E36
NONCOM                    SW-SUBRECORD-E49
LIVERY                    SW-SUBRECORD-E44-L.
269900     MOVE SPACE  TO PNO-STATUS-INDICATOR.
270000     SET IDX-BYP TO 1.
270100******************************************************
270200*  ARG-C01F-EXPIRATION-DATE IS INITIALIZED TO ZEROS
270300*  BECAUSE SOME RECORDS ARE BYPASSED PRIOR TO CALLING
270400*  CALLING ORF182 AND THE BYPASS DOES A DATE COMPARISON
270500*  THAT COUNTS THOSE RECORDS AS EXPIRED.
270600******************************************************
270700     MOVE ZEROS TO ARG-C01F-EXPIRATION-DATE.
272300     IF NOT TYPE-RECORD-0-OR-5
272100
272300     IF NOT TYPE-RECORD-0-OR-5
272300        IF TYPE-RECORD-7
272400            PERFORM 4200-BYPASS-COUNTING
272500            ADD 1 TO CTR-BYP-TYP7 (IDX-BYP)
272600            GO TO 1099-EXIT
272700        ELSE
272800            MOVE 'NOT REC TYPE 0 OR 5' TO WA-ERROR-MSG
272900            PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
273000            PERFORM 4300-COUNT-ERRORS
273100            GO TO 1099-EXIT
273300        END-IF
273300     END-IF.
273400************************************
273500*   SET UP FOR EXPLOSION LINKAGE   *
273600************************************
273700     MOVE EXT-PLATE-LIC-NBR TO CR-RECORD-KEY.
273800     COMPUTE CR-COMPRESSED-LTH = EXT-COMPRESSED-LTH-IN - 11.
273900     MOVE EXT-MASTER-RECORD-IN TO CR-COMPRESSED-MASTER.
274000************************************
274100*   RETRIEVE TL INFO               *
274200************************************
274300     SET IDX-TL TO 1.
274400     SEARCH ALL TYPE-LIC-TBL-REC
274500         AT END
274600              PERFORM 4010-INVALID-TL
274700              GO TO 1099-EXIT
274800         WHEN TL-TYPE-LIC (IDX-TL) = CR-TYPE-LIC
274900            MOVE TYPE-LIC-TBL-REC (IDX-TL)
275000                 TO TYPE-LIC-TBL-DETAIL
275100     END-SEARCH.
275200     IF TL-POTS-TYPE
275300         CONTINUE
275400     ELSE
275500         PERFORM 4010-INVALID-TL
275600         GO TO 1099-EXIT
275700     END-IF.
RB0714
RB0714***      obsolete Type License on Master
RB0714     if  TL-TBL-Det-TL-Obsolete
RB0714         move  TL-TYPE-License   to  WA-Error-MSG2-TLC
RB0714         PERFORM  4012-Obsolete-Type-License-Mas
RB0714         GO TO    1099-EXIT
RB0714     End-If
RB0714     .
RB0714
275800
RE2511***** Do not exclude OHV or Vesseles
RE2511*****IF  TL-OHV OR TL-VESSEL OR TL-DPP OR TL-PRORATE-ID
RE2511     IF   TL-DPP  OR  TL-PRORATE-ID
RE2511       OR TL-SPEC-EQUIP
276100         MOVE 'N' TO TLP-CONSOLIDATED-FLAG
276200     ELSE
276300         MOVE 'Y' TO TLP-CONSOLIDATED-FLAG.
276400
276500     IF  TL-OHV OR TL-VESSEL OR TL-DPP OR TL-PRORATE-ID
276600         MOVE 'N' TO TLP-CITATIONS-FLAG
276700     ELSE
276800         MOVE 'Y' TO TLP-CITATIONS-FLAG.
276900
277000     IF  TL-ANNUAL-EXEMPT OR TL-PRORATE-ID
277100         MOVE 'Y' TO TLP-EXEMPT-FLAG
277200     ELSE
277300         IF DV-SPECIAL-PLT
277400            MOVE 'Y' TO TLP-EXEMPT-FLAG
277500         ELSE
277600            MOVE 'N' TO TLP-EXEMPT-FLAG
277700         END-IF
277800     END-IF.
277900
278000*
278100***************************************************************
278200*   BYPASS NON-POTS TYPE LICENSES BEFORE EXPLODING THE RECORD *
278300***************************************************************
278400     IF CR-TYPE-LIC = 'N2'
278500         PERFORM 4200-BYPASS-COUNTING
278600         ADD 1 TO CTR-BYP-TLN (IDX-BYP)
278700         GO TO 1099-EXIT.
278800     IF  CR-IRP-TYPE-LIC AND NOT EXT-RID-8516
278900         PERFORM 4200-BYPASS-COUNTING
279000         ADD 1 TO CTR-BYP-IRP (IDX-BYP)
279100         GO TO 1099-EXIT.
279200* THE FOLLOWING BYPASS ADDED (1998) FOR COMPETITION ONLY
279300* MOTORCYCLES.
NONCOM*    IF CR-TYPE-LIC = '2T'
279500*        PERFORM 4200-BYPASS-COUNTING
279600*        ADD 1 TO CTR-BYP-COMPMC(IDX-BYP)
279700*        GO TO 1099-EXIT.
279800     EVALUATE TL-FILE-CODE
279900         WHEN  'A'  MOVE '1' TO OF6012-FILE-ID-2
280000         WHEN  'C'  MOVE '4' TO OF6012-FILE-ID-2
280100         WHEN  'T'  MOVE '2' TO OF6012-FILE-ID-2
280200         WHEN  'M'  MOVE '3' TO OF6012-FILE-ID-2
280300         WHEN  'L'  MOVE '1' TO OF6012-FILE-ID-2
280400         WHEN  'E'  MOVE '8' TO OF6012-FILE-ID-2
280500         WHEN  'H'  MOVE '5' TO OF6012-FILE-ID-2
280600         WHEN  'P'  MOVE '6' TO OF6012-FILE-ID-2
IRPTRL         WHEN  'I'  MOVE '7' TO OF6012-FILE-ID-2
280700         WHEN  'S'  MOVE 'A' TO OF6012-FILE-ID-2
280800         WHEN  'B'  MOVE 'C' TO OF6012-FILE-ID-2
280900         WHEN  'F'  MOVE 'D' TO OF6012-FILE-ID-2
281000         WHEN OTHER MOVE '0' TO OF6012-FILE-ID-2
281100     END-EVALUATE.
281200
281300/********************
281400 1010-CALL-OF6012.
281500*********************
265700D    DISPLAY '1010-CALL-OF6012.'.
265700     MOVE    '1010-CALL-OF6012.' TO WA-ERROR-PRM.

281600     MOVE ZERO TO OF6012-RETURN-CODE.
281700     CALL 'OF601C' USING OF6012-COBOL-LINKAGE
281800                         CR-COMPRESSED-RECORD
281900                         EA-EXPLOSION-AREA
282000                         OF6012-COMPRESSED-REC-LTH
282100                         OF6012-DOLLAR-SIGN
282200                         OF6012-RETURN-CODE.
282300     IF OF6012-BAD-EXPLOSION
282400         MOVE 'BAD EXPLOSION' TO WA-ERROR-MSG
282500         PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
282600         PERFORM 4300-COUNT-ERRORS
282700         GO TO 1099-EXIT.
282800*********************
282900 1030-PROCESS-PFR.
283000*********************
265700D    DISPLAY '1030-PROCESS-PFR.'.
265700     MOVE    '1030-PROCESS-PFR.' TO WA-ERROR-PRM.

PFRFix     IF POTEXT-SORT-PFR
RW3557*       IF EA-ACCT-NBR Numeric
RW3557        IF EA-PFR-MSTR
283300           IF SW-PFR = 'N'
283400                OPEN OUTPUT PFR
283500                MOVE 'Y' TO SW-PFR
283600           END-IF
KIOSK            MOVE EA-ACCT-NBR       TO PO-ACCT-CODE
KIOSK            MOVE EA-EQUIP-NBR      TO PO-EQUIP-NBR
284500           MOVE EA-EXPLOSION-AREA TO PFR-MSTR-REC
284700           MOVE PFR-RECORD        TO PFR-OUT
284800           WRITE   PFR-OUT
284900           ADD     1 TO CTR-PFR
285000           GO TO 1099-EXIT
PFRFIX
PFRFix        ELSE
PFRFix           PERFORM 4200-BYPASS-COUNTING
PFRFix           ADD 1 TO CTR-BYP-PFR (IDX-BYP)
PFRFix
PFRFix               MOVE CTR-BYP-PFR (IDX-BYP) TO BYP-DET-NBR-CUR
PFRFix               display 'RP0326-No Longer PFR: '
PFRFix                       ' LIC#= '
PFRFix                       POTEXT-LICENSE-PFN
PFRFix                       ' VRS Acct= '
PFRFix                       POTEXT-IRP-PFR-ACCT-NBR
PFRFix                       ' Master Acct= '
PFRFix                       EA-ACCT-NBR
PFRFix                       '  COUNT= '
PFRFix                        CTR-BYP-PFR (IDX-BYP)
PFRFix                       ' ' BYP-DET-NBR-CUR
PFRFix                       ' ++++ '
PFRFix           GO TO 1099-EXIT
PFRFix        END-IF
285800     END-IF
PFRFix     .

VRMDCK*1030-PROCESS-PFR  End
VRMDCK*************************
VRMDCK 1031-VRMASTER-EXP-DATE-CHECK.
VRMDCK*-----------------------------
VRMDCK*** VR MASTER Expiration DATE CHECK. Bypass if VR Master
VRMDCK*** EXP date is in the future compared to VRS, i.e. just renewed
VRMDCK****************************************************************

VRMDCK     IF POTEXT-SORT-EXP   OR   POTEXT-SORT-DLQ
VRMDCK         move POTEXT-LICENSE-PFN  TO  WA-ERROR-MSG3-LICENSE
VRMDCK         mOVE POTEXT-REG-EXPR-DT  TO  WA-ERROR-MSG3-SEXPDATE
VRMDCK         mOVE EA-exp-YR           TO  WA-ERROR-MSG3-MYY
VRMDCK         mOVE EA-exp-mo           TO  WA-ERROR-MSG3-Mmm
VRMDCK         mOVE EA-exp-da           TO  WA-ERROR-MSG3-Mdd
VRMDCK
VRMDCK         IF WA-ERROR-MSG3-MYY > WA-ERROR-MSG3-sYY
VRMDCK            Add 1   to wa-error-msg3-counter
VRMDCK            MOVE  wa-error-msg3-counter  to wa-error-msg3-count
VRMDCK            Display       WA-error-msg3
VRMDCK            GO TO   1099-EXIT
VRMDCK         End-if
VRMDCK     End-if
VRMDCK     .
VRMDCK*1031-VRMASTER-EXP-DATE-CHECK  end
VRMDCK*---------------------------------
VRMDCK

286000**************************************************************
286100*  1/98 THE FOLLOWING CODE ADDED FOR RETRIEVAL OF
286200*  VR YEAR 2000 CENTURIES
286300**************************************************************
286400
286500     MOVE EA-TYPE-RECORD  TO ARG-C01F-TYPE-RECORD
286600     MOVE EA-REC          TO ARG-C01F-VR-RECORD
286700*    MOVE ZEROS           TO ARG-C01F-REQUEST-TYPE
286800     MOVE LOW-VALUES      TO ARG-LNK-BACK-PGM
286900     COPY C01FCALL.
287000
      ********************************************************
      ***  COPY C01FCALL  End              *******************
      ********************************************************

287100     EVALUATE ARG-C01F-RETURN-CODE
287200     WHEN ZERO
287300     WHEN 'G  '
287400       CONTINUE
287500     WHEN OTHER
287600       MOVE 'BAD ORF182 RC' TO WA-ERROR-MSG
287700       PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
287800       PERFORM 4300-COUNT-ERRORS
MWJCC2       GO TO 1099-EXIT
287900     END-EVALUATE.
288000*************************************************************
288100* NOV. 1997: THE AFP PROCESS WAS TERMINATING DUE TO FINDING *
288200* INCOMPATIBLE CODES FOR TYPE BODY, TYPE LICENSE, AND TYPE  *
288300* VEHICLE.  THE FOLLOWING LOGIC WAS ADDED TO "TRAP' THOSE   *
288400* TYPES OF ERRORS.                                          *
288500*************************************************************
288600     IF TL-SPEC-EQUIP
288700         NEXT SENTENCE
288800     ELSE
288900        IF (EA-TV-TRLR AND (NOT TL-TRLR))
289000             OR
289100          ((NOT EA-TV-TRLR) AND TL-TRLR)
289200        MOVE 'INVALID TL-TV COMBO' TO WA-ERROR-MSG
289300        PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
289400        PERFORM 4300-COUNT-ERRORS
289500        GO TO 1099-EXIT.
OHVERR
RA1108     IF TL-OHV AND
RA1108        NOT ( EA-TV-OHV OR EA-TV-OHV-ELEC )
RA1108        MOVE 'INVALID OHV TL-TV COMBO' TO WA-ERROR-MSG
OHVERR        PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
OHVERR        PERFORM 4300-COUNT-ERRORS
OHVERR        GO TO 1099-EXIT.
289600
289700     INITIALIZE PO-POTENTIAL.
289800     IF  TL-AUTO
289900         MOVE 'A' TO TLP-VEH-CL-PARAM
290000         MOVE 'C' TO PO-PAPER
290100     ELSE
290200        IF  TL-TRLR AND (NOT TL-SPEC-EQUIP)
290300            MOVE 'T' TO TLP-VEH-CL-PARAM
290400            MOVE 'C' TO PO-PAPER
290500        ELSE
290600            IF TL-COML-VEH
290700                MOVE 'C' TO TLP-VEH-CL-PARAM
290800                MOVE 'C' TO PO-PAPER
290900            ELSE
291000                IF TL-SPEC-EQUIP AND TL-FARM-EQUIP
291100                    MOVE 'E' TO TLP-VEH-CL-PARAM
291200                    MOVE 'R' TO PO-PAPER
291300                ELSE
291400                    IF TL-SPEC-EQUIP
291500                        MOVE 'S' TO TLP-VEH-CL-PARAM
291600                        MOVE 'R' TO PO-PAPER
291700                    ELSE
291800                        IF TL-PRORATE-ID AND TL-COML-VEH
291900                            MOVE 'I' TO TLP-VEH-CL-PARAM
292000                            MOVE 'C' TO PO-PAPER
292100                        ELSE
292200                          IF TL-PRORATE-ID
292300                             MOVE 'J' TO TLP-VEH-CL-PARAM
292400                             MOVE 'C' TO PO-PAPER
292500                          ELSE
292600                     IF TL-OHV
292700                         MOVE 'O' TO TLP-VEH-CL-PARAM
292800                         MOVE 'Q' TO PO-PAPER
292900                     ELSE
293000                 IF TL-VESSEL
293100                     MOVE 'V' TO TLP-VEH-CL-PARAM
293200                     MOVE 'S' TO PO-PAPER
293300                 ELSE
293400             IF TL-DPP
293500                 MOVE 'P' TO TLP-VEH-CL-PARAM
293600                 MOVE 'J' TO PO-PAPER
293700             ELSE
293800         IF TL-HISTORICAL-VEH
293900             MOVE 'H' TO TLP-VEH-CL-PARAM
294000             MOVE 'C' TO PO-PAPER
294100         ELSE
294200             MOVE TL-TYPE-VEH-CODE TO TLP-VEH-CL-PARAM
294300             MOVE 'C' TO PO-PAPER.
294400****CORRECTION FOR TL '10'
294500     IF TL-LEGIS-FEE-PD
294600         IF EA-TV-MC
294700             MOVE 'M' TO TLP-VEH-CL-PARAM
294800         ELSE
294900             IF EA-TV-COML
295000                 MOVE 'C' TO TLP-VEH-CL-PARAM
295100             ELSE
295200                 IF EA-TV-TRLR
295300                     MOVE 'T' TO TLP-VEH-CL-PARAM
295400                 ELSE
295500                     MOVE 'A' TO TLP-VEH-CL-PARAM.
295600
295700*****************************************************
295800*  CODE ADDED TO INSURE CORRECT EXPIRATION YEAR AND *
295900*  PNO RECOGNITION ON 407-INPUT, ONLY.              *
296000*  WA-YR = CURRENT YEAR WHEN THE PROCESS IS RUN.    *
296100*  WA-BATCH-YR = EXP. YEAR FOR THE REGULAR EXTRACT.*
296200*****************************************************
296300     IF 407-REC
296400         MOVE SPACE TO GTS-APPEND-DIGITS.
296500
296600/********************
296700 1020-NON-NDR-OR-PNO-TYPE.
296800*********************
265700D    DISPLAY '1020-NON-NDR-OR-PNO-TYPE.'.
265700     MOVE    '1020-NON-NDR-OR-PNO-TYPE.' TO WA-ERROR-PRM.

296900********************************************************
297000*   BYPASS VESSELS & OHV DUE IN FUTURE YEARS
297100*********************************************************
297200     IF TL-OHV OR TL-VESSEL
297300         IF ARG-C01F-EXPIRATION-CCYY > WA-YR
297400             PERFORM 4200-BYPASS-COUNTING
297500             ADD 1 TO CTR-BYP-FUTDUE  (IDX-BYP)
297600             GO TO 1099-EXIT
297700         END-IF
297800     END-IF.
PTI        IF TL-PTI
PTIPRO       IF EA-EXP-MO-JAN-FEB
PTIPRO         IF ARG-C01F-EXPIRATION-CCYY > WA-NEXT-YR
PTI                PERFORM 4200-BYPASS-COUNTING
PTI                ADD 1 TO CTR-BYP-FUTDUE  (IDX-BYP)
PTI                GO TO 1099-EXIT
PTI            END-IF
PTIPRO        ELSE
PTI            IF ARG-C01F-EXPIRATION-CCYY > WA-YR
PTI                PERFORM 4200-BYPASS-COUNTING
PTI                ADD 1 TO CTR-BYP-FUTDUE  (IDX-BYP)
PTI                GO TO 1099-EXIT
PTI            END-IF
PTIPRO       END-IF
PTI        END-IF.
297900********************************************************
298000*   BYPASS EXPIRED EXTRACTS THAT DO NOT GET NDRS OR PNOS
298100*********************************************************
298200     IF ARG-C01F-EXPIRATION-DATE  < WA-CURR-DATE-IN
298300        IF TL-VESSEL OR
298400           TL-SPEC-EQUIP  OR TL-DPP
298500             PERFORM 4200-BYPASS-COUNTING
298600             ADD 1 TO CTR-BYP-NPNO (IDX-BYP)
298700             GO TO 1099-EXIT
298800        END-IF
298900     END-IF.
299000
299100********************************************************
299200*   BYPASS DELINQUENT EXTRACTS THAT DO NOT GET NDRS
299300*   (TITLE ONLY(TL=C0-C7); TYPE REC = 5; OHV)
299400*********************************************************
299500     IF DELINQUENT-REG
PTI          IF TL-TRLR  AND NOT EA-HOUSE-TRLR-TB
PTI                 PERFORM 4200-BYPASS-COUNTING
PTI                 ADD 1 TO CTR-BYP-EXP (IDX-BYP)
PTI                 GO TO 1099-EXIT
PTI          ELSE
299600         IF TL-TITLE-TRANS
299700              PERFORM 4200-BYPASS-COUNTING
299800              ADD 1 TO CTR-BYP-TIT (IDX-BYP)
299900              GO TO 1099-EXIT
300000         ELSE
300100            IF TL-OHV
300200               PERFORM 4200-BYPASS-COUNTING
300300               ADD 1 TO CTR-BYP-EXP (IDX-BYP)
300400               GO TO 1099-EXIT
300500            ELSE
300600                IF TYPE-RECORD-5
300700                    PERFORM 4200-BYPASS-COUNTING
300800                    ADD 1 TO CTR-BYP-TYP5-NDR
300900                    GO TO 1099-EXIT
301000                END-IF
301100             END-IF
301200         END-IF
PTI          END-IF
301300     END-IF.
301400
301500* BYPASS NDRS THAT HAVE THE MMDD FOR NDRS, BUT THE OLD YY
301600
301700     IF DELINQUENT-REG
301800         IF ARG-C01F-EXPIRATION-CCYY = WA-YR
301900             CONTINUE
302000         ELSE
302100             IF CURR-MO-JAN-FEB AND
302200                  ARG-C01F-EXPIRATION-CCYY = WA-LAST-YR
302300                 CONTINUE
302400             ELSE
302500                 PERFORM 4200-BYPASS-COUNTING
302600                 ADD 1 TO CTR-BYP-EXP (IDX-BYP)
302700                 GO TO 1099-EXIT
302800             END-IF
302900         END-IF
303000     END-IF.
303100
303200*******************************************************
303300* BYPASS HOUSE TRAILERS THAT HAVE THE MMDD FOR EBNS   *
303400* BUT THE WRONG YY.  THESE DO NOT NEED TO BE TESTED   *
303500* FOR E69 PNO (PNO NOT ALLOWED).                      *
303600*******************************************************
303700     IF EA-HOUSE-TRLR-TB
303800        IF ARG-C01F-EXPIRATION-DATE  < WA-CURR-DATE-IN
303900          IF NOT DELINQUENT-REG
304000             PERFORM 4200-BYPASS-COUNTING
304100             ADD 1 TO CTR-BYP-NPNO (IDX-BYP)
304200             GO TO 1099-EXIT
304300          END-IF
304400        END-IF
304500     END-IF.
304600
304700
304800/
304900/*******************************
305000 1040-CHECK-BYPASS-CONDITIONS.
305100********************************
265700D    DISPLAY '1040-CHECK-BYPASS-CONDITIONS.'.
265700     MOVE    '1040-CHECK-BYPASS-CONDITIONS.' TO WA-ERROR-PRM.

305200*************************
305300*  BYPASS CONSULAR CORP *
305400*************************
305500     IF TL-CMOH-EXEMPT AND EXT-CC-LIC
305600         PERFORM 4200-BYPASS-COUNTING
305700         ADD 1 TO CTR-BYP-CCP (IDX-BYP)
305800         GO TO 1099-EXIT.
305900*************************
306000*  BYPASS CCHMP         *
306100*************************
306200     IF EA-BTM1-5 = 'CCHMP'
306300         PERFORM 4200-BYPASS-COUNTING
306400         ADD 1 TO CTR-BYP-CCH (IDX-BYP)
306500         GO TO 1099-EXIT.
306600*****************************
306700*  BYPASS NOTICE OF TRANSFER*
306800*****************************
306900     IF EA-NBR-J NOT = ZERO
265700        MOVE    'J SUB-RECORD.' TO WA-ERROR-PRM

307000         PERFORM 4200-BYPASS-COUNTING
307100         ADD 1 TO CTR-BYP-SBJ (IDX-BYP)
307200         GO TO 1099-EXIT.
307300*************************
307400*  BYPASS SCHOOL BUS    *
307500*************************
307600     IF EA-TB = 'Q'
307700         PERFORM 4200-BYPASS-COUNTING
307800         ADD 1 TO CTR-BYP-TBQ (IDX-BYP)
307900         GO TO 1099-EXIT.
308000
308100/**********************
308200 1050-CHECK-SUBRECORDS.
308300***********************
265700D    DISPLAY '1050-CHECK-SUBRECORDS.'.
265700     MOVE    '1050-CHECK-SUBRECORDS.' TO WA-ERROR-PRM.

308400*******************************************************
308500*  INITIALIZE FIELDS AFFECTED BY SUBRECORD PROCESSING *
308600*******************************************************
scanln     MOVE ZERO  TO PO-MA-VALUE
scanln     MOVE  'N'  TO PO-FLAG-REF-PLATE
scanln                   PO-FLAG-MEDAL
309100     MOVE  'N'  TO SW-VET-OWN-RETENTN-FEE.
309200     MOVE '00000000' TO E-MASK.
309300     MOVE ZERO TO WA-OR-FEE.
309400     MOVE ZERO  TO WA-INSPECT-EXEMPT-DATE.
309500     MOVE ZERO TO PO-CITFEE
309600                  PO-NBRCIT
309700                  PO-CITLST
309800                  PO-E46-SMOG-DATE-CCYYMMDD
309900                  PO-SMOG-ABATE-FEE
310000                  PO-E46-REC-COND-DATE-CCYYMMDD
310100                  PO-E46-REASON-CODE
310200                  PO-SITUS-CNTY-CODE
310300                  PO-LESSE-CNTY-CODE
310400                  WA-P-CNTY-CD
310500                  PO-REG-EXP-CCYY
310600                  PO-ASTERISK-YEAR-CCYY
310700                  PO-YM-CCYY
310800                  PO-YEAR-FIRST-SOLD-CCYY
310900                  PO-REG-ZIP
311000                  PO-REDUCED-VLF
311100                  PO-VLF-OFFSET-AMT
311200                  PO-LESSE-ZIP
311200********          PO-LESSE-ZIP.
CVRA                    PO-CVRA-CERT-DATE.
311300     MOVE SPACE TO WA-SITUS-CNTY-CD
311500                   PO-FLAG-GROSS-POLLUTE
311600                   PO-SMOG-ABATE-FLAG
311700                   PO-EFR-ON-FILE
311800                   PO-EFR-REQUIRED
311900                   PO-PNO-INDICATOR
312000                   PO-Z-SUSPENSE
312100                   PO-RECALL-NBR
312100*********          PO-RECALL-NBR.
CVRA                     PO-CVRA-INDICATOR
CVRA                     PO-CVRA-CERT-CODE
CVRA                     PO-CVRA-WEIGHT
PTI                      PO-PTI-INDICATOR
CTIP                     PO-CTIP-INDICATOR.
312200     MOVE '00' TO PO-FLAG-PROC
312300                 WA-FLAG-RCC33
312400     MOVE 'N' TO SW-VESSEL-TAX-DUE.
312500     MOVE LOW-VALUES TO P-LESSE.
312600     MOVE SPACE TO PO-CONFIDENTIAL-FLAG
312700     INITIALIZE WA-MAIL-ADDRESS.
KIOSK *****************************
KIOSK *    PROCESS B SUBRECORD    *
KIOSK *****************************
KIOSK      IF EA-EQUIP-NBR > SPACE
265700        MOVE    'B SUB-RECORD.' TO WA-ERROR-PRM
KIOSK         MOVE EA-EQUIP-NBR TO PO-EQUIP-NBR
KIOSK      END-IF.
KIOSK *****************************
KIOSK *    PROCESS D SUBRECORD    *
KIOSK *****************************
KIOSK      IF EA-LON > SPACE
265700        MOVE    'D SUB-RECORD.' TO WA-ERROR-PRM
KIOSK         MOVE EA-LON1 TO PO-LO-NAME1
KIOSK      END-IF
KIOSK      IF (EA-LO2 > SPACE) AND (EA-LO-NA-1 = '1')
KIOSK         MOVE EA-LON2 TO PO-LO-NAME2
KIOSK      END-IF
KIOSK      IF (EA-LO3 > SPACE) AND (EA-LO-NA-2 = '1')
KIOSK         MOVE EA-LON3 TO PO-LO-NAME3
KIOSK      END-IF.
312800*****************************
312900*    PROCESS E SUBRECORDS   *
313000*****************************
313100     IF EA-NBR-E NOT = ZERO
265700        MOVE    'E SUB-RECORD.' TO WA-ERROR-PRM
313200         SET IDX-E TO 1
313300         PERFORM 2000-CHECK-CONDITION-CODES THRU 2099-RETURN
313400             UNTIL IDX-E > EA-NBR-E
313500                     OR SW-BYPASS-REC = 'Y'
313600             IF SW-BYPASS-REC = 'Y'
313700                 GO TO 1099-EXIT.
POWPRD*
POWE36*    IF (POW-PREFIX AND LICENSE-BYTES4-7 NUMERIC)
POWE36*        IF SUBRECORD-E36-FOUND
POWE36*           CONTINUE
POWE36*        ELSE
POWE36*           PERFORM 4065-MISSING-POW-SUBRECORD
MWJCC2*           GO TO 1099-EXIT
POWE36*    END-IF.
POWE36*
NONCOM**************************************************
NONCOM*    CHECK FOR NON-COM E-49 AND REASON-12        *
NONCOM**************************************************
NONCOM     IF EA-TL-NON-COMP
NONCOM        IF SUBRECORD-E49-FOUND AND REASON-12-FOUND
NONCOM           CONTINUE
NONCOM        ELSE
NONCOM           PERFORM 4045-NO-E49
NONCOM        END-IF
NONCOM     ELSE
NONCOM        IF SUBRECORD-E49-FOUND AND REASON-12-FOUND
NONCOM           PERFORM 4047-TL-RCC-ERROR
NONCOM        END-IF
NONCOM     END-IF.
NONCOM
RB1616**************************************************
RB1616*    ERROR OUT IF TL IS NOT F2 F5 F8 2X AND 2Y   *
RB1616*    WHEN BTM IS RO                              *
RB1616**************************************************
RB1616     IF EA-BTM-ROV
RB1616        IF EA-TL-VAL-RO
RB1616           CONTINUE
RB1616        ELSE
RB1616           PERFORM 4068-TL-INVALID-RO-BTM
RB1616        END-IF
RB1616     END-IF.
RB1616
LIVERY**************************************************
      *    ERROR OUT IF TYPE LICENSE IS 1W OR 1X AND   *
      *    BTM IS NOT LM AND ERROR OUT IF TYPE LICENSE *
      *    IS A0 OR A6 AND THE SPECIAL PLATE TYPE CODE *
      *    IN E44 IS L AND THE BTM IS NOT LM           *
      **************************************************
           IF EA-TL-LIMO AND NOT EA-BTM-LIMO
               PERFORM 4067-BTM-INVALID-LIVERY
           END-IF
           IF EA-TL-CVRA-LIMO AND SUBRECORD-E44-L-FOUND
              AND NOT EA-BTM-LIMO
               PERFORM 4067-BTM-INVALID-LIVERY
           END-IF.

313800**************************************************
313900*    ELIMINATE EXPIRED VEHICLES WITH NO PNO      *
314000**************************************************
314100     IF ARG-C01F-EXPIRATION-DATE  < WA-CURR-DATE-IN
314200        IF NOT DELINQUENT-REG
314300             IF NO-E69
314400                PERFORM 4200-BYPASS-COUNTING
314500                ADD 1 TO CTR-BYP-EXP (IDX-BYP)
314600                GO TO 1099-EXIT.
NDRPRO**************************************************
NDRPRO*    BYPASS ALL EXPIRED VEHICLES WITH NO-E69     *
NDRPRO*    WITH EXPIRATION-DATE BEFORE 1/29/2004       *
NDRPRO**************************************************
NDRPRO     IF WA-CURR-DATE-IN < 20040301
NDRPRO        IF ARG-C01F-EXPIRATION-DATE < 20040129
NDRPRO            IF NO-E69
NDRPRO               PERFORM 4200-BYPASS-COUNTING
NDRPRO               ADD 1 TO CTR-BYP-EXP (IDX-BYP)
NDRPRO               GO TO 1099-EXIT
NDRPRO            END-IF
NDRPRO        END-IF
NDRPRO     END-IF.
314700**************************************************
314800*    CORRECT PRIOR HISTORY FOR REMANUFACTURED    *
314900**************************************************
315000     IF EA-TV-REMAN
315100         IF PO-PRIOR-HST = SPACE
315200             MOVE '8' TO PO-PRIOR-HST
315300         END-IF
315400     END-IF.
315500/
315600*************************************
315700*    PROCESS SUBRECORD G (CITATIONS)*
315800*************************************
315900     IF EA-NBR-G > ZERO
265700        MOVE    'G SUB-RECORD.' TO WA-ERROR-PRM
316000         IF TLP-CITATIONS-NA OR TL-SPEC-EQUIP
316100             NEXT SENTENCE
316200         ELSE
316300             PERFORM 2100-PROCESS-CITS.
316400
316500*****************************
316600*    PROCESS SUBRECORD K    *
316700*****************************
316800     IF EA-HOUSE-TRLR-TB OR TL-VESSEL
316900         IF EA-NBR-K > ZERO
265700           MOVE    'K SUB-RECORD.' TO WA-ERROR-PRM
317000             PERFORM 2200-PROCESS-SITUS
317100         ELSE
317200            IF TL-VESSEL
317300               IF EA-REG-CO = '60'
317400                  PERFORM 4200-BYPASS-COUNTING
317500                  ADD 1 TO CTR-BYP-VSL (IDX-BYP)
317600                  GO TO 1099-EXIT
317700               ELSE
317800                  MOVE L-SITUS-SAME-AS TO PO-SITUS-ADDR
317900            ELSE
318000               MOVE L-SITUS-SAME-AS TO PO-SITUS-ADDR.
318100
318200     IF SW-BYPASS-REC = 'Y'
318300         GO TO 1099-EXIT.
318400
318500*****************************
318600*    PROCESS SUBRECORD P    *
318700*****************************
318800     IF EA-NBR-P > ZERO
265700        MOVE    'P SUB-RECORD.' TO WA-ERROR-PRM
318900         IF WA-SITUS-CNTY-CD = SPACE
319000             PERFORM 2300-PROCESS-P-SUBREC.
319100
319200*****************************
319300*    PROCESS SUBRECORD W    *
319400*****************************
319500*  CHECKING THE W SUBRECORD IS FOR BACK BILLING OF SMOG
319600*  ABATEMENT FEES THAT SHOULD HAVE BEEN BILLED IN 1998.
319700*  THIS CODE MAY BE DELETED AFTER THE 1999 BILLING CYCLE
319800*  IS COMPLETE.
319900*
320000     IF ((EA-NBR-W > ZERO) AND (PO-SMOG-ABATE-FLAG = ' '))
265700        MOVE    'W SUB-RECORD.' TO WA-ERROR-PRM
320100           PERFORM 2400-PROCESS-W-SUBREC
320200     END-IF.
320300
320400/**********************
320500 1060-FORMAT-POTENTIAL.
320600***********************
320700
320800     IF EA-HOUSE-TRLR-TB
320900         IF TL-TRLR AND TL-NO-WGT-FEE
321000             MOVE 'H' TO PO-PAPER
321100         ELSE
321200             PERFORM 4080-INVALID-TYPE-BODY
MWJCC2             GO TO 1099-EXIT
321300         END-IF
321400     ELSE
321500         IF EA-BTM1-5 = 'CCHPT'
321600             PERFORM 4080-INVALID-TYPE-BODY
MWJCC2             GO TO 1099-EXIT
321700         END-IF
321800     END-IF
321900
322000***  CHANGE PAPER-CODES FOR CITATIONS DUE  AND GOLDENROD
322100     IF TL-GOLDENROD
322200         IF PO-PAPER = 'C'
322300             MOVE 'F' TO PO-PAPER
322400         ELSE
322500             IF PO-PAPER = 'H'
322600                 MOVE 'G' TO PO-PAPER.
322700
322800     IF PO-NBRCIT = ZERO
322900         NEXT SENTENCE
323000     ELSE
323100         EVALUATE PO-PAPER
323200             WHEN  'C'
323300                MOVE 'U' TO PO-PAPER
323400             WHEN  'F'
323500                MOVE 'V' TO PO-PAPER
323600             WHEN  'H'
323700                MOVE 'W' TO PO-PAPER
323800             WHEN  'G'
323900                MOVE 'Y' TO PO-PAPER
324000          END-EVALUATE
324100     END-IF.
324200
324300     PERFORM 2500-VALIDATE-AND-MOVE-OP THRU 2899-EXIT.
324400     IF SW-ERROR = 'Y' OR SW-BYPASS-REC = 'Y'
324500         GO TO 1099-EXIT.
324600
324700     PERFORM 2900-RATING THRU 2999-EXIT.
324800     IF SW-ERROR = 'Y'
324900         GO TO 1099-EXIT.
325000
325100/***************
325200 1080-WRAP-UP.
325300****************
265700D    DISPLAY '1080-WRAP-UP. ' EXT-RID.
265700     MOVE    '1080-WRAP-UP.' TO WA-ERROR-PRM.

325400     IF PO-VLF-EXMPT = ZERO
325500         MOVE SPACE TO PO-VLF-EXMPT-ALPHA.
325600
325700     IF EXT-RID-8515
325800         ADD 1 TO CTR-STAT-8515
               IF EXT-RC8271
                   ADD 1 TO CTR-STAT-R66
               ELSE
                   ADD 1 TO CTR-STAT-R66
               END-IF
325900     ELSE
326000         IF DMVA-REC
326100             ADD 1 TO CTR-STAT-8519
326200         ELSE
326300             IF EXT-RID-4401
326400                 ADD 1 TO CTR-STAT-4401
326500             ELSE
326600                 IF EXT-RID-4405
326700                     ADD 1 TO CTR-STAT-4405
326800                 ELSE
326900                     IF DELINQUENT-REG
327000                         SET IDX-NDR TO 1
327100                         MOVE 'N' TO SW-QUIT
327200                         PERFORM 3071-COUNT-BY-DATE
327300                                  UNTIL SW-QUIT = 'Y'
327400                                        OR IDX-NDR > 15
327500                     ELSE
327600                         SET IDX-WRK TO 1
327700                         MOVE 'N' TO SW-QUIT
327800                         PERFORM 3070-COUNT-BY-DATE
327900                                  UNTIL SW-QUIT = 'Y'
                                              OR IDX-WRK > 40
                               IF IDX-WRK > 40
328200                             ADD 1 TO CTR-OTHER-DATES.
328300     SET IDX-CNT TO 1.
328400     SEARCH ACTUAL-COUNTS-R
328500         WHEN ACT-PAPER (IDX-CNT) = PO-PAPER
328600         PERFORM
328700             IF ARG-C01F-EXPIRATION-DATE  < WA-CURR-DATE-IN
328800                 SET IDX-CNT UP BY 1
328900             END-IF
329000             ADD 1 TO ACT-CNT (IDX-CNT)
329100         END-PERFORM
329200     END-SEARCH.
329300************************************
329400*  SET UP SPECIAL PROCESSING CODES *
329500************************************
329600********************
329700* PO-PNO-INDICATOR *
329800********************
329900     MOVE PNO-STATUS-INDICATOR TO PO-PNO-INDICATOR.
330000********************
330100* PO-NOTICE-TYPE   *
330200********************
330300* NOTICE-TYPE VALUES:  POT = 1,2,4; NDR = 3,5; PNOINV = 6,7,8
330400     EVALUATE EXT-RID
330500         WHEN '4401'
330600             IF PO-PNO-INDICATOR = 'P'
330700                 MOVE 8 TO PO-NOTICE-TYPE
330800             ELSE
330900                 MOVE 4 TO PO-NOTICE-TYPE
331000             END-IF
331100**           DATA-ENTRY REQUESTED EXTRACT REC
331200         WHEN '4405'
331300             MOVE 5 TO PO-NOTICE-TYPE
331400**           DATA-ENTRY REQUESTED DELQ REC
331500         WHEN '8515'
331600             IF PO-PNO-INDICATOR = 'P'
331700                 MOVE 7 TO PO-NOTICE-TYPE
331800             ELSE
331900                 MOVE 2 TO PO-NOTICE-TYPE
332000             END-IF
332100**           ADDRESS CHANGE EXTRACT REC
332200         WHEN '8516'
332300             IF PO-PNO-INDICATOR = 'P'
332400                 MOVE 6 TO PO-NOTICE-TYPE
332500             ELSE
332600                 MOVE 1 TO PO-NOTICE-TYPE
332700             END-IF
332800**           REGULAR WEEKLY EXTRACT REC
332900         WHEN '8519'
333000             IF PO-PNO-INDICATOR = 'P'
333100                 MOVE 7 TO PO-NOTICE-TYPE
333200             ELSE
333300                 MOVE 2 TO PO-NOTICE-TYPE
333400             END-IF
333500**           DMVA-CREATED EXTRACT REC - ADDRESS CHANGE
333600         WHEN '8520'
333700             MOVE 3 TO PO-NOTICE-TYPE
333800**           DELINQUENT EXTRACT REC
333900     END-EVALUATE
334000********************
334100* PO-FLAG-407      *
334200********************
334300     IF 407-REC
334400         IF DMVA-REC
334500            MOVE '6' TO PO-FLAG-407
334600         ELSE
334700            MOVE 'Y' TO PO-FLAG-407
334800         END-IF
334900         ADD 1 TO CTR-407
335000     ELSE
335100         MOVE SPACE TO PO-FLAG-407
335200     END-IF
335300
335400     PERFORM 8000-NCOA-ADDR-VALIDATION THRU 8009-EXIT.
335500
335600**************************************************
335700*  REMAINING SPECIAL PROCESS (CERTS) FLAG VALUES *
335800*  SET IN RP0826.                                *
335900**************************************************
336000     IF VESSEL-TAX-DUE
336100         MOVE '04' TO PO-FLAG-PROC
336200     END-IF.
336300/
336400     IF TL-GOLDENROD
336500         MOVE 'Y' TO PO-NONRES-INDIC.
336600
336700**********************************************************
336800*    CHANGE ALL GOLDENROD PAPER-TYPES AND     PARKING    *
336900*    CITATIONS PAPER-TYPES TO NEW STANDARD PAPER-TYPES   *
337000**********************************************************
337100     IF PO-NONRES-PAPER OR PO-CITS-TRLR-PAPER
337200         EVALUATE PO-PAPER
337300         WHEN     'D'
337400             MOVE 'B' TO PO-PAPER
337500         WHEN     'F'
337600             MOVE 'C' TO PO-PAPER
337700         WHEN     'P'
337800             MOVE 'N' TO PO-PAPER
337900         WHEN     'V'
338000             MOVE 'U' TO PO-PAPER
338100         WHEN     'G'
338200             MOVE 'H' TO PO-PAPER
338300         WHEN     'Y'
338400             MOVE 'H' TO PO-PAPER
338500         WHEN     'W'
338600             MOVE 'H' TO PO-PAPER
338700         END-EVALUATE.
338800**********************************************
338900*  RE-ASSIGN TRAILER TYPES TO PAPER-CODE "C" *
339000*  (AS OF 8/92)                              *
339100**********************************************
339200* LOGIC SHOULD BE ADDED WHICH HANDLES TRAILERS WITH PARKING CITS
339300     IF PO-PAPER = 'H'
339400         MOVE 'C' TO PO-PAPER.
339500*************************************
339600*  ASSIGN NEW FILE CODE FOR TYPE-5  *
339700*  AND SPECIAL PLATE PROBLEM RECS.  *
339800*************************************
339900     IF TYPE-RECORD-5 OR SW-INVALID-RCC33-07
340000             OR SW-INVALID-RCC33-08
340100         MOVE ZERO TO PO-ELP-FEE
340200     END-IF.
340300
340400**********************************************
340500*   CREATE ITT RECORD FOR "BAIL-DUE" POTS    *
340600**********************************************
340700     IF EXT-RID-8516 OR EXT-RID-8520 OR DESTROYED-BILLING
340800         IF PO-NBRCIT > ZERO
340900             PERFORM 3900-ITT-OUT THRU 3949-EXIT.
341000
341100************************
341200*   WRITE POT RECORD   *
341300************************
341400     MOVE WA-JDATE-ALL TO PO-SYS-JDATE-CCYYDDD.
KIOSK      MOVE TL-FILE-CODE TO PO-CODE-FILE.
      *
      * 09/29/99 CHANGE PAPER CODE "U" (POT WITH CITATIONS) TO "C"
      * IMMEDIATELY BEFORE WRITING POTREC. PM RBQ-1349
      * CREATION OF THE "U" WAS NOT DELETED IN OTHER PARTS OF
      * THIS PROGRAM BECAUSE CITATION COUNTERS DEPEND ON THE "U"
      *
           IF PO-PAPER = "U"
               MOVE "C" TO PO-PAPER
           END-IF.
R3366 *
R3366 * MOVE THE POTREC WRITE AFTER PNO, WE NO LONGER WILL SEND OUT
R3366 *  PNO INVITATION TO RENEW
341700     IF NOTICE-TYPE-PNO
341800         ADD 1 TO CTR-POTS-PNO
341900     ELSE
R3366          MOVE PO-POTENTIAL TO POT-OUT-1
R3366          WRITE POT-OUT-1
342000         IF DELQ-NOTICE
342100             ADD 1 TO CTR-NDR
342200         ELSE
342300             ADD 1 TO CTR-POTS-REG
R3366          END-IF
R3366      END-IF .
342400
342500 1099-EXIT.
342600     EXIT.
342700
342800/***************************
342900 2000-CHECK-CONDITION-CODES.
343000****************************
265700D    DISPLAY '2000-CHECK-CONDITION-CODES. '
265700     MOVE    '2000-CHECK-CONDITION-CODES.' TO WA-ERROR-PRM.

343100*****************************************************
343200*         THERE MAY BE MULTIPLE                     *
343300*   E SUBRECS.  IF A BYPASS OR ERROR CONDITION IS   *
343400*   FOUND, LOOP IS ENDED.                           *
343500*****************************************************
343600
343700     EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
343800
343900     WHEN      '01'               ALSO    ANY
344000         PERFORM 4200-BYPASS-COUNTING
344100         ADD 1 TO CTR-BYP-SBE01 (IDX-BYP)
344200     WHEN      '02'               ALSO    ANY
344300         PERFORM 4200-BYPASS-COUNTING
344400         ADD 1 TO CTR-BYP-SBE02 (IDX-BYP)
344500     WHEN      '03'               ALSO    ANY
344600         PERFORM 4200-BYPASS-COUNTING
344700         ADD 1 TO CTR-BYP-SBE03 (IDX-BYP)
344800     WHEN      '04'               ALSO    ANY
344900         PERFORM 4200-BYPASS-COUNTING
345000         ADD 1 TO CTR-BYP-SBE04 (IDX-BYP)
JC0900     WHEN      '05'               ALSO    '04' THRU '11'
JC0900         PERFORM 4200-BYPASS-COUNTING
JC0900         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
345100     WHEN      '05'               ALSO    '23'
345200         PERFORM 4200-BYPASS-COUNTING
345300         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
345400     WHEN      '05'               ALSO    '38' THRU '40'
345500         PERFORM 4200-BYPASS-COUNTING
345600         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
345700     WHEN      '05'               ALSO    '51' THRU '53'
345800         PERFORM 4200-BYPASS-COUNTING
345900         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
346000     WHEN      '05'               ALSO    '55' THRU '56'
346100         PERFORM 4200-BYPASS-COUNTING
346200         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
JC0900     WHEN      '05'               ALSO    '59' THRU '68'
346400         PERFORM 4200-BYPASS-COUNTING
346500         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
346600     WHEN      '05'               ALSO    '74'
346700         PERFORM 4200-BYPASS-COUNTING
346800         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
346900     WHEN      '05'               ALSO    '78'
347000         PERFORM 4200-BYPASS-COUNTING
347100         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
347200     WHEN      '05'               ALSO    '86'
347300         PERFORM 4200-BYPASS-COUNTING
347400         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
347500     WHEN      '05'               ALSO    '89' THRU '91'
347600         PERFORM 4200-BYPASS-COUNTING
347700         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
347800
RF3543***
RF3543     WHEN      '05'               ALSO    '94'
RF3543         PERFORM 4200-BYPASS-COUNTING
RF3543         ADD 1 TO CTR-BYP-VLT (IDX-BYP)
RF3543         ADD 1 TO CTR-BYP-VLTS94
PFRFIX
Rf3543         Display '**NN '
RF3543                 'VLTS94 ' CTR-BYP-VLTS94
RF3543                 ' LIC '    EA-LICENSE-NUM
RF3543                 ' EXDT '   EA-EXP-DT
RF3543                 ' VIN '    EA-VIN
RF3543                 ' ECC '    E-COND-CODE (IDX-E)
RF3543                 ' RSN '    E-RSN-CODE (IDX-E)
RF3543                 ' *** '
RF3543***
347800***
347900/*   EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
348000
348100     WHEN      '06'               ALSO    ANY
348200         PERFORM 4200-BYPASS-COUNTING
348300         ADD 1 TO CTR-BYP-DOJ (IDX-BYP)
348400     WHEN      '07'               ALSO    ANY
348500         PERFORM 4200-BYPASS-COUNTING
348600         ADD 1 TO CTR-BYP-SBE07 (IDX-BYP)
348700     WHEN      '09'               ALSO    ANY
PTI            IF TL-TRLR
PTI               IF EA-EXP-DT = 011231
PTI                  CONTINUE
PTI               END-IF
PTI            ELSE
348800            PERFORM 4200-BYPASS-COUNTING
348900            ADD 1 TO CTR-BYP-PYR (IDX-BYP)
PTI            END-IF
349000     WHEN      '11'               ALSO    ANY
349100         PERFORM 4200-BYPASS-COUNTING
349200         ADD 1 TO CTR-BYP-SBE11 (IDX-BYP)
349300     WHEN      '12'               ALSO    ANY
349400         PERFORM 4200-BYPASS-COUNTING
349500         ADD 1 TO CTR-BYP-SBE12 (IDX-BYP)
349600     WHEN      '13'               ALSO    ANY
349700         PERFORM 4200-BYPASS-COUNTING
349800         ADD 1 TO CTR-BYP-SBE13 (IDX-BYP)
349900     WHEN      '18'               ALSO    ANY
350000         PERFORM 4200-BYPASS-COUNTING
350100         ADD 1 TO CTR-BYP-SBE18 (IDX-BYP)
350200     WHEN      '20'               ALSO    ANY
350300         PERFORM 4250-CHECK-MAIL-CODES
350400         IF SW-MAIL-RETURNED = 'Y'
350500             PERFORM 4200-BYPASS-COUNTING
350600             ADD 1 TO CTR-BYP-SBE20 (IDX-BYP)
350700         ELSE
350800             CONTINUE
350900         END-IF
351000**************************
351100*  R/O "TOO LONG" INFO   *
351200**************************
351300     WHEN      '22'               ALSO    ANY
351400         MOVE 1 TO E-BIT-1
351500                   E-BIT-3
351600     WHEN      '23'               ALSO    ANY
351700         MOVE 1 TO E-BIT-1
351800                   E-BIT-4
351900     WHEN      '24'               ALSO    ANY
352000         MOVE 1 TO E-BIT-1
352100                   E-BIT-5
352200     WHEN      '25'               ALSO    ANY
352300         MOVE 1 TO E-BIT-1
352400                   E-BIT-6
352500     WHEN      '26'               ALSO    ANY
352600        IF E-UNIT-CODE(IDX-E) = '3A' OR E-UNIT-CODE(IDX-E) = '3F'
352700            PERFORM 4200-BYPASS-COUNTING
352800            ADD 1 TO CTR-BYP-REV (IDX-BYP)
352900        ELSE
353000            CONTINUE
353100        END-IF
353200
353300/*   EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
353400
353500     WHEN      '27'               ALSO    ANY
353600         PERFORM 4200-BYPASS-COUNTING
353700         ADD 1 TO CTR-BYP-SBE27 (IDX-BYP)
353800     WHEN      '28'               ALSO    ANY
353900         PERFORM 4200-BYPASS-COUNTING
354000         ADD 1 TO CTR-BYP-SBE28 (IDX-BYP)
354100     WHEN      '30'               ALSO    ANY
354200         PERFORM 4200-BYPASS-COUNTING
354300         ADD 1 TO CTR-BYP-SBE30 (IDX-BYP)
354400     WHEN      '33'               ALSO    '01' THRU '06'
354500         PERFORM 4200-BYPASS-COUNTING
354600         ADD 1 TO CTR-BYP-SBE33 (IDX-BYP)
354700     WHEN      '33'               ALSO    '07' THRU '08'
354800*        IF DELINQUENT-REG
354900             PERFORM 4200-BYPASS-COUNTING
355000             ADD 1 TO CTR-BYP-SBE33 (IDX-BYP)
355100*        ELSE
355200*            MOVE E-RSN-CODE (IDX-E) TO WA-RCC33-REASON
355300*        END-IF
355400     WHEN      '33'               ALSO    '09'
355500         PERFORM 4200-BYPASS-COUNTING
355600         ADD 1 TO CTR-BYP-SBE33 (IDX-BYP)
355700     WHEN      '34'               ALSO    ANY
355800         PERFORM 4200-BYPASS-COUNTING
355900         ADD 1 TO CTR-BYP-SBE34 (IDX-BYP)
356000
356100     WHEN      '35'               ALSO    ANY
356200         MOVE 'Y' TO  PO-CONFIDENTIAL-FLAG
356300
356400     WHEN      '36'               ALSO    ANY
356500***  SETTING SWITCH MUST PAY OWNERSHIP/RETENTION FEE ANNUALLY
356600*  PASSING 'V' TO RP1526 SO THAT A 1 IS MOVED INTO   *
356700*  THE PROCESS CODE FIELD OF THE SCANLINE            *
356800*************************************************************
POWE36*        MOVE 'Y' TO SW-SUBRECORD-E36
356900         IF ((E-RSN-CODE (IDX-E) = 01) OR
357000             (E-RSN-CODE (IDX-E) = 02))
357100            MOVE 'Y'              TO TLP-EXEMPT-FLAG
357200                                     SW-VET-OWN-RETENTN-FEE
357400            MOVE 'V'              TO PO-FLAG-SINGLE-PLATE
357500         ELSE
357600            MOVE E-VLF-EXMPT (IDX-E) TO PO-VLF-EXMPT
357700         END-IF
357800     WHEN      '37'               ALSO    ANY
357900         PERFORM 4200-BYPASS-COUNTING
358000         ADD 1 TO CTR-BYP-SBE37 (IDX-BYP)
358100     WHEN      '41'               ALSO    ANY
358200         PERFORM 4200-BYPASS-COUNTING
358300         ADD 1 TO CTR-BYP-SBE41 (IDX-BYP)
358400     WHEN      '42'               ALSO    ANY
358500         PERFORM 4200-BYPASS-COUNTING
358600         ADD 1 TO CTR-BYP-SBE42 (IDX-BYP)
358700     WHEN      '44'               ALSO    ANY
scanln         IF E-UNIT-CODE (IDX-E) = 'Y '
scanln             MOVE 'X' TO PO-FLAG-REF-PLATE
scanln         ELSE
scanln             MOVE E-UNIT-CODE (IDX-E) TO PO-FLAG-REF-PLATE
scanln         END-IF
LIVERY
LIVERY         IF (EA-TL-CVRA-LIMO AND E-UNIT-CODE (IDX-E) = 'L ')
                   MOVE 'Y' TO SW-SUBRECORD-E44-L
               END-IF
359300
359400/*   EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
359500**************************
359600*  SMOG DATE             *
359700**************************
359800*
359900* PO-E46-REASON-CODE, PO-E46-SMOG-DUE-DT, PO-E46-REASON-CODE,
360000* PO-E46-REC-COND-DATE ARE ALREADY INITIALIZED TO ZEROES IN
360100* PARAGRAPH 1050-CHECK-SUBRECORDS
360200* IF NOT MODIFIED HERE, DATES ARE ZERO-FILLED
360300*
360400     WHEN      '46'               ALSO    01
360500       MOVE E-RSN-CODE(IDX-E)   TO PO-E46-REASON-CODE
360600       IF E-COND-DATE(IDX-E) NUMERIC
360700          MOVE E-COND-DATE (IDX-E) TO PO-E46-REC-COND-DATE
360800       ELSE
360900          CONTINUE
361000       END-IF
361100     WHEN      '46'               ALSO    02
361200       MOVE E-RSN-CODE(IDX-E)   TO PO-E46-REASON-CODE
361300       IF E-COND-DATE(IDX-E) NUMERIC
361400          MOVE E-COND-DATE (IDX-E) TO PO-E46-REC-COND-DATE
361500       ELSE
361600          CONTINUE
361700       END-IF
361800     WHEN      '46'               ALSO    03
361900       MOVE E-RSN-CODE(IDX-E)   TO PO-E46-REASON-CODE
362000       IF E-COND-DATE(IDX-E) NUMERIC
362100          MOVE E-COND-DATE (IDX-E) TO PO-E46-REC-COND-DATE
362200       ELSE
362300          CONTINUE
362400       END-IF
362500       IF E-DATE-SMOG-CERT-EXP(IDX-E) NUMERIC
362600          MOVE E-DATE-SMOG-CERT-EXP(IDX-E) TO PO-E46-SMOG-DUE-DT
362700       ELSE
362800          CONTINUE
362900       END-IF
363000     WHEN      '46'               ALSO    04
363100       MOVE E-RSN-CODE(IDX-E)   TO PO-E46-REASON-CODE
363200       IF E-SMOG-TYPE (IDX-E) = 'D'
363300           MOVE 'D' TO PO-SMOG-ABATE-FLAG
363400       END-IF
363500       IF E-COND-DATE(IDX-E) NUMERIC
363600          MOVE E-COND-DATE (IDX-E) TO PO-E46-REC-COND-DATE
363700       ELSE
363800          CONTINUE
363900       END-IF
364000       IF E-SMOG-DUE-DATE(IDX-E) NUMERIC
364100          MOVE E-SMOG-DUE-DATE(IDX-E) TO PO-E46-SMOG-DUE-DT
364200       ELSE
364300          CONTINUE
364400       END-IF
364500     WHEN      '46'               ALSO    ANY
364600       IF (E-RSN-CODE(IDX-E) = ZEROES) OR
364700          (E-RSN-CODE(IDX-E) = '?')
364800          IF E-COND-DATE(IDX-E) NUMERIC
364900             MOVE E-COND-DATE (IDX-E) TO PO-E46-REC-COND-DATE
365000          ELSE
365100             CONTINUE
365200          END-IF
365300       ELSE
365400          CONTINUE
365500       END-IF
scanln     WHEN      '47'               ALSO    ANY
scanln         MOVE 'Y' TO PO-FLAG-MEDAL
365800
365900/*   EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
366000
366100**************************
366200*   OWNER RESPONSIBILITY *
366300**************************
366400     WHEN      '48'               ALSO    ANY
366500         MOVE ZERO TO WA-OR-FEE
366600         IF E-RSN-CODE(IDX-E) IS NUMERIC
366700             COMPUTE WA-OR-FEE = E-RSN-CODE (IDX-E) * 7
366800             IF SW-REASON-72 = 'Y'
366900                 MOVE 'N' TO SW-REASON-72
367000             END-IF
367100         ELSE
367200             MOVE '48' TO WA-E-CODE
367300             PERFORM 4070-INVALID-REASON-CD
367400         END-IF
367500
367500
367600     WHEN      '49'               ALSO    ANY
367700         IF E-RSN-CODE(IDX-E) IS NUMERIC
NONCOM            MOVE 'Y' TO SW-SUBRECORD-E49
RAY634***--------------------------------------------------------------
RAY634***     DISALLOW RENEWAL SUB-E RCC:49 RSN:03 (SALVAGE RETENTION)
RAY634***--------------------------------------------------------------
RAY634             IF E-RSN-CODE(IDX-E)   =      03
RAY634                  MOVE 'D'              to  PO-INT-RENEWAL-ELIG
RAY634                  ADD  1                TO  CTR-IR-DISALLOW
RAY634                  MOVE CTR-IR-DISALLOW  TO  CTR-IR-DISALLOW-PRT
RAY634                  DISPLAY 'RP0326-VRIR LIC=' EA-LICENSE-NUM
RAY634                          ' SUB-REC E RCC=' E-COND-CODE (IDX-E)
RAY634                          ' RSN='           E-RSN-CODE (IDX-E)
RAY634                          ' DISALLOW INTERNET RENEWAL.'
RAY634                          ' COUNT='         CTR-IR-DISALLOW-PRT
RAY634             else
RAY634                    MOVE space          to  PO-INT-RENEWAL-ELIG
RAY634             end-if
RAY634***
367800             IF E-RSN-CODE (IDX-E) = 10
367900                MOVE 'A' TO PO-PRIOR-HST
PRIORB             ELSE
PRIORB                IF E-RSN-CODE (IDX-E) = 11
PRIORB                  MOVE 'B' TO PO-PRIOR-HST
368000                ELSE
368100                  MOVE E-PRIOR-HST (IDX-E) TO PO-PRIOR-HST
368200                END-IF
PRIORB             END-IF
NONCOM             IF E-RSN-CODE (IDX-E) = 12
NONCOM                MOVE 'Y' TO SW-REASON-12
NONCOM             ELSE
NONCOM                MOVE 'N' TO SW-REASON-12
NONCOM             END-IF
RE3253
RE3253             IF E-RSN-CODE (IDX-E) = 14
RE3253                MOVE 'E' TO PO-PRIOR-HST
RE3253             end-if
R2882
R2882 * MOVE 'G' TO PRIOR HISTORY FOR AUTONOMOUS D VEHICLES
R2882              IF E-RSN-CODE (IDX-E) = 16
R2882                 MOVE 'G' TO PO-PRIOR-HST
R2882              END-IF
R2882
368300         ELSE
368400             MOVE '49' TO WA-E-CODE
368500             PERFORM 4070-INVALID-REASON-CD
368600         END-IF
368700
368800     WHEN      '50' THRU '54'     ALSO    ANY
368900         PERFORM 4200-BYPASS-COUNTING
369000         ADD 1 TO CTR-BYP-SBE50 (IDX-BYP)
369100
scanln     WHEN      '55'               ALSO    ANY
scanln         MOVE E-DOLLAR-VALUE (IDX-E) TO PO-MA-VALUE
369400
369500     WHEN      '58'               ALSO    ANY
369600         PERFORM 4200-BYPASS-COUNTING
369700         ADD 1 TO CTR-BYP-SBE58 (IDX-BYP)
369800     WHEN      '61'               ALSO    ANY
369900         PERFORM 4200-BYPASS-COUNTING
370000         ADD 1 TO CTR-BYP-SBE61 (IDX-BYP)
370100     WHEN      '62'               ALSO    '01' THRU '06'
370200         PERFORM 4200-BYPASS-COUNTING
370300         ADD 1 TO CTR-BYP-SBE62 (IDX-BYP)
SB1500** DELETE ITT FOR E62 CONDITION CD 7
SB1500     WHEN      '62'               ALSO    '07'
SB1500         PERFORM 3950-ITT-OUT2 THRU 3999-EXIT
370400     WHEN      '63'               ALSO    ANY
370500         PERFORM 4200-BYPASS-COUNTING
370600         ADD 1 TO CTR-BYP-SBE63 (IDX-BYP)
370700
370800**************************
370900*   MAILING ADDRESS      *
371000**************************
371100     WHEN      '64'               ALSO    ANY
JC0201         PERFORM 5300-PROCESS-MAIL-ADDR THRU 5399-EXIT
JC0201         IF E64-MAIL-ADDR-DATE   > '19940510'
371300             MOVE 'Y' TO SW-MAIL-ADDRESS
371400             MOVE  E-64-ADDL-DATA (IDX-E) TO WA-MAIL-ADDRESS
371500         END-IF
371600
371700**************************
371800*   PROPERTY TAX OWED    *
371900**************************
372000     WHEN      '68'                 ALSO    ANY
372100         IF TL-VESSEL
372200             MOVE 'Y' TO SW-VESSEL-TAX-DUE
372300         END-IF
372400
372500/*   EVALUATE E-COND-CODE (IDX-E) ALSO  E-RSN-CODE (IDX-E)
372600
372700     WHEN      '69'                 ALSO    ANY
372800         PERFORM 5500-PROCESS-PNO THRU 5599-EXIT
372900         IF CURRENT-PNO-ISSUED
373000             PERFORM 4200-BYPASS-COUNTING
373100             ADD 1 TO CTR-BYP-PNO (IDX-BYP)
373200         ELSE
373300             IF PNO-EXPIRED
373400                 PERFORM 4200-BYPASS-COUNTING
373500                 ADD 1 TO CTR-BYP-EXP (IDX-BYP)
373600             ELSE
373700                 IF PNO-STATUS-INDICATOR = 'Q'
373800                    PERFORM 4200-BYPASS-COUNTING
373900                    ADD 1 TO CTR-BYP-PNO (IDX-BYP)
374000                 ELSE
OHVITR                    IF TL-OHV
OHVITR                       IF (WA-CDI-YY-EVEN AND EA-EXP-YR-EVEN) OR
OHVITR                          (WA-CDI-YY-ODD  AND EA-EXP-YR-ODD)
OHVITR                          CONTINUE
OHVITR                       ELSE
OHVITR                          PERFORM 4200-BYPASS-COUNTING
OHVITR                          ADD 1 TO CTR-BYP-PNO(IDX-BYP)
OHVITR                       END-IF
OHVITR                    ELSE
374100                       CONTINUE
OHVITR                    END-IF
374200                 END-IF
374300             END-IF
374400         END-IF
374500     WHEN      '70'                 ALSO    ANY
374600         PERFORM 4200-BYPASS-COUNTING
374700         ADD 1 TO CTR-BYP-SBE70 (IDX-BYP)
374800     WHEN      '71'                 ALSO    ANY
374900         PERFORM 4200-BYPASS-COUNTING
375000         ADD 1 TO CTR-BYP-SBE71 (IDX-BYP)
375100     WHEN      '74'                 ALSO    ANY
375200         MOVE RECALL-NBR (IDX-E) TO PO-RECALL-NBR
375300         IF NOT TLP-CONSOLIDATED OR
375400                 EA-HOUSE-TRLR-TB
375500             PERFORM 4097-INVALID-ARB-SUBREC
375600         END-IF
375700     WHEN      '76'                 ALSO    ANY
375800         PERFORM 4200-BYPASS-COUNTING
375900         ADD 1 TO CTR-BYP-SBE76 (IDX-BYP)
376000     WHEN      '78'                 ALSO    ANY
376100         PERFORM 4200-BYPASS-COUNTING
376200         ADD 1 TO CTR-BYP-SBE78 (IDX-BYP)
376300**************************
376400*   GROSS POLLUTERS      *
376500**************************
376600     WHEN      '79'                 ALSO    ANY
376700         MOVE 'G' TO PO-FLAG-GROSS-POLLUTE
376900     WHEN      '80'                 ALSO    '01'
377000         MOVE '1' TO PO-FLAG-GROSS-POLLUTE
377200     WHEN      '80'                 ALSO    '02'
377300         MOVE '2' TO PO-FLAG-GROSS-POLLUTE
377500     WHEN      '80'                 ALSO    '03'
377600         MOVE '3' TO PO-FLAG-GROSS-POLLUTE
377800     WHEN      '81'                 ALSO    ANY
377900         PERFORM 4200-BYPASS-COUNTING
378000         ADD 1 TO CTR-BYP-SBE81 (IDX-BYP)
SB1500**************************
SB1500*   INSURANCE SB1500     *
SB1500**************************
SB1500     WHEN      '83'                 ALSO    ANY
SB1500         MOVE 'S' TO PO-EFR-REQUIRED
RAR709     WHEN      '85'                 ALSO    '02'
RAR709         MOVE 'Y' TO PO-E85-REASON-CODE
SB1500     END-EVALUATE.
378200
378300 2099-RETURN.
378400     SET IDX-E UP BY 1.
378500
378600/**********************
378700 2100-PROCESS-CITS.
378800***********************
265700D    DISPLAY '2100-PROCESS-CITS.'.
265700     MOVE    '2100-PROCESS-CITS.' TO WA-ERROR-PRM.

378900     COMPUTE G-FIRST = 687 + EA-NBR-E * 104 + EA-NBR-F * 19 .
379000     COMPUTE G-LENGTH = EA-NBR-G * 62 .
379100     SET IDX-EA TO G-FIRST
379200     SET IDX-G TO 1
379300     PERFORM 2130-MOVE-G-SUBRECS G-LENGTH TIMES.
379400
379500     SET IDX-PO TO 1.
379600     SET IDX-G-R TO 1.
379700
379800     IF EXT-RID-8516 OR EXT-RID-8520 OR DESTROYED-BILLING
379900         PERFORM 2150-MAIN-EXTRACT-CIT
380000                  UNTIL IDX-G-R > EA-NBR-G
380100     ELSE
380200         PERFORM 2170-OTHER-EXTRACT-CIT
380300                  UNTIL IDX-G-R > EA-NBR-G.
380400
380500 2130-MOVE-G-SUBRECS.
265700D    DISPLAY '2130-MOVE-G-SUBRECS.'.
265700     MOVE    '2130-MOVE-G-SUBRECS.' TO WA-ERROR-PRM.

380600     MOVE EA-BYTE (IDX-EA) TO G-BYTE (IDX-G).
380700     SET IDX-EA UP BY 1.
380800     SET IDX-G UP BY 1.
380900
381000 2150-MAIN-EXTRACT-CIT.
265700D    DISPLAY '2150-MAIN-EXTRACT-CIT.'.
265700     MOVE    '2150-MAIN-EXTRACT-CIT.' TO WA-ERROR-PRM.

381100**************************************************************
381200*   ANY VALUE IN POT-PRINT OR BILL-PRINT INDICATOR OTHER
381300*   THAN X'FF' IS CONSIDERED INDICATOR SET "ON".
381400*   CITS ARE BILLED IF NOT DISP CODE 1-9,
381500*   OR IF DISP 1-9 AND BOTH PRINT INDICATORS ARE "OFF"
381600**************************************************************
381700     EVALUATE G-DISPOSITION-CODE (IDX-G-R)
381800         ALSO ( G-POT-PRINT-IND (IDX-G-R)  = HIGH-VALUE )
381900         ALSO ( G-BILL-PRINT-IND (IDX-G-R) = HIGH-VALUE )
382000     WHEN '1' THRU '9' ALSO TRUE   ALSO  TRUE
382100         PERFORM 3200-BUILD-OP-CIT
382200     WHEN '1' THRU '9' ALSO FALSE  ALSO  ANY
382300         CONTINUE
382400     WHEN '1' THRU '9' ALSO  ANY   ALSO  FALSE
382500         CONTINUE
382600     WHEN OTHER
382700         PERFORM 3200-BUILD-OP-CIT
382800     END-EVALUATE.
382900
383000     SET IDX-G-R UP BY 1.
383100
383200 2170-OTHER-EXTRACT-CIT.
265700D    DISPLAY '2170-OTHER-EXTRACT-CIT.'.
265700     MOVE    '2170-OTHER-EXTRACT-CIT.' TO WA-ERROR-PRM.

383300**************************************************************
383400*   ANY VALUE IN POT-PRINT OR BILL-PRINT INDICATOR OTHER
383500*   THAN X'FF' IS CONSIDERED INDICATOR SET "ON".
383600*   CITS ARE BILLED IF DISP CODE = X'FF'
383700*   AND POT PRINT INDICATOR IS "ON" WHILE BILL-PRINT IS "OFF"
383800**************************************************************
383900     EVALUATE G-DISPOSITION-CODE (IDX-G-R)
384000         ALSO ( G-POT-PRINT-IND (IDX-G-R)  = HIGH-VALUE )
384100         ALSO ( G-BILL-PRINT-IND (IDX-G-R) = HIGH-VALUE )
384200     WHEN HIGH-VALUE  ALSO FALSE  ALSO  TRUE
384300         PERFORM 3200-BUILD-OP-CIT
384400     END-EVALUATE.
384500     SET IDX-G-R UP BY 1.
384600
384700/****************************
384800 2200-PROCESS-SITUS.
384900*****************************
265700D    DISPLAY '2200-PROCESS-SITUS.'.
265700     MOVE    '2200-PROCESS-SITUS.' TO WA-ERROR-PRM.

385000     COMPUTE K-FIRST = 687 + EA-NBR-E * 104 + EA-NBR-F * 19 +
385100              EA-NBR-G * 62 + EA-NBR-H * 100 + EA-NBR-J * 246 .
385200     SET IDX-EA TO K-FIRST
385300     SET IDX-K TO 1
385400     PERFORM 88 TIMES
385500       MOVE EA-BYTE (IDX-EA) TO K-BYTES (IDX-K)
385600       SET IDX-EA UP BY 1
385700       SET IDX-K UP BY 1
385800     END-PERFORM.
385900     MOVE K-SITUS-ADDR TO PO-SITUS-ADDR.
386000     MOVE K-SITUS-CITY TO PO-SITUS-CITY.
386100     IF K-SITUS-CNTY-CD NOT NUMERIC
386200         PERFORM 4085-INVALID-SITUS-CNTY
386300     ELSE
386400         IF K-VALID-SITUS-CNTY-CD
386500             MOVE COUNTY-SITUS-NAME (K-SITUS-CNTY-CD) TO
386600                      PO-SITUS-CNTY
386700             MOVE K-SITUS-CNTY-CD TO WA-SITUS-CNTY-CD
386800         ELSE
386900             IF K-OUT-OF-STATE-CNTY
387000                IF TL-VESSEL
387100                   PERFORM 4200-BYPASS-COUNTING
387200                   ADD 1 TO CTR-BYP-VSL (IDX-BYP)
387300                ELSE
387400                   MOVE SPACE TO PO-SITUS-CNTY
387500                   MOVE K-SITUS-CNTY-CD TO WA-SITUS-CNTY-CD
387600                END-IF
387700             ELSE
387800                IF TL-VESSEL
387900                    NEXT SENTENCE
388000                ELSE
388100                    PERFORM 4085-INVALID-SITUS-CNTY
388200                END-IF
388300             END-IF
388400         END-IF
388500     END-IF.
388600
388700
388800/****************************
388900 2300-PROCESS-P-SUBREC.
389000*****************************
265700D    DISPLAY '2300-PROCESS-P-SUBREC.'.
265700     MOVE    '2300-PROCESS-P-SUBREC.' TO WA-ERROR-PRM.

389100     COMPUTE P-FIRST = 687 + EA-NBR-E * 104 + EA-NBR-F *
389200                19 + EA-NBR-G * 62 + EA-NBR-H * 100 +
389300                EA-NBR-J * 246 + EA-NBR-K * 88 + EA-NBR-L *
389400                107 + EA-NBR-M * 56 + EA-NBR-N * 132 +
389500                EA-NBR-P * 206 - 206 .
389600     SET IDX-EA TO P-FIRST
389700     SET IDX-P TO 1
389800     PERFORM 2350-MOVE-P-SUBREC 166 TIMES.
389900     IF P-CNTY-CD NOT NUMERIC
390000         PERFORM 4090-INVALID-LESSE-CNTY
390100     ELSE
390200         IF P-REMOVAL-HIGH
390300            IF P-VALID-CNTY-CD
390400               MOVE P-CNTY-CD TO WA-SITUS-CNTY-CD
390500                                 WA-P-CNTY-CD
390600               IF P-CNTY-CD = 60
390700                   MOVE P-CITY  TO PO-OS-SMOG-ADDR
390800                   MOVE P-STATE TO PO-OS-SMOG-CITY
390900               END-IF
391000            ELSE
391100               PERFORM 4090-INVALID-LESSE-CNTY
391200            END-IF
391300         END-IF
391400     END-IF.
391500
391600 2350-MOVE-P-SUBREC.
265700D    DISPLAY '2350-MOVE-P-SUBREC.'.
265700     MOVE    '2350-MOVE-P-SUBREC.' TO WA-ERROR-PRM.

391700     MOVE EA-BYTE (IDX-EA) TO P-BYTES (IDX-P).
391800     SET IDX-EA UP BY 1.
391900     SET IDX-P UP BY 1.
392000/
392100*****************************
392200 2400-PROCESS-W-SUBREC.
392300*****************************
265700D    DISPLAY '2400-PROCESS-W-SUBREC.'.
265700     MOVE    '2400-PROCESS-W-SUBREC.' TO WA-ERROR-PRM.

392400     COMPUTE W-FIRST = 687 + EA-NBR-E * 104 + EA-NBR-F *
392500                19 + EA-NBR-G * 62 + EA-NBR-H * 100 +
392600                EA-NBR-J * 246 + EA-NBR-K * 88 + EA-NBR-L *
392700                107 + EA-NBR-M * 56 + EA-NBR-N * 132 +
392800                EA-NBR-P * 206 + EA-NBR-R * 252 + EA-NBR-S *
392900                31 + EA-NBR-T * 100 + EA-NBR-U * 36 +
393000                EA-NBR-V * 63
393100     COMPUTE W-LENGTH = EA-NBR-W * 253 .
393200     SET IDX-EA TO W-FIRST
393300     SET IDX-W TO 1
393400     PERFORM 2450-MOVE-W-SUBREC W-LENGTH TIMES.
393500     SET IDX-W-R TO 1
393600     PERFORM EA-NBR-W TIMES
393700         IF W-ODOMETER-YR (IDX-W-R) = '1998'
393800              IF W-TTC (IDX-W-R) =
393900                   ('A00' OR 'A01' OR 'K00' OR 'K01')
394000                  CONTINUE
394100              ELSE
394200                  MOVE 'W' TO PO-SMOG-ABATE-FLAG
394300              END-IF
394400         ELSE
394500             IF W-ODOMETER-YR (IDX-W-R) = '1999'
394600                  IF W-TTC (IDX-W-R) =
394700                       ('A00' OR 'A01' OR 'K00' OR 'K01')
394800                      MOVE 'W' TO PO-SMOG-ABATE-FLAG
394900                  ELSE
395000                      CONTINUE
395100                  END-IF
395200             END-IF
395300         END-IF
395400         SET IDX-W-R UP BY 1
395500     END-PERFORM.
395600 2450-MOVE-W-SUBREC.
265700D    DISPLAY '2450-MOVE-W-SUBREC.'.
265700     MOVE    '2450-MOVE-W-SUBREC.' TO WA-ERROR-PRM.

395700     MOVE EA-BYTE (IDX-EA) TO W-BYTES (IDX-W).
395800     SET IDX-EA UP BY 1.
395900     SET IDX-W UP BY 1.
396000***************************
396100 2500-VALIDATE-AND-MOVE-OP.
396200***************************
265700D    DISPLAY '2500-VALIDATE-AND-MOVE-OP.'.
265700     MOVE    '2500-VALIDATE-AND-MOVE-OP.' TO WA-ERROR-PRM.

396300     MOVE EA-TL TO PO-TL.
396400
396500***************************************************
396600*  IF 1ST TYPE 5 RECORD FOR A NEW LICENSE NUMBER, *
396700*  FLAG WITH A '1'.  IF 2ND OR SUBSEQUENT TYPE 5  *
396800*  FOR SAME LICENSE, FLAG '2', '3', ETC.  IF  VIN *
396900*  AND LICENSE ARE IDENTICAL, LEAVE FLAG BLANK -  *
397000*  DUPLICATE WILL BE THROWN OUT IN THE SORT.      *
397100***************************************************
397200     IF EA-TYPE-RECORD-5
397300         IF EA-LICENSE-NUM = PREVIOUS-LICENSE
397400             IF EA-VIN = PREVIOUS-VIN
397500                 MOVE WA-DUP-NBR TO PO-SAME-LIC-FLAG
397600             ELSE
397700                 ADD 1 TO WA-DUP-NBR
397800                 MOVE WA-DUP-NBR TO PO-SAME-LIC-FLAG
397900                 MOVE EA-VIN TO PREVIOUS-VIN
398000         ELSE
398100             MOVE 1 TO WA-DUP-NBR
398200             MOVE WA-DUP-NBR TO PO-SAME-LIC-FLAG
398300             MOVE EA-LICENSE-NUM TO PREVIOUS-LICENSE
398400             MOVE EA-VIN TO PREVIOUS-VIN
398500     ELSE
398600         NEXT SENTENCE.
398700
398800     MOVE EA-MAKE TO PO-MAKE.
398900
399000/****************************
399100 2530-VALIDATE-EXPIRATION-DATE.
399200*****************************
265700D    DISPLAY '2530-VALIDATE-EXPIRATION-DATE. ' EA-EXP-DT.
265700     MOVE    '2530-VALIDATE-EXPIRATION-DATE.' TO WA-ERROR-PRM.

399300     MOVE 'N'  TO SW-EXP.
399400
399500     IF TLP-EXEMPT-FLAG = 'Y'
399600         IF POW-PREFIX AND LICENSE-BYTES4-7 NUMERIC
399700             CONTINUE
R20192*        ELSE
R20192*            IF EA-EXP-MODA NOT  = '1231'
R20192*                PERFORM 4050-INVALID-EXPDT
R20192*            END-IF
400200         END-IF
400300     END-IF.
400400
400500     IF TL-SPEC-EQUIP
400600         IF EA-EXP-YR2 = 0 OR EA-EXP-YR2 = 5
400700             CONTINUE
400800         ELSE
400900             PERFORM 4050-INVALID-EXPDT.
401000
401100*    IF EA-EXP-DA = 27
401200*        IF EA-TL-COM-EXP-DT1 OR EA-TL-COM-EXP-DT
401300*            GO TO 2535-MOVE-EXPIRATION-DATE.
401400     IF TL-VAL-0630
401500         IF EA-EXP-MODA = 0630
401600             IF EA-EXP-YR-ODD
401700                 GO TO 2535-MOVE-EXPIRATION-DATE.
401800     IF EA-EXP-DA > 28
401900         IF EA-EXP-MODA = '1231'
402000             IF TL-VAL-1231 OR (TL-CB AND TL-AUTO) or
402100                   TLP-EXEMPT-FLAG = 'Y'
402200                 GO TO 2535-MOVE-EXPIRATION-DATE
402300             ELSE
402400                 PERFORM 3850-VAL-END-MO
402500                 GO TO 2535-MOVE-EXPIRATION-DATE
402600         ELSE
402700             SET IDX-MO TO 1
402800             PERFORM 3800-SRCH-ENDMO-TBL
402900             PERFORM 3850-VAL-END-MO
403000             GO TO 2535-MOVE-EXPIRATION-DATE
403100     ELSE
403200         NEXT SENTENCE.
403300     IF EA-EXP-MODA = '0228'
403400         IF TL-VAL-ENDMO OR TL-COML-VEH
403500             NEXT SENTENCE
403600         ELSE
403700             IF TL-VAL-8-28
403800                 PERFORM 4050-INVALID-EXPDT
403900             ELSE
404000                 NEXT SENTENCE
404100      ELSE
404200         IF EA-BAD-DAY
404300            PERFORM 4050-INVALID-EXPDT
404400         ELSE
404500            IF TL-VAL-8-28
404600               NEXT SENTENCE
404700            ELSE
404800               IF TL-VAL-ANY
404900                  NEXT SENTENCE
405000               ELSE
405100                  PERFORM 4050-INVALID-EXPDT.
405200
405300/****************************
405400 2535-MOVE-EXPIRATION-DATE.
405500*****************************
265700D    DISPLAY '2535-MOVE-EXPIRATION-DATE.'.
265700     MOVE    '2535-MOVE-EXPIRATION-DATE.' TO WA-ERROR-PRM.

405600     MOVE '  /  /    ' TO PO-EXP-DT.
405700     MOVE EA-EXP-MO TO PO-EXP-MO WA-RENEW-MO.
405800     MOVE EA-EXP-DA TO PO-EXP-DA WA-RENEW-DA.
405900
406000**   IF THE RECORD DOES NOT HAVE AN A PNO SUBRECORD, USE
406100**   THE EXPIRATION DATE, IF THE RECORD DOES HAVE A PNO
406200**   AND IT IS FOR AN OHV THE YEAR IS SAME AS CURRENT YEAR
406300**   IF THERE IS A PNO FOR OTHER VEHICLES THE YEAR WILL USUALLY
406400**   BE THE SAME AS THE CURRENT YEAR UNLESS WE ARE IN THE LAST
406500**   QUARTER OF THE YEAR, WE MAY BE PROCESSING FOR THE NEXT YEAR
406600**   IF WE ARE PROCESSING A DELINQUENT RECORD RID, THE EXP YR
406700**   WILL BE USED BECAUSE IF A PNO WAS FOUND FOR A DELINQUENT
406800**   THE PROGRAM WILL BYPASS THAT RECORD.
406900     IF NO-E69
407000         MOVE ARG-C01F-EXPIRATION-CCYY TO PO-EXP-CCYY
407100                                          WA-RENEW-CCYY
407200     ELSE
407300         IF CURR-MO-OCT-NOV-DEC AND EA-EXP-MO-JAN-MAR
407400            MOVE WA-NEXT-YR TO PO-EXP-CCYY WA-RENEW-CCYY
407500         ELSE
407600            MOVE WA-YR TO PO-EXP-CCYY WA-RENEW-CCYY
407700         END-IF
407800     END-IF.
407900
408000/*************************************
408100*    SET UP LICENSE VALID LINKAGE    *
408200**************************************
408300****************
408400 2550-MOVE-LIC.
408500****************
265700D    DISPLAY '2550-MOVE-LIC.'.
265700     MOVE    '2550-MOVE-LIC.' TO WA-ERROR-PRM.

408600     IF EA-TYPE-RECORD-5
408700        IF LICENSE-1ST-BYTE < SPACE
408800            MOVE SPACE TO LICENSE-1ST-BYTE.
408900     MOVE EA-LICENSE-NUM TO PO-LIC-NBR.
409000     IF TL-ELP
409100         MOVE EA-LICENSE-NUM TO WA-ELP-LIC-PTN
409200         INSPECT WA-ELP-LIC-PTN
409300             REPLACING ALL SPACES BY '*'
409400         INSPECT WA-ELP-LIC-PTN
409500             REPLACING CHARACTERS BY 'X' BEFORE INITIAL '*'
409600         IF NOT VALID-ELP-PATTERN
                 MOVE EA-LICENSE-NUM (2:6) TO WA-ELP-LIC-PTN
                 INSPECT WA-ELP-LIC-PTN
                     REPLACING ALL SPACES BY '*'
                 INSPECT WA-ELP-LIC-PTN
                     REPLACING CHARACTERS BY 'X' BEFORE INITIAL '*'
                 IF NOT VALID-ELP-PATTERN
409700             PERFORM 4060-LIC-NOT-VALID
                 END-IF
409800         END-IF
409900         GO TO 2580-TYPE-REC-REG-CO
410000     END-IF.
410100
410200     IF TL-PRORATE-ID
410300         MOVE 'Q' TO PO-LIC-NBR-BYTE1.
410400
410500     MOVE ZERO              TO OF6512-RETURN-CODE-V.
410600     MOVE SPACE             TO OF6512-KEY-AREA.
410700     MOVE EA-TL             TO OF6512-VAL-TL.
410800     MOVE EA-LICENSE-NUM TO OF6512-VAL-LIC-NBR.
410900
411000******************
411100 2560-CALL-OF651C.
411200******************
265700D    DISPLAY '2560-CALL-OF651C.'.
265700     MOVE    '2560-CALL-OF651C.' TO WA-ERROR-PRM.

411300     CALL 'OF651C' USING OF6512-VALIDATION-LINKAGE
411400                         OF6512-KEY-AREA
411500                         OF6512-RETURN-CODE-V.
411600     IF OF6512-LIC-NOT-VALID
411700         PERFORM 4060-LIC-NOT-VALID.
411800     IF TL-DP
411900         IF OF6512-DP-0A0A
412000             NEXT SENTENCE
412100         ELSE
412200             PERFORM 4200-BYPASS-COUNTING
412300             ADD 1 TO CTR-BYP-DPL (IDX-BYP)
412400             GO TO 2899-EXIT.
412500
412600/*********************
412700 2580-TYPE-REC-REG-CO.
412800**********************
265700D    DISPLAY '2580-TYPE-REC-REG-CO.'.
265700     MOVE    '2580-TYPE-REC-REG-CO.' TO WA-ERROR-PRM.

412900     PERFORM 3600-SET-FILE-CODE THRU 3699-EXIT.
413000
413100     IF TL-COML-VEH
413200         IF TL-HORSELESS-CAR
413300             MOVE 'A' TO PO-TYPE-REC
413400         ELSE
413500             MOVE TLP-VEH-CL-PARAM TO PO-TYPE-REC
413600     ELSE
413700         MOVE TLP-VEH-CL-PARAM TO PO-TYPE-REC.
413800
413900     IF EA-REG-CO NOT NUMERIC
414000         IF EA-TL-V3-4
414100             MOVE ZERO TO PO-REG-CO
414200         ELSE
414300             PERFORM 4095-INVALID-REG-CNTY.
414400
414500     IF EA-VALID-REG-CO
414600        MOVE EA-REG-CO TO PO-REG-CO
414700     ELSE
414800         IF EA-TL-V3-4
414900             MOVE ZERO TO PO-REG-CO
415000         ELSE
415100             PERFORM 4095-INVALID-REG-CNTY.
415200
415300/**********************
415400 2600-ALLOC-CNTY.
415500***********************
265700D    DISPLAY '2600-ALLOC-CNTY.'.
265700     MOVE    '2600-ALLOC-CNTY.' TO WA-ERROR-PRM.

415600     IF EA-NO-ALLOC-CO OR EA-ALCO = SPACE
415700         MOVE ZERO TO PO-ALCO
415800     ELSE
415900         IF EA-VALID-ALLOC-CO
416000             MOVE EA-ALCO TO PO-ALCO
416100         ELSE
416200            IF TL-VESSEL OR TL-DPP
416300               MOVE ZERO TO PO-ALCO
416400            ELSE
416500               IF TL-TITLE-TRANS
416600                   IF EA-ALCO = '00'
416700                      MOVE ZERO TO PO-ALCO
416800                   END-IF
416900               ELSE
417000                  MOVE 'INVALID ALLOCATED COUNTY' TO WA-ERROR-MSG
417100                  PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
417200                  PERFORM 4300-COUNT-ERRORS
417300               END-IF
417400            END-IF
417500         END-IF
417600     END-IF.
417700
417800     IF PO-ALCO = ZERO
417900         CONTINUE
418000     ELSE
418100         IF PO-REG-CO = PO-ALCO
418200             MOVE ZERO TO PO-ALCO
418300         END-IF
418400     END-IF.
418500
418600/**********************
418700 2620-VIN-ENG-BTM.
418800***********************
265700D    DISPLAY '2620-VIN-ENG-BTM.'.
265700     MOVE    '2620-VIN-ENG-BTM.' TO WA-ERROR-PRM.

418900     IF PO-VIN = SPACE
419000         MOVE EA-VIN TO PO-VIN
419100         IF EA-NO-ENG-NBR
419200             NEXT SENTENCE
419300         ELSE
419400             IF EA-ENG-EQUALS-VIN-55
419500                 MOVE EA-VIN TO PO-ENG
419600             ELSE
419700                 MOVE EA-ENG TO PO-ENG.
419800     MOVE EA-VIN3  TO PO-VIN-LAST3.
419900
420000     IF TL-VESSEL
420100         MOVE SPACE TO PO-BTM
420200     ELSE
420300         MOVE EA-BTM TO PO-BTM.
420400
420500***************************
420600 2630-PROCESS-DATE-1ST-SOLD.
420500***************************
265700D    DISPLAY '2630-PROCESS-DATE-1ST-SOLD.'.
265700     MOVE    '2630-PROCESS-DATE-1ST-SOLD.' TO WA-ERROR-PRM.

420500***************************
420700* PRIOR TO CREATION OF THE U SUBRECORD FOR CENTURY (1998),
420800* "00" IN THE YEAR FIRST SOLD (YFS) INDICATED NON-EXISTANCE
420900* OF YFS.  AFTER IMPLEMENTATION OF THE U SUBRECORD, "00"
421000* MAY INDICATE 2000 IF THE CENTURY IS ON THE U SUB.  NOTE
421100* THAT ONLY "YY" (NOT "CCYY") IS CHECKED FOR NOT NUMERIC, BECAUSE
421200* THE LINKAGE DATE WILL CONTAIN "  YY" IF THE CENTURY IS NOT ON
421300* THE U SUB OR CAN NOT BE GENERATED.
421400***************************
421500     IF TL-SPEC-EQUIP OR TL-DPP OR
421600         (ARG-C01F-FIRST-SOLD-CCYY IS NUMERIC)
421700         NEXT SENTENCE
421800     ELSE
421900         IF ARG-C01F-FIRST-SOLD-CCYY IS NOT NUMERIC
422000            PERFORM 3400-YFS-ZERO-CHECK-AST-YR
422100         ELSE
422200* 3/98 NO ONE CAN IDENTIFY THE REASONS FOR THE FOLLOWING
422300* LOGIC; THEREFORE, IT IS NOT BEING CHANGED FOR Y2K. S.M.
422400            IF EA-TV-HISTORICAL
422500                 IF EA-YFS < 90
422600                     PERFORM 4030-YFS-ERROR
422700                 ELSE
422800                     NEXT SENTENCE
422900                 ELSE
423000                     PERFORM 4030-YFS-ERROR.
423100
423200     IF ARG-C01F-FIRST-SOLD-CCYY NUMERIC
423300         MOVE ARG-C01F-FIRST-SOLD-CCYY
423400            TO PO-YEAR-FIRST-SOLD-CCYY.
423500
423600/**********************
423700 2640-CYL-VLF-AST.
423800***********************
265700D    DISPLAY '2640-CYL-VLF-AST.'.
265700     MOVE    '2640-CYL-VLF-AST.' TO WA-ERROR-PRM.

423900     IF EA-NO-CYL
424000         NEXT SENTENCE
424100     ELSE
424200         MOVE EA-CYL TO PO-CYL.
424300     IF TL-VESSEL
424400         MOVE SPACE TO PO-VLF-CL
424500     ELSE
424600         MOVE EA-VLF-CL TO PO-VLF-CL.
424700
424800     IF ARG-C01F-ASTERISK-YEAR NOT NUMERIC
424900         NEXT SENTENCE
425000     ELSE
425100         IF TL-VESSEL
425200             MOVE ARG-C01F-ASTERISK-YEAR
425300                 TO PO-ASTERISK-YEAR-CCYY
425400         ELSE
425500             IF  (ARG-C01F-ASTERISK-YEAR  > WA-YR) or
425600                 (ARG-C01F-ASTERISK-YEAR-CC = '18')
425700                 MOVE 'INVALID ASTERISK YEAR' TO WA-ERROR-MSG
425800                 PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
425900                 PERFORM 4300-COUNT-ERRORS
426000             ELSE
426100                 MOVE ARG-C01F-ASTERISK-YEAR
426200                     TO PO-ASTERISK-YEAR-CCYY.
426300
426400
426500***************************
426600 2660-PROCESS-YEAR-MODEL.
426700***************************
265700D    DISPLAY '2660-PROCESS-YEAR-MODEL.'.
265700     MOVE    '2660-PROCESS-YEAR-MODEL.' TO WA-ERROR-PRM.

426800      IF ARG-C01F-YEAR-MODEL NUMERIC
426900         MOVE ARG-C01F-YEAR-MODEL TO PO-YM-CCYY.
427000
427100/**************************
427200 2670-PROCESS-TYPE-VEHICLE.
427300***************************
265700D    DISPLAY '2670-PROCESS-TYPE-VEHICLE.'.
265700     MOVE    '2670-PROCESS-TYPE-VEHICLE.' TO WA-ERROR-PRM.

427400     IF TL-SPEC-EQUIP
427500         MOVE EA-TV TO PO-TV
427600         GO TO 2680-TYPE-BODY.
427700     IF EA-TV-HISTORICAL
427800         IF EA-TL = '70' OR '79'
427900             PERFORM 4040-INVALID-TV
428000         ELSE
428100             MOVE EA-TV TO PO-TV
428200             MOVE SPACE TO PO-VLF-CL
428300             MOVE ' ' TO WA-IND-H
428400             SET IDX-HIST TO 1
428500             PERFORM 3700-HIST-TV-VAL
428600             IF TL-LEGIS-FEE-PD
428700                 MOVE 'L' TO WA-IND-L
428800             ELSE
428900                 NEXT SENTENCE
429000     ELSE
429100         MOVE EA-TV TO PO-TV
429200         IF TL-LEGIS-FEE-PD
429300             MOVE 'L' TO WA-IND-L
429400         END-IF.
PTI   **************************  SINCE SPECIAL EQUIPMENT HAS BEEN
PTI   * PTI INDICATOR SET HERE *  DIRECTED TO GO TO 2680-TYPE-BODY
PTI   **************************  NO CHECK WAS DONE TO EXCLUDE
PTI        IF (PO-EXP-CCYY = 2001 AND PO-EXP-MO = 12) OR
PTI           (PO-EXP-CCYY > 2001)
PTI
PTI           IF TL-TRLR
PTI             IF NOT EA-HOUSE-TRLR-TB
PTI               IF TL-PTI
PTI                 MOVE 'R' TO PO-PTI-INDICATOR
PTI               ELSE
PTI                 MOVE 'Y' TO PO-PTI-INDICATOR
PTI               END-IF
PTI               EVALUATE PO-FILE-CODE
PTI                 WHEN 'N '
PTI                   IF TL-PTI
PTI                     MOVE '43' TO PO-FILE-CODE
PTI                   ELSE
PTI                     MOVE '40' TO PO-FILE-CODE
PTI                   END-IF
PTI                 WHEN '2 '
PTI                   IF TL-PTI
PTI                     MOVE '41' TO PO-FILE-CODE
PTI                   ELSE
PTI                     MOVE '40' TO PO-FILE-CODE
PTI                   END-IF
PTI                 WHEN '4 '
PTI                   IF TL-PTI
PTI                     MOVE '45' TO PO-FILE-CODE
PTI                   ELSE
PTI                     MOVE '40' TO PO-FILE-CODE
PTI                   END-IF
PTI                 WHEN 'J '
PTI                   IF TL-PTI
PTI                     MOVE '46' TO PO-FILE-CODE
PTI                   ELSE
PTI                     MOVE '40' TO PO-FILE-CODE
PTI                   END-IF
PTI               END-EVALUATE
PTI            END-IF
PTI          END-IF
PTI        END-IF.
429500***********************
429600* INSURANCE INDICATOR *
429700***********************
SB1500     IF NOT (PO-EFR-REQUIRED = 'S')
429800        IF EA-TV-10-39-INS-REQ
429900           MOVE 'Y' TO PO-EFR-REQUIRED
430000        ELSE
430100           MOVE 'N' TO PO-EFR-REQUIRED
430200        END-IF
430300     END-IF.
SB1500
430400***********************
430500 2680-TYPE-BODY.
430600***********************
265700D    DISPLAY '2680-TYPE-BODY.'.
265700     MOVE    '2680-TYPE-BODY.' TO WA-ERROR-PRM.

430700     MOVE EA-TB TO PO-TB.
430800     IF TL-VESSEL
430900         MOVE EA-TB TO WA-VALIDATION-CHAR
431000         MOVE 'Y' TO SW-VALID-DATA
431100         PERFORM 5000-VALIDATE-CHARACTER THRU 5099-EXIT
431200         IF SW-VALID-DATA = 'N'
431300             MOVE SPACE TO PO-TB.
431400
431500/*********************
431600 2700-MOTIVE-POWER.
431700**********************
265700D    DISPLAY '2700-MOTIVE-POWER.'.
265700     MOVE    '2700-MOTIVE-POWER.' TO WA-ERROR-PRM.

431800     IF IDX-BYP-LIC > 12
431900        SET IDX-BYP-LIC TO 1.
432000
432100     IF EA-NO-MP
432200         GO TO 2730-AXLES-WGT
432300     ELSE
432400         MOVE EA-MP TO PO-MP.
432500*********************************************************
432600*  THE FOLLOWING ROUTINE WILL PROVIDE A LIST OF RECORDS *
432700*  WITH INVALID MOTIVE POWER FIELDS ON THE BYPASS RPT.  *
432800*  INVALID CHARACTERS ARE OVERWRITTEN WITH SPACES, AND  *
432900*  RECORD CONTINUES PROCESSING.                         *
433000*********************************************************
433100     IF TL-VESSEL
433200         MOVE EA-MP TO WA-VALIDATION-CHAR
433300         MOVE 'Y' TO SW-VALID-DATA
433400         PERFORM 5000-VALIDATE-CHARACTER THRU 5099-EXIT
433500         IF SW-VALID-DATA = 'N'
433600             MOVE SPACE TO PO-MP
433700             MOVE PO-LIC-NBR TO BYP-LIC-NBR (IDX-BYP-LIC)
433800             MOVE SPACE TO BYP-LIC-SP-1 (IDX-BYP-LIC)
433900                           BYP-LIC-SP-2 (IDX-BYP-LIC)
434000             MOVE PO-TL TO BYP-TL (IDX-BYP-LIC)
434100             SET IDX-BYP-LIC UP BY 1
434200         END-IF
434300     ELSE
434400         IF PO-VALID-MP
434500             NEXT SENTENCE
434600         ELSE
434700             MOVE SPACE TO PO-MP
434800             MOVE PO-LIC-NBR TO BYP-LIC-NBR (IDX-BYP-LIC)
434900             MOVE SPACE TO BYP-LIC-SP-1 (IDX-BYP-LIC)
435000                           BYP-LIC-SP-2 (IDX-BYP-LIC)
435100             MOVE PO-TL TO BYP-TL (IDX-BYP-LIC)
435200             SET IDX-BYP-LIC UP BY 1
435300         END-IF
435400     END-IF.
435500
435600     IF EA-ELEC-MP
435700         IF EA-TV-ELEC
435800             NEXT SENTENCE
435900         ELSE
436000             IF EA-TV-ELEC-COML
436100                 NEXT SENTENCE
436200             ELSE
RA1108*    electric OHV are an exempt status
RA1108                 IF EA-TV-OHV-ELEC
RA1108                     NEXT SENTENCE
RA1108                 ELSE
RA1108                     PERFORM 4040-INVALID-TV
436400     ELSE
RDC355        IF EA-DIESEL-HYBRID
RDC355           IF EA-TV-DIESEL-HYBRID
RDC355              NEXT SENTENCE
RDC355           ELSE
RDC355              PERFORM 4040-INVALID-TV
RDC355        ELSE
RDC355           NEXT SENTENCE
RDC355     END-IF.
436600
436700****************
436800 2730-AXLES-WGT.
436900****************
265700D    DISPLAY '2730-AXLES-WGT.'.
265700     MOVE    '2730-AXLES-WGT.' TO WA-ERROR-PRM.

437000     IF PO-TYPE-REC = 'A'
437100       NEXT SENTENCE
437200     ELSE
437300       IF TL-VESSEL
437400         MOVE EA-VES-PROP TO PO-AXLE
437500         MOVE EA-VES-LENGTH TO PO-WGT
437600       ELSE
437700        IF EA-NO-AX-WGT
437800          NEXT SENTENCE
437900        ELSE
438000          MOVE EA-AXLE TO PO-AXLE
CVRA            MOVE EA-WGT  TO PO-WGT
CVRA            IF EA-PICKUP-TB
CVRA              IF EA-WGT > 8000
CVRA                PERFORM 4075-INVALID-BTC-FOR-PICKUP
CVRA              END-IF
CVRA            ELSE
eHCVRa**
EHCVRA*           IF EA-TL-CVRA  AND NOT EA-ELEC-MP
RB1948*    COMMENT OUT ABOVE LINE WITH ELECTRIC CRITERIA EXCEPTION
RB1948            IF EA-TL-CVRA
CVRA                IF (EA-WGT > 6000) OR (EA-CVRA-CERT-CODE = 'C')
CVRAPK                OR (EA-CVRA-CERT-CODE = 'D')
CVRA                  IF (PO-EXP-CCYY = 2001 AND PO-EXP-MO = 12)
CVRA                    OR (PO-EXP-CCYY > 2001)
CVRA                    MOVE 'Y' TO PO-CVRA-INDICATOR
CVRA
CVRA                    EVALUATE PO-FILE-CODE
CVRA                      WHEN '2 '
CVRA                        MOVE '3 ' TO PO-FILE-CODE
CVRA                      WHEN '4 '
CVRA                        MOVE '5 ' TO PO-FILE-CODE
CVRA                      WHEN 'J '
CVRA                        MOVE 'K ' TO PO-FILE-CODE
CVRA                      WHEN 'N '
CVRA                        MOVE 'O ' TO PO-FILE-CODE
CVRA                       WHEN OTHER
CVRA                        CONTINUE
CVRA                    END-EVALUATE
CVRA
CVRA
CVRA                    EVALUATE EA-CVRA-CERT-CODE
CVRA                      WHEN 'C'
CVRA                        MOVE EA-CVRA-CERT-CODE TO PO-CVRA-CERT-CODE
CVRA                        MOVE EA-CVRA-WEIGHT    TO PO-CVRA-WEIGHT
CVRA                        MOVE EA-CVRA-CERT-DATE TO PO-CVRA-CERT-DATE
CVRA                      WHEN 'U'
CVRA                        IF EA-WGT > 10000
CVRA                           MOVE 'D'            TO PO-CVRA-CERT-CODE
CVRA                           MOVE '80000'        TO PO-CVRA-WEIGHT
CVRA                        ELSE
CVRA                           MOVE EA-CVRA-CERT-CODE TO
CVRA                                                  PO-CVRA-CERT-CODE
CVRA                           MOVE EA-CVRA-WEIGHT    TO PO-CVRA-WEIGHT
CVRA                           MOVE EA-CVRA-CERT-DATE TO
CVRA                                                  PO-CVRA-CERT-DATE
CVRA                        END-IF
CVRA                      WHEN 'D'
CVRA                        MOVE EA-CVRA-CERT-CODE TO PO-CVRA-CERT-CODE
CVRA                        MOVE EA-CVRA-WEIGHT    TO PO-CVRA-WEIGHT
CVRA                      WHEN ' '
CVRA                        MOVE 'D'     TO PO-CVRA-CERT-CODE
CVRA                        MOVE '80000' TO PO-CVRA-WEIGHT
CVRA                    END-EVALUATE
CVRA                  END-IF
CVRA                 END-IF
CVRA               END-IF
CVRA             END-IF
CVRA           END-IF
CVRA         END-IF
CVRA       END-IF
CVRA  *
488200
438300     IF TL-VESSEL
438400         IF PO-WGT = ZERO
438500             MOVE SPACE TO PO-WGT
438600         END-IF
438700         GO TO 2750-PROCESS-RO-ADDRESS
438800     END-IF.
438900
439000     IF EA-NO-AX-WGT
439100         IF TLP-COML-VEH  AND TL-WGT-FEE-TYPE
439200             PERFORM 4020-WGT-ERROR
CVRA           END-IF
439500     ELSE
439600         IF EA-AXLE NOT = SPACE
439700             IF EA-AXLE < '1' OR > '9'
439800                 MOVE 'INVALID AXLES' TO WA-ERROR-MSG
439900                 PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
440000                 PERFORM 4300-COUNT-ERRORS
440100             ELSE
440200                 IF EA-WGT NOT NUMERIC
440300                     PERFORM 4020-WGT-ERROR
CVRA                       IF EA-CVRA-CERT-CODE = 'C'
CVRA                          IF EA-CVRA-WEIGHT NOT NUMERIC
CVRA                              PERFORM 4020-WGT-ERROR
CVRA                          END-IF
CVRA                       END-IF
440400                 ELSE
CVRAPR                     IF (EA-CVRA-WEIGHT NUMERIC) AND
CVRAPR                        (EA-WGT > EA-CVRA-WEIGHT) AND
CVRAPR                        (EA-CVRA-WEIGHT < 80000) AND
CVRAPR                        (EA-CVRA-WEIGHT NOT = ZEROS)
CVRAPR                          PERFORM 4023-UNL-WGT-CVRA-WGT-ERROR
CVRAPR                     END-IF
CVRAPR                     IF (EA-PICKUP-TB) AND
CVRAPR                        (EA-CVRA-WEIGHT NUMERIC) AND
CVRAPR                        (EA-WGT > EA-CVRA-WEIGHT) AND
CVRAPR                        (EA-CVRA-WEIGHT < 80000)
CVRAPR                          PERFORM 4023-UNL-WGT-CVRA-WGT-ERROR
CVRAPR                     END-IF
POWWGT                     IF (POW-PREFIX AND LICENSE-BYTES4-7 NUMERIC)
POWWGT                        AND (EA-WGT > 8000)
POWWGT                        PERFORM 4025-TL-VS-WEIGHT-ERROR
POWWGT                     END-IF
DPWGT                      IF (EA-TL-COM-DP) AND (EA-WGT > 8000)
DPWGT                          PERFORM 4025-TL-VS-WEIGHT-ERROR
DPWGT                      END-IF
DPWGT                  END-IF
DPWGT              END-IF
DPWGT          END-IF
DPWGT      END-IF
441100
CTIP  ************************************
CTIP  * CTIP - MARKS POTREC CTIP INDICATOR FOR DOWNSTREAM
CTIP  ************************************
CTIP
CTIP       IF (PO-EXP-CCYY = 2001 AND PO-EXP-MO = 12) OR
CTIP          (PO-EXP-CCYY > 2001)
CTIP          IF (PO-CVRA-INDICATOR     = 'Y') AND
CTIP             (PO-CVRA-WEIGHT        > '10000')
CTIP             EVALUATE TRUE
CTIP                WHEN EA-CTIP-EXEMPT
CTIP                   CONTINUE
CTIP                WHEN EA-CTIP-TOWTRUCK AND EA-BTM-TOW
CTIP                   CONTINUE
CTIP                WHEN EA-CTIP-AMBULANCE
CTIP                   CONTINUE
CTIP                WHEN EA-ELEC-MP
CTIP                   CONTINUE
CTIP                WHEN OTHER
CTIP                   MOVE 'Y' TO PO-CTIP-INDICATOR
CTIP             END-EVALUATE
CTIP          END-IF
CTIP       END-IF.
CTIP
CTIP
441200/*************************
441300 2750-PROCESS-RO-ADDRESS.
441400**************************
265700D    DISPLAY '2750-PROCESS-RO-ADDRESS.'.
265700     MOVE    '2750-PROCESS-RO-ADDRESS.' TO WA-ERROR-PRM.

441500     IF EA-RO2-L = LOW-VALUE AND EA-RO2-BYTE1 = SPACE
441600         GO TO 2775-OTHER-ADDRESS
441700     ELSE
441800         MOVE EA-NA-INDS TO WA-NA-INDS.
441900     IF EA-NO-RO3
442000         MOVE '0' TO WA-RO3-IND
442100     ELSE
442200         MOVE '1' TO WA-RO3-IND.
442300     IF EA-NO-RO4
442400         MOVE '0' TO WA-RO4-IND
442500     ELSE
442600         MOVE '1' TO WA-RO4-IND.
442700
442800     EVALUATE WA-NA-PARAM
442900     WHEN     '0000'
443000         MOVE EA-RO2 TO PO-SORT-ADS
ADDRPR         IF SW-MAIL-ADDRESS = 'N'
ADDRSP           MOVE EA-RO2 TO WA-NAME-ADDR-CHKLGTH
ADDRSP           PERFORM 3002-CHECK-LNGTH-ADDR
ADDRSP           PERFORM 3006-CHECK-SPACES-ADD
ADDRPR           PERFORM 3020-RO-VALID-ADDR
ADDRPR         END-IF
443100     WHEN     '0010'
443200         MOVE EA-RO2 TO PO-SORT-ADS
443300         MOVE 'A' TO PO-RO2-IND
443400         MOVE EA-RO3 TO PO-RO2
443500     WHEN     '0011'
443600         MOVE EA-RO2 TO PO-SORT-ADS
443700         MOVE 'A' TO PO-RO2-IND
443800                     PO-RO3-IND
443900         MOVE EA-RO3 TO PO-RO2
444000         MOVE EA-RO4 TO PO-RO3
444100     WHEN     '1000'
444200         MOVE 'N' TO PO-RO2-IND
444300         MOVE EA-RO2 TO PO-RO2
444400     WHEN     '1010'
444500         MOVE EA-RO3 TO PO-SORT-ADS
444600         MOVE 'N' TO PO-RO2-IND
444700         MOVE EA-RO2 TO PO-RO2
444800     WHEN     '1011'
444900         MOVE EA-RO3 TO PO-SORT-ADS
445000         MOVE 'N' TO PO-RO2-IND
445100         MOVE EA-RO2 TO PO-RO2
445200         MOVE 'A' TO PO-RO3-IND
445300         MOVE EA-RO4 TO PO-RO3
445400     WHEN     '1110'
445500         MOVE 'N' TO PO-RO2-IND
445600                     PO-RO3-IND
445700         MOVE EA-RO2 TO PO-RO2
445800         MOVE EA-RO3 TO PO-RO3
445900     WHEN     '1111'
446000         MOVE EA-RO4 TO PO-SORT-ADS
446100         MOVE 'N' TO PO-RO2-IND
446200                     PO-RO3-IND
446300         MOVE EA-RO2 TO PO-RO2
446400         MOVE EA-RO3 TO PO-RO3
446500     END-EVALUATE.
446600
441200**************************
446700 2775-OTHER-ADDRESS.
441200**************************
265700D    DISPLAY '2775-OTHER-ADDRESS.'.
265700     MOVE    '2775-OTHER-ADDRESS.' TO WA-ERROR-PRM.

446800     IF SW-MAIL-ADDRESS = 'Y'
446900         MOVE WA-MAIL-ADDR1 TO PO-SORT-ADS
ADDRSP                               WA-NAME-ADDR-CHKLGTH
ADDRSP         PERFORM 3002-CHECK-LNGTH-ADDR
ADDRSP         PERFORM 3006-CHECK-SPACES-ADD
ADDRPR         PERFORM 3010-M-VALID-ADDR1
447000         MOVE 'B' TO PO-ADDR-IND
447100***************************************************
447200*  SAVE THE ORIGINAL RO ADDRESS IF OUT-OF-STATE   *
447300***************************************************
447400         IF PO-REG-CO = 60
447500             PERFORM 5200-SAVE-SMOG-ADDRESS
447600         END-IF
447700         MOVE PO-REG-CO TO PO-REG-CC
447800         MOVE WA-MAIL-CC TO PO-REG-CO
447900         IF PO-RO2-IND = 'N'
448000             MOVE WA-MAIL-ADDR2 TO PO-RO3
448100             IF PO-RO3 = SPACE
448200                 MOVE SPACE TO PO-RO3-IND
448300             ELSE
448400                 MOVE 'A' TO PO-RO3-IND
448500             END-IF
448600         ELSE
448700             MOVE WA-MAIL-ADDR2 TO PO-RO2
ADDRPR             IF WA-MAIL-ADDR1 = SPACES
ADDRSP                 MOVE WA-MAIL-ADDR2 TO WA-NAME-ADDR-CHKLGTH
ADDRSP                 PERFORM 3002-CHECK-LNGTH-ADDR
ADDRSP                 PERFORM 3006-CHECK-SPACES-ADD
ADDRPR                 PERFORM 3015-M-VALID-ADDR2
ADDRPR             END-IF
448800             IF PO-RO2 = SPACE
448900                 MOVE SPACE TO PO-RO2-IND
449000             ELSE
449100                 MOVE 'A' TO PO-RO2-IND
449200             END-IF
449300             MOVE SPACE TO PO-RO3
449400                           PO-RO3-IND
449500         END-IF
449600     END-IF.
449700**************************************************************
449800*  ADJUST ALLOCATED CNTY TO CORRESPOND TO COUNTY RELATED TO  *
449900*  FEES CHARGED (RO CNTY WILL CORRESPOND TO MAILING ADDRESS  *
450000*  COUNTY
450100**************************************************************
450200     IF PO-ALCO = ZERO
450300         IF PO-REG-CC NOT = ZERO
450400             MOVE PO-REG-CC TO PO-ALCO
450500         END-IF
450600     END-IF.
450700
450800/*********************
450900 2780-RO-NAME-CITY.
451000**********************
265700D    DISPLAY '2780-RO-NAME-CITY.'.
265700     MOVE    '2780-RO-NAME-CITY.' TO WA-ERROR-PRM.

451100     MOVE EA-RON TO PO-RON.
451200     MOVE SPACE TO WA-RO-NAME-3.
451300     MOVE EA-RONM3 TO WA-RO-NAME-3.
451400     SET IDX-NAME TO 1
451500     MOVE 'Y' TO SW-VALID-DATA.
451600     PERFORM 3 TIMES
451700         MOVE WA-RO-NAME-CHAR(IDX-NAME) TO WA-VALIDATION-CHAR
451800         PERFORM 5000-VALIDATE-CHARACTER THRU 5099-EXIT
451900         SET IDX-NAME UP BY 1
452000     END-PERFORM.
452100
452200     IF SW-VALID-DATA = 'N'
452300         MOVE 'INVALID CHARACTER IN RO NAME' TO WA-ERROR-MSG
452400         PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
452500         PERFORM 4300-COUNT-ERRORS.
452600     IF SW-MAIL-ADDRESS = 'Y'
452700         MOVE WA-MAIL-CITY TO PO-ROCITY
ADDRSP                              WA-NAME-CITY-CHKLGTH
ADDRSP         PERFORM 3004-CHECK-LNGTH-CITY
ADDRSP         PERFORM 3008-CHECK-SPACES-CITY
ADDRPR         PERFORM 3025-VALID-CITY
452800         IF PO-REG-CC = 60
452900             MOVE PO-ROCITY TO PO-OS-SMOG-CITY
453000         END-IF
453100     ELSE
453200         MOVE EA-ROCITY TO PO-ROCITY
ADDRSP                           WA-NAME-CITY-CHKLGTH
ADDRSP         PERFORM 3004-CHECK-LNGTH-CITY
ADDRSP         PERFORM 3008-CHECK-SPACES-CITY
ADDRPR         PERFORM 3028-VALID-CITY2.
453300
453400     IF EA-RO-ZIP NOT NUMERIC
453500         MOVE 'INVALID R/O ZIP CODE' TO WA-ERROR-MSG
453600         PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
453700         PERFORM 4300-COUNT-ERRORS.
453800     IF SW-MAIL-ADDRESS = 'Y'
453900         MOVE EA-RO-ZIP TO PO-REG-ZIP
454000         MOVE WA-MAIL-ZIP-CD TO PO-RO-ZIP
454100     ELSE
454200         IF EA-NO-RO-ZIP
454300             NEXT SENTENCE
454400         ELSE
454500             MOVE EA-RO-ZIP TO PO-RO-ZIP
454600         END-IF
454700     END-IF.
454800**************************************
454900*   OUT-OF-STATE ADDRESSES
455000**************************************
455100     IF PO-RO-ZIP = SPACE
455200         IF PO-REG-CO = 60
455300             SET IDX-NON TO 1
455400             MOVE 'F' TO WA-IND-F
455500             IF SW-MAIL-ADDRESS = 'N'
455600                 MOVE EA-ROCITY TO WA-CITY
ADDRSP                                WA-NAME-CITY-CHKLGTH
ADDRSP                 PERFORM 3004-CHECK-LNGTH-CITY
ADDRSP                 PERFORM 3008-CHECK-SPACES-CITY
ADDRPR                 PERFORM 3028-VALID-CITY2
455700             ELSE
455800                 MOVE WA-MAIL-CITY TO WA-CITY
ADDRSP                                      WA-NAME-CITY-CHKLGTH
ADDRSP                 PERFORM 3004-CHECK-LNGTH-CITY
ADDRSP                 PERFORM 3008-CHECK-SPACES-CITY
ADDRPR                 PERFORM 3025-VALID-CITY
455900             END-IF
456000             PERFORM 3000-FIND-FOREIGN
456100                      UNTIL IDX-NON = 98
456200         END-IF
456300     END-IF.
456400
456500/****************************
456600 2800-PROCESS-SPECIAL-HANDLE.
456700*****************************
265700D    DISPLAY '2800-PROCESS-SPECIAL-HANDLE.'.
265700     MOVE    '2800-PROCESS-SPECIAL-HANDLE.' TO WA-ERROR-PRM.

456800     SET IDX-IND-WA TO 1.
456900     SEARCH WA-INDS-R
457000     WHEN WA-IND (IDX-IND-WA) NOT = SPACE
457100         MOVE WA-IND (IDX-IND-WA) TO PO-SPEC-H.
457200
457300     IF E-CANT-HANDLE-ITEM
457400         MOVE 1 TO PO-SPEC-H
457500     ELSE
457600         GO TO 2820-EXEMPT-VAL.
457700     IF E-VIN-IS-TOO-LONG
457800         MOVE SPACE TO PO-VIN.
457900     IF E-RO-IS-TOO-LONG
458000         MOVE SPACE TO PO-SORT-ADS
458100                       PO-RON-A
458200         IF PO-ENHANCED-RENEWAL
458300             MOVE EA-RONM3 TO PO-RONM3
458400         ELSE
458500             NEXT SENTENCE.
458600     IF E-ENG-IS-TOO-LONG
458700         IF EA-ENG-EQUALS-VIN-55
458800             IF EA-MAX-VIN-LTH
458900                 MOVE SPACE TO PO-ENG
459000             ELSE
459100                 NEXT SENTENCE
459200         ELSE
459300             IF EA-MAX-ENG-LTH-1D
459400                 MOVE SPACE TO PO-ENG
459500             ELSE
459600                 NEXT SENTENCE.
459700
459800*******************
459900 2820-EXEMPT-VAL.
460000*******************
265700D    DISPLAY '2820-EXEMPT-VAL.            '.
265700     MOVE    '2820-EXEMPT-VAL.            ' TO WA-ERROR-PRM.

460100     IF TLP-NOT-EXEMPT
460200         NEXT SENTENCE
460300     ELSE
460400         MOVE 'X' TO PO-TYPE-REC
460500         IF PO-SPEC-H = '1'
460600             NEXT SENTENCE
460700         ELSE
460800             IF (TL-DISABLED-VET) OR
460900                 (POW-PREFIX AND LICENSE-BYTES4-7 NUMERIC)
461000                 MOVE ' ' TO PO-SPEC-H
461100             ELSE
461200                 IF TL-CMOH-EXEMPT
461300                     MOVE ' ' TO PO-SPEC-H
461400                 ELSE
461500                     MOVE 'X' TO PO-SPEC-H
461600                 END-IF
461700             END-IF
461800         END-IF
461900     END-IF.
462000
462100     IF WA-OR-FEE > ZERO
462200         MOVE WA-OR-FEE TO PO-OWN-FEE
462300         IF PO-SPEC-H = ' '
462400             MOVE '2' TO PO-SPEC-H.
462500
462600***********************
462700 2850-PROCESS-FHVUT.
462800***********************
265700D    DISPLAY '2850-PROCESS-FHVUT.         '.
265700     MOVE    '2850-PROCESS-FHVUT.         ' TO WA-ERROR-PRM.

462900     IF TL-HEAVY-VEH
CVRA          IF (PO-EXP-CCYY = 2001 AND PO-EXP-MO = 12) OR
CVRA                 (PO-EXP-CCYY > 2001)
CVRA              IF PO-CVRA-WEIGHT > '54999'
CVRA                 MOVE 'C' TO PO-FLAG-HVY-VEH
CVRA                 ADD 1 TO CTR-FHVUT
CVRA                 IF PO-SPEC-H = ' '
CVRA                   MOVE '3' TO PO-SPEC-H
CVRA                 END-IF
CVRA          END-IF
CVRA       END-IF
FHVUT *    THE FOLLOWING HAS BEEN COMMENTED OUT.  OUTGOING WILL
FHVUT *    ONLY ONLY REQUEST A FHVUT ON DEFAULTED CVRA OR THOSE
FHVUT *    VEHICLES THAT HAVE WEIGHT => 55000 CERTIFIED WEIGHT,
FHVUT *    POT BILLING NOTICE WILL MARK THIS WITH AN 'X' FHVUT
CVRA  *           ELSE
CVRA  *              IF PO-WGT > '08000'
CVRA  *                 MOVE 'Y' TO PO-FLAG-HVY-VEH
CVRA  *                 ADD 1 TO CTR-FHVUT
CVRA  *                 IF PO-SPEC-H = ' '
CVRA  *                   MOVE '3' TO PO-SPEC-H
CVRA  *                 END-IF
CVRA  *              END-IF
CVRA  *           END-IF
CVRA  *       ELSE
463000*          IF PO-WGT > '08000'
463100*             MOVE 'Y' TO PO-FLAG-HVY-VEH
463200*             ADD 1 TO CTR-FHVUT
463300*             IF PO-SPEC-H = ' '
CVRA  *                MOVE '3' TO PO-SPEC-H
CVRA  *             END-IF
CVRA  *          END-IF
CVRA  *       END-IF
CVRA  *    END-IF
RB0714***  IF PO-TL = '10'
RB0714     IF PO-TL = 'L2'
463600         IF EA-TV-COML
463700             NEXT SENTENCE
463800         ELSE
463900             MOVE SPACE TO PO-FLAG-HVY-VEH
464000             IF PO-SPEC-H = '3'
464100                 MOVE SPACE TO PO-SPEC-H
464200             ELSE
464300                 NEXT SENTENCE.
464400     IF EA-P
464500        MOVE SPACE TO WA-RO-NAME
464600        MOVE EA-RON TO WA-RO-NAME
464700        PERFORM 5100-TRANSFORM-NAME
464800        SET IDX-PGE TO 1
464900        MOVE 'N' TO SW-QUIT
465000        PERFORM 3030-FIND-PGE UNTIL IDX-PGE > 19
465100                              OR SW-QUIT = 'Y'
465200     ELSE
465300        NEXT SENTENCE.
465400
465500*****************
465600 2899-EXIT.
465700*****************
465800     EXIT.
465900
466000
466100/****************
466200 2900-RATING.
466300*****************
265700D    DISPLAY '2900-RATING.                '.
265700     MOVE    '2900-RATING.                ' TO WA-ERROR-PRM.

466400     MOVE ZERO TO PO-REG-FEE
466500                  PO-VLF-FEE
466600                  PO-WGT-FEE
466700                  PO-ELP-FEE
466800                  PO-COMBINED-COUNTY-FEE
466900                  PO-PENALTIES.
467000****************************************************
467100*  SET UP LINKAGE FOR RP032F                       *
467200*  PARAM 'D' RETURNS NO COUNTY FEES OR SMOG CODE.  *
467300****************************************************
468800*****USE CURRENT EXPIRATION YEAR FOR RATING************
469000
469800
471000*****RP032F-LK-MA-VALUE MOVED IN THE E SUBREC ROUTINE******
scanln     IF WA-SITUS-CNTY-CD = SPACE
472000         NEXT SENTENCE
472100     ELSE
472300         MOVE WA-SITUS-CNTY-NUM TO PO-SITUS-CNTY-CODE.
472500     MOVE WA-P-CNTY-CD TO PO-LESSE-CNTY-CODE.
472600     IF P-ZIP-LOW-VALUES
472800         MOVE ZERO  TO PO-LESSE-ZIP
472900     ELSE
473100         MOVE P-ZIP-CODE TO PO-LESSE-ZIP.
473500
473700*****RP032F-FLAG-GR-POLLUTER MOVED IN THE E SUBREC ROUTINE
473800
473900***************************************************
474000*   RP0326 WILL COMPUTE ITS OWN OWNER RESP. FEES  *
474100*   AND PARKING VIOLATION FEES.                   *
474200*   AS OF 6/91, PARKING FEES AREA ALSO USED TO LET*
474300*   RP032F KNOW THAT A PNO RECORD IS BEING RATED. *
474400***************************************************
475100
481400******************************************************
481500*  PASSING 'V' TO RP1526 SO THAT A 1 IS MOVED INTO   *
481600*  THE PROCESS CODE FIELD OF THE SCANLINE            *
481700******************************************************
481800*
481900*    IF DV-SPECIAL-PLT
482000*          MOVE 'V'              TO PO-FLAG-SINGLE-PLATE
482100*    END-IF.
482200**************************
482300 2950-WT-CODE.
482400**************************
265700D    DISPLAY '2950-WT-CODE.               '.
265700     MOVE    '2950-WT-CODE.               ' TO WA-ERROR-PRM.

482500     IF TL-VESSEL
482600         PERFORM 4500-VALIDATE-HULL-MATERIAL
482700         MOVE EA-VES-HULL-MAT TO PO-WGT-CODE
482800     ELSE
482900         MOVE SPACES TO PO-WGT-CODE.
483000
483100 2999-EXIT.
483200     EXIT.
483300
483400/*****************************************
483500*  S  U  B     R  O  U  T  I  N  E  S    *
483600******************************************
483700*********************
483800 3000-FIND-FOREIGN.
483900*********************
265700D    DISPLAY '3000-FIND-FOREIGN.          '.
265700     MOVE    '3000-FIND-FOREIGN.          ' TO WA-ERROR-PRM.

484000     SET IDX-NON-2 TO 1.
484100     SET IDX-CITY TO 1.
484200     PERFORM 3300-FIND-FOREIGN
484300              UNTIL IDX-NON-2 > NON-NBR-BYTES (IDX-NON).
484400     SET IDX-NON UP BY 1.
484500
ADDRSP 3002-CHECK-LNGTH-ADDR.
265700D    DISPLAY '3002-CHECK-LNGTH-ADDR.      '.
265700     MOVE    '3002-CHECK-LNGTH-ADDR.      ' TO WA-ERROR-PRM.

ADDRSP******************************
ADDRSP*  CHECK-LENGTH FOR ADDRESS
ADDRSP******************************
ADDRSP     PERFORM VARYING WA-LENGTH FROM 27 BY -1
ADDRSP         UNTIL WA-LENGTH = 0 OR
ADDRSP             WA-NAME-ADDR-CHKLGTH (WA-LENGTH : 1)
ADDRSP               NOT = SPACE
ADDRSP     END-PERFORM.
ADDRSP
ADDRSP 3004-CHECK-LNGTH-CITY.
265700D    DISPLAY '3004-CHECK-LNGTH-CITY.      '.
265700     MOVE    '3004-CHECK-LNGTH-CITY.      ' TO WA-ERROR-PRM.

ADDRSP******************************
ADDRSP*  CHECK-LENGTH FOR CITY
ADDRSP******************************
ADDRSP
ADDRSP     PERFORM VARYING WA-LENGTH-CITY FROM 13 BY -1
ADDRSP         UNTIL WA-LENGTH-CITY = 0 OR
ADDRSP             WA-NAME-CITY-CHKLGTH (WA-LENGTH-CITY : 1)
ADDRSP               NOT = SPACE
ADDRSP     END-PERFORM.
ADDRSP
ADDRSP 3006-CHECK-SPACES-ADD.
265700D    DISPLAY '3006-CHECK-SPACES-ADD.      '.
265700     MOVE    '3006-CHECK-SPACES-ADD.      ' TO WA-ERROR-PRM.

ADDRSP******************************
ADDRSP*  CHECK SPACES FOR ADDRESS
ADDRSP******************************
ADDRSP     MOVE 'N' TO SW-ADD-FLAG
ADDRSP     PERFORM VARYING WA-ADDCTR FROM 1 BY 1
ADDRSP         UNTIL WA-ADDCTR = WA-LENGTH  OR
ADDRSP            SW-ADD-FLAG = 'Y'
ADDRSP            IF WA-NAME-ADDR-CHKLGTH(WA-ADDCTR:2) = '  '
ADDRSP               MOVE 'Y' TO SW-ADD-FLAG
ADDRSP            END-IF
ADDRSP     END-PERFORM.

ADDRSP
ADDRSP 3008-CHECK-SPACES-CITY.
265700D    DISPLAY '3008-CHECK-SPACES-CITY.     '.
265700     MOVE    '3008-CHECK-SPACES-CITY.     ' TO WA-ERROR-PRM.

ADDRSP******************************
ADDRSP*  CHECK SPACES FOR CITY
ADDRSP******************************
ADDRSP     MOVE 'N' TO SW-CITY-FLAG
ADDRSP     PERFORM VARYING WA-CITYCTR FROM 1 BY 1
ADDRSP         UNTIL WA-CITYCTR = WA-LENGTH-CITY OR
ADDRSP            SW-CITY-FLAG = 'Y'
ADDRSP            IF WA-NAME-CITY-CHKLGTH(WA-CITYCTR:2) = '  '
ADDRSP               MOVE 'Y' TO SW-CITY-FLAG
ADDRSP            END-IF
ADDRSP     END-PERFORM.

ADDRPR 3010-M-VALID-ADDR1.
265700D    DISPLAY '3010-M-VALID-ADDR1.         '.
265700     MOVE    '3010-M-VALID-ADDR1.         ' TO WA-ERROR-PRM.

ADDRPR******************************
ADDRPR*                            *
ADDRPR*    VALIDATE MAIL ADDRESS 1 *
ADDRPR*                            *
ADDRPR******************************
ADDRSP     IF SW-ADD-FLAG = 'Y'
ADDRSP        PERFORM 4092-INVALID-ADDR
ADDRSP     ELSE
ADDRPR        SET IDX-ADD1 TO 1
ADDRPR        MOVE 'Y' TO SW-VALID-DATA
ADDRPR        PERFORM 27 TIMES
ADDRPR          MOVE WA-RO-ADDR1-CHAR(IDX-ADD1) TO WA-VALIDATION-CHAR
ADDRPR          PERFORM 4600-VALIDATE-ADDRESS THRU 4699-EXIT
ADDRPR          SET IDX-ADD1 UP BY 1
ADDRPR        END-PERFORM
ADDRSP     END-IF.

ADDRPR     IF SW-VALID-DATA = 'N'
ADDRPR        PERFORM 4092-INVALID-ADDR.
ADDRPR
ADDRPR 3015-M-VALID-ADDR2.
265700D    DISPLAY '3015-M-VALID-ADDR2.         '.
265700     MOVE    '3015-M-VALID-ADDR2.         ' TO WA-ERROR-PRM.

ADDRPR******************************
ADDRPR*                            *
ADDRPR*    VALIDATE MAIL ADDRESS 2 *
ADDRPR*                            *
ADDRPR******************************
ADDRSP     IF SW-ADD-FLAG = 'Y'
ADDRSP        PERFORM 4092-INVALID-ADDR
ADDRSP     ELSE
ADDRPR       SET IDX-ADD2 TO 1
ADDRPR       MOVE 'Y' TO SW-VALID-DATA
ADDRPR       PERFORM 27 TIMES
ADDRPR         MOVE WA-RO-ADDR2-CHAR(IDX-ADD2) TO WA-VALIDATION-CHAR
ADDRPR         PERFORM 4600-VALIDATE-ADDRESS THRU 4699-EXIT
ADDRPR         SET IDX-ADD2 UP BY 1
ADDRPR       END-PERFORM
ADDRSP     END-IF.
ADDRPR
ADDRPR     IF SW-VALID-DATA = 'N'
ADDRPR        PERFORM 4092-INVALID-ADDR.
ADDRPR
ADDRPR 3020-RO-VALID-ADDR.
265700D    DISPLAY '3020-RO-VALID-ADDR.         '.
265700     MOVE    '3020-RO-VALID-ADDR.         ' TO WA-ERROR-PRM.

ADDRPR*****************************
ADDRPR*                           *
ADDRPR*    VALIDATE RO ADDRESS    *
ADDRPR*                           *
ADDRPR*****************************
ADDRSP     IF SW-ADD-FLAG = 'Y'
ADDRSP        PERFORM 4092-INVALID-ADDR
ADDRSP     ELSE
ADDRPR       SET IDX-ADD3 TO 1
ADDRPR       MOVE 'Y' TO SW-VALID-DATA
ADDRPR      PERFORM 30 TIMES
ADDRPR         MOVE EA-RO-ADDR-CHAR(IDX-ADD3) TO WA-VALIDATION-CHAR
ADDRPR         PERFORM 4600-VALIDATE-ADDRESS THRU 4699-EXIT
ADDRPR         SET IDX-ADD3 UP BY 1
ADDRPR      END-PERFORM
ADDRPR     END-IF.
ADDRPR
ADDRPR     IF SW-VALID-DATA = 'N'
ADDRPR        PERFORM 4092-INVALID-ADDR.
ADDRPR
ADDRPR 3025-VALID-CITY.
265700D    DISPLAY '3025-VALID-CITY.            '.
265700     MOVE    '3025-VALID-CITY.            ' TO WA-ERROR-PRM.

ADDRPR*****************************
ADDRPR*                           *
ADDRPR*    VALIDATE CITY          *
ADDRPR*                           *
ADDRPR*****************************
ADDRSP     IF SW-CITY-FLAG = 'Y'
ADDRSP        PERFORM 4094-INVALID-CITY
ADDRSP     ELSE
ADDRPR       SET IDX-CIT1 TO 1
ADDRPR       MOVE 'Y' TO SW-VALID-DATA
ADDRPR      PERFORM 13 TIMES
ADDRPR         MOVE WA-MAIL-CITY-CHAR(IDX-CIT1) TO WA-VALIDATION-CHAR
ADDRPR         PERFORM 4700-VALIDATE-CITY THRU 4799-EXIT
ADDRPR         SET IDX-CIT1 UP BY 1
ADDRPR      END-PERFORM
ADDRPR     END-IF.
ADDRPR
ADDRPR     IF SW-VALID-DATA = 'N'
ADDRPR         PERFORM 4094-INVALID-CITY.
ADDRPR
ADDRPR 3028-VALID-CITY2.
265700D    DISPLAY '3028-VALID-CITY2.           '.
265700     MOVE    '3028-VALID-CITY2.           ' TO WA-ERROR-PRM.

ADDRPR*****************************
ADDRPR*                           *
ADDRPR*    VALIDATE CITY2         *
ADDRPR*                           *
ADDRPR*****************************
ADDRSP     IF SW-CITY-FLAG = 'Y'
ADDRSP        PERFORM 4094-INVALID-CITY
ADDRSP     ELSE
ADDRPR       SET IDX-ROCITY TO 1
ADDRPR       MOVE 'Y' TO SW-VALID-DATA
ADDRPR      PERFORM 13 TIMES
ADDRPR         MOVE EA-ROCITY-BYTE(IDX-ROCITY) TO WA-VALIDATION-CHAR
ADDRPR         PERFORM 4700-VALIDATE-CITY THRU 4799-EXIT
ADDRPR         SET IDX-ROCITY UP BY 1
ADDRPR      END-PERFORM
ADDRPR     END-IF.
ADDRPR
ADDRPR     IF SW-VALID-DATA = 'N'
ADDRPR         PERFORM 4094-INVALID-CITY.
ADDRPR
484600*********************
484700 3030-FIND-PGE.
484800*********************
265700D    DISPLAY '3030-FIND-PGE.              '.
265700     MOVE    '3030-FIND-PGE.              ' TO WA-ERROR-PRM.

484900     IF WA-RO-NAME-27 = TBL-PGE-NAME (IDX-PGE)
485000        MOVE 'Y' TO SW-QUIT
485100        IF PO-SPEC-H = ' '
485200           MOVE '4' TO PO-SPEC-H
485300        ELSE
485400           NEXT SENTENCE
485500     ELSE
485600        SET IDX-PGE UP BY 1.
485700
485800*********************
485900 3070-COUNT-BY-DATE.
486000*********************
265700D    DISPLAY '3070-COUNT-BY-DATE.         '.
265700     MOVE    '3070-COUNT-BY-DATE.         ' TO WA-ERROR-PRM.

486100     IF ARG-C01F-EXPIRATION-CCYY NOT > WA-SEL-YR
486200         ADD 1 TO CTR-OLD-DATES
486300         MOVE 'Y' TO SW-QUIT
486400     ELSE
486500         IF W-STAT-SEL-CNT (IDX-WRK) = ZERO
486600             MOVE EA-EXP-DT TO W-STAT-SEL-DT (IDX-WRK)
486700             MOVE 1 TO W-STAT-SEL-CNT (IDX-WRK)
486800             MOVE 'Y' TO SW-QUIT
486900         ELSE
487000             IF EA-EXP-DT = W-STAT-SEL-DT (IDX-WRK)
487100                 ADD 1 TO W-STAT-SEL-CNT (IDX-WRK)
487200                 MOVE 'Y' TO SW-QUIT
487300             ELSE
487400                 SET IDX-WRK UP BY 1.
487500
487600
487700*********************
487800 3071-COUNT-BY-DATE.
487900*********************
265700D    DISPLAY '3071-COUNT-BY-DATE.         '.
265700     MOVE    '3071-COUNT-BY-DATE.         ' TO WA-ERROR-PRM.

488000     IF W-STAT-SEL-NDR-CNT (IDX-NDR) = ZERO
488100         MOVE EA-EXP-DT TO W-STAT-SEL-NDR-DT (IDX-NDR)
488200         MOVE 1 TO W-STAT-SEL-NDR-CNT (IDX-NDR)
488300         MOVE 'Y' TO SW-QUIT
488400     ELSE
488500         IF EA-EXP-DT = W-STAT-SEL-NDR-DT (IDX-NDR)
488600             ADD 1 TO W-STAT-SEL-NDR-CNT (IDX-NDR)
488700             MOVE 'Y' TO SW-QUIT
488800         ELSE
488900             SET IDX-NDR UP BY 1.
489000
489100
490000/**********************
490100 3200-BUILD-OP-CIT.
490200***********************
265700D    DISPLAY '3200-BUILD-OP-CIT.          '.
265700     MOVE    '3200-BUILD-OP-CIT.          ' TO WA-ERROR-PRM.

490300     ADD 1 TO PO-NBRCIT.
490400     ADD G-BAIL (IDX-G-R) TO PO-CITFEE.
490500     IF PO-CITLST = 12
490600         MOVE 'OVERFL' TO G-OVERFL (IDX-G-R)
490700     ELSE
490800         MOVE G-CIT-NBR (IDX-G-R) TO PO-CIT-NBR (IDX-PO)
490900         MOVE '  /  /    ' TO PO-VIOL-DT (IDX-PO)
491000         MOVE G-VIOL-MO (IDX-G-R) TO PO-VIOL-MO (IDX-PO)
491100         MOVE G-VIOL-DA (IDX-G-R) TO PO-VIOL-DA (IDX-PO)
491200         MOVE G-VIOL-YR (IDX-G-R) TO PO-VIOL-YR (IDX-PO)
491300         MOVE ZERO TO PO-VIOL-CC(IDX-PO)
491400         MOVE G-COURT-CD (IDX-G-R) TO PO-COURT-CD (IDX-PO)
491500         MOVE G-BAIL (IDX-G-R) TO PO-BAIL (IDX-PO)
491600         PERFORM 3250-GET-COURT-NAME
491700         ADD 1 TO PO-CITLST
491800         SET IDX-PO UP BY 1
491900     END-IF.
492000***********************
492100 3250-GET-COURT-NAME.
492200***********************
265700D    DISPLAY '3250-GET-COURT-NAME.        '.
265700     MOVE    '3250-GET-COURT-NAME.        ' TO WA-ERROR-PRM.

492300     SEARCH ALL COURT-ENTRIES
492400     WHEN COURT-CODE (IDX-COURT) = PO-COURT-CD (IDX-PO)
492500         MOVE COURT-NAME (IDX-COURT) TO
492600                  PO-COURT-NAME (IDX-PO).
492700
492800***********************
492900 3300-FIND-FOREIGN.
493000***********************
265700D    DISPLAY '3300-FIND-FOREIGN.          '.
265700     MOVE    '3300-FIND-FOREIGN.          ' TO WA-ERROR-PRM.

493100     IF WA-CITY-BYTE (IDX-CITY) =
493200              NON-FORGN-BYTE (IDX-NON IDX-NON-2)
493300         IF IDX-NON-2 = NON-NBR-BYTES (IDX-NON)
493400             MOVE SPACE TO WA-IND-F
493500             SET IDX-NON TO 97
493600         ELSE
493700             NEXT SENTENCE
493800     ELSE
493900         SET IDX-NON-2 TO NON-NBR-BYTES (IDX-NON).
494000     SET IDX-NON-2 UP BY 1.
494100     SET IDX-CITY UP BY 1.
494200
494300/**********************
494400 3400-YFS-ZERO-CHECK-AST-YR.
494700***********************
265700D    DISPLAY '3400-YFS-ZERO-CHECK-AST-YR. '.
265700     MOVE    '3400-YFS-ZERO-CHECK-AST-YR. ' TO WA-ERROR-PRM.

494700***********************
494500* FOR MOST VEHICLES, IF THERE IS NO YEAR FIRST SOLD, THERE
494600* MUST BE AN ASTERISK YEAR
494700***********************
494800         IF EA-TV-HISTORICAL OR TL-VESSEL
494900             NEXT SENTENCE
495000         ELSE
495100             IF ARG-C01F-ASTERISK-YEAR NOT NUMERIC
495200                 MOVE WA-INVALID-YR-SOLD TO WA-ERROR-MSG
495300                 PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
495400                 PERFORM 4300-COUNT-ERRORS.
495500
495600***********************
495700 3600-SET-FILE-CODE.
495800***********************
265700D    DISPLAY '3600-SET-FILE-CODE.         '.
265700     MOVE    '3600-SET-FILE-CODE.         ' TO WA-ERROR-PRM.

495900******************** ********************************************
CVRA  * PO-FILE-CODE     * * (CVRA) CHG PO-FILE-CODE TO A 2 BYTE FIELD*
496100******************** ********************************************
497700********************
497800* PO-Z-SUSPENSE    *
497900********************
498000*    IF WA-FLAG-RCC33 = 7
498100*        MOVE '7' TO PO-Z-SUSPENSE
498200*    ELSE
498300*      IF (WA-FLAG-RCC33 = 8) OR EA-TL-C0-C7 OR TYPE-RECORD-5
498400*         MOVE '8' TO PO-Z-SUSPENSE
498500*      ELSE
498600*         CONTINUE
498700*      END-IF
498800*    END-IF.

           EVALUATE TRUE
496200        WHEN TL-VESSEL
496300           MOVE 'G ' TO PO-FILE-CODE
496400           GO TO 3699-EXIT
496500        WHEN TL-OHV
496700             MOVE 'F ' TO PO-FILE-CODE
496800             GO TO 3699-EXIT
496900        WHEN TL-DPP
497100             MOVE 'P ' TO PO-FILE-CODE
497200             GO TO 3699-EXIT
497300        WHEN TL-SPEC-EQUIP
497500             MOVE 'H ' TO PO-FILE-CODE
497600             GO TO 3699-EXIT
              WHEN DELINQUENT-REG
                   MOVE 'N ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN SPU-E33-RCC7
                   MOVE 'Z ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN RPU-SUSPENSE-ITR AND PNO-02
                   MOVE 'Z ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN PNO-02
                   MOVE '4 ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN TYPE-RECORD-5 OR EA-TL-C0-C7 OR RPU-SUSPENSE-ITR
                   MOVE 'J ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN TLP-EXEMPT-FLAG = 'Y'
                   MOVE 'M ' TO PO-FILE-CODE
                   GO TO 3699-EXIT
              WHEN OTHER
                   MOVE '2 ' TO PO-FILE-CODE
           END-EVALUATE.

501000
501100 3699-EXIT.
501200     EXIT.
501300/******************
501400 3700-HIST-TV-VAL.
501500*******************
265700D    DISPLAY '3700-HIST-TV-VAL.           '.
265700     MOVE    '3700-HIST-TV-VAL.           ' TO WA-ERROR-PRM.

501600     IF EA-TL = 'V3' OR 'V4'
501700         IF EA-TV-VSL-NON-RES
501800             PERFORM 4040-INVALID-TV.
501900     IF EA-TV-HISTORICAL-MC
502000        IF EA-TL = 'H2' OR 'H4'
502100           NEXT SENTENCE
502200        ELSE
502300           PERFORM 4040-INVALID-TV
502400     ELSE
502500         IF EA-TV-HISTORICAL-TRLR
502600            IF EA-TL = 'H8' OR 'H9'
502700               NEXT SENTENCE
502800            ELSE
502900               PERFORM 4040-INVALID-TV
503000         ELSE
503100            SEARCH HIST-TLS-R
503200                      VARYING IDX-HIST END
503300               PERFORM 4040-INVALID-TV
503400                  WHEN EA-TL = HIST-TL (IDX-HIST)
503500                     NEXT SENTENCE.
503700*****************
503800*3750-GEN-OLD-TV.
503900*****************
504000*    SEARCH ALL TV-ENTRIES END
504100*        PERFORM 4040-INVALID-TV
504200*        WHEN TV-CLASS (IDX-TV) = WA-TV-SRCH-KEY
504300*            MOVE TV-OLD (IDX-TV) TO PO-TV.
504400
504500**********************
504600 3800-SRCH-ENDMO-TBL.
504700**********************
265700D    DISPLAY '3800-SRCH-ENDMO-TBL.        '.
265700     MOVE    '3800-SRCH-ENDMO-TBL.        ' TO WA-ERROR-PRM.

504800     SEARCH END-MO-R
504900              VARYING IDX-MO END
505000         PERFORM 4050-INVALID-EXPDT
505100         WHEN EA-EXP-MODA = END-MODA (IDX-MO)
505200             NEXT SENTENCE.
505300
505400*******************
505500 3850-VAL-END-MO.
505600*******************
265700D    DISPLAY '3850-VAL-END-MO.            '.
265700     MOVE    '3850-VAL-END-MO.            ' TO WA-ERROR-PRM.

505700     IF TL-VAL-ENDMO OR TL-COML-VEH
505800         NEXT SENTENCE
505900     ELSE
506000         IF TL-OHV
506100             IF EA-EXP-MODA = '0630'
506200                 NEXT SENTENCE
506300             ELSE
506400                 PERFORM 4050-INVALID-EXPDT
506500         ELSE
506600             IF EA-VLF-CL = 'MA'
506700                 NEXT SENTENCE
506800             ELSE
506900                 PERFORM 4050-INVALID-EXPDT.
507000
507100/*****************
507200 3900-ITT-OUT.
507300******************
265700D    DISPLAY '3900-ITT-OUT.               '.
265700     MOVE    '3900-ITT-OUT.               ' TO WA-ERROR-PRM.

507400     IF SW-ITT = 'Y'
507500         GO TO 3920-WRITE-ITT.
507600     OPEN OUTPUT ITTOUT.
507700     MOVE 'Y' TO SW-ITT.
507800
507300******************
507900 3920-WRITE-ITT.
507300******************
265700D    DISPLAY '3920-WRITE-ITT.             '.
265700     MOVE    '3920-WRITE-ITT.             ' TO WA-ERROR-PRM.

508000     ADD 1 TO ITT-MLN.
508100     MOVE EA-TL TO ITT-TL.
508200     MOVE EA-LICENSE-NUM TO ITT-LIC-NBR.
508300     MOVE EA-RONM5 TO ITT-RONM5.
508400     MOVE EA-VIN3 TO ITT-VIN3.
508500     MOVE ITT-OUTPUT TO ITT-OUT.
508600     WRITE ITT-OUT.
508700     ADD 1 TO CTR-ITT.
508800
508900 3949-EXIT.
509000     EXIT.
509100/
507100/*****************
507200 3950-ITT-OUT2.
507300******************
265700D    DISPLAY '3950-ITT-OUT2.              '.
265700     MOVE    '3950-ITT-OUT2.              ' TO WA-ERROR-PRM.

507400     IF SW-ITT2 = 'Y'
507500         GO TO 3970-WRITE-ITT2.
507600     OPEN OUTPUT ITTOUT2.
507700     MOVE 'Y' TO SW-ITT2.
507800
507900 3970-WRITE-ITT2.
265700D    DISPLAY '3970-WRITE-ITT2.            '.
265700     MOVE    '3970-WRITE-ITT2.            ' TO WA-ERROR-PRM.

508000     ADD 1 TO ITT2-MLN.
508100     MOVE EA-TL TO ITT2-TL.
508200     MOVE EA-LICENSE-NUM TO ITT2-LIC-NBR.
508400     MOVE EA-VIN3 TO ITT2-VIN3.
SB1500     MOVE 'D' TO ITT2-ACTION-CD.
SB1500     MOVE WS-BYTE-2A TO ITT2-END-MGS.
508500     MOVE ITT-OUTPUT2 TO ITT-OUT2.
508600     WRITE ITT-OUT2.
508700     ADD 1 TO CTR-ITT2.
508800
508900 3999-EXIT.
509000     EXIT.
509100/
513200/*************************************
513300*  COMMON ERROR MESSAGE ROUTINES     *
513400**************************************
513500 4010-INVALID-TL.
513600     MOVE 'INVALID TL' TO WA-ERROR-MSG.
513700     MOVE CR-TYPE-LIC TO EA-TL.
513800     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
513900     PERFORM 4300-COUNT-ERRORS.
RB0714***
RB0714 4011-obsolete-type-license-Tbl.
RB0714     MOVE WA-ERROR-MSG1           TO WA-ERROR-MSG.
RB0714     MOVE CR-TYPE-LIC             TO EA-TL.
RB0714     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
RB0714     PERFORM 4300-COUNT-ERRORS
RB0714     .
RB0714 4012-obsolete-type-license-Mas.
RB0714     MOVE WA-ERROR-MSG2           TO WA-ERROR-MSG.
RB0714     MOVE CR-TYPE-LIC             TO EA-TL.
RB0714     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
RB0714     PERFORM 4300-COUNT-ERRORS
RB0714     .
RB0714***-------------------------------------------------
514000
514100 4020-WGT-ERROR.
514200     MOVE 'INVALID WEIGHT/ OR AXLES' TO WA-ERROR-MSG.
514300     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
514400     PERFORM 4300-COUNT-ERRORS.
514500
CVRAPR 4023-UNL-WGT-CVRA-WGT-ERROR.
           MOVE 'UNLADEN WGT > GVW/CGW WGT' TO WA-ERROR-MSG.
CVRAPR     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
CVRAPR     PERFORM 4300-COUNT-ERRORS.
CVRAPR
DPWGT  4025-TL-VS-WEIGHT-ERROR.
DPWGT      MOVE 'TYPE LIC VS UNLADEN WGT' TO WA-ERROR-MSG.
DPWGT      PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
DPWGT      PERFORM 4300-COUNT-ERRORS.
DPWGT
514600 4030-YFS-ERROR.
514700     MOVE 'INVALID YR SOLD' TO WA-ERROR-MSG.
514800     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
514900     PERFORM 4300-COUNT-ERRORS.
515000
515100 4040-INVALID-TV.
515200     MOVE 'INVALID TV' TO WA-ERROR-MSG.
515300     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
515400     PERFORM 4300-COUNT-ERRORS.
515500
NONCOM 4045-NO-E49.
NONCOM     MOVE 'NO E49 ON RECORD' TO WA-ERROR-MSG.
NONCOM     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
NONCOM     PERFORM 4300-COUNT-ERRORS.
NONCOM
NONCOM 4047-TL-RCC-ERROR.
NONCOM     MOVE 'TL-INVALID-ERROR' TO WA-ERROR-MSG.
NONCOM     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
NONCOM     PERFORM 4300-COUNT-ERRORS.
NONCOM
515600 4050-INVALID-EXPDT.
516100     MOVE 'INVALID EXPIRATION DATE' TO WA-ERROR-MSG
515700     IF SW-EXP = 'Y'
515800         NEXT SENTENCE
515900     ELSE
516000         MOVE 'Y' TO SW-EXP
516200         PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN
516300         PERFORM 4300-COUNT-ERRORS.
516400
516500 4060-LIC-NOT-VALID.
265700D    DISPLAY '4060-LIC-NOT-VALID.  '.
265700     MOVE    '4060-LIC-NOT-VALID.  ' TO WA-ERROR-PRM.

516600     MOVE 'INVALID LICENSE PATTERN' TO WA-ERROR-MSG.
516700     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
516800     PERFORM 4300-COUNT-ERRORS.
POWE36*
POWE36*4065-MISSING-POW-SUBRECORD.
POWE36*    MOVE 'POW W/NO EXEMPTION' TO WA-ERROR-MSG.
POWE36*    PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
POWE36*    PERFORM 4300-COUNT-ERRORS.
LIVERY
LIVERY 4067-BTM-INVALID-LIVERY.
LIVERY     MOVE 'BTM INVALID FOR LIVERY' TO WA-ERROR-MSG.
LIVERY     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
LIVERY     PERFORM 4300-COUNT-ERRORS.
516900
RB1616 4068-TL-INVALID-RO-BTM.
RB1616     MOVE 'TL INVALID FOR BTM RO' TO WA-ERROR-MSG.
RB1616     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
RB1616     PERFORM 4300-COUNT-ERRORS.
RB1616
517000 4070-INVALID-REASON-CD.
517100     MOVE WA-INVALID-REASON-CD TO WA-ERROR-MSG.
517200     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
517300     PERFORM 4300-COUNT-ERRORS.
517400
516500 4075-INVALID-BTC-FOR-PICKUP.
516600     MOVE 'BODY TYPE P > 8000#' TO WA-ERROR-MSG.
516700     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
516800     PERFORM 4300-COUNT-ERRORS.
516900
517500 4080-INVALID-TYPE-BODY.
517600     MOVE 'INVALID TYPE BODY' TO WA-ERROR-MSG.
517700     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
517800     PERFORM 4300-COUNT-ERRORS.
517900
518000 4085-INVALID-SITUS-CNTY.
518100     MOVE 'INVALID SITUS CNTY CD' TO WA-ERROR-MSG.
518200     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
518300     PERFORM 4300-COUNT-ERRORS.
518400
518500 4090-INVALID-LESSE-CNTY.
518600     MOVE 'INVALID LESSE CNTY CD' TO WA-ERROR-MSG.
518700     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
518800     PERFORM 4300-COUNT-ERRORS.
518900
ADDRPR 4092-INVALID-ADDR.
ADDRPR     MOVE 'INVALID CHAR IN ADDRESS' TO WA-ERROR-MSG.
ADDRPR     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
ADDRPR     PERFORM 4300-COUNT-ERRORS.
ADDRPR
ADDRPR 4094-INVALID-CITY.
ADDRPR     MOVE 'INVALID CHAR IN CITY' TO WA-ERROR-MSG.
ADDRPR     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
ADDRPR     PERFORM 4300-COUNT-ERRORS.
ADDRPR
519000 4095-INVALID-REG-CNTY.
519100     MOVE 'INVALID REGISTERED COUNTY' TO WA-ERROR-MSG.
519200     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
519300     PERFORM 4300-COUNT-ERRORS.
519400
519500 4097-INVALID-ARB-SUBREC.
519600     MOVE 'INVALID E74 (ARB) SUBREC'  TO WA-ERROR-MSG.
519700     PERFORM 4100-PROCESS-ERROR THRU 4199-RETURN.
519800     PERFORM 4300-COUNT-ERRORS.
519900
520000/***************************
520100 4100-PROCESS-ERROR.
520200****************************
      *    MOVE WA-ERROR-MSG  TO MS-TITLE.
      *    MOVE O-EXT         TO MS-POT2.
      *    WRITE POT-OUT-1 FROM MS-ERROR.
      *    WRITE POT-OUT-1 FROM EA-EXPLOSION-AREA.
      *    MOVE SPACE TO  MS-ERROR.
520300     MOVE 'Y' TO SW-ERROR.
520400     IF CTR-ERR-LINE > 54 OR ERR-PAGE-NBR = ZERO
520500         PERFORM
520600             MOVE WA-RPT-DATE    TO ERR-DATE
520700             MOVE ZERO           TO CTR-ERR-LINE
520800             ADD  1              TO ERR-PAGE-NBR
520900             WRITE REPORT-LINE FROM ERR-HEAD-1
521000             WRITE REPORT-LINE FROM ERR-HEAD-2
521100             WRITE REPORT-LINE FROM ERR-HEAD-3
521200             WRITE REPORT-LINE FROM ERR-DETAIL
521300             MOVE 1              TO ERR-MSG-CNT
521400         END-PERFORM
521500     END-IF.
521600     GO TO 4110-1ST-HALF
521700           4120-2ND-HALF
521800              DEPENDING ON ERR-MSG-CNT.
521900
522000 4110-1ST-HALF.
522100     IF EA-LICENSE-NUM    = WA-LIC-NBR
522200         MOVE '*'               TO ERR-ASK-1
522300     ELSE
522400         MOVE EA-LICENSE-NUM    TO WA-LIC-NBR
522500     END-IF.
522600     MOVE EA-LICENSE-NUM        TO ERR-LIC-NBR-1.
522700     MOVE EA-EXP-YR             TO ERR-EXP-YR-1.
522800     MOVE EA-VIN3               TO ERR-VIN3-1.
522900     MOVE EA-TL                 TO ERR-TL-1.
523000     MOVE EA-RONM3              TO ERR-RONM3-1.
523100     MOVE WA-ERROR-MSG          TO ERR-MSG-1.
523200     MOVE 2                     TO ERR-MSG-CNT.
523300     GO TO 4199-RETURN.
523400
523500 4120-2ND-HALF.
523600     IF EA-LICENSE-NUM    = WA-LIC-NBR
523700         MOVE '*'               TO ERR-ASK-2
523800     ELSE
523900         MOVE EA-LICENSE-NUM    TO WA-LIC-NBR
524000     END-IF.
524100     MOVE EA-LICENSE-NUM        TO ERR-LIC-NBR-2.
524200     MOVE EA-EXP-YR             TO ERR-EXP-YR-2.
524300     MOVE EA-VIN3               TO ERR-VIN3-2.
524400     MOVE EA-TL                 TO ERR-TL-2.
524500     MOVE EA-RONM3              TO ERR-RONM3-2.
524600     MOVE WA-ERROR-MSG          TO ERR-MSG-2.
524700     WRITE REPORT-LINE        FROM ERR-DETAIL.
524800     MOVE SPACE                 TO ERR-DETAIL.
524900     ADD  1                     TO CTR-ERR-LINE.
525000     MOVE 1                     TO ERR-MSG-CNT.
525100
525200 4199-RETURN.
525300     MOVE SPACE                 TO WA-ERROR-MSG.
525400/
525500****************************
525600 4200-BYPASS-COUNTING.
525700****************************
265700D    DISPLAY '4200-BYPASS-COUNTING.       '.
265700     MOVE    '4200-BYPASS-COUNTING.       ' TO WA-ERROR-PRM.

525800***********************************************************
525900*   BECAUSE EXPIRATION DATE IS STILL UNEXPLODED, TL 'N2'  *
526000*   WILL ALL BE COUNTED AS IF "CURRENT". TYPE REC 7, TOO. *
526100***********************************************************
526200     IF SW-BYPASS-REC = 'Y'
526300         ADD 1 TO CTR-BYP-DUPS.
526400
526500     IF ARG-C01F-EXPIRATION-DATE  < WA-CURR-DATE-IN
526600         ADD 1             TO CTR-BYP-EXPIRED
526700         IF DELINQUENT-REG
526800             SET IDX-BYP   TO 2
526900         ELSE
527000             SET IDX-BYP   TO 3
527100         END-IF
527200     ELSE
527300         ADD 1             TO CTR-BYP-REG
527400         SET IDX-BYP       TO 1
527500     END-IF.
527600
527700     MOVE 'Y'              TO SW-BYPASS-REC.
527800
527900     IF EXT-RID-8516
528000        ADD 1              TO CTR-STAT-8516-BYP
528100     ELSE
528200        IF DMVA-REC
528300           ADD 1           TO CTR-STAT-8519-BYP
528400        ELSE
528500           IF EXT-RID-8515
528600              ADD 1        TO CTR-STAT-8515-BYP
                   IF EXT-RC8271
                       ADD 1 TO CTR-STAT-R66-BYP
                   ELSE
                       ADD 1 TO CTR-STAT-R66-BYP
                   END-IF
528700           ELSE
528800              IF EXT-RID-4401
528900                 ADD 1     TO CTR-STAT-4401-BYP
529000              ELSE
529100                 IF DELINQUENT-REG
529200                    ADD 1  TO CTR-STAT-NDR-BYP
529300                 END-IF
529400              END-IF
529500           END-IF
529600        END-IF
529700     END-IF.
529800
529900****************************
530000*4220-BYPASS-DETAIL.
530100****************************
530200*  USED TO LIST LICENSE NUMBERS ON BYPASS REPORT OF POTS
530300*  WITH PARTICULAR TYPES OF PROBLEMS.
530400****************************
530500
530600************************
530700 4250-CHECK-MAIL-CODES.
530800************************
265700D    DISPLAY '4250-CHECK-MAIL-CODES.      '.
265700     MOVE    '4250-CHECK-MAIL-CODES.      ' TO WA-ERROR-PRM.

530900*  ROUTINE TO FIND LAST UNCLAIMED MAIL CODE IN E-20 ADD'L DATA
531000*
531100     MOVE 'N' TO SW-MAIL-RETURNED
531200     IF E-20-ADDL-DATA-LTH (IDX-E) = LOW-VALUE
531300         CONTINUE
531400     ELSE
531500         SET IDX-E20 TO 1
531600         PERFORM UNTIL E-20-RETURN-MAIL-CD (IDX-E IDX-E20)
531700                                 NOT > SPACE
531800                             OR  IDX-E20 > 6
531900             SET IDX-E20 UP BY 1
532000         END-PERFORM
532100         SET IDX-E20 DOWN BY 1
532200         EVALUATE E-20-RETURN-MAIL-CD (IDX-E IDX-E20)
532300             WHEN    'PR'
532400                 MOVE 'Y' TO SW-MAIL-RETURNED
532500             WHEN    'PD'
532600                 MOVE 'Y' TO SW-MAIL-RETURNED
532700             WHEN    'RR'
532800                 MOVE 'Y' TO SW-MAIL-RETURNED
532900             WHEN    'RD'
533000                 MOVE 'Y' TO SW-MAIL-RETURNED
533100             WHEN    'LR'
533200                 MOVE 'Y' TO SW-MAIL-RETURNED
533300             WHEN    'LD'
533400                 MOVE 'Y' TO SW-MAIL-RETURNED
533500             WHEN    'SD'
533600                 MOVE 'Y' TO SW-MAIL-RETURNED
533700             WHEN    'UV'
533800                 MOVE 'Y' TO SW-MAIL-RETURNED
533900             WHEN    'OS'
534000                 MOVE 'Y' TO SW-MAIL-RETURNED
534100             WHEN    'DE'
534200                 MOVE 'Y' TO SW-MAIL-RETURNED
534300             WHEN    'AP'
534400                 MOVE 'Y' TO SW-MAIL-RETURNED
534500             WHEN    'SE'
534600                 MOVE 'Y' TO SW-MAIL-RETURNED
534700             WHEN    'NC'
534800                 MOVE 'Y' TO SW-MAIL-RETURNED
534900         END-EVALUATE
535000     END-IF.
535100/
535200*********************
535300 4300-COUNT-ERRORS.
535400*********************
265700D    DISPLAY 'WA-ERROR-PRM: ' WA-ERROR-PRM.
265700D    DISPLAY 'WA-ERROR-MSG: ' WA-ERROR-MSG.
265700D    DISPLAY '4300-COUNT-ERRORS.          '.
265700     MOVE    '4300-COUNT-ERRORS.          ' TO WA-ERROR-PRM.

535500     IF ERROR-IS-COUNTED
535600         ADD 1 TO CTR-ERROR-DUPS
535700     ELSE
535800         ADD 1 TO CTR-ERROR
535900         MOVE 'Y'  TO SW-ERR-COUNTED
536000     END-IF.
536100
536200
536300****************************
536400 4500-VALIDATE-HULL-MATERIAL.
536500****************************
265700D    DISPLAY '4500-VALIDATE-HULL-MATERIAL.'.
265700     MOVE    '4500-VALIDATE-HULL-MATERIAL.' TO WA-ERROR-PRM.

536600     MOVE EA-VES-HULL-MAT TO WA-VALIDATION-CHAR.
536700     MOVE 'Y' TO SW-VALID-DATA.
536800*     PERFORM 5000-VALIDATE-CHARACTER THRU 5099-EXIT.
536900     IF SW-VALID-DATA = 'N'
537000         MOVE SPACE TO EA-VES-HULL-MAT.
537100
537300****************************
ADDRPR 4600-VALIDATE-ADDRESS.
ADDRPR****************************
265700D    DISPLAY '4600-VALIDATE-ADDRESS.      '.
265700     MOVE    '4600-VALIDATE-ADDRESS.      ' TO WA-ERROR-PRM.

ADDRPR     SET IDX-ADD TO 1.
ADDRPR     SEARCH TBL-INVALID-ADDR-CHAR
ADDRPR         WHEN WA-VALIDATION-CHAR = TBL-INVALID-ADDR-CHAR(IDX-ADD)
ADDRPR           MOVE 'N' TO SW-VALID-DATA
ADDRPR              GO TO 4699-EXIT.
ADDRPR
ADDRPR 4699-EXIT.
ADDRPR     EXIT.
537300****************************
ADDRPR 4700-VALIDATE-CITY.
ADDRPR****************************
265700D    DISPLAY '4700-VALIDATE-CITY.         '.
265700     MOVE    '4700-VALIDATE-CITY.         ' TO WA-ERROR-PRM.

ADDRPR     SET IDX-CIT TO 1.
ADDRPR     SEARCH TBL-INVALID-CITY-CHAR
ADDRPR       WHEN WA-VALIDATION-CHAR = TBL-INVALID-CITY-CHAR(IDX-CIT)
ADDRPR         MOVE 'N' TO SW-VALID-DATA
ADDRPR             GO TO 4799-EXIT.
ADDRPR
ADDRPR 4799-EXIT.
ADDRPR     EXIT.
538400
537200
537300/***************************
537400 5000-VALIDATE-CHARACTER.
537500****************************
265700D    DISPLAY '5000-VALIDATE-CHARACTER.    '.
265700     MOVE    '5000-VALIDATE-CHARACTER.    ' TO WA-ERROR-PRM.

537600     SET IDX-CHAR TO 1.
537700     SEARCH TBL-VALID-CHAR-ENTRY
537800         AT END MOVE 'N' TO SW-VALID-DATA
537900         WHEN WA-VALIDATION-CHAR = TBL-VALID-CHAR-ENTRY(IDX-CHAR)
538000             GO TO 5099-EXIT.
538100
538200 5099-EXIT.
538300     EXIT.
538400
538500****************************
538600 5100-TRANSFORM-NAME.
538700****************************
265700D    DISPLAY '5100-TRANSFORM-NAME.        '.
265700     MOVE    '5100-TRANSFORM-NAME.        ' TO WA-ERROR-PRM.

538800     SET IDX-NAME TO 1.
538900     PERFORM 5150-REPLACE-INVALID-CHAR
539000         UNTIL IDX-NAME > 30.
539100
539200****************************
539300 5150-REPLACE-INVALID-CHAR.
539400****************************
265700D    DISPLAY '5150-REPLACE-INVALID-CHAR.  '.
265700     MOVE    '5150-REPLACE-INVALID-CHAR.  ' TO WA-ERROR-PRM.

539500     SET IDX-INV TO 1.
539600     SEARCH TBL-INVALID-CHAR-ENTRY
539700         WHEN TBL-INVALID-CHAR-ENTRY(IDX-INV) =
539800                                     WA-RO-NAME-CHAR (IDX-NAME)
539900             MOVE SPACE TO WA-RO-NAME-CHAR (IDX-NAME).
540000     SET IDX-NAME UP BY 1.
540100
540200****************************
540300 5200-SAVE-SMOG-ADDRESS.
540200****************************
265700D    DISPLAY '5200-SAVE-SMOG-ADDRESS.     '.
265700     MOVE    '5200-SAVE-SMOG-ADDRESS.     ' TO WA-ERROR-PRM.

540400*********************************************************
540500*  OUT-OF-STATE ADDRESS INFO NEEDED BY SMOG MODULE WILL *
540600*  BE PASSED DOWNSTREAM TO RP0826 IN THE PTOUT1 RECORD. *
540700*********************************************************
540800     IF PO-REG-CO = 60
540900         IF PO-RO3-IND = 'A'
541000             MOVE PO-RO3 TO PO-OS-SMOG-ADDR
541100         ELSE
541200             IF PO-RO2-IND = 'A'
541300                 MOVE PO-RO2 TO PO-OS-SMOG-ADDR
541400             ELSE
541500                 MOVE PO-SORT-ADS TO PO-OS-SMOG-ADDR
541600             END-IF
541700         END-IF
541800     END-IF.
541900
JC0201/***************************
JC0201 5300-PROCESS-MAIL-ADDR.
JC0201****************************
265700D    DISPLAY '5300-PROCESS-MAIL-ADDR.     '.
265700     MOVE    '5300-PROCESS-MAIL-ADDR.     ' TO WA-ERROR-PRM.

JC0201*  THE FOLLOWING CALL WAS ADDED TO GET THE CENTURY FOR
JC0201*  THE CONDITION DATE ON SUBRECORD E64 MAILING ADDRESS INFO
JC0201         MOVE LOW-VALUES TO WS-LINKAGE-LIST.
JC0201         INITIALIZE WS-LINK-BACK-PGM
JC0201             WS-TRANS-DATA
JC0201             WS-CURRENT-DATE.
JC0201**** SET UP INPUT DATE PARAMETERS HERE*********
JC0201         MOVE 'A' TO ARG-IN-REQUEST-FORMAT.
JC0201         MOVE 'D' TO ARG-IN-DATE-FORMAT.
JC0201         MOVE E-COND-DATE(IDX-E) TO ARG-IN-DATE.
JC0201
JC0201             CALL 'OR1582'
JC0201              USING
JC0201               BY REFERENCE
JC0201                WS-LINK-BACK-PGM,
JC0201                WS-LINKAGE-LIST,
JC0201                WS-RETURN-CODE,
JC0201                WS-TRANS-DATA,
JC0201                WS-CURRENT-DATE,
JC0201               ON EXCEPTION
JC0201                MOVE 9 TO WS-RETURN-CODE
JC0201             END-CALL.
JC0201
JC0201             EVALUATE WS-RETURN-CODE
JC0201               WHEN ZERO
JC0201                  MOVE ARG-OUT-DATE-CCYYMMDD TO E64-MAIL-ADDR-DATE
JC0201               WHEN OTHER
JC0201                  GO TO 5399-EXIT
JC0201             END-EVALUATE.
JC0201 5399-EXIT.
JC0201     EXIT.
JC0201
JC0201
542000/***************************
542100 5500-PROCESS-PNO.
542200****************************
265700D    DISPLAY '5500-PROCESS-PNO.           '.
265700     MOVE    '5500-PROCESS-PNO.           ' TO WA-ERROR-PRM.

542300**************************************************
542400*  PNO GOOD UNTIL NEXT YEAR ARE BYPASSED.        *
542500*  PNO EXPIRED; IF VEHICLE ALSO EXPIRED - BYPASS.*
542600*  'C' = CURRENT OHV (NOT DUE UNTIL NEXT YEAR)   *
542700*  'D' = OHV PNO DUE FOR RENEWAL                 *
542800*  'E' = PNO EXPIRED                             *
542900*  'P' = OPEN-ENDED PNO DUE                      *
543000*  'Q' = OPEN-ENDED PNO DELINQUENT BYPASS        *
543100*  'T' = TEMPORARY NON-OHV PNO PRIOR TO 10/97    *
543200************************************************************
543300* IF THE SYSTEM DATE IS 1 YEAR LESS THAN EXTRACT YEAR DATES*
543400*  THE WA-PNO-YR HAS TO TAKE ACCOUNT OF THIS. (I.E. OCT.   *
543500*  EXTRACT IS FOR JAN OF NEXT YEAR EXP. DATES, ETC.)       *
543600*  ONCE THE EXTRACT YEAR AND EXPIRATION YEARS ARE THE SAME *
543700*  NO SPECIAL LOGIC IS REQUIRED                            *
543800************************************************************
543900*  OHVS ARE PROCESSED IN APRIL AND ARE DUE IN JUNE;
544000*  THEREFORE NO DATE CHECKING IS NEEDED FOR NEXT YEAR.
544100*  NDRS ARE NOT CREATED FOR OHVS.
544200     IF E-RSN-CODE(IDX-E) = '02'
544300        IF DELINQUENT-REG
544400           MOVE 'Q' TO PNO-STATUS-INDICATOR
544500        ELSE
544600           MOVE 'P' TO PNO-STATUS-INDICATOR
544700        END-IF
544800        GO TO 5599-EXIT
544900     END-IF.
545000*
545100*  THE FOLLOWING CALL WAS ADDED TO GET THE CENTURY FOR
545200*  THE OHV PNO EXPIRATION YEAR.
545300         MOVE LOW-VALUES TO WS-LINKAGE-LIST.
545400         INITIALIZE WS-LINK-BACK-PGM
545500           WS-TRANS-DATA
545600           WS-CURRENT-DATE.
545700**** SET UP INPUT DATE PARAMETERS HERE*********
545800     MOVE 'A' TO ARG-IN-REQUEST-FORMAT.
545900     MOVE 'D' TO ARG-IN-DATE-FORMAT.
546000     MOVE PNO-EXP-YR(IDX-E) TO ARG-IN-DATE.
546100
546200         CALL 'OR1582'
546300          USING
546400           BY REFERENCE
546500            WS-LINK-BACK-PGM,
546600            WS-LINKAGE-LIST,
546700            WS-RETURN-CODE,
546800            WS-TRANS-DATA,
546900            WS-CURRENT-DATE
547000           ON EXCEPTION
547100            MOVE 9  TO WS-RETURN-CODE
547200         END-CALL
547300         EVALUATE WS-RETURN-CODE
547400          WHEN ZERO
547500           MOVE ARG-OUT-DATE-CCYYMMDD TO E69-PNO-DATE
547600         WHEN OTHER
547700           GO TO 5599-EXIT
547800          END-EVALUATE.
547900
548000     IF TL-OHV
548100        IF E69-PNO-CCYY > WA-YR
548200            MOVE 'C' TO PNO-STATUS-INDICATOR
548300        ELSE
548400            IF E69-PNO-CCYY < WA-YR
548500               MOVE 'E' TO PNO-STATUS-INDICATOR
548600            ELSE
548700               MOVE 'D' TO PNO-STATUS-INDICATOR
548800            END-IF
548900        END-IF
549000        GO TO 5599-EXIT
549100     END-IF.
549200
549300 5599-EXIT.
549400     EXIT.
549500
549600
549700/*************************
549800 6000-PRINT-STAT-1.
549900**************************
265700D    DISPLAY '6000-PRINT-STAT-1.          '.
265700     MOVE    '6000-PRINT-STAT-1.          ' TO WA-ERROR-PRM.

550000     IF ERR-MSG-CNT = 2
550100         MOVE ERR-DETAIL TO REPORT-LINE
550200         WRITE REPORT-LINE.
550300     MOVE WA-RPT-DATE TO STAT-DATE.
550400     ADD 1 TO STAT-PAGE.
550500     MOVE STAT-HEAD-1 TO REPORT-LINE.
550600     WRITE REPORT-LINE.
550700     MOVE STAT-HEAD-A-2 TO REPORT-LINE.
550800     WRITE REPORT-LINE.
550900     MOVE STAT-HEAD-A-3 TO REPORT-LINE.
551000     WRITE REPORT-LINE.
551100     IF SI-STAT-RUN-YEAR = 'XX'
551200         MOVE TDI-YY TO STAT-PRT-RUN-YEAR
551300         MOVE TDI-MM TO STAT-PRT-RUN-MONTH
551400         MOVE TDI-DD TO STAT-PRT-RUN-DAY
551500     ELSE
551600         MOVE SI-STAT-RUN-YEAR TO STAT-PRT-RUN-YEAR
551700         MOVE SI-STAT-RUN-MONTH TO STAT-PRT-RUN-MONTH
551800         MOVE SI-STAT-RUN-DAY TO STAT-PRT-RUN-DAY
551900     END-IF.
552000     MOVE STAT-HEAD-A-4 TO REPORT-LINE.
552100     WRITE REPORT-LINE.
552200     MOVE STAT-HEAD-A-5 TO REPORT-LINE.
552300     WRITE REPORT-LINE.
552400     IF CTR-POTS-REG > ZERO
552500         SET IDX-WRK TO 1
552600         SET IDX-WK1 TO 1
552700         SET IDX-WK2 TO 1
552800         SET IDX-WK3 TO 1
552900         SET IDX-WK4 TO 1
553000         SET IDX-WK5 TO 1
               PERFORM 7000-PRINT-SELECTED 40 TIMES.
553200     IF CTR-OLD-DATES > ZERO
553300         MOVE WA-SEL-DATE TO STAT-SEL-DT-PRT-1
553400         MOVE 'AND OLDER' TO STAT-SEL-1
553500         MOVE CTR-OLD-DATES   TO STAT-SEL-CNT-PRT-1
553600         MOVE STAT-DET-A-1 TO REPORT-LINE
553700         WRITE REPORT-LINE.
553800     IF CTR-OTHER-DATES > ZERO
553900         MOVE SPACE TO STAT-DET-A-1
554000         MOVE '    ALL OTHER DATES' TO STAT-SEL-TAG
554100         MOVE CTR-OTHER-DATES TO STAT-SEL-CNT-PRT-1
554200         MOVE STAT-DET-A-1 TO REPORT-LINE
554300         WRITE REPORT-LINE.
554400     MOVE CTR-STAT-4401 TO STAT-DET-PRT.
554500     MOVE STAT-DET-A-2 TO REPORT-LINE.
554600     WRITE REPORT-LINE.
554700     MOVE '8515' TO STAT-DET-RID.
554800     MOVE CTR-STAT-8515 TO STAT-DET-PRT.
554900     MOVE STAT-DET-A-2 TO REPORT-LINE.
555000     WRITE REPORT-LINE.
554700     MOVE 'RA5' TO STAT-DET-TCODE.
554800     MOVE CTR-STAT-RA5 TO STAT-DET3-PRT.
554900     MOVE STAT-DET-A-3 TO REPORT-LINE.
555000     WRITE REPORT-LINE.
554700     MOVE 'R66' TO STAT-DET-TCODE.
554800     MOVE CTR-STAT-R66 TO STAT-DET3-PRT.
554900     MOVE STAT-DET-A-3 TO REPORT-LINE.
555000     WRITE REPORT-LINE.
555100     MOVE '8519' TO STAT-DET-RID.
555200     MOVE CTR-STAT-8519 TO STAT-DET-PRT.
555300     MOVE STAT-DET-A-2 TO REPORT-LINE.
555400     WRITE REPORT-LINE.
555500     ADD CTR-OLD-DATES TO CTR-STAT-TOT-SELECTED.
555600     ADD CTR-OTHER-DATES TO CTR-STAT-TOT-SELECTED.
555700     ADD CTR-STAT-4401 CTR-STAT-8515  CTR-STAT-8519
555800             TO CTR-STAT-TOT-SELECTED.
555900     MOVE CTR-STAT-TOT-SELECTED TO STAT-TOT-SEL-PRT-1.
556000**   MOVE CTR-STAT-TOT-SEL-2 TO STAT-TOT-SEL-PRT-2.
556100**   MOVE CTR-STAT-TOT-SEL-3 TO STAT-TOT-SEL-PRT-3.
556200**   MOVE CTR-STAT-TOT-SEL-4 TO STAT-TOT-SEL-PRT-4.
556300**   MOVE CTR-STAT-TOT-SEL-5 TO STAT-TOT-SEL-PRT-5.
556400     MOVE STAT-DET-A-4 TO REPORT-LINE.
556500     WRITE REPORT-LINE.
556600     ADD SI-THIS-BYP TO CTR-STAT-8516-BYP.
556700**   MOVE CTR-STAT-8516-BYP TO STAT-8516-BYP-PRT.
556800**   MOVE STAT-DET-A-5 TO REPORT-LINE.
556900**   WRITE REPORT-LINE.
557000**   MOVE CTR-STAT-4401-BYP TO STAT-4401-BYP-PRT.
557100**   MOVE STAT-DET-A-6 TO REPORT-LINE.
557200**   WRITE REPORT-LINE.
557300**   MOVE CTR-STAT-8515-BYP TO STAT-8515-BYP-PRT.
557400**   MOVE STAT-DET-A-7 TO REPORT-LINE.
557500**   WRITE REPORT-LINE.
557600     ADD CTR-STAT-8516-BYP CTR-STAT-4401-BYP CTR-STAT-8515-BYP
557700              CTR-STAT-8519-BYP TO CTR-STAT-TOT-BYP.
557800     MOVE CTR-STAT-TOT-BYP TO STAT-TOT-BYP-PRT.
557900     MOVE STAT-DET-A-8 TO REPORT-LINE.
558000     WRITE REPORT-LINE.
558100*****************************
558200*   NEW DISPLAY FIELDS      *
558300*****************************
558400     MOVE STAT-HDR-N-1 TO REPORT-LINE.
558500     WRITE REPORT-LINE.
558600     MOVE STAT-HDR-N-2 TO REPORT-LINE.
558700     WRITE REPORT-LINE.
558800     MOVE STAT-HDR-N-3 TO REPORT-LINE.
558900     WRITE REPORT-LINE.
559000     MOVE STAT-HDR-N-4 TO REPORT-LINE.
559100     WRITE REPORT-LINE.
559200     IF CTR-NDR > ZERO
559300         SET IDX-WRK TO 1
559400         SET IDX-NDR TO 1
559500         PERFORM 15 TIMES
559600             MOVE W-STAT-SEL-NDR-ENTRY (IDX-NDR)
559700                  TO  W-STAT-SEL-ENTRY (IDX-WRK)
559800             SET IDX-WRK UP BY 1
559900             SET IDX-NDR UP BY 1
560000         END-PERFORM
560100         PERFORM  2 TIMES
560200             MOVE '999999' TO W-STAT-SEL-DT (IDX-WRK)
560300             MOVE  ZERO   TO W-STAT-SEL-CNT (IDX-WRK)
560400             SET IDX-WRK UP BY 1
560500             SET IDX-NDR UP BY 1
560600         END-PERFORM
560700         SET IDX-WRK TO 1
560800         SET IDX-WK1 TO 1
560900**       SET IDX-WK2 TO 1
561000**       SET IDX-WK3 TO 1
561100**       SET IDX-WK4 TO 1
561200**       SET IDX-WK5 TO 1
561300         MOVE  ZERO  TO CTR-STAT-TOT-SELECTED
561400         MOVE SPACE TO STAT-SEL-TAG
561500         MOVE 'Y' TO SW-WEEK1-COUNTS
               PERFORM 7000-PRINT-SELECTED 40 TIMES
561700*****TOTAL FOR STAT-DET-N-3 LINE
561800         ADD CTR-STAT-4405 TO CTR-STAT-TOT-SELECTED.
561900     MOVE CTR-STAT-TOT-SELECTED TO STAT-TOT-NDR-SEL.
562000     MOVE CTR-STAT-4405 TO STAT-4405-SEL.
562100     MOVE STAT-DET-N-2 TO REPORT-LINE.
562200     WRITE REPORT-LINE.
562300     MOVE STAT-DET-N-3 TO REPORT-LINE.
562400     WRITE REPORT-LINE.
562500     MOVE CTR-STAT-NDR-BYP TO STAT-TOT-NDR-BYP.
562600     MOVE STAT-DET-N-4 TO REPORT-LINE.
562700     WRITE REPORT-LINE.
562800
562900/*************************
563000 6010-PRINT-STAT-2.
563100**************************
265700D    DISPLAY '6010-PRINT-STAT-2.          '.
265700     MOVE    '6010-PRINT-STAT-2.          ' TO WA-ERROR-PRM.

563200     ADD 1 TO STAT-PAGE.
563300     MOVE STAT-HEAD-1 TO REPORT-LINE.
563400     WRITE REPORT-LINE.
563500     MOVE PRT-HEAD-B-2 TO REPORT-LINE.
563600     WRITE REPORT-LINE.
563700     MOVE PRT-HEAD-B-3 TO REPORT-LINE.
563800     WRITE REPORT-LINE.
563900     MOVE PRT-HEAD-B-4 TO REPORT-LINE.
564000     WRITE REPORT-LINE.
564100     MOVE PRT-HEAD-B-5 TO REPORT-LINE.
564200     WRITE REPORT-LINE.
564300****************************************************
564400*  DETAIL LINES: SUBSCRIPT USED FOR LITERAL "TAGS" *
564500*  1ST HALF      INDEXES USED FOR COUNTS           *
564600****************************************************
564700     MOVE ZERO TO CTR-ACT-TOT-1
564800                  CTR-ACT-TOT-2.
564900     SET IDX-PROJ TO 1.
565000     PERFORM 4 TIMES
565100         MOVE ZERO TO CTR-PROJ-TOT (IDX-PROJ)
565200         SET IDX-PROJ UP BY 1
565300     END-PERFORM.
565400
565500     MOVE 1 TO SUB-1.
565600     SET IDX-CNT TO 1.
565700*    PERFORM UNTIL SUB-1 > 10
           PERFORM UNTIL SUB-1 > 5
565800         MOVE REPORT-TAG (SUB-1) TO PRT-TITLE
565900         ADD 1 TO SUB-1
566000         MOVE ACT-CNT (IDX-CNT) TO PRT-REG-COUNT
566100         ADD ACT-CNT (IDX-CNT) TO CTR-ACT-TOT-1
566200         SET IDX-CNT UP BY 1
566300         MOVE ACT-CNT (IDX-CNT) TO PRT-EXP-COUNT
566400         ADD ACT-CNT (IDX-CNT) TO CTR-ACT-TOT-2
566500**       MOVE SPACE TO PRT-LINE-REMAIN
566600         SET IDX-WK TO 1
566700**       SET IDX-PRT TO 1
566800         SET IDX-PROJ TO 1
566900         PERFORM 6050-SET-SI-INDEX
567000         SET IDX-CNT UP BY 1
567100**       PERFORM 4 TIMES
567200**           IF NO-SI-COUNT
567300**               MOVE ZERO TO PRT-CNT (IDX-PRT)
567400**           ELSE
567500**               MOVE SI-CNT (IDX-WK IDX-SI)
567600**                          TO PRT-CNT (IDX-PRT)
567700**               ADD SI-CNT (IDX-WK IDX-SI)
567800**                         TO CTR-PROJ-TOT (IDX-PROJ)
567900**           END-IF
568000**           SET IDX-WK UP BY 1
568100**           SET IDX-PRT UP BY 1
568200**           SET IDX-PROJ UP BY 1
568300**       END-PERFORM
568400         MOVE PRT-DET-B-1 TO REPORT-LINE
568500         WRITE REPORT-LINE
568600     END-PERFORM.
568700/**************************************************************
568800*  SUBTOTALS: EVEN-INDEXED ITEMS INTO ONE TOTAL (FOR CURRENT),*
568900*             ODD-INDEXED ITEMS INTO THE OTHER (FOR EXPIRED)  *
569000***************************************************************
569100     MOVE CTR-ACT-TOT-1 TO PRT-REG-TOT-CNT
569200                           WA-STAT-TOT-1.
569300     MOVE CTR-ACT-TOT-2 TO PRT-EXP-TOT-CNT
569400                           WA-STAT-TOT-2.
569500**   MOVE SPACE TO PRT-TOT-REMAIN
569600**   SET IDX-PROJ TO 1.
569700**   SET IDX-TOT TO 1.
569800**   SET IDX-STAT TO 1.
569900**   PERFORM 4 TIMES
570000**       MOVE CTR-PROJ-TOT (IDX-PROJ) TO PRT-TOT-CNT (IDX-TOT)
570100**                                       WA-STAT-TOT (IDX-STAT)
570200**       SET IDX-PROJ UP BY 1
570300**       SET IDX-TOT  UP BY 1
570400**       SET IDX-STAT UP BY 1
570500**   END-PERFORM.
570600
570700     MOVE PRT-DET-B-7 TO REPORT-LINE.
570800     WRITE REPORT-LINE.
570900
571000     MOVE PRT-DET-B-8 TO REPORT-LINE.
571100     WRITE REPORT-LINE.
571200/***************************************************
571300*  DETAIL LINES: SUBSCRIPT USED FOR LITERAL "TAGS" *
571400*  2ND HALF      INDEXES USED FOR COUNTS           *
571500****************************************************
571600     MOVE ZERO TO CTR-ACT-TOT-1
571700                  CTR-ACT-TOT-2.
571800     SET IDX-PROJ TO 1.
571900     PERFORM 4 TIMES
572000         MOVE ZERO TO CTR-PROJ-TOT (IDX-PROJ)
572100         SET IDX-PROJ UP BY 1
572200     END-PERFORM.
572300
572400     MOVE 1 TO SUB-1.
572600     MOVE REPORT-TAG (SUB-1) TO PRT-TITLE
572800     MOVE ACT-CNT (IDX-CNT) TO PRT-REG-COUNT
572900     ADD ACT-CNT (IDX-CNT) TO CTR-ACT-TOT-1
573000     SET IDX-CNT UP BY 1
573100     MOVE ACT-CNT (IDX-CNT) TO PRT-EXP-COUNT
573200     ADD ACT-CNT (IDX-CNT) TO CTR-ACT-TOT-2
573300**       MOVE SPACE TO PRT-LINE-REMAIN
573400     SET IDX-WK TO 1
573500**       SET IDX-PRT TO 1
573600     SET IDX-PROJ TO 1
573700     PERFORM 6050-SET-SI-INDEX
573900**       PERFORM 4 TIMES
574000**           IF NO-SI-COUNT
574100**               MOVE ZERO TO PRT-CNT (IDX-PRT)
574200**           ELSE
574300**               MOVE SI-CNT (IDX-WK IDX-SI)
574400**                          TO PRT-CNT (IDX-PRT)
574500**               ADD SI-CNT (IDX-WK IDX-SI)
574600**                         TO CTR-PROJ-TOT (IDX-PROJ)
574700**           END-IF
574800**           SET IDX-WK UP BY 1
574900**           SET IDX-PRT UP BY 1
575000**           SET IDX-PROJ UP BY 1
575100**       END-PERFORM
575200     MOVE PRT-DET-B-1 TO REPORT-LINE
575300     WRITE REPORT-LINE
575500/*****************
575600*  TOTALS        *
575700******************
575800     MOVE CTR-ACT-TOT-1 TO PRT-REG-TOT-CNT.
575900     ADD  CTR-ACT-TOT-1 TO WA-STAT-TOT-1.
576000     MOVE CTR-ACT-TOT-2 TO PRT-EXP-TOT-CNT.
576100     ADD  CTR-ACT-TOT-2 TO WA-STAT-TOT-2.
576200**   MOVE SPACE TO PRT-TOT-REMAIN
576300**
576400**   SET IDX-PROJ TO 1.
576500**   SET IDX-TOT TO 1.
576600**   SET IDX-STAT TO 1.
576700**   PERFORM 4 TIMES
576800**       MOVE CTR-PROJ-TOT (IDX-PROJ) TO PRT-TOT-CNT (IDX-TOT)
576900**       ADD  CTR-PROJ-TOT (IDX-PROJ) TO WA-STAT-TOT (IDX-STAT)
577000**       SET IDX-PROJ UP BY 1
577100**       SET IDX-TOT  UP BY 1
577200**       SET IDX-STAT UP BY 1
577300**   END-PERFORM.
577400
577500     MOVE PRT-DET-B-7 TO REPORT-LINE.
577600     WRITE REPORT-LINE.
577700
577800     MOVE '-' TO PRT-FINAL-CC.
577900     MOVE '  FINAL ' TO PRT-FINAL.
578000     MOVE WA-STAT-TOT-1 TO PRT-REG-TOT-CNT.
578100     MOVE WA-STAT-TOT-2 TO PRT-EXP-TOT-CNT.
578200**   MOVE SPACE TO PRT-TOT-REMAIN
578300**
578400**   SET IDX-TOT TO 1.
578500**   SET IDX-STAT TO 1.
578600**   PERFORM 4 TIMES
578700**       MOVE WA-STAT-TOT (IDX-STAT) TO PRT-TOT-CNT (IDX-TOT)
578800**       SET IDX-TOT  UP BY 1
578900**       SET IDX-STAT UP BY 1
579000**   END-PERFORM.
579100
579200     MOVE PRT-DET-B-7 TO REPORT-LINE.
579300     WRITE REPORT-LINE.
579400
579500/*****************
579600*  END OF REPORT *
579700******************
581000     MOVE WA-START-TIME-HR TO PRT-START-TIME-HR.
581100     MOVE WA-START-TIME-MIN TO PRT-START-TIME-MIN.
581200     ACCEPT WA-STOP-TIME FROM TIME.
581300     MOVE WA-STOP-TIME-HR TO PRT-STOP-TIME-HR.
581400     MOVE WA-STOP-TIME-MIN TO PRT-STOP-TIME-MIN.
581500     MOVE PRT-DET-B-12 TO REPORT-LINE.
581600     WRITE REPORT-LINE.
581700     MOVE SI-THIS-STRT-YR TO PRT-THIS-STRT-YR
581800     MOVE SI-THIS-STRT-MO TO PRT-THIS-STRT-MO
581900     MOVE SI-THIS-STRT-DA TO PRT-THIS-STRT-DA
582000     MOVE SI-THIS-STOP-YR TO PRT-THIS-STOP-YR
582100     MOVE SI-THIS-STOP-MO TO PRT-THIS-STOP-MO
582200     MOVE SI-THIS-STOP-DA TO PRT-THIS-STOP-DA.
582300
584100/
584200 6050-SET-SI-INDEX.
265700D    DISPLAY '6050-SET-SI-INDEX.          '.
265700     MOVE    '6050-SET-SI-INDEX.          ' TO WA-ERROR-PRM.

584300***************************************************
584400*  COUNTS ON THE STAT-IN RECORD DO NOT CORRESPOND *
584500*  EXACTLY TO THIS PROGRAMS INDEXED COUNTERS.     *
584600*  ORDER IS DIFFERENT, AND THERE ARE NO SEPARATE  *
584700*  COUNTS FOR SMOG.  THIS SUBROUTINE WILL SET     *
584800*  THE IDX-SI TO CORRECT VALUE TO CORRESPOND WITH *
584900*  THE COUNTS BEING REPORTED ON A PARTICULAR LINE.*
585000***************************************************
585100     MOVE 'Y' TO SW-SI-COUNT.
585200     EVALUATE IDX-CNT
585300     WHEN      1 THRU  2
585400           SET IDX-SI TO 1
585500     WHEN      3 THRU  4
585600           MOVE 'N' TO SW-SI-COUNT
585700     WHEN      5 THRU  6
585800           SET IDX-SI TO 2
585900     WHEN      7 THRU  8
586000           SET IDX-SI TO 3
586100     WHEN      9 THRU 10
586200           SET IDX-SI TO 5
586300     WHEN     11 THRU 12
586400           MOVE 'N' TO SW-SI-COUNT
586500     WHEN     13 THRU 14
586600           SET IDX-SI TO 11
586700     WHEN     15 THRU 16
586800           IF SI-OHV
586900               SET IDX-SI TO 6
587000           ELSE
587100               MOVE 'N' TO SW-SI-COUNT
587200           END-IF
587300     WHEN     17 THRU 18
587400           IF SI-FARM
587500               SET IDX-SI TO 6
587600           ELSE
587700               MOVE 'N' TO SW-SI-COUNT
587800           END-IF
587900     WHEN     19 THRU 20
588000           IF SI-DPP
588100               SET IDX-SI TO 6
588200           ELSE
588300               MOVE 'N' TO SW-SI-COUNT
588400           END-IF
588500     WHEN     21 THRU 22
588600           SET IDX-SI TO 7
588700     WHEN     23 THRU 24
588800           MOVE 'N' TO SW-SI-COUNT
588900     WHEN     25 THRU 26
589000           SET IDX-SI TO 10
589100     WHEN     27 THRU 28
589200           SET IDX-SI TO 9
589300     WHEN     29 THRU 30
589400           SET IDX-SI TO 8
589500     WHEN     31 THRU 32
589600           MOVE 'N' TO SW-SI-COUNT
589700     END-EVALUATE.
589800
589900/***************************
590000 6080-PRINT-BYPASS-RPT.
590100****************************
265700D    DISPLAY '6080-PRINT-BYPASS-RPT.      '.
265700     MOVE    '6080-PRINT-BYPASS-RPT.      ' TO WA-ERROR-PRM.

590200     MOVE WA-RPT-DATE TO BYP-DATE.
590300     OPEN OUTPUT BYPASS.
590400
590500     MOVE SPACE TO BYP-TOTAL-X.
590600     MOVE 'TL DISABLED ' TO BYP-REASON.
590700     MOVE CTR-BYP-TLN (1) TO BYP-DET-NBR-CUR.
590800     MOVE CTR-BYP-TLN (2) TO BYP-DET-NBR-NDR.
      *
590900     MOVE CTR-BYP-TLN (3) TO BYP-DET-NBR-EXP.
591000     PERFORM 6090-WRITE-BYPASS.
591100     IF CTR-BYP-IRP (1) > ZERO OR
591200        CTR-BYP-IRP (2) > ZERO OR
591300        CTR-BYP-IRP (3) > ZERO
591400         MOVE 'IRP 407 RECS' TO BYP-REASON
591500         MOVE CTR-BYP-IRP (1) TO BYP-DET-NBR-CUR
591600         MOVE CTR-BYP-IRP (2) TO BYP-DET-NBR-NDR
591700         MOVE CTR-BYP-IRP (3) TO BYP-DET-NBR-EXP
591800         PERFORM 6090-WRITE-BYPASS.
591900     IF CTR-BYP-PFR (1) > ZERO OR
592000        CTR-BYP-PFR (2) > ZERO OR
592100        CTR-BYP-PFR (3) > ZERO
PFRFIX***
PFRFix***      MOVE 'PFR NOT 8516' TO BYP-REASON
PFRFix         MOVE 'No Longer PFR  (ON VRMaster)' TO BYP-REASON
592300         MOVE CTR-BYP-PFR (1) TO BYP-DET-NBR-CUR
592400         MOVE CTR-BYP-PFR (2) TO BYP-DET-NBR-NDR
592500         MOVE CTR-BYP-PFR (3) TO BYP-DET-NBR-EXP
592600         PERFORM 6090-WRITE-BYPASS.
592700     IF CTR-BYP-TYP7 (1) > ZERO OR
592800        CTR-BYP-TYP7 (2) > ZERO OR
592900        CTR-BYP-TYP7 (3) > ZERO
593000         MOVE 'TYPE REC 7  ' TO BYP-REASON
593100         MOVE CTR-BYP-TYP7 (1) TO BYP-DET-NBR-CUR
593200         MOVE CTR-BYP-TYP7 (2) TO BYP-DET-NBR-NDR
593300         MOVE CTR-BYP-TYP7 (3) TO BYP-DET-NBR-EXP
593400         PERFORM 6090-WRITE-BYPASS.
593500     IF CTR-BYP-NPNO (1) > ZERO OR
593600        CTR-BYP-NPNO (2) > ZERO OR
593700        CTR-BYP-NPNO (3) > ZERO
593800         MOVE 'NOT PNO TYPE' TO BYP-REASON
593900         MOVE CTR-BYP-NPNO (1) TO BYP-DET-NBR-CUR
594000         MOVE CTR-BYP-NPNO (2) TO BYP-DET-NBR-NDR
594100         MOVE CTR-BYP-NPNO (3) TO BYP-DET-NBR-EXP
594200         PERFORM 6090-WRITE-BYPASS.
594300     IF CTR-BYP-CIT  (1) > ZERO OR
594400        CTR-BYP-CIT  (2) > ZERO OR
594500        CTR-BYP-CIT  (3) > ZERO
594600         MOVE 'BAIL DUE'   TO BYP-REASON
594700         MOVE CTR-BYP-CIT  (1) TO BYP-DET-NBR-CUR
594800         MOVE CTR-BYP-CIT  (2) TO BYP-DET-NBR-NDR
594900         MOVE CTR-BYP-CIT  (3) TO BYP-DET-NBR-EXP
595000         PERFORM 6090-WRITE-BYPASS.
595100     MOVE 'CONSUL CORP  ' TO BYP-REASON.
595200     MOVE CTR-BYP-CCP (1) TO BYP-DET-NBR-CUR.
595300     MOVE CTR-BYP-CCP (2) TO BYP-DET-NBR-NDR.
595400     MOVE CTR-BYP-CCP (3) TO BYP-DET-NBR-EXP.
595500/
595600     PERFORM 6090-WRITE-BYPASS.
595700     MOVE 'CCHMP       ' TO BYP-REASON.
595800     MOVE CTR-BYP-CCH (1) TO BYP-DET-NBR-CUR.
595900     MOVE CTR-BYP-CCH (2) TO BYP-DET-NBR-NDR.
596000     MOVE CTR-BYP-CCH (3) TO BYP-DET-NBR-EXP.
596100     PERFORM 6090-WRITE-BYPASS.
596200     MOVE 'SUB REC J   ' TO BYP-REASON.
596300     MOVE CTR-BYP-SBJ (1) TO BYP-DET-NBR-CUR.
596400     MOVE CTR-BYP-SBJ (2) TO BYP-DET-NBR-NDR.
596500     MOVE CTR-BYP-SBJ (3) TO BYP-DET-NBR-EXP.
596600     PERFORM 6090-WRITE-BYPASS.
596700
596800     MOVE 'TB  Q - BUS ' TO BYP-REASON.
596900     MOVE CTR-BYP-TBQ (1) TO BYP-DET-NBR-CUR.
597000     MOVE CTR-BYP-TBQ (2) TO BYP-DET-NBR-NDR.
597100     MOVE CTR-BYP-TBQ (3) TO BYP-DET-NBR-EXP.
597200     PERFORM 6090-WRITE-BYPASS.
597300     IF CTR-BYP-DPL (1) > ZERO OR
597400        CTR-BYP-DPL (2) > ZERO OR
597500        CTR-BYP-DPL (3) > ZERO
597600         MOVE 'DP WRONG FILE' TO BYP-REASON
597700         MOVE CTR-BYP-DPL (1) TO BYP-DET-NBR-CUR
597800         MOVE CTR-BYP-DPL (2) TO BYP-DET-NBR-NDR
597900         MOVE CTR-BYP-DPL (3) TO BYP-DET-NBR-EXP
598000         PERFORM 6090-WRITE-BYPASS.
598100     IF CTR-BYP-VSL (1) > ZERO OR
598200        CTR-BYP-VSL (2) > ZERO OR
598300        CTR-BYP-VSL (3) > ZERO
598400         MOVE 'VESSEL CC 60' TO BYP-REASON
598500         MOVE CTR-BYP-VSL (1) TO BYP-DET-NBR-CUR
598600         MOVE CTR-BYP-VSL (2) TO BYP-DET-NBR-NDR
598700         MOVE CTR-BYP-VSL (3) TO BYP-DET-NBR-EXP
598800         PERFORM 6090-WRITE-BYPASS.
598900     IF CTR-BYP-TIT (1) > ZERO OR
599000        CTR-BYP-TIT (2) > ZERO OR
599100        CTR-BYP-TIT (3) > ZERO
599200         MOVE 'TITLE/TRANS ' TO BYP-REASON
599300         MOVE CTR-BYP-TIT (1) TO BYP-DET-NBR-CUR
599400         MOVE CTR-BYP-TIT (2) TO BYP-DET-NBR-NDR
599500         MOVE CTR-BYP-TIT (3) TO BYP-DET-NBR-EXP
599600         PERFORM 6090-WRITE-BYPASS.
599700
599800     IF CTR-BYP-SBE01 (1) > ZERO OR
599900        CTR-BYP-SBE01 (2) > ZERO OR
600000        CTR-BYP-SBE01 (3) > ZERO
600100     MOVE 'JUNK (REC COND 01)'  TO BYP-REASON
600200     MOVE CTR-BYP-SBE01 (1) TO BYP-DET-NBR-CUR
600300     MOVE CTR-BYP-SBE01 (2) TO BYP-DET-NBR-NDR
600400     MOVE CTR-BYP-SBE01 (3) TO BYP-DET-NBR-EXP
600500     PERFORM 6090-WRITE-BYPASS.
600600
600700     IF CTR-BYP-SBE02 (1) > ZERO OR
600800        CTR-BYP-SBE02 (2) > ZERO OR
600900        CTR-BYP-SBE02 (3) > ZERO
601000/
601100     MOVE 'SUBPLATE (REC COND 02)' TO BYP-REASON
601200     MOVE CTR-BYP-SBE02 (1) TO BYP-DET-NBR-CUR
601300     MOVE CTR-BYP-SBE02 (2) TO BYP-DET-NBR-NDR
601400     MOVE CTR-BYP-SBE02 (3) TO BYP-DET-NBR-EXP
601500     PERFORM 6090-WRITE-BYPASS.
601600
601700     IF CTR-BYP-SBE03 (1) > ZERO OR
601800        CTR-BYP-SBE03 (2) > ZERO OR
601900        CTR-BYP-SBE03 (3) > ZERO
602000     MOVE 'SURR TITLE (REC COND 03)'  TO BYP-REASON
602100     MOVE CTR-BYP-SBE03 (1) TO BYP-DET-NBR-CUR
602200     MOVE CTR-BYP-SBE03 (2) TO BYP-DET-NBR-NDR
602300     MOVE CTR-BYP-SBE03 (3) TO BYP-DET-NBR-EXP
602400     PERFORM 6090-WRITE-BYPASS.
602500
602600     IF CTR-BYP-SBE04 (1) > ZERO OR
602700        CTR-BYP-SBE04 (2) > ZERO OR
602800        CTR-BYP-SBE04 (3) > ZERO
602900     MOVE 'CANCELLED (REC COND 04)'  TO BYP-REASON
603000     MOVE CTR-BYP-SBE04 (1) TO BYP-DET-NBR-CUR
603100     MOVE CTR-BYP-SBE04 (2) TO BYP-DET-NBR-NDR
603200     MOVE CTR-BYP-SBE04 (3) TO BYP-DET-NBR-EXP
603300     PERFORM 6090-WRITE-BYPASS.
603400
603500     MOVE 'VLT STOPS (REC COND 05)' TO BYP-REASON.
603600     MOVE CTR-BYP-VLT (1) TO BYP-DET-NBR-CUR.
603700     MOVE CTR-BYP-VLT (2) TO BYP-DET-NBR-NDR.
603800     MOVE CTR-BYP-VLT (3) TO BYP-DET-NBR-EXP.

RF3543     Move 'RC-94 Test Vehicles Included '
RF3543       to                      Byp-DET-VLTS94-TEXT
RF3543     Move  CTR-BYP-VLTS94  TO  byp-DET-VLTS94
RF3543
603900     PERFORM 6090-WRITE-BYPASS.

RF3543     MOVE SPACES          to  byp-DET-VLTS94-TEXT
RF3543     Move ZEROS           TO  byp-DET-VLTS94

604000     MOVE 'DOJ STOPS (REC COND 06)' TO BYP-REASON.
604100     MOVE CTR-BYP-DOJ (1) TO BYP-DET-NBR-CUR.
604200     MOVE CTR-BYP-DOJ (2) TO BYP-DET-NBR-NDR.
604300     MOVE CTR-BYP-DOJ (3) TO BYP-DET-NBR-EXP.
604400     PERFORM 6090-WRITE-BYPASS.
604500     IF CTR-BYP-SBE07 (1) > ZERO OR
604600        CTR-BYP-SBE07 (2) > ZERO OR
604700        CTR-BYP-SBE07 (3) > ZERO
604800     MOVE 'SUBPLATE PWO (REC COND 07)'  TO BYP-REASON
604900     MOVE CTR-BYP-SBE07 (1) TO BYP-DET-NBR-CUR
605000     MOVE CTR-BYP-SBE07 (2) TO BYP-DET-NBR-NDR
605100     MOVE CTR-BYP-SBE07 (3) TO BYP-DET-NBR-EXP
605200     PERFORM 6090-WRITE-BYPASS.
605300
605400     IF CTR-BYP-PYR (1) > ZERO OR
605500        CTR-BYP-PYR (2) > ZERO OR
605600        CTR-BYP-PYR (3) > ZERO
605700         MOVE 'PARTIAL YEAR (REC COND 09)' TO BYP-REASON
605800         MOVE CTR-BYP-PYR (1) TO BYP-DET-NBR-CUR
605900         MOVE CTR-BYP-PYR (2) TO BYP-DET-NBR-NDR
606000         MOVE CTR-BYP-PYR (3) TO BYP-DET-NBR-EXP
606100         PERFORM 6090-WRITE-BYPASS.
606200
606300     IF CTR-BYP-SBE11 (1) > ZERO OR
606400        CTR-BYP-SBE11 (2) > ZERO OR
606500        CTR-BYP-SBE11 (3) > ZERO
606600/
606700     MOVE 'PWO RETENTION (REC COND 11)'  TO BYP-REASON
606800     MOVE CTR-BYP-SBE11 (1) TO BYP-DET-NBR-CUR
606900     MOVE CTR-BYP-SBE11 (2) TO BYP-DET-NBR-NDR
607000     MOVE CTR-BYP-SBE11 (3) TO BYP-DET-NBR-EXP
607100     PERFORM 6090-WRITE-BYPASS.
607200
607300     IF CTR-BYP-SBE12 (1) > ZERO OR
607400        CTR-BYP-SBE12 (2) > ZERO OR
607500        CTR-BYP-SBE12 (3) > ZERO
607600     MOVE 'PWO SURRENDER (REC COND 12)'  TO BYP-REASON
607700     MOVE CTR-BYP-SBE12 (1) TO BYP-DET-NBR-CUR
607800     MOVE CTR-BYP-SBE12 (2) TO BYP-DET-NBR-NDR
607900     MOVE CTR-BYP-SBE12 (3) TO BYP-DET-NBR-EXP
608000     PERFORM 6090-WRITE-BYPASS.
608100
608200     IF CTR-BYP-SBE13 (1) > ZERO OR
608300        CTR-BYP-SBE13 (2) > ZERO OR
608400        CTR-BYP-SBE13 (3) > ZERO
608500     MOVE 'NONREVIVABLE (REC COND 13)'  TO BYP-REASON
608600     MOVE CTR-BYP-SBE13 (1) TO BYP-DET-NBR-CUR
608700     MOVE CTR-BYP-SBE13 (2) TO BYP-DET-NBR-NDR
608800     MOVE CTR-BYP-SBE13 (3) TO BYP-DET-NBR-EXP
608900     PERFORM 6090-WRITE-BYPASS.
609000
609100     IF CTR-BYP-SBE18 (1) > ZERO OR
609200        CTR-BYP-SBE18 (2) > ZERO OR
609300        CTR-BYP-SBE18 (3) > ZERO
609400     MOVE 'PENDING APP (REC COND 18)'  TO BYP-REASON
609500     MOVE CTR-BYP-SBE18 (1) TO BYP-DET-NBR-CUR
609600     MOVE CTR-BYP-SBE18 (2) TO BYP-DET-NBR-NDR
609700     MOVE CTR-BYP-SBE18 (3) TO BYP-DET-NBR-EXP
609800     PERFORM 6090-WRITE-BYPASS.
609900
610000/
610100     IF CTR-BYP-SBE20 (1) > ZERO OR
610200        CTR-BYP-SBE20 (2) > ZERO OR
610300        CTR-BYP-SBE20 (3) > ZERO
610400     MOVE 'UNCLAIMED (REC COND 20)'  TO BYP-REASON
610500     MOVE CTR-BYP-SBE20 (1) TO BYP-DET-NBR-CUR
610600     MOVE CTR-BYP-SBE20 (2) TO BYP-DET-NBR-NDR
610700     MOVE CTR-BYP-SBE20 (3) TO BYP-DET-NBR-EXP
610800     PERFORM 6090-WRITE-BYPASS.
610900
611000     IF CTR-BYP-REV (1) > ZERO OR
611100        CTR-BYP-REV (2) > ZERO OR
611200        CTR-BYP-REV (3) > ZERO
611300         MOVE 'REVENUE COLL. (REC COND 26)' TO BYP-REASON
611400         MOVE CTR-BYP-REV (1) TO BYP-DET-NBR-CUR
611500         MOVE CTR-BYP-REV (2) TO BYP-DET-NBR-NDR
611600         MOVE CTR-BYP-REV (3) TO BYP-DET-NBR-EXP
611700         PERFORM 6090-WRITE-BYPASS.
611800
611900     IF CTR-BYP-SBE27 (1) > ZERO OR
612000        CTR-BYP-SBE27 (2) > ZERO OR
612100        CTR-BYP-SBE27 (3) > ZERO
612200/
612300     MOVE '******* (REC COND 27)'  TO BYP-REASON
612400     MOVE CTR-BYP-SBE27 (1) TO BYP-DET-NBR-CUR
612500     MOVE CTR-BYP-SBE27 (2) TO BYP-DET-NBR-NDR
612600     MOVE CTR-BYP-SBE27 (3) TO BYP-DET-NBR-EXP
612700     PERFORM 6090-WRITE-BYPASS.
612800
612900     IF CTR-BYP-SBE28 (1) > ZERO OR
613000        CTR-BYP-SBE28 (2) > ZERO OR
613100        CTR-BYP-SBE28 (3) > ZERO
613200     MOVE 'SALVAGE CERT (REC COND 28)'  TO BYP-REASON
613300     MOVE CTR-BYP-SBE28 (1) TO BYP-DET-NBR-CUR
613400     MOVE CTR-BYP-SBE28 (2) TO BYP-DET-NBR-NDR
613500     MOVE CTR-BYP-SBE28 (3) TO BYP-DET-NBR-EXP
613600     PERFORM 6090-WRITE-BYPASS.
613700
613800     IF CTR-BYP-SBE30 (1) > ZERO OR
613900        CTR-BYP-SBE30 (2) > ZERO OR
614000        CTR-BYP-SBE30 (3) > ZERO
614100     MOVE 'PENDING PAPER (REC COND 30)'  TO BYP-REASON
614200     MOVE CTR-BYP-SBE30 (1) TO BYP-DET-NBR-CUR
614300     MOVE CTR-BYP-SBE30 (2) TO BYP-DET-NBR-NDR
614400     MOVE CTR-BYP-SBE30 (3) TO BYP-DET-NBR-EXP
614500     PERFORM 6090-WRITE-BYPASS.
614600
614700     IF CTR-BYP-SBE33 (1) > ZERO OR
614800        CTR-BYP-SBE33 (2) > ZERO OR
614900        CTR-BYP-SBE33 (3) > ZERO
615000     MOVE '******* (REC COND 33)'  TO BYP-REASON
615100     MOVE CTR-BYP-SBE33 (1) TO BYP-DET-NBR-CUR
615200     MOVE CTR-BYP-SBE33 (2) TO BYP-DET-NBR-NDR
615300     MOVE CTR-BYP-SBE33 (3) TO BYP-DET-NBR-EXP
615400     PERFORM 6090-WRITE-BYPASS.
615500
615600     IF CTR-BYP-SBE34 (1) > ZERO OR
615700        CTR-BYP-SBE34 (2) > ZERO OR
615800        CTR-BYP-SBE34 (3) > ZERO
615900     MOVE 'PRORATE DELETE (REC COND 34)'  TO BYP-REASON
616000     MOVE CTR-BYP-SBE34 (1) TO BYP-DET-NBR-CUR
616100     MOVE CTR-BYP-SBE34 (2) TO BYP-DET-NBR-NDR
616200     MOVE CTR-BYP-SBE34 (3) TO BYP-DET-NBR-EXP
616300     PERFORM 6090-WRITE-BYPASS.
616400
616500     IF CTR-BYP-SBE37 (1) > ZERO OR
616600        CTR-BYP-SBE37 (2) > ZERO OR
616700        CTR-BYP-SBE37 (3) > ZERO
616800     MOVE 'CERT VOID (REC COND 37)'  TO BYP-REASON
616900     MOVE CTR-BYP-SBE37 (1) TO BYP-DET-NBR-CUR
617000     MOVE CTR-BYP-SBE37 (2) TO BYP-DET-NBR-NDR
617100     MOVE CTR-BYP-SBE37 (3) TO BYP-DET-NBR-EXP
617200     PERFORM 6090-WRITE-BYPASS.
617300
617400     IF CTR-BYP-SBE41 (1) > ZERO OR
617500        CTR-BYP-SBE41 (2) > ZERO OR
617600        CTR-BYP-SBE41 (3) > ZERO
617700/
617800     MOVE 'DOC VESSEL (REC COND 41)'  TO BYP-REASON
617900     MOVE CTR-BYP-SBE41 (1) TO BYP-DET-NBR-CUR
618000     MOVE CTR-BYP-SBE41 (2) TO BYP-DET-NBR-NDR
618100     MOVE CTR-BYP-SBE41 (3) TO BYP-DET-NBR-EXP
618200     PERFORM 6090-WRITE-BYPASS.
618300
618400     IF CTR-BYP-SBE42 (1) > ZERO OR
618500        CTR-BYP-SBE42 (2) > ZERO OR
618600        CTR-BYP-SBE42 (3) > ZERO
618700     MOVE 'VESSEL REG O/S (REC COND 42)'  TO BYP-REASON
618800     MOVE CTR-BYP-SBE42 (1) TO BYP-DET-NBR-CUR
618900     MOVE CTR-BYP-SBE42 (2) TO BYP-DET-NBR-NDR
619000     MOVE CTR-BYP-SBE42 (3) TO BYP-DET-NBR-EXP
619100     PERFORM 6090-WRITE-BYPASS.
619200
619300     IF CTR-BYP-SBE50 (1) > ZERO OR
619400        CTR-BYP-SBE50 (2) > ZERO OR
619500        CTR-BYP-SBE50 (3) > ZERO
619600     MOVE 'PHASE II (REC COND 50-54)'  TO BYP-REASON
619700     MOVE CTR-BYP-SBE50 (1) TO BYP-DET-NBR-CUR
619800     MOVE CTR-BYP-SBE50 (2) TO BYP-DET-NBR-NDR
619900     MOVE CTR-BYP-SBE50 (3) TO BYP-DET-NBR-EXP
620000     PERFORM 6090-WRITE-BYPASS.
620100
620200     IF CTR-BYP-SBE58 (1) > ZERO OR
620300        CTR-BYP-SBE58 (2) > ZERO OR
620400        CTR-BYP-SBE58 (3) > ZERO
620500     MOVE 'DISPLAY PLATE (REC COND 58)'  TO BYP-REASON
620600     MOVE CTR-BYP-SBE58 (1) TO BYP-DET-NBR-CUR
620700     MOVE CTR-BYP-SBE58 (2) TO BYP-DET-NBR-NDR
620800     MOVE CTR-BYP-SBE58 (3) TO BYP-DET-NBR-EXP
620900     PERFORM 6090-WRITE-BYPASS.
621000
621100     IF CTR-BYP-SBE61 (1) > ZERO OR
621200        CTR-BYP-SBE61 (2) > ZERO OR
621300        CTR-BYP-SBE61 (3) > ZERO
621400     MOVE 'LIEN SALE (REC COND 61)'  TO BYP-REASON
621500     MOVE CTR-BYP-SBE61 (1) TO BYP-DET-NBR-CUR
621600     MOVE CTR-BYP-SBE61 (2) TO BYP-DET-NBR-NDR
621700     MOVE CTR-BYP-SBE61 (3) TO BYP-DET-NBR-EXP
621800     PERFORM 6090-WRITE-BYPASS.
621900
622000     IF CTR-BYP-SBE62 (1) > ZERO OR
622100        CTR-BYP-SBE62 (2) > ZERO OR
622200        CTR-BYP-SBE62 (3) > ZERO
622300     MOVE '******* (REC COND 62)'  TO BYP-REASON
622400     MOVE CTR-BYP-SBE62 (1) TO BYP-DET-NBR-CUR
622500     MOVE CTR-BYP-SBE62 (2) TO BYP-DET-NBR-NDR
622600     MOVE CTR-BYP-SBE62 (3) TO BYP-DET-NBR-EXP
622700     PERFORM 6090-WRITE-BYPASS.
622800
622900     IF CTR-BYP-SBE63 (1) > ZERO OR
623000        CTR-BYP-SBE63 (2) > ZERO OR
623100        CTR-BYP-SBE63 (3) > ZERO
623200/
623300     MOVE 'SITUS O/S (REC COND 63)'  TO BYP-REASON
623400     MOVE CTR-BYP-SBE63 (1) TO BYP-DET-NBR-CUR
623500     MOVE CTR-BYP-SBE63 (2) TO BYP-DET-NBR-NDR
623600     MOVE CTR-BYP-SBE63 (3) TO BYP-DET-NBR-EXP
623700     PERFORM 6090-WRITE-BYPASS.
623800
623900     MOVE 'ALREADY PNO''D'  TO BYP-REASON.
624000     MOVE CTR-BYP-PNO  (1) TO BYP-DET-NBR-CUR.
624100     MOVE CTR-BYP-PNO  (2) TO BYP-DET-NBR-NDR.
624200     MOVE CTR-BYP-PNO  (3) TO BYP-DET-NBR-EXP.
624300     PERFORM 6090-WRITE-BYPASS.
624400
624500
624600     IF CTR-BYP-EXP (1) > ZERO OR
624700        CTR-BYP-EXP (2) > ZERO OR
624800        CTR-BYP-EXP (3) > ZERO
624900         MOVE 'EXPIRED - NO CURRENT PNO' TO BYP-REASON
625000         MOVE CTR-BYP-EXP  (1) TO BYP-DET-NBR-CUR
625100         MOVE CTR-BYP-EXP  (2) TO BYP-DET-NBR-NDR
625200         MOVE CTR-BYP-EXP  (3) TO BYP-DET-NBR-EXP
625300         PERFORM 6090-WRITE-BYPASS.
625400
625500     IF CTR-BYP-SBE70 (1) > ZERO OR
625600        CTR-BYP-SBE70 (2) > ZERO OR
625700        CTR-BYP-SBE70 (3) > ZERO
625800     MOVE 'VLF REFUND (REC COND 70)'  TO BYP-REASON
625900     MOVE CTR-BYP-SBE70 (1) TO BYP-DET-NBR-CUR
626000     MOVE CTR-BYP-SBE70 (2) TO BYP-DET-NBR-NDR
626100     MOVE CTR-BYP-SBE70 (3) TO BYP-DET-NBR-EXP
626200     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-SBE71 (1) > ZERO OR
626500        CTR-BYP-SBE71 (2) > ZERO OR
626600        CTR-BYP-SBE71 (3) > ZERO
626700     MOVE 'IRP LIEN (REC COND 71)'  TO BYP-REASON
626800     MOVE CTR-BYP-SBE71 (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-SBE71 (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-SBE71 (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-IRPTK (1) > ZERO OR
626500        CTR-BYP-IRPTK (2) > ZERO OR
626600        CTR-BYP-IRPTK (3) > ZERO
626700     MOVE 'IRP TRUCK'  TO BYP-REASON
626800     MOVE CTR-BYP-IRPTK (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-IRPTK (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-IRPTK (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-IRPTL (1) > ZERO OR
626500        CTR-BYP-IRPTL (2) > ZERO OR
626600        CTR-BYP-IRPTL (3) > ZERO
626700     MOVE 'IRP TRAILER'  TO BYP-REASON
626800     MOVE CTR-BYP-IRPTL (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-IRPTL (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-IRPTL (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-IRPIK (1) > ZERO OR
626500        CTR-BYP-IRPIK (2) > ZERO OR
626600        CTR-BYP-IRPIK (3) > ZERO
626700     MOVE 'IRP ID TRUCK'  TO BYP-REASON
626800     MOVE CTR-BYP-IRPIK (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-IRPIK (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-IRPIK (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-IRPIR (1) > ZERO OR
626500        CTR-BYP-IRPIR (2) > ZERO OR
626600        CTR-BYP-IRPIR (3) > ZERO
626700     MOVE 'IRP ID TRAILER'  TO BYP-REASON
626800     MOVE CTR-BYP-IRPIR (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-IRPIR (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-IRPIR (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
626300
626400     IF CTR-BYP-IRPFR (1) > ZERO OR
626500        CTR-BYP-IRPFR (2) > ZERO OR
626600        CTR-BYP-IRPFR (3) > ZERO
626700     MOVE 'IRP TRAILER NO WGT FEE'  TO BYP-REASON
626800     MOVE CTR-BYP-IRPFR (1) TO BYP-DET-NBR-CUR
626900     MOVE CTR-BYP-IRPFR (2) TO BYP-DET-NBR-NDR
627000     MOVE CTR-BYP-IRPFR (3) TO BYP-DET-NBR-EXP
627100     PERFORM 6090-WRITE-BYPASS.
627200
627300     IF CTR-BYP-SBE76 (1) > ZERO OR
627400        CTR-BYP-SBE76 (2) > ZERO OR
627500        CTR-BYP-SBE76 (3) > ZERO
627600     MOVE 'ELP REFUND (REC COND 76)'  TO BYP-REASON
627700     MOVE CTR-BYP-SBE76 (1) TO BYP-DET-NBR-CUR
627800     MOVE CTR-BYP-SBE76 (2) TO BYP-DET-NBR-NDR
627900     MOVE CTR-BYP-SBE76 (3) TO BYP-DET-NBR-EXP
628000     PERFORM 6090-WRITE-BYPASS.
628100
628200     IF CTR-BYP-SBE78 (1) > ZERO OR
628300        CTR-BYP-SBE78 (2) > ZERO OR
628400        CTR-BYP-SBE78 (3) > ZERO
628500     MOVE 'EXPORTED VEH (REC COND 78)'  TO BYP-REASON
628600     MOVE CTR-BYP-SBE78 (1) TO BYP-DET-NBR-CUR
628700     MOVE CTR-BYP-SBE78 (2) TO BYP-DET-NBR-NDR
628800     MOVE CTR-BYP-SBE78 (3) TO BYP-DET-NBR-EXP
628900     PERFORM 6090-WRITE-BYPASS.
629000
629100     IF CTR-BYP-SBE81 (1) > ZERO OR
629200        CTR-BYP-SBE81 (2) > ZERO OR
629300        CTR-BYP-SBE81 (3) > ZERO
629400     MOVE 'NON REPAIRABLE (REC COND 81)'  TO BYP-REASON
629500     MOVE CTR-BYP-SBE81 (1) TO BYP-DET-NBR-CUR
629600     MOVE CTR-BYP-SBE81 (2) TO BYP-DET-NBR-NDR
629700     MOVE CTR-BYP-SBE81 (3) TO BYP-DET-NBR-EXP
629800     PERFORM 6090-WRITE-BYPASS.
629900
630000     IF CTR-BYP-FUTDUE (1) > ZERO OR
630100        CTR-BYP-FUTDUE (2) > ZERO OR
630200        CTR-BYP-FUTDUE (3) > ZERO
630300     MOVE 'VESSEL, PTI, OR OHV NOT DUE'  TO BYP-REASON
630400     MOVE CTR-BYP-FUTDUE (1) TO BYP-DET-NBR-CUR
630500     MOVE CTR-BYP-FUTDUE (2) TO BYP-DET-NBR-NDR
630600     MOVE CTR-BYP-FUTDUE (3) TO BYP-DET-NBR-EXP
630700     PERFORM 6090-WRITE-BYPASS.
630800
630900     IF CTR-BYP-COMPMC (1) > ZERO OR
631000        CTR-BYP-COMPMC (2) > ZERO OR
631100        CTR-BYP-COMPMC (3) > ZERO
631200     MOVE 'COMPETITION ONLY MC'  TO BYP-REASON
631300     MOVE CTR-BYP-COMPMC (1) TO BYP-DET-NBR-CUR
631400     MOVE CTR-BYP-COMPMC (2) TO BYP-DET-NBR-NDR
631500     MOVE CTR-BYP-COMPMC (3) TO BYP-DET-NBR-EXP
631600     PERFORM 6090-WRITE-BYPASS.
631700
631800/***************************
631900*  SUBTOTALS AND TOTALS    *
632000****************************
632100     MOVE ZERO TO CTR-BYP-SUB1
632200                  CTR-BYP-SUB2
632300                  CTR-BYP-SUB3.
632400     MOVE   '-'  TO BYP-DET-CC.
632500     MOVE 'SUBTOTALS   ' TO BYP-REASON.
632600     SET IDX-COL TO 1.
632700     SET IDX-ROW TO 1.
RB1948     PERFORM UNTIL IDX-ROW > 54
RB1948*    PERFORM UNTIL IDX-ROW > 47
632900         ADD CTR-BYP-ROW (IDX-COL  IDX-ROW) TO CTR-BYP-SUB1
633000         SET IDX-ROW UP BY 1
633100     END-PERFORM.
633200     MOVE CTR-BYP-SUB1 TO  BYP-DET-NBR-CUR.
633300     SET IDX-COL TO 2.
633400     SET IDX-ROW TO 1.
RB1948     PERFORM UNTIL IDX-ROW > 54
RB1948*    PERFORM UNTIL IDX-ROW > 47
633600         ADD CTR-BYP-ROW (IDX-COL  IDX-ROW) TO CTR-BYP-SUB2
633700         SET IDX-ROW UP BY 1
633800     END-PERFORM.
633900     MOVE CTR-BYP-SUB2 TO  BYP-DET-NBR-NDR.
634000     SET IDX-COL TO 3.
634100     SET IDX-ROW TO 1.
RB1948     PERFORM UNTIL IDX-ROW > 54
RB1948*    PERFORM UNTIL IDX-ROW > 47
634300         ADD CTR-BYP-ROW (IDX-COL  IDX-ROW) TO CTR-BYP-SUB3
634400         SET IDX-ROW UP BY 1
634500     END-PERFORM.
634600     MOVE CTR-BYP-SUB3 TO  BYP-DET-NBR-EXP.
634700***DON'T PAGE DURING TOTALS
634800     IF CTR-BYP-LINE < 50
634900         MOVE ZERO TO CTR-BYP-LINE
635000     ELSE
635100         MOVE 56 TO CTR-BYP-LINE.
635200     PERFORM 6090-WRITE-BYPASS.
635300
635600     COMPUTE CTR-BYP-TOT = CTR-BYP-SUB1 + CTR-BYP-SUB2
635700                             + CTR-BYP-SUB3.
635900     MOVE SPACE TO BYP-DET-NBR-CUR-X
636000                   BYP-DET-NBR-NDR-X
636100                   BYP-DET-NBR-EXP-X.
636300
636800     ADD SI-THIS-BYP TO CTR-BYP-TOT.
636900     MOVE 'TOTAL BYPASS' TO BYP-REASON.
637000     MOVE CTR-BYP-TOT TO BYP-TOTAL.
637100     PERFORM 6090-WRITE-BYPASS.
637200
637300     MOVE CTR-BYP-TYP5-NDR TO CTR-MISC.
637400     MOVE BYP-MISC-COUNT1 TO BYPASS-LINE.
637500     WRITE BYPASS-LINE.
637600     MOVE BYP-BATCH-NBR TO BYPASS-LINE.
637700     WRITE BYPASS-LINE.
637800/
637900     MOVE SUB-2 TO ARRAY-SIZE.
638000     MOVE 1 TO SUB-2.
638100     PERFORM ARRAY-SIZE TIMES
638200         MOVE TBL-BYPASS-LIC (SUB-2) TO LICENSE-DISPLAY (SUB-2)
638300         ADD 1 TO SUB-2
638400     END-PERFORM.
638500     IF ARRAY-SIZE > ZERO
638600         MOVE BYP-LICENSE-LINE1 TO BYP-LIC-DET-LINE
638700         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
638800     IF ARRAY-SIZE > 13
638900         MOVE BYP-LICENSE-LINE2 TO BYP-LIC-DET-LINE
639000         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
639100     IF ARRAY-SIZE > 26
639200         MOVE BYP-LICENSE-LINE3 TO BYP-LIC-DET-LINE
639300         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
639400     IF ARRAY-SIZE > 39
639500         MOVE BYP-LICENSE-LINE4 TO BYP-LIC-DET-LINE
639600         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
639700     IF ARRAY-SIZE > 52
639800         MOVE BYP-LICENSE-LINE5 TO BYP-LIC-DET-LINE
639900         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
640000     IF ARRAY-SIZE > 65
640100         MOVE BYP-LICENSE-LINE6 TO BYP-LIC-DET-LINE
640200         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
640300     IF ARRAY-SIZE > 78
640400         MOVE BYP-LICENSE-LINE7 TO BYP-LIC-DET-LINE
640500         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
640600     IF ARRAY-SIZE > 91
640700         MOVE BYP-LICENSE-LINE8 TO BYP-LIC-DET-LINE
640800         WRITE BYPASS-LINE FROM BYP-LICENSES-DETAIL.
640900
641000 6090-WRITE-BYPASS.
265700D    DISPLAY '6090-WRITE-BYPASS.          '.
265700     MOVE    '6090-WRITE-BYPASS.          ' TO WA-ERROR-PRM.

641100     IF CTR-BYP-PAGE = 0 OR CTR-BYP-LINE > 55
641200         ADD 1               TO CTR-BYP-PAGE
641300         MOVE CTR-BYP-PAGE   TO BYP-PAGE-NBR
641400         WRITE BYPASS-LINE FROM BYP-HEAD-1
641500         WRITE BYPASS-LINE FROM BYP-HEAD-3
641600         MOVE ZERO           TO CTR-BYP-LINE
641700     END-IF.
641800     WRITE BYPASS-LINE     FROM BYP-DETAIL-1.
641900     ADD 2                   TO CTR-BYP-LINE.
642000
642100/**************************
642200 6100-FINAL-COUNTS.
642300***************************
265700D    DISPLAY '6100-FINAL-COUNTS.          '.
265700     MOVE    '6100-FINAL-COUNTS.          ' TO WA-ERROR-PRM.

642400     MOVE CTR-IN1            TO TOT-IN1.
642400     MOVE CTR-EXT            TO TOT-EXT.
642400     MOVE CTR-DPP            TO TOT-DPP.
642400     COMPUTE CTR-IN = CTR-IN1 + CTR-EXT + CTR-DPP.
642400     MOVE CTR-IN             TO TOT-IN.
642500     MOVE CTR-IN1-EXPIRED    TO EXP-IN.
642600     MOVE CTR-ERR-BYP        TO TOT-ERR-BYP.
642600     MOVE CTR-ERROR          TO TOT-ERR.
642700     MOVE CTR-ERROR-EXPIRED  TO TOT-ERR-EXP.
642800     MOVE CTR-BYP-REG        TO TOT-REG-BYP.
642900     MOVE CTR-BYP-EXPIRED    TO TOT-PNO-BYP.
643000     MOVE CTR-POTS-REG       TO TOT-REG-POT.
643100     MOVE CTR-POTS-PNO       TO TOT-PNO-POT.
643200     MOVE CTR-NON-POT        TO TOT-NON-POT.
643300     MOVE CTR-NDR            TO TOT-NDR.
643400     MOVE CTR-PFR            TO TOT-PFR.
643500     MOVE CTR-TYPE4          TO TOT-TYPE4.
643600     MOVE CTR-BYP-DUPS       TO TOT-BYP-ERROR.
643700     MOVE CTR-ERROR-DUPS     TO TOT-DUP-ERROR.
643800     COMPUTE CTR-TOTAL-DUPS = CTR-BYP-DUPS + CTR-ERROR-DUPS.
643900     MOVE CTR-ITT            TO TOT-ITT.
SB1500     MOVE CTR-ITT2           TO TOT-ITT2.
644000     COMPUTE CTR-TOTAL = CTR-ERROR       + CTR-BYP-REG +
644100                         CTR-BYP-EXPIRED + CTR-POTS-REG +
644200                         CTR-POTS-PNO    + CTR-PFR +
644300                         CTR-NDR         + CTR-NON-POT +
Ray634                         wa-error-msg3-COUNTER  +
644400                         CTR-TYPE4.
644500     MOVE CTR-TOTAL          TO TOT-OUT.
644600     SUBTRACT CTR-TOTAL-DUPS FROM CTR-TOTAL.
644700     MOVE CTR-TOTAL          TO TOT-ADJUSTED.
644800     ADD CTR-POTS-PNO        TO CTR-POTS-REG.
644900     ADD CTR-NDR             TO CTR-POTS-REG.
645000     MOVE CTR-POTS-REG       TO TOT-POT.
645100
645200     DISPLAY '   '.
645300     DISPLAY CTR-TOT-IN-LINE.
645300     DISPLAY CTR-TOT-IN1-LINE.
645300     DISPLAY CTR-TOT-EXT-LINE.
645300     DISPLAY CTR-TOT-DPP-LINE.
645400     DISPLAY '   '.
645500     DISPLAY CTR-TOT-ERR-BYP-LINE.
645500     DISPLAY CTR-TOT-ERR-LINE.
645700     DISPLAY CTR-REG-BYP-LINE.
645800     DISPLAY CTR-EXP-BYP-LINE.
645900     DISPLAY '   '.
646000     DISPLAY CTR-TOT-POT-LINE.
646100     DISPLAY CTR-REG-POT-LINE.
646200     DISPLAY CTR-PNO-POT-LINE.
646300     DISPLAY CTR-TOT-NDR-LINE.
646400     DISPLAY '   '.
646500     DISPLAY '   '.
646600     DISPLAY '   '.
646700     DISPLAY CTR-TOT-PFR-LINE.
646800     DISPLAY CTR-TOT-TYPE4-LINE.
646900     DISPLAY CTR-NON-POT-LINE.
647000     DISPLAY '   '.
ray634* control total
647100     DISPLAY CTR-TOT-OUT-LINE.
647200     DISPLAY '   '.
647300     DISPLAY CTR-DUP-ERR-LINE.
647400     DISPLAY CTR-DUP-BYP-LINE.
647500     DISPLAY '   '.
ray634* adjusted output
647600     DISPLAY CTR-ADJUST-LINE.
647700     DISPLAY '   '.
647800     DISPLAY CTR-TOT-ITT-LINE.
647900     DISPLAY ' '.
647800     DISPLAY CTR-TOT-ITT2-LINE.
647900     DISPLAY ' '.
648000
648100*&***********************************************
648200*   FOR TEST - DATE PARAMETER SUPPLIED AT START *
648300*   USED INSTEAD OF SYSTEM DATE                 *
648400*************************************************
648500*   THIS CODE GETS THE END DATE AND TIME
648600*   END DATE MAY BE DIFFERENT THAN START
648700*   DATE IF PROCESSING AROUND MIDNIGHT
648800*************************************************
648900*    ACCEPT WA-CURR-DATE-IN FROM DATE.
649000     MOVE FUNCTION CURRENT-DATE(1:8) TO WA-CURR-DATE-IN.
649100     MOVE WA-CDI-MM           TO TDI-MM.
649200     MOVE WA-CDI-DD           TO TDI-DD.
649300     MOVE WA-CDI-YY           TO TDI-YY.
649400     ACCEPT WA-CURR-TIME-IN FROM TIME.
649500     MOVE WA-CTI-HH           TO TDI-HH.
649600     MOVE WA-CTI-MM           TO TDI-MI.
649700     MOVE WA-CTI-SS           TO TDI-SS.
649800     MOVE WA-CTI-100          TO TDI-100.
649900     DISPLAY ' '.
650000     DISPLAY ' '.
650100     DISPLAY '      **RP0326**  E N D   D A T E  ' TODAYS-DATE-IN.
650200
650300/
650400 7000-PRINT-SELECTED.
265700D    DISPLAY '7000-PRINT-SELECTED.        '.
265700     MOVE    '7000-PRINT-SELECTED.        ' TO WA-ERROR-PRM.

650500     IF IDX-WRK = 1
650600         MOVE W-WORK-WEEK TO W-SORT-WEEK
650700         PERFORM 7100-SORT-DATES
                        UNTIL IDX-WRK > 40
650900         MOVE W-WORK-WEEK TO W-WEEK1
651000         IF WEEK1-COUNTS-ONLY
651100             PERFORM 7010-ZERO-OTHER-WEEKS
651200         ELSE
651300             SET IDX-WK2-SI TO 1
651400             SET IDX-WK2 TO 1
651500             PERFORM 7200-MOVE-WEEK2
651600                      UNTIL IDX-WK2-SI = 16
651700             SET IDX-WRK TO 1
651800             MOVE W-WEEK2 TO W-SORT-WEEK
651900             PERFORM 7100-SORT-DATES
                            UNTIL IDX-WRK > 40
652100             MOVE W-WORK-WEEK TO W-WEEK2
652200             SET IDX-WK3-SI TO 1
652300             SET IDX-WK3 TO 1
652400             PERFORM 7210-MOVE-WEEK3
652500                      UNTIL IDX-WK3-SI = 16
652600             SET IDX-WRK TO 1
652700             MOVE W-WEEK3 TO W-SORT-WEEK
652800             PERFORM 7100-SORT-DATES
                            UNTIL IDX-WRK > 40
653000             MOVE W-WORK-WEEK TO W-WEEK3
653100             SET IDX-WK4-SI TO 1
653200             SET IDX-WK4 TO 1
653300             PERFORM 7220-MOVE-WEEK4
653400                      UNTIL IDX-WK4-SI = 16
653500             SET IDX-WRK TO 1
653600             MOVE W-WEEK4 TO W-SORT-WEEK
653700             PERFORM 7100-SORT-DATES
                            UNTIL IDX-WRK > 40
653900             MOVE W-WORK-WEEK TO W-WEEK4
654000             SET IDX-WK5-SI TO 1
654100             SET IDX-WK5 TO 1
654200             PERFORM 7230-MOVE-WEEK5
654300                      UNTIL IDX-WK5-SI = 16
654400             SET IDX-WRK TO 1
654500             MOVE W-WEEK5 TO W-SORT-WEEK
654600             PERFORM 7100-SORT-DATES
                            UNTIL IDX-WRK > 40
654800             MOVE W-WORK-WEEK TO W-WEEK5
654900         END-IF
655000         SET IDX-WK1 TO 1
655100         SET IDX-WK2 TO 1
655200         SET IDX-WK3 TO 1
655300         SET IDX-WK4 TO 1
655400         SET IDX-WK5 TO 1
655500     END-IF.
655600/
655700     IF W-STAT-SEL-DT-1 (IDX-WK1) NOT = '999999'
655800         MOVE '  /  /  ' TO STAT-SEL-DT-PRT-1
655900         MOVE W-STAT-SEL-YR-1 (IDX-WK1) TO STAT-SEL-YR-PRT-1
656000         MOVE W-STAT-SEL-MO-1 (IDX-WK1) TO STAT-SEL-MO-PRT-1
656100         MOVE W-STAT-SEL-DA-1 (IDX-WK1) TO STAT-SEL-DA-PRT-1
656200*****    MOVE ' SELECTED' TO STAT-SEL-1
656300         MOVE W-STAT-SEL-CNT-1 (IDX-WK1) TO STAT-SEL-CNT-PRT-1
656400         ADD W-STAT-SEL-CNT-1 (IDX-WK1) TO
656500                  CTR-STAT-TOT-SELECTED.
656600
656700**   IF W-STAT-SEL-DT-2 (IDX-WK2) NOT = '999999'
656800**      MOVE '  /  /  ' TO STAT-SEL-DT-PRT-2
656900**      MOVE W-STAT-SEL-YR-2 (IDX-WK2) TO STAT-SEL-YR-PRT-2
657000**      MOVE W-STAT-SEL-MO-2 (IDX-WK2) TO STAT-SEL-MO-PRT-2
657100**      MOVE W-STAT-SEL-DA-2 (IDX-WK2) TO STAT-SEL-DA-PRT-2
657200**      MOVE W-STAT-SEL-CNT-2 (IDX-WK2) TO STAT-SEL-CNT-PRT-2
657300**      ADD W-STAT-SEL-CNT-2 (IDX-WK2) TO CTR-STAT-TOT-SEL-2
657400**   END-IF
657500**   IF W-STAT-SEL-DT-3 (IDX-WK3) NOT = '999999'
657600**      MOVE '  /  /  ' TO STAT-SEL-DT-PRT-3
657700**      MOVE W-STAT-SEL-YR-3 (IDX-WK3) TO STAT-SEL-YR-PRT-3
657800**      MOVE W-STAT-SEL-MO-3 (IDX-WK3) TO STAT-SEL-MO-PRT-3
657900**      MOVE W-STAT-SEL-DA-3 (IDX-WK3) TO STAT-SEL-DA-PRT-3
658000**      MOVE W-STAT-SEL-CNT-3 (IDX-WK3) TO STAT-SEL-CNT-PRT-3
658100**      ADD W-STAT-SEL-CNT-3 (IDX-WK3) TO CTR-STAT-TOT-SEL-3
658200**   END-IF
658300**   IF W-STAT-SEL-DT-4 (IDX-WK4) NOT = '999999'
658400**      MOVE '  /  /  ' TO STAT-SEL-DT-PRT-4
658500**      MOVE W-STAT-SEL-YR-4 (IDX-WK4) TO STAT-SEL-YR-PRT-4
658600**      MOVE W-STAT-SEL-MO-4 (IDX-WK4) TO STAT-SEL-MO-PRT-4
658700**      MOVE W-STAT-SEL-DA-4 (IDX-WK4) TO STAT-SEL-DA-PRT-4
658800**      MOVE W-STAT-SEL-CNT-4 (IDX-WK4) TO STAT-SEL-CNT-PRT-4
658900**      ADD W-STAT-SEL-CNT-4 (IDX-WK4) TO CTR-STAT-TOT-SEL-4
659000**   END-IF
659100**   IF W-STAT-SEL-DT-5 (IDX-WK5) NOT = '999999'
659200**      MOVE '  /  /  ' TO STAT-SEL-DT-PRT-5
659300**      MOVE W-STAT-SEL-YR-5 (IDX-WK5) TO STAT-SEL-YR-PRT-5
659400**      MOVE W-STAT-SEL-MO-5 (IDX-WK5) TO STAT-SEL-MO-PRT-5
659500**      MOVE W-STAT-SEL-DA-5 (IDX-WK5) TO STAT-SEL-DA-PRT-5
659600**      MOVE W-STAT-SEL-CNT-5 (IDX-WK5) TO STAT-SEL-CNT-PRT-5
659700**      ADD W-STAT-SEL-CNT-5 (IDX-WK5) TO CTR-STAT-TOT-SEL-5
659800**   END-IF.
659900     IF W-STAT-SEL-DT-1 (IDX-WK1) NOT = '999999'
660000**            W-STAT-SEL-DT-2 (IDX-WK2) NOT = '999999' OR
660100**            W-STAT-SEL-DT-3 (IDX-WK3) NOT = '999999' OR
660200**            W-STAT-SEL-DT-4 (IDX-WK4) NOT = '999999' OR
660300**            W-STAT-SEL-DT-5 (IDX-WK5) NOT = '999999'
660400         IF SW-SEL = 'N'
660500             MOVE STAT-DET-A-1 TO REPORT-LINE
660600             WRITE REPORT-LINE
660700             MOVE 'Y' TO SW-SEL
660800         ELSE
660900             MOVE STAT-DET-A-1 TO REPORT-LINE
661000             MOVE SPACE TO STAT-DET-A1-CC
661100             WRITE REPORT-LINE.
661200
661300
661400     MOVE SPACE TO STAT-DET-A-1.
661500     SET IDX-WK1 UP BY 1.
661600**   SET IDX-WK2 UP BY 1.
661700**   SET IDX-WK3 UP BY 1.
661800**   SET IDX-WK4 UP BY 1.
661900**   SET IDX-WK5 UP BY 1.
662000
662100 7010-ZERO-OTHER-WEEKS.
265700D    DISPLAY '7010-ZERO-OTHER-WEEKS.      '.
265700     MOVE    '7010-ZERO-OTHER-WEEKS.      ' TO WA-ERROR-PRM.

662200     SET IDX-WK2 TO 1
662300     SET IDX-WK3 TO 1
662400     SET IDX-WK4 TO 1
662500     SET IDX-WK5 TO 1
           PERFORM 40 TIMES
662700       MOVE '999999' TO W-STAT-SEL-DT-2 (IDX-WK2)
662800       MOVE '999999' TO W-STAT-SEL-DT-3 (IDX-WK3)
662900       MOVE '999999' TO W-STAT-SEL-DT-4 (IDX-WK4)
663000       MOVE '999999' TO W-STAT-SEL-DT-5 (IDX-WK5)
663100       SET IDX-WK2 UP BY 1
663200       SET IDX-WK3 UP BY 1
663300       SET IDX-WK4 UP BY 1
663400       SET IDX-WK5 UP BY 1
663500     END-PERFORM.
663700
663800 7100-SORT-DATES.
265700D    DISPLAY '7100-SORT-DATES.            '.
265700     MOVE    '7100-SORT-DATES.            ' TO WA-ERROR-PRM.

663900     MOVE '999999' TO W-STAT-SEL-DT (IDX-WRK).
664000     SET IDX-SORT TO 1.
664100     PERFORM 7240-SORT-DATES
                    UNTIL IDX-SORT > 40.
664300     SET IDX-SORT TO IDX-SAVE.
664400     MOVE ZERO TO W-COUNT-SORT (IDX-SORT).
664500     SET IDX-WRK UP BY 1.
664600
664700 7200-MOVE-WEEK2.
265700D    DISPLAY '7200-MOVE-WEEK2.            '.
265700     MOVE    '7200-MOVE-WEEK2.            ' TO WA-ERROR-PRM.

664800     MOVE SI-WK2-SEL-DT (IDX-WK2-SI)
664900                 TO W-STAT-SEL-DT-2 (IDX-WK2).
665000*Y2K COMPUTE WA-ADJ-SIGNED-DT = W-SIGNED-DT / 10.
665100*Y2K MOVE WA-ADJ-SIGNED-DT TO W-STAT-SEL-DT-2 (IDX-WK2).
665200     MOVE SI-WK2-SEL-CNT (IDX-WK2-SI) TO
665300              W-STAT-SEL-CNT-2 (IDX-WK2).
665400     SET IDX-WK2-SI UP BY 1.
665500     SET IDX-WK2 UP BY 1.
665600
665700 7210-MOVE-WEEK3.
265700D    DISPLAY '7210-MOVE-WEEK3.            '.
265700     MOVE    '7210-MOVE-WEEK3.            ' TO WA-ERROR-PRM.

665800     MOVE SI-WK3-SEL-DT (IDX-WK3-SI)
665900                 TO W-STAT-SEL-DT-3 (IDX-WK3).
666000*Y2K COMPUTE WA-ADJ-SIGNED-DT = W-SIGNED-DT / 10.
666100*Y2K MOVE WA-ADJ-SIGNED-DT TO W-STAT-SEL-DT-3 (IDX-WK3).
666200     MOVE SI-WK3-SEL-CNT (IDX-WK3-SI) TO
666300              W-STAT-SEL-CNT-3 (IDX-WK3).
666400     SET IDX-WK3-SI UP BY 1.
666500     SET IDX-WK3 UP BY 1.
666600
666700 7220-MOVE-WEEK4.
265700D    DISPLAY '7220-MOVE-WEEK4.            '.
265700     MOVE    '7220-MOVE-WEEK4.            ' TO WA-ERROR-PRM.

666800     MOVE SI-WK4-SEL-DT (IDX-WK4-SI)
666900                 TO W-STAT-SEL-DT-4 (IDX-WK4).
667000*Y2K COMPUTE WA-ADJ-SIGNED-DT = W-SIGNED-DT / 10.
667100*Y2K MOVE WA-ADJ-SIGNED-DT TO W-STAT-SEL-DT-4 (IDX-WK4).
667200     MOVE SI-WK4-SEL-CNT (IDX-WK4-SI) TO
667300              W-STAT-SEL-CNT-4 (IDX-WK4).
667400     SET IDX-WK4-SI UP BY 1.
667500     SET IDX-WK4 UP BY 1.
667600/
667700 7230-MOVE-WEEK5.
265700D    DISPLAY '7230-MOVE-WEEK5.            '.
265700     MOVE    '7230-MOVE-WEEK5.            ' TO WA-ERROR-PRM.

667800     MOVE SI-WK5-SEL-DT (IDX-WK5-SI)
667900                 TO W-STAT-SEL-DT-5 (IDX-WK5).
668000*Y2K COMPUTE WA-ADJ-SIGNED-DT = W-SIGNED-DT / 10.
668100*Y2K MOVE WA-ADJ-SIGNED-DT TO W-STAT-SEL-DT-5 (IDX-WK5).
668200     MOVE SI-WK5-SEL-CNT (IDX-WK5-SI) TO
668300              W-STAT-SEL-CNT-5 (IDX-WK5).
668400     SET IDX-WK5-SI UP BY 1.
668500     SET IDX-WK5 UP BY 1.
668600
668700 7240-SORT-DATES.
265700D    DISPLAY '7240-SORT-DATES.            '.
265700     MOVE    '7240-SORT-DATES.            ' TO WA-ERROR-PRM.

668800     IF W-COUNT-SORT (IDX-SORT) NOT = ZERO
668900         IF W-DATE-SORT (IDX-SORT) < W-STAT-SEL-DT (IDX-WRK)
669000             MOVE W-ENTRY-SORT (IDX-SORT) TO
669100                      W-STAT-SEL-ENTRY (IDX-WRK)
669200             SET IDX-SAVE TO IDX-SORT
669300         ELSE
669400             NEXT SENTENCE.
669500     SET IDX-SORT UP BY 1.
669600
669700*7400-WRITE-WEEK-RANGE.
265700**   DISPLAY '7400-WRITE-WEEK-RANGE.      '.
265700**   MOVE    '7400-WRITE-WEEK-RANGE.      ' TO WA-ERROR-PRM.
      **
669800**   MOVE SI-STRT-YR (IDX-WK) TO PRT-STRT-YR.
669900**   MOVE SI-STRT-MO (IDX-WK) TO PRT-STRT-MO.
670000**   MOVE SI-STRT-DA (IDX-WK) TO PRT-STRT-DA.
670100**   MOVE SI-STOP-YR (IDX-WK) TO PRT-STOP-YR.
670200**   MOVE SI-STOP-MO (IDX-WK) TO PRT-STOP-MO.
670300**   MOVE SI-STOP-DA (IDX-WK) TO PRT-STOP-DA.
670400**   MOVE PRT-DET-B-13 TO REPORT-LINE.
670500**   WRITE REPORT-LINE.
670600**   MOVE SPACE TO PRT-DET-B-13-1.
670700**   ADD 1 TO PRT-WEEK-NR.
670800**   SET IDX-WK UP BY 1.
670900/
671000 8000-NCOA-ADDR-VALIDATION.
265700D    DISPLAY '8000-NCOA-ADDR-VALIDATION.  '.
265700     MOVE    '8000-NCOA-ADDR-VALIDATION.  ' TO WA-ERROR-PRM.

671100**************************************************************
671200*  THE FOLLOWING PROCESS PERFORMS SAME ADDRESS VALIDATIONS AS
671300*  IN PROGRAM RP0826.  RECORDS WHICH HAVE INVALID ADDRESSES
671400*  WILL BE MARKED WITH A 'B' IN THE ADDRESS FLAG, AND ARE NOT
671500*  COUNTED AS ADDRESS ERRORS WHEN RETURNED FROM NCOA, NOR ARE
671600*  THEY VALIDATED AGAIN FOR CORRECT ADDRESS INFO AT THAT POINT.
671700**************************************************************
671800*********************************************************
671900*  ADDRESS LINE 1 MUST BE PRESENT.  LINES 2 AND 3 MAY   *
672000*  BE BLANK, BUT IF DATA PRESENT, 1ST CHARACTER CANNOT  *
672100*  BE A SPACE.                                          *
672200*********************************************************
672300     IF PO-SORT-ADS (1:1) = SPACE
672400         MOVE 'B' TO PO-ADDR-IND
672500         GO TO 8009-EXIT
672600     END-IF
672700     IF PO-RO2 = SPACE
672800         CONTINUE
672900     ELSE
673000         IF PO-RO2 (1:1) = SPACE
673100             MOVE 'B' TO PO-ADDR-IND
673200             GO TO 8009-EXIT
673300         END-IF
673400     END-IF
673500     IF PO-RO3 = SPACE
673600         CONTINUE
673700     ELSE
673800         IF PO-RO3 (1:1) = SPACE
673900             MOVE 'B' TO PO-ADDR-IND
674000             GO TO 8009-EXIT
674100         END-IF
674200     END-IF
674300
674400*********************************************************
674500*  VALIDATE CITY & COUNTY
674600*  IF DUPLICATE CITY (RETURN CODE 6), ASSUME COUNTY CODE
674700*  FROM VR DATABASE IS CORRECT: DO NOT CHANGE
674800*********************************************************
674900     IF PO-ROCITY (1:1) = SPACE
675000         MOVE 'B' TO PO-ADDR-IND
675100         GO TO 8009-EXIT
RD1722     END-IF
RD1722     IF PO-REG-CO = 60 GO TO 8009-EXIT  END-IF
RD1722*** FINALIST START ---------------------------------------
RD1722     PERFORM   8100-CALL-FINALIST-USPCBM01
RD1722***                                   PO = POTREC copymember
RD1722     EVALUATE  FINALIST-RETURN-CODE
RD1722         WHEN  0
RD1722                 MOVE FINALIST-RET2-ROCC          TO PO-REG-CO
RD1722                 IF PO-ALCO = 0
RD1722                    IF      FINALIST-RET2-ROCC
RD1722                      NOT = FINALIST-RET1-ALCO
RD1722                         MOVE FINALIST-RET1-ALCO  TO PO-ALCO
RD1722                    END-IF
RD1722                 END-IF
RD1722         WHEN  6
RD1722                 CONTINUE
RD1722         WHEN  OTHER
RD1722                 MOVE 'B' TO PO-ADDR-IND
RD1722     END-EVALUATE
RD1722*** FINALIST END -----------------------------------------
RD1722     .
677500
677600 8009-EXIT.
677700     EXIT.
677500
rd1722**************************************************************
RD1722*8100-CALL-FINALIST-USPCBM01. FINALIST COUNTY CODE GENERATOR
rd1722**************************************************************
RD1722 8100-CALL-FINALIST-USPCBM01.
265700D    DISPLAY '8100-CALL-FINALIST-USPCBM01.'.
265700     MOVE    '8100-CALL-FINALIST-USPCBM01.' TO WA-ERROR-PRM.

rd1722     INITIALIZE FINALIST-USPCBM01-PARMS
rd1722                FINALIST-RETURN-RECORD
rd1722     SET FINALIST-CITY-COUNTY-SEARCH TO TRUE
rd1722     MOVE PO-SORT-ADS           tO  FINALIST-LK-ADDR1
rd1722     IF PO-RO2-IND = 'A'
rd1722         MOVE PO-RO2            TO  FINALIST-LK-ADDR2
rd1722     END-IF
rd1722     IF PO-RO3-IND = 'A'
RD1722         MOVE PO-RO3            TO  FINALIST-LK-ADDR3
RD1722     END-IF
RD1722     MOVE  PO-ROCITY   (1:13)   tO  FINALIST-LK-CITY.
RD1722
RD1722     CALL  FINALIST-call-PGM-ID   using
rd1722             FInalist-LK-BUFFER
RD1722             FINALIst-LK-FUNC-CODE
rd1722             FInalist-LK-CITY
rd1722             FInalist-LK-ADDR
rd1722             FInalist-RET-AREA-1
RD1722             FInalist-RET-AREA-2
RD1722     END-CALL
RD1722     .
RD1722*** ON FINAL CALL MOVE THE LITERAL 'EOF'
RD1722*** TO THE IN-ADDRESS AREA
rd1722*** AND MAKE THE CALL.
rd1722***
RD1722*8100-CALL-FINALIST-USPCBM01. END
RD1722*--------------------------------
rd1722***
679900****************************************************
680000 9999-USE-TEST-DATE.
679900****************************************************
265700D    DISPLAY '9999-USE-TEST-DATE.         '.
265700     MOVE    '9999-USE-TEST-DATE.         ' TO WA-ERROR-PRM.

680100*&*************************************************
680200*  CODE ADDED FOR TEST ONLY - CHANGE SYSTEM DATE  *
680300***************************************************
680400*&**************************************************
680500*  ADDED FOR CHANGING THE SYSTEM DATE TO A DATE IN *
680600*  THE FUTURE OR IN THE PAST                       *
680700*                                                  *
680800*  TO USE:  IN THE FIRST EXTRACT RECORD, CHANGE:   *
680900*  1. CHANGE:
681000*               BYTES 2-4 FROM 407 TO 519 FOR      *
681100*               CENTURY = 19, OR CHANGE 407 TO 520 *
681200*               FOR CENTURY = 20                   *
681300*                                                  *
681400*  2.  CHANGE:                                     *
681500*               BYTES 5-8 FOR TEST MONTH AND YEAR: *
681600*                                                  *
681700*      EXAMPLES:               YYMM                *
681800*          03/01/94      RID = 9403                *
681900*          12/31/94      RID = 9424 (12 + 12 = (24)*
682000*          04/30/98      RID = 9816 (12 + 04 = (16)*
682100*  DESCRIPTION:                                    *
682200*  THE FIRST TWO BYTES ARE THE YEAR.               *
682300*  THE SECOND TWO BYTES REPRESENT THE MONTH.       *
682400*  FOR END OF THE MONTH PROCESSING ADD 12 TO THE   *
682500*  MONTH POSITION (SEE EXAMPLE ABOVE).             *
682600*                                                  *
682700*  THE SECOND TWO BYTES WILL BE USED TO ACCESS     *
682800*  THE TABLE TO EXTRACT THE JULIAN DAY AND MMDD    *
682900*  TO REPLACE THE SYSTEM DATE                      *
683000*&***********************************************
683100     IF EXT-TEST-CC-19
683200         MOVE 19 TO WA-CDI-CC WA-JDATE-CC
683300     ELSE
683400         MOVE 20 TO WA-CDI-CC WA-JDATE-CC.
683500
683600     MOVE EXT-TEST-YY TO WA-CDI-YY   TDI-YY
683700                         WA-RPT-YR   WA-JDATE-YY.
683800     MOVE TEST-DT-MM (EXT-TEST-MM)
683900                          TO WA-CDI-MM TDI-MM WA-RPT-MO.
684000     MOVE TEST-DT-DD (EXT-TEST-MM)
684100                          TO WA-CDI-DD TDI-DD WA-RPT-DA.
684200     MOVE TEST-DT-JJJ (EXT-TEST-MM) TO WA-JDATE-DDD.
684300     COMPUTE WA-NEXT-YR = WA-YR + 1.
684400     COMPUTE WA-LAST-YR = WA-YR - 1.
684500     COMPUTE WA-SEL-YR = WA-YR - 5.
684600
684700     DISPLAY ' '.
684800     DISPLAY '  O V E R R I D E   D A T E *******' TODAYS-DATE-IN
684900                    '      B A T C H   I D - ' WA-BATCH-ID.
685000     DISPLAY ' '.
685100     DISPLAY ' '.
685200*************************************************
685300
685400
685500 PROGRAM-STOP-RETURN.
685600*PSR-010.
685700 PSR-EXIT.
685800     GOBACK.
      *******************************************************
      ***  End-Of-Program  RP0326
      *******************************************************
