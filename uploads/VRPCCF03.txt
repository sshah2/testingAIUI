                    TITLE 'VRPCCF03 - RESPONSE FORMATTER MODULE'
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    VRPCCF03.
       AUTHOR.        EDS.
       DATE-WRITTEN.  06/01/09.
       DATE-COMPILED. MM/DD/YY.
      *****************************************************************
      * IDENTIFICATION:
      *       MODULE ID:     VRPCCF03
      *       MODULE TYPE:   CALLED SUBROUTINE
      *       LANGUAGE:      ENTERPRISE COBOL FOR Z/OS
      *       ENVIRONMENT:   CICS
      *       DATABASE:      N/A
      * ---------------------------------------------------------------
      *                                                               *
      * PURPOSE: THE PURPOSE OF THIS MODULE IS TO FORMAT THE RESPONSE *
      *          OR AN ERROR MESSAGE SENT BY THE TRANSACTION          *
      *          CONTROLLER                                           *
      * ------------------------------------------------------------- *
      * DESCRIPTION:                                                  *
      *          THIS MODULE IS CALLED BY THE TRANSACTION CONTROLLER  *
      *          FOR TRANSACTIONS R60 AND R62. THIS MODULE FORMATS    *
      *          EITHER AN ERROR MESSAGE OR A RESPONSE.               *
      *                                                               *
      * --------------------------------------------------------------*
      *                                                               *
      * INPUTS:  TDS COMMON FIXED PACKET (TRFX)                       *
      *          VR DATA PACKETS                                      *
      *                                                               *
      * --------------------------------------------------------------*
      *                                                               *
      * OUTPUTS: RETURN CODE                                          *
      *          TEMPORARY STORAGE QUEUE                              *
      * --------------------------------------------------------------*
      *                                                               *
      * CHANGES:                                                      *
      *    CCYY/MM/DD  FUNDING SOURCE & DESCRIPTION OF CHANGE         *
      *    ----------  -----------------------------------------------*
      *    2009/06/01  TC07-009 DED RTCI1 - INITIAL CODING            *
      *    2009/10/30  DEFECT#678 - NEW PARAGRAPH 2215- ADDED FOR     *
      *                             MULTI VIN MESSAGE                 *
      *    2009/11/11  DEFECT#727 - PARAGRAPH 2105- CHANGED TO CHECK  *
      *                FOR SPACE IN FIRST BYTE OF VIN IN IREQ AND     *
      *                MOVE ONE BYTE LEFT IF PRESENT                  *
      *    2009/11/11  DEFECT#840 - PARAGRAPH 5155- CHANGED TO ADD A  *
      *                SKIP LINE AFTER MESSAGE L-CUR-ON-OTH-VIN       *
      *    2009/11/11  DEFECT#841 - PARAGRAPH 3010- CHANGED TO CHECK  *
      *                FOR VIN INQUIRY TO MOVE MSG L-CUR-ON-OTH-VIN   *
      *    2009/11/11  DEFECT#857 - PARAGRAPH 2200- CHANGED TO CHECK  *
      *                FOR TYPE RECORD CODES BEFORE MOVING MESSAGE    *
      *                L-RETRY-48-HRS                                 *
      *    2009/11/11  DEFECT#865 - PARAGRAPH 5205- CHANGED TO CHECK  *
      *                FOR REASON CODE '01' FOR MOVING MESSAGE        *
      *                L-TST-ANNU-INS                                 *
      *    2009/11/11  DEFECT#883 -                                   *
      *                CODE MODIFIED TO CHECK WS-FIL-CD               *
      *                INSTEAD PRKY-FILE-CODE FOR VALUE 'V'           *
      *    2009/11/17  DEFECT#841 - NEW FLAG CUR-ON-OTH-VIN-MSG-WRTN  *
      *                SET IN 3010- TO AND CHECK IN 5155- IF MESSAGE  *
      *                WRITTEN                                        *
      *    2009/11/17  DEFECT#867 - CHANGES TO 'C' SUB-RECORD TO SKIP *
      *                'CYL:' IF SPACES - COPYBOOK VRCXCF27           *
      *    2009/11/17  DEFECT#870 - CHANGES TO 'Z' SUB-RECORD TO      *
      *                FORMAT 2ND AND 3RD LINE ADDRESS - VRCXCF37     *
      *    2009/11/23  DEFECT#948 - CHANGES TO 'H' SUB-RECORD TO      *
      *                DISPLAY TEXT 'RECEIPT DATE(S)'                 *
      *    2009/11/23  DEFECT#989 - CHANGES TO 2205- SET ERROR-RTN    *
      *                FLAG                                           *
      *    2009/11/23  DEFECT#996 - CHANGES TO 6055- PACKET ID FROM   *
      *                UYP TO VYP                                     *
      *    2009/12/02  DEFECT#846 - SKIP VEHICLE INFO LOGIC ADDED     *
      *                FOR VBB-VRC-PRESENT(30) PRESENT CASE           *
      *    2009/12/31  DEFECT#993 - ZZ/2DPA PLATES LOGIC CORRECTED    *
      *                TO SYNC DCS                                    *
      *                DEFECT#1078 CORRECT INSURANCE MESSAGE          *
      *    2010/02/18  DEFECT#1221 FIX PTI TRAILER MESSAGE            *
      *                DEFECT#1222 FIX PTI TRAILER MESSAGE            *
      *                DEFECT#1237 FIX INVALID READ MESSAGE           *
      *    2010/03/04  DEFECT#1228 FIX TO DISPLAY SALVAGE CERT MGG    *
      *                DEFECT#1358,1396 FIX DISPLAY OF ADDRESS CONFI  *
      *                -DENTIAL MESSAGE                               *
      *                DEFECT#1405 FIX TO RETURN TO TC IF RETENTION   *
      *                AND NOT INHOUSE AND F-SUB-REC > 0              *
      *                DEFECT#1232 FIX TO DISPALY 'DOJ STOP-REFERRAL' *
      *                WHEN STATUS IS 'D' AND 'R'.                    *
      *                DEFECT#1233 FIX TO DISPALY 'OUT-OF-STATE LIC   *
      *                FLAG'                                          *
      *                DEFECT#1245 FIX MESSAGE 'INVITATION TO RENEW   *
      *                                         (ITR)'                *
      *    2010/03/18  DEFECT#1064 DISPLAY '# TRNSFR:' UNCONDITIONALLY*
      *                DEFECT#1210 DISPLAY 'RCD:' UNCONDITIONALLY     *
      *                DEFECT#1266 FIX TO DISPLAY 'CALIF TITLE ISSUED'*
      *                MESSAGE                                        *
      *                DEFECT#1267 FIX TO DISPLAY "VEHICLE CURRENTLY  *
      *                NOT REGISTERED" MESSAGE                        *
      *                DEFECT#1282 FIX TO DISPLAY TAX CODE IN USETAX: *
      *                DEFECT#1286 FIX TO DISPLAY ADDITIONAL DATA     *
      *                CORRECTLY FOR E-30                             *
      *                DEFECT#1290 FIX TO DISPLAY CITATION TRANSFER   *
      *                DATE CORRECTLY                                 *
      *                DEFECT#1296 CHANGES   FOR DISPLAYING MESSAGE   *
      *                'SURR AND/OR CANCELLED'                        *
      *                DEFECT#1299 FIX TO DISPLAY MESSAGE             *
      *                'INVALID VETERANS ORGANIZATION CODE'           *
      *                DEFECT#1300 FIX E-80 FORMATTING                *
      *                DEFECT#1306 FIX DATE FORMATTING FOR 'H' SUBREC *
      *                DEFECT#1364 & 1514 RESTRICT DISPLAY OF E-65    *
      *                FOR LINES OTHER THAN RAD1 & CRU1               *
      *    2010/04/01  DEFECT#1218 DISPLAY SUBPLATE T.L MESSAGES.     *
      *                DEFECT#1283 FIX TO PROCESS VEH VES INFORMATION.*
      *                DEFECT#1302 DISPLAY 'DEALER STOP' MESSAGES.    *
      *                DEFECT#1303 FIX NOT TO DISPLAY VLT MSG IF RCD. *
      *                AND REASON CODE NOT PRESENT.                   *
      *                DEFECT#1382 FIX TO DISPLAY 'NO MAILING ADDRESS'*
      *                MESSAGE.                                       *
      *                DEFECT#1389 FIX TO DISPLAY 'NO MAILING ADDRESS'*
      *                MESSAGE.                                       *
      *                DEFECT#1436 FIX FROM DATE CALCULATION IN 2050- *
      *                DEFECT#1587 SKIPLINE AFTER E-22,23,24 AND 25   *
      *                MESSAGES                                       *
      *                DEFECT#1597 FIX TO MOVE VSL-BUILT-YR TO AST YR *
      *                IF TYP LIC IS 'V'                              *
      *    2010/04/15  DEFECT#1266 FIX TO DISPLAY 'CALIF TITLE ISSUED'*
      *                MESSAGE                                        *
      *                DEFECT#1352 FIX TO MOVE SPACES IN U SUB-RECORD *
      *                DATES WHEN ZEROS                               *
      *    2010/04/29  DEFECT#1394 FIX TO DISPLAY CITY, CC AND ZIP FOR*
      *                REQ 71717                                      *
      *                DEFECT#1450 FIX TO DISPLAY 24 LINES FOR 0 T0 4 *
      *                INFO CODES OF 'P' SUBRECORD                    *
      *                DEFECT#1645 FIX TO FORMAT E66 AND E67 ADDITION-*
      *                AL DATA                                        *
      *    2010/05/27  REDECED CICS FOOTPRINT AT BEHEST OF DMV        *
      *    2010/10/13  WS3 - REPLACED STRUCTURE MAPPER WITH STRUCTURE *
      *                MANAGER AND REMOVED TDS/ADS IN LINKAGE SECTION *
      *    2010/10/27  PRIORITY MEMO RBME-0810 - ADDED GOLD STAR      *
      *                FAMILY LICENSE TEST FOR SUB-RECORD E.          *
      *    2010/12/06  PROD FIX FOR DISPLAYING STOP MESSAGES WHEN BOTH*
      *                STOP AND INVALID KEY PRESNET ON A PLATE.       *
      *    2011/01/04  PROD FIX FOR EXITING 6510- LOOP FOR A INVALID  *
      *                VIN RECORD.                                    *
      *                RETURN WITH ERROR IF PAGES WRITTEN TO TSQ IS   *
      *                MORE THAN 20.                                  *
      *    2012/03/12  TA-10393 DED DWB10 - MODIFIED TO USE THE NEW   *
      *                IACB COPYBOOK - NO ADDITIONAL PACKET NEEDED.   *
      *    2012/05/14  WS4 - UPDATE FOR MODIFIED VVP PACKET           *
      *    2012/06/25  WS4 - FIX TO CALL AFTER STRUCTURE MANAGER.  VVP*
      *                PACKET WAS NOT ADDED TO THE "NO MORE" LIST.    *
      *    2013/05/22  REMEDY TICKET: 611474 TIP DISPLAY PROBLEM      *
      *    2013/07/24  RBCC-0933 PET LOVERS PLATE                     *
      *    2013/07/24  RBCB-0234 QUAGGA MUSSEL FEE                    *
      *    2014/01/27  REWA-3253 AUTONOMOUS VEHICLE E49 RCC 14        *
      *    2014/07/11  CR8668 PRODUCTION FIX UNT: HND: HEADINGS       *
      *    2014/12/26  CR10002 1960 LEGACY PLATES                     *
      *    2016/01/28  RCH-3435 CALIFORNIA MUSEUM PLATES(SNOOPY)      *
      *    2017/03/16  RAM-0197 SMOG VERBAGE CHANGE TO STAR STATION   *
      *    2017/06/28  RBP-1616 NON COMPLYING ROV T/L 2X AND 2Y       *
      *    2017/06/28  RCI-2506 SPECIAL EQUIPTMENT T/L EA - EJ        *
      *    2017/06/28  RBW-2016 TITLE ONLY ROV AND HOV T/L CA         *
      *    2017/07/25  RBI-1097 BREAST CANCER AWARENESS PLATES        *
RA0709*    2019/06/12  RAR-0709 CARB HEAVY DUTY VR COMPLIANCE PRGRAM  *
RA0709*                NEW RCC-85 MESSAGE                             *
      *    2021/03/18  NEW HV CONFIGURATION                           *
      *    2021/11/05  ROD-2020-2882 AUTONOMOUS VEHICLE E49 RCC 16    *
      /****************************************************************
       ENVIRONMENT DIVISION.
      /*
       DATA DIVISION.

      ******************************************************************
      *       W O R K I N G  S T O R A G E  S E C T I O N              *
      ******************************************************************
       WORKING-STORAGE SECTION.

       01  FILLER                           PIC X(24)  VALUE
           'WS-START  VRPCCF03 ---->'.


      ******************************************************************
      *     WORK-AREA                                                  *
      ******************************************************************
       01  WS-WORK-AREAS.

           05  ARRAY-PKTS.
               10  ARRAY-PKT-ID             PIC X(04)
                                            OCCURS 50 TIMES.

           05  WS-TEMP-INFO-CODE            PIC X(01) VALUE SPACE.
               88  VEH-INFO                 VALUE '0'.
               88  VEH-RO-INFO              VALUE '1'.
               88  VEH-RO-LO-INFO           VALUE '2'.
               88  VEH-RO-LO-ADD-INFO       VALUE '3'.
               88  VEH-RO-LO-ADD-PEN-INFO   VALUE '4'.

      * RECORD CONDITION CODES
           COPY VRCXCF05.

           05  WS-REASON-CD-E19             PIC X(02).
               88  RCD-00-E19               VALUE '00'.
               88  RCD-01-E19               VALUE '01'.
               88  RCD-02-E19               VALUE '02'.
               88  RCD-03-E19               VALUE '03'.
               88  RCD-04-E19               VALUE '04'.
               88  RCD-05-E19               VALUE '05'.
               88  RCD-06-E19               VALUE '06'.
               88  RCD-07-E19               VALUE '07'.
               88  RCD-08-E19               VALUE '08'.
               88  RCD-SP-E19               VALUE '  '.

           05  WS-REASON-CD-E26             PIC X(02).
               88  RCD-01-E26               VALUE '01'.
               88  RCD-02-E26               VALUE '02'.
               88  RCD-16-E26               VALUE '16'.
               88  RCD-17-E26               VALUE '17'.
               88  RCD-21-E26               VALUE '21'.
               88  RCD-31-E26               VALUE '31'.

           05  WS-REASON-CD-E33             PIC X(02).
               88  RCD-02-E33               VALUE '02'.
               88  RCD-03-E33               VALUE '03'.
               88  RCD-04-E33               VALUE '04'.
               88  RCD-05-E33               VALUE '05'.
               88  RCD-06-E33               VALUE '06'.
               88  RCD-07-E33               VALUE '07'.
               88  RCD-08-E33               VALUE '08'.
               88  RCD-09-E33               VALUE '09'.

           05  WS-REASON-CD-E46             PIC X(02).
               88  RCD-01-E46               VALUE '01'.
               88  RCD-02-E46               VALUE '02'.
               88  RCD-03-E46               VALUE '03'.
               88  RCD-04-E46               VALUE '04'.
               88  RCD-09-E46               VALUE '09'.
               88  RCD-10-E46               VALUE '10'.
               88  RCD-11-E46               VALUE '11'.

           05  WS-REASON-CD-E49             PIC X(02).
               88  RCD-01-E49               VALUE '01'.
               88  RCD-02-E49               VALUE '02'.
               88  RCD-03-E49               VALUE '03'.
               88  RCD-04-E49               VALUE '04'.
               88  RCD-05-E49               VALUE '05'.
               88  RCD-06-E49               VALUE '06'.
               88  RCD-07-E49               VALUE '07'.
               88  RCD-08-E49               VALUE '08'.
               88  RCD-09-E49               VALUE '09'.
               88  RCD-10-E49               VALUE '10'.
               88  RCD-11-E49               VALUE '11'.
               88  RCD-12-E49               VALUE '12'.
               88  RCD-13-E49               VALUE '13'.
               88  RCD-14-E49               VALUE '14'.
               88  RCD-16-E49               VALUE '16'.

           05  WS-REASON-CD-E61             PIC X(02).
               88  RCD-01-E61               VALUE '01'.
               88  RCD-02-E61               VALUE '02'.
               88  RCD-03-E61               VALUE '03'.

           05  WS-REASON-CD-E62             PIC X(02).
               88  RCD-01-E62               VALUE '01'.
               88  RCD-02-E62               VALUE '02'.
               88  RCD-03-E62               VALUE '03'.
               88  RCD-04-E62               VALUE '04'.
               88  RCD-05-E62               VALUE '05'.
               88  RCD-06-E62               VALUE '06'.
               88  RCD-07-E62               VALUE '07'.

           05  WS-REASON-CD-E81             PIC X(02).
               88  RCD-02-E81               VALUE '02'.
               88  RCD-03-E81               VALUE '03'.
               88  RCD-04-E81               VALUE '04'.

           05  WS-REASON-CD-E82             PIC X(02).
               88  RCD-01-E82               VALUE '02'.

           05  WS-UNIT-CD                   PIC X(02).
           05  WS-UNIT-CD-E44               PIC X(01).
               88  UCD-A-E44                VALUE 'A'.
               88  UCD-C-E44                VALUE 'C'.
               88  UCD-D-E44                VALUE 'D'.
               88  UCD-E-E44                VALUE 'E'.
               88  UCD-F-E44                VALUE 'F'.
               88  UCD-G-E44                VALUE 'G'.
               88  UCD-H-E44                VALUE 'H'.
               88  UCD-I-E44                VALUE 'I'.
               88  UCD-J-E44                VALUE 'J'.
               88  UCD-K-E44                VALUE 'K'.
               88  UCD-L-E44                VALUE 'L'.
               88  UCD-M-E44                VALUE 'M'.
               88  UCD-P-E44                VALUE 'P'.
               88  UCD-Q-E44                VALUE 'Q'.
               88  UCD-S-E44                VALUE 'S'.
               88  UCD-T-E44                VALUE 'T'.
               88  UCD-U-E44                VALUE 'U'.
               88  UCD-V-E44                VALUE 'V'.
               88  UCD-W-E44                VALUE 'W'.
               88  UCD-Y-E44                VALUE 'Y'.
10002          88  UCD-Z-E44                VALUE 'Z'.

           05  WS-JMSG                      PIC X(30) VALUE SPACES.

           05  WS-TYPE-VEH-VSL-CD           PIC X(02).
               88  VEH-CD-11                VALUE '10' THRU '19'.
               88  VEH-CD-20                VALUE '20' THRU '29'.
               88  VEH-CD-31                VALUE '31' THRU '39'.

           05  WS-SUB-RECORD                PIC X(01).
               88  SUB-REC-B                VALUE 'B'.
               88  SUB-REC-C                VALUE 'C'.
               88  SUB-REC-D                VALUE 'D'.
               88  SUB-REC-E                VALUE 'E'.
               88  SUB-REC-F                VALUE 'F'.
               88  SUB-REC-G                VALUE 'G'.
               88  SUB-REC-H                VALUE 'H'.
               88  SUB-REC-J                VALUE 'J'.
               88  SUB-REC-K                VALUE 'K'.
               88  SUB-REC-L                VALUE 'L'.
               88  SUB-REC-M                VALUE 'M'.
               88  SUB-REC-N                VALUE 'N'.
               88  SUB-REC-P                VALUE 'P'.
               88  SUB-REC-R                VALUE 'R'.
               88  SUB-REC-S                VALUE 'S'.
               88  SUB-REC-T                VALUE 'T'.
               88  SUB-REC-U                VALUE 'U'.
               88  SUB-REC-V                VALUE 'V'.
               88  SUB-REC-W                VALUE 'W'.

           05  WS-TYPE-RECORD-CD            PIC X(01).
               88  REC-TYP-SUBPL            VALUE '1'.
               88  REC-TYP-UNACCEPTABLE     VALUE '2'.
               88  REC-TYP-RESERVATION      VALUE '3'.
               88  REC-TYP-RETENTION        VALUE '4'.
               88  REC-TYP-OWNPLATE         VALUE '5'.
               88  REC-TYP-SUSPENSE         VALUE '6'.
               88  RT-BAS-OWN-SUS           VALUE '0', '5', '6'.
               88  RT-BAS-SUB-OWN-SUS-PSE   VALUE
                            '0', '1', '5', '6', '7'.
               88  RT-BAS-SUB-RET-OWN-SUS-PSE
                                            VALUE
                            '0', '1', '4', '5', '6', '7'.
               88  RT-BAS-RET-OWN-SUS-PSE
                                            VALUE
                            '0', '4', '5', '6', '7'.
               88  RT-BAS-UNA-ELP-RET-OWN-SUS-PSE
                                            VALUE
                            '0', '2', '3', '4', '5', '6', '7'.
               88  RT-BAS-SUB-ELP-RET-OWN-SUS-PSE
                                            VALUE
                            '0', '1', '3', '4', '5', '6', '7'.

           05  WS-LN1-ADDR-WRITTEN-SW       PIC 9(01).
               88 LN1-ADDR-WRITTEN          VALUE 1.
           05  WS-LN2-ADDR-WRITTEN-SW       PIC 9(01).
               88 LN2-ADDR-WRITTEN          VALUE 2.
           05  WS-LN3-ADDR-WRITTEN-SW       PIC 9(01).
               88 LN3-ADDR-WRITTEN          VALUE 3.
           05  WS-LN4-ADDR-WRITTEN-SW       PIC 9(01).
               88 LN4-ADDR-WRITTEN          VALUE 4.

           05  WS-RTS-LINE-FOUND-SW         PIC X(01).
               88 RTS-LINE-NOT-FOUND        VALUE 'N'.
               88 RTS-LINE-FOUND            VALUE 'Y'.
           05  WS-VALID-VIN-FILE-CD         PIC X(01).
               88 VIN-FILE-CD-VALID         VALUE
               'A', 'L', 'H', 'P', 'I', 'S', 'D', 'B', 'F',
               'T', 'M', 'C', 'U', 'E'.

           05  WS-LIC-NUM                   PIC X(07).
           05  WS-SUB-PLATE-LIC             PIC X(07).
           05  WS-Q-LIC-FRMT.
             10  WS-Q                       PIC X.
             10  WS-Q-LIC-NUM               PIC X(06).
           05  WS-DMVFEES-VAL               PIC 9(04) VALUE ZEROS.
           05  WS-SAVE-LIC-NBR              PIC X(07).
           05  WS-SAVE-DATE                 PIC 9(08) VALUE ZEROS.
           05  WS-LIC-NBR                   PIC X(08).
           05  WS-CURRENT-LICENSE           PIC X(08).
           05  WS-EXMP-PCT-36               PIC 9(03).
           05  WS-ODOM-READ-QUAN            PIC Z(09).
           05  WS-LN-ADDR                   PIC X(35).
           05  WS-OVR-8-NTCS-ON-FILE        PIC S9(01) COMP-3.
           05  WS-PROPLSN-CD                PIC X(01).
           05  WS-GVW-IND                   PIC X(01).

           05  WS-VES-GVW-FLD.
               10  WS-HULL-CGW-GVW-CD       PIC X(01).
               10  WS-PROPCERT-IND          PIC X(01).
               10  WS-GROSS-WGT-HIGH-RN.
                   15  WS-VSL-LTH-FT        PIC X(03).
                   15  WS-VSL-LTH-INCHS     PIC X(02).
               10  WS-CGW-GVW-IND           PIC X(01).
               10  WS-FILLER                PIC X(01) VALUE SPACE.

           05  WS-END-CHAR                  PIC X(04).
               88 TXT-MORE                  VALUE 'MORE'.
               88 TXT-END                   VALUE ' END'.

           05  WS-SQL-CODE.
               10  WS-SIGN                  PIC X(01).
                   88  WS-PLUS                VALUE '+'.
                   88  WS-MINUS               VALUE '-'.
               10  WS-SQLCODE               PIC S9(08)
                                              SIGN LEADING SEPARATE.

           05  WS-MOVE-FLD                  PIC X(80).
           05  WS-LENGTH                    PIC 9(04) COMP.
           05  WS-VIN-LEN                   PIC 9(04) COMP.
           05  WS-TEST-FIELD                PIC X(85).
           05  WS-CONT-CHAR                 PIC X(01).
           05  WS-LINE-CNT                  PIC S9(04) VALUE ZEROS.
           05  WS-VRC-CNT                   PIC 9(04) COMP VALUE 0.
           05  WS-FLD-LEN                   PIC S9(04) COMP.
           05  WS-ACCU-LEN                  PIC S9(04) COMP
                                            VALUE ZEROS.
           05  WS-GRP-LEN                   PIC S9(04) COMP
                                                       VALUE ZEROS.
           05  WS-MSG-LENG-X.
               10  WS-MSG-LENG              PIC S9(04) COMP.

           05  WS-TSQ-NAME.
               10  WS-TSQ-HDR               PIC X(02) VALUE 'RF'.
               10  WS-TSQ-SYSID             PIC X(04).
               10  WS-TSQ-TASKN             PIC 9(07).
               10  FILLER                   PIC X(03) VALUE SPACES.
           05  WS-TSQ-LEN                   PIC S9(04) COMP.
           05  WS-TSQ-ITM                   PIC S9(04) COMP.
           05  WS-RESP                      PIC S9(08) COMP.
           05  WS-SEP-COLON                 PIC X(01) VALUE ':'.
           05  WS-SEP-COMMA                 PIC X(01) VALUE ','.
           05  WS-WRNT-AMT1                 PIC 9(05)V99.
           05  FILLER REDEFINES WS-WRNT-AMT1.
               10  WS-WRNT-AMT              PIC 9(07).
           05  WS-INT-AMT1                  PIC 9(05)V99.
           05  FILLER REDEFINES WS-INT-AMT1.
               10  WS-INT-AMT               PIC 9(07).
           05  WS-AMOUNT1                   PIC 9(05)V99.
           05  FILLER REDEFINES WS-AMOUNT1.
               10  WS-AMOUNT                PIC 9(07).
           05  WS-AMOUNT-ALPHA              PIC X(07).

           05  WS-DATE-TIME.
               10  FILLER                   PIC X(06) VALUE 'DATE: '.
               10  WS-DATE-MM               PIC X(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-DATE-DD               PIC X(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-DATE-YY               PIC X(02).
               10  FILLER                   PIC X(07) VALUE ' TIME: '.
               10  WS-TIME-HR               PIC X(02).
               10  FILLER                   PIC X(01) VALUE ':'.
               10  WS-TIME-MN               PIC X(02).
           05  WS-FORMAT-DT                 PIC X(08).
           05  WS-FRMAT-DATE1 REDEFINES WS-FORMAT-DT.
               10  WS-FRMAT-DAT-CC1         PIC X(02).
               10  WS-FRMAT-DAT-YMD         PIC X(06).
           05  WS-FRMAT-DATE2 REDEFINES WS-FORMAT-DT.
               10  WS-FRMAT-DAT-CC          PIC X(02).
               10  WS-FRMAT-YMD.
                   15  WS-FRMAT-DAT-YY      PIC X(02).
                   15  WS-FRMAT-DAT-MM      PIC X(02).
                   15  WS-FRMAT-DAT-DD      PIC X(02).
           05  WS-FRMAT-DATE3 REDEFINES WS-FORMAT-DT.
               10  WS-FRMAT-DAT3-CCYY       PIC 9(04).
               10  WS-FRMAT-DAT3-MM         PIC 9(02).
               10  WS-FRMAT-DAT3-DD         PIC 9(02).
           05  WS-FRMAT-DATE4.
               10  WS-FRMAT-DAT4-MM         PIC 9(02).
               10  WS-FRMAT-DAT4-DD         PIC 9(02).
               10  WS-FRMAT-DAT4-CCYY       PIC 9(04).
           05  WS-FORMAT-CCYY.
               10  WS-FORMAT-CC             PIC 9(02).
               10  WS-FORMAT-YY             PIC 9(02).
           05  WS-FORMAT-CCYYJJJ.
               10  WS-FORMAT-CENT           PIC 9(02).
               10  WS-FORMAT-YYJJJ          PIC 9(05).
           05  WS-FRMATTED-DT.
               10  WS-FRMTD-DAT-MM          PIC X(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMTD-DAT-DD          PIC X(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMTD-DAT-YY          PIC X(02).

           05  WS-FRMT-CCYYMMDD.
               10  WS-FRMT-DAT-CC           PIC 9(02).
               10  WS-FRMT-DAT-YY           PIC 9(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMT-DAT-MM           PIC 9(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMT-DAT-DD           PIC 9(02).

           05  WS-FRMT-MMDDCCYY.
               10  WS-FRMT-DT-MM            PIC 9(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMT-DT-DD            PIC 9(02).
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-FRMT-DT-CC            PIC 9(02).
               10  WS-FRMT-DT-YY            PIC 9(02).
           05  WS-DATE-FRMT                 PIC X(01) VALUE '1'.
               88  MMDDYY-FRMT              VALUE '1'.
               88  CCYYMMDD-FRMT            VALUE '2'.
               88  MMDDCCYY-FRMT            VALUE '3'.

           05  WS-TEST-DATE.
               10  WS-TEST-DATE-MM          PIC X(02) VALUE SPACES.
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-TEST-DATE-DD          PIC X(02) VALUE SPACES.
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-TEST-DATE-YY          PIC X(02) VALUE SPACES.

           05  WS-TEST-DATE1.
               10  WS-TEST-DATE-MM1         PIC X(02) VALUE ZEROS.
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-TEST-DATE-DD1         PIC X(02) VALUE ZEROS.
               10  FILLER                   PIC X(01) VALUE '/'.
               10  WS-TEST-DATE-YY1         PIC X(02) VALUE ZEROS.

           05  WS-AMT                       PIC 9(07).
           05  WS-VRC70-AMT                 PIC 9(05)V99.
           05  WS-LIEN-AMT-E71.
               10  WS-LIEN-M-E71            PIC 9(01).
               10  FILLER                   PIC X(01) VALUE ','.
               10  WS-LIEN-T-E71            PIC 9(03).
               10  FILLER                   PIC X(01) VALUE ','.
               10  WS-LIEN-U-E71            PIC 9(03).

           05  WS-VLF-RFND-AMT-E70.
               10  WS-VLF-T-E70             PIC X(02).
               10  FILLER                   PIC X(01) VALUE ','.
               10  WS-VLF-U-E70             PIC X(03).
               10  FILLER                   PIC X(01) VALUE '.'.
               10  WS-VLF-C-E70             PIC X(02).

           05  WS-LAST-VMP-001-READ.
               10  WS-LST-VMP-001-ODOM-DT   PIC 9(08).
               10  WS-LST-VMP-001-ODOM-RDG  PIC 9(09).
               10  WS-LST-VMP-001-ODOM-IND  PIC X(01).
               10  WS-LST-VMP-001-ODOM-CD   PIC X(01).

           05  WS-SUPRS-ZEROS-AMT.
               10 WS-SUPRS-ZEROS-DOL        PIC Z(05).
               10 WS-DOT                    PIC X(01) VALUE '.'.
               10 WS-CENTS                  PIC 9(02).
           05  WS-FORMAT-AMT2               PIC 99999.99.
           05  WS-FORMAT-AMT                PIC 9(07).
           05  WS-FRMT-AMT1 REDEFINES WS-FORMAT-AMT.
               10  WS-FRMT-AMT-DOL          PIC 9(05).
               10  WS-FRMT-AMT-CEN          PIC 9(02).
           05  WS-FRMATTED-AMT.
               10  WS-FRMTD-AMT-DOL         PIC 9(05).
               10  FILLER                   PIC X(01) VALUE '.'.
               10  WS-FRMTD-AMT-CEN         PIC 9(02).

           05  WS-SUSP-KEY.
               10  WS-7BYT-SPACE            PIC X(07) VALUE SPACES.
               10  WS-8BYT-LIC              PIC X(08).

           05  WS-ELP-RTN-TOT-FEES.
               10  WS-ELP-RTN-FEE1          PIC 9(02).
               10  WS-ELP-RTN-FEE2          PIC 9(02).

           05  WS-TYP-VEHICLE               PIC 9(02).
               88  TYPE-VESSEL              VALUE 81, 82, 83.

           05  WS-ADD-DATA-LN.
               10  WS-MAX-LENGTH            PIC 9(02) VALUE 67.
               10  WS-FRST-LN-LEN           PIC 9(02) VALUE 40.
               10  WS-CITA-LN-LEN           PIC 9(02) VALUE 26.

           05  WS-ADD-DATA-CIT.
               10  WS-ADD-DATA-CIT1         PIC X(26).
               10  WS-ADD-DATA-CIT2         PIC X(26).
               10  WS-ADD-DATA-CIT3         PIC X(26).

           05  WS-ADD-DATA.
               10  WS-ADD-DATA-LIN1         PIC X(40).
               10  WS-ADD-DATA-LIN2         PIC X(40).
           05  WS-LAST-TRAN-CD              PIC X(02).
           05  WS-KEY-LIC-NBR               PIC X(07).
           05  WS-VMP-ODOM-READ-QUAN        PIC ZZZ,ZZZ,ZZZ.

           05  WS-MAX-Q-CNT                 PIC 9(02) VALUE 20.
           05  WS-VIN-COUNT                 PIC 9(03).
           05  WS-SUB2                      PIC S9(04) COMP VALUE 1.
           05  WS-SUBH                      PIC 9(04) COMP.
           05  WS-PREV-CNT                  PIC 9(04) COMP.
           05  WS-VEHYY-PLUS-ONE            PIC 9(02).
           05  WS-VEHYY-MINUS-ONE           PIC 9(02).
           05  WS-VIN-PACKET.
               10  WS-VIN-CTR               PIC 9(04) COMP.
               10  WS-VIN-ENTRY OCCURS 140.
                   15  WS-MAKE-OF-VEH-CD    PIC X(03).
                   15  WS-VEH-LIC-NBR       PIC X(08).
                   15  WS-FILE-KEY-CD       PIC X(01).
                   15  WS-STAT-INFO         PIC X(08).
                   15  WS-VEH-FRST-SLD-YR   PIC 9(04).
                   15  FILLER REDEFINES WS-VEH-FRST-SLD-YR.
                      20  WS-VEH-FR-SLD-CC  PIC 9(02).
                      20  WS-VEH-FR-SLD-YY  PIC 9(02).

      ****************************************************************
      *     SUB SCRIPTS                                              *
      ****************************************************************
       01  WS-SUB-SCRIPTS.

           05  WS-SUB1                      PIC S9(04) COMP.
           05  WS-STRT                      PIC S9(04) COMP.
           05  WS-BASI                      PIC S9(04) COMP.
           05  WS-BASB                      PIC S9(04) COMP.
           05  WS-BASC                      PIC S9(04) COMP.
           05  WS-BASD                      PIC S9(04) COMP.
           05  WS-RATI                      PIC S9(04) COMP.
           05  WS-SUB                       PIC S9(04) COMP.
           05  WS-SUB3                      PIC S9(04) COMP.
           05  WS-PKT                       PIC S9(04) COMP.
           05  WS-SBA                       PIC S9(04) COMP.
           05  WS-PTR                       PIC S9(04) COMP.
           05  WS-STR                       PIC S9(04) COMP.
           05  WS-SUB-SAVE                  PIC S9(04) COMP.
           05  WS-VIN-SUB                   PIC S9(04) COMP.

      ****************************************************************
      *     INDICES                                                  *
      ****************************************************************
       01  WS-INDEX.
           05  IDX-SMG                      PIC S9(04) COMP VALUE +0.

      ****************************************************************
      *     COUNTERS                                                 *
      ****************************************************************
       01  WS-COUNTERS.

           05  CTR-FLD                      PIC S9(4) COMP.
           05  CTR-LIN                      PIC S9(4) COMP.
           05  CTR-MSG                      PIC S9(4) COMP.
           05  CTR-IND                      PIC S9(4) COMP.
           05  CTR-SPACES                   PIC S9(4) COMP.
           05  CTR-FREQ                     PIC 9(04) COMP.
           05  CTR-IACB                     PIC 9(04) COMP.
           05  CTR-VBB                      PIC 9(04) COMP.
           05  CTR-VRC                      PIC 9(04) COMP.
           05  CTR-VPO                      PIC 9(04) COMP.
           05  CTR-VPC                      PIC 9(04) COMP.
           05  CTR-VNH                      PIC 9(04) COMP.
           05  CTR-VSA                      PIC 9(04) COMP.
           05  CTR-VFP                      PIC 9(04) COMP.
           05  CTR-VNR                      PIC 9(04) COMP.
           05  CTR-VLS                      PIC 9(04) COMP.
           05  CTR-VRH                      PIC 9(04) COMP.
           05  CTR-VMG                      PIC 9(04) COMP.
           05  CTR-VCI                      PIC 9(04) COMP.
           05  CTR-VFD                      PIC 9(04) COMP.
           05  CTR-VDC                      PIC 9(04) COMP.
           05  CTR-VHY                      PIC 9(04) COMP.
           05  CTR-VMP                      PIC 9(04) COMP.
           05  CTR-VYP                      PIC 9(04) COMP.
           05  CTR-VINX                     PIC 9(04) COMP.
           05  CTR-CURR-PTR                 PIC 9(04) COMP.
           05  CTR-PREV-PTR                 PIC 9(04).
           05  CTR-TO-BE-SRCHD              PIC 9(03).
           05  CTR-SMG-DATA-PKTS            PIC 9(04) COMP VALUE ZERO.
           05  CTR-WRITE-Q                  PIC 9(04) COMP VALUE ZERO.

      * FREQ DATA
       01  WS-FREQ-DATA.
           05  WS-FIX-DATA.
               10  WS-TCODE                 PIC X(03).
               10  WS-REQ-CODE              PIC X(05).
               10  WS-OPER-CODE             PIC X(03).
               10  WS-INF-CD                PIC X(01).
                   88  MASTER-FILE-FORMAT   VALUE '8'.
                   88  ZERO-TO-FOUR-INFO    VALUE
                       '0', '1', '2', '3', '4'.
               10  WS-FIL-CD                PIC X(01).
           05  WS-LIC                       PIC X(30).
           05  WS-ANI-INFO                  PIC X(47).
           05  WS-VIN                       PIC X(30).
           05  WS-YEAR                      PIC X(02).
           05  WS-YEAR-YY REDEFINES WS-YEAR PIC 9(02).
           05  WS-MAKE                      PIC X(03).
           05  WS-GROUP                     PIC X(02).
           05  WS-GRP                       REDEFINES WS-GROUP
                                            PIC 9(02).

           05  WS-VRC82-DATA.
               10  WS-VRC82-QMF-FEE-PD      PIC X(01).
               10  WS-VRC82-QMF-FEE-DT      PIC X(08).
               10                           PIC X(81).

      * STRUCTURE MANAGER PARAMETERS
       01  WS-STRUCT-MGR-PARMS.
           COPY USCXMSMG.

       01  WS-VINX-PKT.
           COPY OCCXMVNX.

      * DATA ACCESS PARMS
       01 WS-DA-PARMS.
          COPY OCCXMDAP.
      *------------------------*
      * DATA ACCESS PARAMETERS
      *------------------------*
          05  WS-TABLE-ID                 PIC  X(03).
              88 WS-CODE-TABLE-ID        VALUE 'CTB'.
          05  WS-KEY                      PIC  X(82) .
          05  FILLER REDEFINES WS-KEY.
              10  WS-TABLE-NAME           PIC  X(08).
              10  WS-KEY-DATA             PIC  X(32).
              10  WS-ALT-KEY-DATA         PIC  X(32).
              10  WS-EFFECTIVE-DT         PIC  X(10).

      * CODE TABLE KEY RECORD
       01  WS-CODE-TBL-KEY.
           COPY OCCXMTBC.

      * EXPANDED SECURITY SYMBOLIC FLAGS
       01  WS-EXP-SEC-MODULE.
           COPY OCCXXSYF.

       01  WS-RESPONSE-OUTPUT.
           05  WS-RESP-OUTPUT               PIC X(2200).

      ****************************************************************
      *     SWITCHES                                                 *
      ****************************************************************
       01  WS-SWITCHES.

           05  SW-PKT-SRCH                  PIC X(01).
               88  SW-PKT-SRCH-MORE             VALUE 'Y'.
               88  SW-PKT-SRCH-EXIT             VALUE 'N'.

           05  SW-VMP-PKT-FOUND             PIC X(01).
               88  SW-VMP-FOUND                 VALUE 'Y'.
               88  SW-VMP-NOT-FOUND             VALUE 'N'.

           05  SW-FORMAT-ERROR-MESSAGE      PIC X(01) VALUE 'R'.
               88  FORMAT-ERR-MSG           VALUE 'E'.
               88  FORMAT-RESPONSE          VALUE 'R'.

           05  SW-VR-OR-SUSP-READ           PIC X(01) VALUE 'V'.
               88  VR-MASTR-READ            VALUE 'V'.
               88  SUSP-RDF-ERR-READ        VALUE 'S'.

           05  SW-SKIP-LINE                 PIC X(01) VALUE 'N'.
               88  SKIP-LINE-DONE           VALUE 'Y'.
               88  SKIP-LINE-NOT-DONE       VALUE 'N'.

           05  SW-OVER-8-NTCS               PIC X(01) VALUE SPACE.
               88  OVER-8-NTCS-WRTEN        VALUE 'Y'.
               88  OVER-8-NTCS-NOT-WRTEN    VALUE 'N'.

           05  SW-VINX-SEARCH-DONE-SW       PIC X(01) VALUE SPACE.
               88  VINX-SEARCH-DONE         VALUE 'Y'.
               88  VINX-SEARCH-NOT-DONE     VALUE 'N'.

           05  SW-SKIP-VEHICLE-INFO         PIC X(01) VALUE 'N'.
               88  SKIP-VEHICLE-INFO        VALUE 'Y'.

           05  SW-DIS-INS                   PIC X(01) VALUE SPACE.
               88  DIS-INS-YES              VALUE 'Y'.

           05  SW-WRITE-PENDING-INS         PIC X(01) VALUE SPACE.
               88  WRITE-PENDING-INS-YES    VALUE 'Y'.

           05  SW-LIC-HAS-STOP              PIC X(01) VALUE SPACE.
               88  LIC-HAS-STOP             VALUE 'Y'.
               88  LIC-HAS-NO-STOP          VALUE 'N'.

           05  SW-CURR-LIC-HAS-STOP         PIC X(01) VALUE SPACE.
               88  CURR-LIC-HAS-STOP        VALUE 'Y'.
               88  CURR-LIC-HAS-NO-STOP     VALUE 'N'.

           05  SW-WRITE-STOP-MSG            PIC X(01) VALUE SPACE.
               88  WRITE-STOP-MSG           VALUE 'S'.
               88  WRITE-REST-MSG           VALUE 'R'.
               88  STOP-NOT-WRITTEN         VALUE 'N'.

           05  SW-FRMT-ZZ-2DPA              PIC X(01) VALUE SPACE.
               88  FRMT-ZZ-2DPA-YES         VALUE 'Y'.
               88  FRMT-ZZ-2DPA-NO          VALUE 'N'.

           05  SW-ERROR-MSG-SRCH-DONE-SW    PIC X(01) VALUE SPACE.
               88  ERROR-MSG-SEARCH-DONE    VALUE 'Y'.

           05  SW-SEARCH-DONE               PIC X(01) VALUE SPACE.
               88  SEARCH-DONE              VALUE 'Y'.

           05  SW-E20-CURR-REC              PIC X(01) VALUE SPACE.
               88  CURRNT-REC-FOUND         VALUE 'Y'.

           05  SW-MULTI-VIN-MSG             PIC X(01) VALUE 'N'.
               88  MULT-VIN-MSG-WRITEN      VALUE 'Y'.
               88  MULT-VIN-MSG-NOT-WRITEN  VALUE 'N'.

           05  SW-TRC-MSG                   PIC X(01) VALUE 'N'.
               88  TRC-MSG-WRITTEN          VALUE 'Y'.
               88  TRC-MSG-NOT-WRITTEN      VALUE 'N'.

           05  SW-INS-MSG                   PIC X(01).
               88  INS-MSG-WRITTEN          VALUE 'Y'.
               88  INS-MSG-NOT-WRITTEN      VALUE 'N'.

           05  SW-E5X-MSG                   PIC X(01).
               88  E5X-MSG-WRITTEN          VALUE 'Y'.
               88  E5X-MSG-NOT-WRITTEN      VALUE 'N'.

           05  SW-REC-STATUS-MSG            PIC X(01).
               88  REC-STATUS-MSG-WRITTEN   VALUE 'Y'.
               88  REC-STATUS-MSG-NOT-WRITTEN
                                            VALUE 'N'.

           05  SW-CUR-ON-OTH-VIN-MSG        PIC X(01).
               88  CUR-ON-OTH-VIN-MSG-WRTN  VALUE 'Y'.
               88  CUR-ON-OTH-VIN-MSG-NOT-WRTN
                                            VALUE 'N'.

           05  SW-SPL-COURT-MSG             PIC X(01) VALUE 'N'.
               88  SPL-COURT-MSG-WRITEN     VALUE 'Y'.
               88  SPL-COURT-MSG-NOT-WRITEN VALUE 'N'.

           05  SW-SUB-PLATE-LIC             PIC X(01) VALUE 'N'.
               88  SUB-PLATE-LIC            VALUE 'Y'.
               88  NOT-SUB-PLATE-LIC        VALUE 'N'.

           05  SW-LAST-MOVE-SBA             PIC X(01) VALUE 'N'.
               88  LAST-MOVE-SBA            VALUE 'Y'.
               88  LAST-MOVE-NOT-SBA        VALUE 'N'.

           05  SW-LAST-MOVE-SPACE           PIC X(01) VALUE 'N'.
               88  LAST-MOVE-SPACE          VALUE 'Y'.
               88  LAST-MOVE-NOT-SPACE      VALUE 'N'.

           05  SW-LAST-MOVE-END-BYTES       PIC X(01) VALUE 'N'.
               88  LAST-MOVE-END-BYTES      VALUE 'Y'.
               88  LAST-MOVE-NOT-END-BYTES  VALUE 'N'.

           05  SW-ERROR-RETURN              PIC X(01) VALUE 'N'.
               88  ERROR-RTN                VALUE 'Y'.
               88  NO-ERROR                 VALUE 'N'.

           05  SW-TC-RETURN                 PIC X(01).
               88  RETURN-TO-TC             VALUE 'Y'.
               88  NO-RETURN-TO-TC          VALUE 'N'.

           05  SW-CHK-FIRST-PAGE            PIC X(01) VALUE 'Y'.
               88  FIRST-PAGE               VALUE 'Y'.
               88  NOT-FIRST-PAGE           VALUE 'N'.

           05  SW-CALL-STATUS               PIC X(01) VALUE 'Y'.
               88  SW-FIRST-CALL            VALUE 'Y'.
               88  SW-NOT-FIRST-CALL        VALUE 'N'.

           05  SW-END-OF-FORMAT             PIC X(01) VALUE SPACE.
               88  MORE-TO-FORMAT           VALUE 'N'.
               88  END-OF-FORMAT            VALUE 'Y'.

           05  SW-END-OF-E                  PIC X(01) VALUE SPACE.
               88  END-OF-E                 VALUE 'Y'.
               88  NOT-END-OF-E             VALUE 'N'.

           05  SW-FRMT66-IND1-END           PIC X(01) VALUE 'N'.
               88  IND1-END                 VALUE 'Y'.
               88  IND1-NOT-AT-END          VALUE 'N'.

           05  SW-FRMT66-IND2-END           PIC X(01) VALUE 'N'.
               88  IND2-END                 VALUE 'Y'.
               88  IND2-NOT-AT-END          VALUE 'N'.

           05  SW-FIRST-TIME-LOOP           PIC X(01) VALUE 'Y'.
               88  FIRST-TIME-LOOP          VALUE 'Y'.
               88  NOT-FIRST-TIME           VALUE 'N'.

           05  SW-IAC-MAIL-ADDR             PIC X(01) VALUE 'N'.
               88  IAC-MAIL-ADDR            VALUE 'Y'.

           05  SW-PROCESS-SUBRECORDS        PIC X(01) VALUE 'Y'.
               88  PROCESS-SUBRECORDS       VALUE 'Y'.
               88  DONOT-PROCESS-SUBS       VALUE 'N'.

           05  SW-SUBPLATE                  PIC X(01) VALUE 'N'.
               88  SUBPLATE-FOUND           VALUE 'Y'.

           05  SW-SUSPENSE-DATA             PIC X(01) VALUE 'N'.
               88  SUS-DATA-FOUND           VALUE 'Y'.
               88  SUS-DATA-NOT-FOUND       VALUE 'N'.

           05  SW-INHOUSE-E30-USER          PIC X(01) VALUE 'N'.
               88  SW-INHOUSE-E30-PRESENT   VALUE 'Y'.

           05  SW-CONT-PRINTER              PIC X(01) VALUE 'S'.
               88  CONT-PRINTER             VALUE 'P'.
               88  SCRN-DISPLAY             VALUE 'S'.

           05  SW-FORCE-PAGE-BREAK          PIC X(01) VALUE SPACE.
               88  FORCE-PAGE-BREAK         VALUE 'Y'.
               88  NO-PAGE-BREAK            VALUE 'N'.

           05  SW-EREC-STATUS               PIC X(01) VALUE SPACE.
               88  SW-EREC-FOUND            VALUE 'Y'.
               88  SW-EREC-NOT-FOUND        VALUE 'N'.

           05  SW-LICENSE-STATUS            PIC X(01) VALUE SPACE.
               88  LICENSE-SPACES           VALUE 'Y'.
               88  LICENSE-NOT-SPACE        VALUE 'N'.
               88  LICENSE-STOP-ONLY        VALUE 'S'.
               88  LICENSE-VIN-RESTR        VALUE 'R'.
               88  END-OF-VINX              VALUE 'E'.

           05  SW-NEXT-LIC-SPACE            PIC X(01) VALUE SPACE.
               88  NEXT-LIC-SPACE           VALUE 'Y'.
               88  NEXT-IS-RESPONSE         VALUE 'N'.
               88  NEXT-IS-VINX-END         VALUE 'E'.
               88  NEXT-IS-STOP-ONLY        VALUE 'S'.
               88  NEXT-IS-VIN-RESTR        VALUE 'R'.

           05  SW-CURRENT-PTR-SET           PIC X(01) VALUE 'N'.
               88  POINTER-SET              VALUE 'Y'.
               88  POINTER-NOT-SET          VALUE 'N'.

           05  SW-SEARCH-COMPLETED          PIC X(01) VALUE SPACE.
               88  SEARCH-COMPLETED         VALUE 'Y'.
               88  ADDITIONAL-OPTION        VALUE 'N'.

           05  SW-SEND-PWO-MESSAGE          PIC X(01) VALUE 'N'.
               88  SEND-PWO-MESSAGE         VALUE 'Y'.
               88  NO-PWO-MESSAGE           VALUE 'N'.

           05  SW-CURRENT-LIC-SPACE         PIC X(01) VALUE SPACE.
               88  CURRENT-LIC-SPACE        VALUE 'Y'.
               88  CURRENT-LIC-NOT-SPACE    VALUE 'N'.

           05  SW-VIN-INQUIRY-BY            PIC X(01) VALUE 'V'.
               88  INQUIRY-BY-VIN           VALUE 'V'.
               88  INQUIRY-BY-MAKE          VALUE 'M'.
               88  INQUIRY-BY-YEAR          VALUE 'Y'.
               88  INQUIRY-BY-BOTH          VALUE 'B'.

           05  SW-SHORT-REPLY               PIC X(01) VALUE SPACE.
               88  SHORT-REPLY              VALUE 'Y'.

           05  SW-NO-MORE-DATES             PIC X(01) VALUE 'N'.
               88  NO-MORE-DATES            VALUE 'Y'.

           05  SW-DISPLAY-E65               PIC X(01) VALUE 'Y'.
               88  DISPLAY-E65              VALUE 'Y'.
               88  DONT-DISPLAY-E65         VALUE 'N'.

           05  SW-R67-FORMAT                PIC X(01) VALUE 'N'.
               88  R67-FORMAT               VALUE 'Y'.
               88  R60-FORMAT               VALUE 'N'.

           05  SW-PEACE-OFFICER-ADDRESS     PIC X(01) VALUE 'N'.
               88  PEACE-OFF-ADDR-YES       VALUE 'Y'.
               88  PEACE-OFF-ADDR-NO        VALUE 'N'.

           05  SW-MSG-WRITTEN               PIC X(01) VALUE 'N'.
               88  MSG-WRITTEN              VALUE 'Y'.
               88  MSG-NOT-WRITTEN          VALUE 'N'.

       01  WS-SUB-PROG-CALLED.
           05  L-STRUCTURE-MANAGER          PIC X(08) VALUE 'USPCMSMG'.

      ******************************************************************
      *     CONSTANTS AND LITERALS                                     *
      ******************************************************************
       01  WS-LITERALS.

           05  L-THIS-PROGRAM               PIC X(08) VALUE 'VRPCCF03'.
           05  L-CD-TBL-READER              PIC X(08) VALUE 'CSPDMCTB'.
           05  L-DAO-MODULE                 PIC X(08) VALUE 'CSPCCTSQ'.
           05  L-END-OF-MSG                 PIC X(01) VALUE X'03'.
           05  L-FLD-LEN                    PIC S9(04) COMP
                                            VALUE 0006.
           05  L-DTE-LEN                    PIC S9(04) COMP
                                            VALUE 0008.
           05  L-VIN-START-POS              PIC 9(02) VALUE 14.

           05  L-INPUT-REQ.
               10  L-TRANCODE               PIC X(10) VALUE 'TRANCODE'.
               10  L-REQCODE                PIC X(10) VALUE 'REQCODE'.
               10  L-OPERCODE               PIC X(10) VALUE 'OPERCODE'.
               10  L-INFOCODE               PIC X(10) VALUE 'INFOCODE'.
               10  L-FILECODE               PIC X(10) VALUE 'FILECODE'.
               10  L-LICPLATE               PIC X(10) VALUE 'LICPLATE'.
               10  L-VINNBR                 PIC X(10) VALUE 'VIN'.
               10  L-ANIINFO                PIC X(10) VALUE 'ANIINFO'.
               10  L-VINYEAR                PIC X(10) VALUE 'VINYEAR'.
               10  L-VINMAKE                PIC X(10) VALUE 'VINMAKE'.
               10  L-VINGROUP               PIC X(10) VALUE 'VINGROUP'.

               10  L-1                      PIC 9(01) VALUE 1.
               10  L-2                      PIC 9(01) VALUE 2.
               10  L-3                      PIC 9(01) VALUE 3.
               10  L-4                      PIC 9(01) VALUE 4.
               10  L-5                      PIC 9(01) VALUE 5.
               10  L-6                      PIC 9(01) VALUE 6.
               10  L-7                      PIC 9(01) VALUE 7.
               10  L-8                      PIC 9(01) VALUE 8.
               10  L-9                      PIC 9(01) VALUE 9.
               10  L-10                     PIC 9(02) VALUE 10.
               10  L-11                     PIC 9(02) VALUE 11.
               10  L-13                     PIC 9(02) VALUE 13.
               10  L-14                     PIC 9(02) VALUE 14.
               10  L-17                     PIC 9(02) VALUE 17.
               10  L-20                     PIC 9(02) VALUE 20.
               10  L-22                     PIC 9(02) VALUE 22.
               10  L-23                     PIC 9(02) VALUE 23.
               10  L-27                     PIC 9(02) VALUE 27.
               10  L-28                     PIC 9(02) VALUE 28.
               10  L-33                     PIC 9(02) VALUE 33.
               10  L-37                     PIC 9(02) VALUE 37.
               10  L-43                     PIC 9(02) VALUE 43.
               10  L-47                     PIC 9(02) VALUE 47.
               10  L-55                     PIC 9(02) VALUE 55.
               10  L-72                     PIC 9(02) VALUE 72.
               10  L-76                     PIC 9(02) VALUE 76.
               10  L-01                     PIC X(02) VALUE '01'.
               10  L-COMMA                  PIC X(01) VALUE ','.
               10  L-CA                     PIC X(02) VALUE 'CA'.
               10  L-C9                     PIC X(02) VALUE 'C9'.
               10  L-E0                     PIC X(02) VALUE 'E0'.
               10  L-E9                     PIC X(02) VALUE 'E9'.
               10  L-EA                     PIC X(02) VALUE 'EA'.
               10  L-EH                     PIC X(02) VALUE 'EH'.
               10  L-EJ                     PIC X(02) VALUE 'EJ'.
               10  L-F0                     PIC X(02) VALUE 'F0'.
               10  L-F8                     PIC X(02) VALUE 'F8'.
               10  L-PT                     PIC X(02) VALUE 'PT'.
               10  L-C                      PIC X(01) VALUE 'C'.
               10  L-D                      PIC X(01) VALUE 'D'.
               10  L-E                      PIC X(01) VALUE 'E'.
               10  L-F                      PIC X(01) VALUE 'F'.
               10  L-G                      PIC X(01) VALUE 'G'.
               10  L-H                      PIC X(01) VALUE 'H'.
               10  L-I                      PIC X(01) VALUE 'I'.
               10  L-J                      PIC X(01) VALUE 'J'.
               10  L-K                      PIC X(01) VALUE 'K'.
               10  L-U-SP                   PIC X(01) VALUE 'U'.
               10  L-Q                      PIC X(01) VALUE 'Q'.
               10  L-T                      PIC X(02) VALUE '2T'.
               10  L-V-SP                   PIC X(02) VALUE 'V '.
               10  L-W                      PIC X(02) VALUE '2W'.
               10  L-N1                     PIC X(02) VALUE 'N1'.
               10  L-N2                     PIC X(02) VALUE 'N2'.
               10  L-N3                     PIC X(02) VALUE 'N3'.
               10  L-1L                     PIC X(02) VALUE '1L'.
               10  L-1P                     PIC X(02) VALUE '1P'.
               10  L-2L                     PIC X(02) VALUE '2L'.
               10  L-2P                     PIC X(02) VALUE '2P'.
               10  L-3L                     PIC X(02) VALUE '3L'.
               10  L-3P                     PIC X(02) VALUE '3P'.
               10  L-4L                     PIC X(02) VALUE '4L'.
               10  L-4P                     PIC X(02) VALUE '4P'.
               10  L-2T                     PIC X(02) VALUE '2T'.
               10  L-2Y                     PIC X(02) VALUE '2Y'.
               10  L-COMP-DATE1             PIC 9(08) VALUE 19871015.
               10  L-COMP-DATE2             PIC 9(08) VALUE 19940201.
               10  L-R60-FLAG1              PIC X(09) VALUE
                                                          'R60-FLAG1'.
               10  L-R60-FLAG2              PIC X(09) VALUE
                                                          'R60-FLAG2'.
           05  L-PACKET-ID.
               10  L-TRFX-PKT-ID            PIC X(04) VALUE 'TRFX'.
               10  L-IACB-PKT-ID            PIC X(04) VALUE 'IACB'.
               10  L-IREQ-PKT-ID            PIC X(04) VALUE 'IREQ'.
               10  L-FREQ-PKT-ID            PIC X(04) VALUE 'FREQ'.
               10  L-VINX-PKT-ID            PIC X(04) VALUE 'VINX'.
               10  L-VVP-PKT-ID             PIC X(04) VALUE 'VVP '.
               10  L-VBB-PKT-ID             PIC X(04) VALUE 'VBB '.
               10  L-VLO-PKT-ID             PIC X(04) VALUE 'VLO '.
               10  L-VRO-PKT-ID             PIC X(04) VALUE 'VRO '.
               10  L-VRC-PKT-ID             PIC X(04) VALUE 'VRC '.
               10  L-VNR-PKT-ID             PIC X(04) VALUE 'VNR '.
               10  L-VLS-PKT-ID             PIC X(04) VALUE 'VLS '.
               10  L-VCI-PKT-ID             PIC X(04) VALUE 'VCI '.
               10  L-VMP-PKT-ID             PIC X(04) VALUE 'VMP '.
               10  L-VPO-PKT-ID             PIC X(04) VALUE 'VPO '.
               10  L-VPC-PKT-ID             PIC X(04) VALUE 'VPC '.
               10  L-VRH-PKT-ID             PIC X(04) VALUE 'VRH '.
               10  L-VMG-PKT-ID             PIC X(04) VALUE 'VMG '.
               10  L-VDC-PKT-ID             PIC X(04) VALUE 'VDC '.
               10  L-VHY-PKT-ID             PIC X(04) VALUE 'VHY '.
               10  L-VSA-PKT-ID             PIC X(04) VALUE 'VSA '.
               10  L-VNH-PKT-ID             PIC X(04) VALUE 'VNH '.
               10  L-VFP-PKT-ID             PIC X(04) VALUE 'VFP '.
               10  L-VFD-PKT-ID             PIC X(04) VALUE 'VFD '.
               10  L-VYP-PKT-ID             PIC X(04) VALUE 'VYP '.
               10  L-VIV-PKT-ID             PIC X(04) VALUE 'VIV '.
               10  L-UBB-PKT-ID             PIC X(04) VALUE 'UBB '.
               10  L-ULO-PKT-ID             PIC X(04) VALUE 'ULO '.
               10  L-URO-PKT-ID             PIC X(04) VALUE 'URO '.
               10  L-URC-PKT-ID             PIC X(04) VALUE 'URC '.
               10  L-UNR-PKT-ID             PIC X(04) VALUE 'UNR '.
               10  L-ULS-PKT-ID             PIC X(04) VALUE 'ULS '.
               10  L-UCI-PKT-ID             PIC X(04) VALUE 'UCI '.
               10  L-UMP-PKT-ID             PIC X(04) VALUE 'UMP '.
               10  L-UPO-PKT-ID             PIC X(04) VALUE 'UPO '.
               10  L-UPC-PKT-ID             PIC X(04) VALUE 'UPC '.
               10  L-URH-PKT-ID             PIC X(04) VALUE 'URH '.
               10  L-UMG-PKT-ID             PIC X(04) VALUE 'UMG '.
               10  L-UDC-PKT-ID             PIC X(04) VALUE 'UDC '.
               10  L-UHY-PKT-ID             PIC X(04) VALUE 'UHY '.
               10  L-USA-PKT-ID             PIC X(04) VALUE 'USA '.
               10  L-UNH-PKT-ID             PIC X(04) VALUE 'UNH '.
               10  L-UFP-PKT-ID             PIC X(04) VALUE 'UFP '.
               10  L-UFD-PKT-ID             PIC X(04) VALUE 'UFD '.

           05  L-HEADER-TAB-1.
               10  FILLER                   PIC X(05) VALUE 'LIC#:'.
               10  FILLER                   PIC X(05) VALUE 'YRMD:'.
               10  FILLER                   PIC X(05) VALUE 'MAKE:'.
               10  FILLER                   PIC X(05) VALUE 'BTM :'.
               10  FILLER                   PIC X(05) VALUE 'VIN :'.
               10  FILLER                   PIC X(05) VALUE 'R/O :'.
               10  FILLER                   PIC X(05) VALUE 'CITY:'.
               10  FILLER                   PIC X(05) VALUE 'C.C.:'.
               10  FILLER                   PIC X(05) VALUE 'ALCO:'.
               10  FILLER                   PIC X(05) VALUE 'ZIP#:'.
               10  FILLER                   PIC X(05) VALUE 'SOLD:'.
                   88  BD                   VALUE 'B/D :'.
               10  FILLER                   PIC X(05) VALUE 'RCID:'.
               10  FILLER                   PIC X(05) VALUE 'OCID:'.
               10  FILLER                   PIC X(05) VALUE 'LOCD:'.
               10  FILLER                   PIC X(05) VALUE 'SUBP:'.
               10  FILLER                   PIC X(05) VALUE 'ENG#:'.
           05  FILLER REDEFINES L-HEADER-TAB-1.
               10  TBL-BASIC-FLDS           PIC X(05)
                                            OCCURS 16 TIMES.
           05  L-SUBE-HEADER-TABLE.
               10  L-RCID                   PIC X(05)
                                            VALUE 'RCID:'.
               10  L-INCOM                  PIC X(11)
                                            VALUE 'INCOMPLETE:'.
               10  L-LONG-VIN               PIC X(09)
                                            VALUE 'LONG VIN '.
               10  L-LONG-RO                PIC X(09)
                                            VALUE 'LONG R/O '.
               10  L-LONG-LO                PIC X(09)
                                            VALUE 'LONG L/O '.
               10  L-LONG-ENG               PIC X(09)
                                            VALUE 'LONG ENG '.
               10  L-REC-STAT               PIC X(11)
                                            VALUE 'REC STATUS:'.
               10  L-NO-DATE                PIC X(09)
                                            VALUE 'NO DATE  '.
               10  L-JUNK                   PIC X(04) VALUE 'JUNK'.
               10  L-SUB-PLATE              PIC X(09)
                                            VALUE 'SUB PLATE'.
               10  L-REG-OUT-STATE          PIC X(25) VALUE
                   'REGISTERED OUT OF STATE: '.
               10  L-SUR-TITLE              PIC X(25) VALUE
                   'SURRENDER OF TITLE       '.
               10  L-LIC-CANCEL             PIC X(13)
                                            VALUE 'LIC CANCELLED'.
               10  L-DOJ-STOP               PIC X(08)
                                            VALUE 'DOJ STOP'.
               10  L-REFERRAL               PIC X(09)
                                            VALUE '-REFERRAL'.
               10  L-VEH-REREG              PIC X(09)
                                            VALUE 'VEH REREG'.
               10  L-RES-MILT               PIC X(12)
                                            VALUE 'NON/RES MILT'.
               10  L-PAR-YEAR               PIC X(13)
                                            VALUE 'PARTIAL YEAR '.
               10  L-REL-LIABILITY          PIC X(31) VALUE
                   'RELEASE OF LIABILITY (REG. 138)'.
               10  L-DEL-NOTICE             PIC X(26) VALUE
                   'ELP DELINQUENT NOTICE SENT'.
               10  L-ELP-SUR-PUC-REV        PIC X(37) VALUE
                   'ELP SURRENDERED PUC AUTHORITY REVOKED'.
               10  L-PLT-SUR-OR-CAN         PIC X(37) VALUE
                   'PLATES SURR AND/OR CANCELLED         '.
               10  L-PLT-SUR-FOR-YOM        PIC X(37) VALUE
                   'PLATES SURR FOR YOM APP              '.
               10  L-DISMAN                 PIC X(38) VALUE
                   'DISMANTLED, RE-REGISTRATION PROHIBITED'.
               10  L-CAUTION                PIC X(10) VALUE
                   'CAUTION 01'.
               10  L-VR-TITLE               PIC X(09) VALUE
                   'VR TITLED'.
               10  L-OHV-TITLE              PIC X(09) VALUE
                   'OHV TITLE'.
               10  L-PRI-VR-REC             PIC X(15) VALUE
                   'PRIOR VR RECORD'.
               10  L-OHV-ID                 PIC X(15) VALUE
                   'OHV ID ONLY    '.
               10  L-DUP-PLATE              PIC X(23) VALUE
                   'DUPLICATE PLATES ISSUED'.
               10  L-PEN-SUB-PLATE          PIC X(32) VALUE
                   'PEND SUBPLATE: PREVIOUS LICENSE '.
               10  L-POS-RO-TRANS           PIC X(21) VALUE
                   'POSSIBLE R/O TRANSFER'.
               10  L-APP-IN-PRO             PIC X(38) VALUE
                   'APP IN PROCESS, CONTACT DMV SACRAMENTO'.
               10  L-SAL-CERT               PIC X(27) VALUE
                   'SALVAGE CERTIFICATE ISSUED '.
               10  L-WRECK-DT               PIC X(11) VALUE
                   'WRECK DATE '.
               10  L-ADD-RECPT-INFO         PIC X(15) VALUE
                   'ADDL RECPT INFO'.
               10  L-CONTACT-DMV            PIC X(48) VALUE
                   'CONTACT DMV SACRAMENTO FOR NEW OWNER INFORMATION'.
               10  L-VEH-SOLD               PIC X(21) VALUE
                   'VEHICLE REPORTED SOLD'.
               10  L-PRE-JUD-ATCH           PIC X(23) VALUE
                   'PREJUDGEMENT ATTACHMENT'.
               10  L-PEN-PLT-LIC            PIC X(32) VALUE
                   'PEND SUBPLATE: PREVIOUS LICENSE '.
               10  L-REG-OWR-CHG            PIC X(20) VALUE
                   'REG OWNER MAY CHANGE'.
               10  L-IND-RESER              PIC X(18) VALUE
                   'INDIAN RESERVATION'.
               10  L-PLA-LOST               PIC X(33) VALUE
                   'PLACARD/PLATE LOST/STOLEN        '.
               10  L-PLA-DEC                PIC X(33) VALUE
                   'PLACARD/PLATE HOLDER DECEASED    '.
               10  L-PLA-RET                PIC X(33) VALUE
                   'PLACARD/PLATE RETURNED UNCLAIMED '.
               10  L-PLA-OS                 PIC X(33) VALUE
                   'PLACARD/PLATE HOLDER MOVED O/S   '.
               10  L-PLA-SUR                PIC X(33) VALUE
                   'PLACARD/PLATE SURRENDERED        '.
               10  L-PWO-CAN-DMV            PIC X(33) VALUE
                   'PWO CANCELED BY DMV              '.
               10  L-SPL-PLATE              PIC X(33) VALUE
                   'SPECIAL PLATE-NOT RE-ISSUABLE    '.
               10  L-PLA-CAN-DMV            PIC X(33) VALUE
                   'PLACARD/PLATE CANCELED BY DMV    '.
               10  L-PLATE-LOST             PIC X(33) VALUE
                   'PLATES LOST/STOLEN               '.
               10  L-PFR-DEL                PIC X(15) VALUE
                   'PFR DELETED    '.
               10  L-PRO-DEL                PIC X(15) VALUE
                   'PRORATE DELETED'.
               10  L-REG-EXP                PIC X(30) VALUE
                   'REG EXPIRED/ASSESSOR NOTIFIED '.
               10  L-DV-REG-EXMP            PIC X(29) VALUE
                   'DV REGISTRATION EXEMPTION    '.
               10  L-EXPOW-LIC              PIC X(29) VALUE
                   'EX-POW LICENSE PLATE         '.
               10  L-DIS-VET-EXMP           PIC X(26) VALUE
                   'DISABLED VET EXEMPTION - V'.
               10  L-CERT-VOID              PIC X(31) VALUE
                   'CERT VOID CORRECTION IN PROCESS'.
               10  L-PEN-REASIGN-PLT        PIC X(33) VALUE
                   'PENDING REASSIGNMENT OF PLATES - '.
               10  L-SEE-LIC-NUM            PIC X(18) VALUE
                   'SEE LICENSE NUMBER'.
               10  L-PEN-REASIGN-PLT1       PIC X(30) VALUE
                   'PENDING REASSIGNMENT OF PLATES'.
               10  L-INCOM-REN              PIC X(28) VALUE
                   'INCOMPLETE ENHANCED RENEWAL '.
               10  L-DMV-FEE-DEP            PIC X(28) VALUE
                   'DMV FEES DEPOSITED          '.
               10  L-DOC                    PIC X(11) VALUE
                   'DOCUMENTED '.
               10  L-REG-OUT-STA            PIC X(17) VALUE
                   'REG OUT OF STATE '.
               10  L-NC                     PIC X(03) VALUE
                   'NC '.
               10  L-ADD-CHG-REN            PIC X(35) VALUE
                   'ADDRESS CHG RENEWAL NOTICE         '.
               10  L-REN-NOT-EXP            PIC X(47) VALUE
                   'RENEWAL NOTICE EXTRACTED                       '.
               10  L-DEL-NOT-EXT            PIC X(35) VALUE
                   'DELINQUENT NOTICE EXTRACTED        '.
               10  L-REN-NOT-REQ            PIC X(35) VALUE
                   'RENEWAL NOTICE REQUESTED           '.
               10  L-DEL-NOT-REQ            PIC X(35) VALUE
                   'DELINQUENT NOTICE REQUESTED        '.
               10  L-INV-TO-REN             PIC X(35) VALUE
                   'INVITATION TO RENEW (ITR)          '.
               10  L-ITR-ADD-CHG            PIC X(50) VALUE
                   'ITR GENERATED BY AN ADDR CHANGE OR R/O TRANSFER  '.
               10  L-ITR-NOT-MUT            PIC X(50) VALUE
                   '2ND ITR GENERATED AFTER FIRST NOTICE MUTILATED   '.
               10  L-ARTS-LIC               PIC X(18) VALUE
                   'ARTS LICENSE PLATE'.
               10  L-COL-LIC                PIC X(31) VALUE
                   'COLLEGIATE LICENSE PLATE - UCLA'.
               10  L-CALAG-LIC              PIC X(05) VALUE
                   'CALAG'.
      ***          'CA AGRICULTURE LICENSE PLATE'.
               10  L-PET-LOVERS             PIC X(10) VALUE
                   'PET LOVERS'.
               10  L-FOREIGN-LIC            PIC X(34) VALUE
                   'FOREIGN ORGANIZATION LICENSE PLATE'.
               10  L-CA-FIRE-LIC            PIC X(37) VALUE
                   'CALIFORNIA FIREFIGHTERS LICENSE PLATE'.
               10  L-CA-MEM-PLT             PIC X(17) VALUE
                   'CA MEMORIAL PLATE'.
               10  L-LAKE-LIC               PIC X(24) VALUE
                   'LAKE TAHOE LICENSE PLATE'.
               10  L-KIDS-LIC               PIC X(21) VALUE
                   'KIDS LICENSE PLATE - '.
               10  L-SLASH                  PIC X(02) VALUE
                   '/1'.
               10  L-GOLD-STAR-FAMILY       PIC X(27) VALUE
                   'GOLD STAR FAMILY           '.
               10  L-PUC-LIC                PIC X(27) VALUE
                   'PUC LIMOUSINE LICENSE PLATE'.
               10  L-OLYMPIC                PIC X(39) VALUE
                   'REFLECTORIZED LICENSE PLATE  - OLYMPIC '.
               10  L-STA-OLYMPIC            PIC X(47) VALUE
                   'REFLECTORIZED LICENSE PLATE  - STACKED OLYMPIC '.
               10  L-OLYM-TRAN-LIC          PIC X(45) VALUE
                   'OLYMPIC TRAINING CENTER LICENSE PLATE - PLAIN'.
               10  L-STA-OLYM-TRAN-LIC      PIC X(47) VALUE
                   'OLYMPIC TRAINING CENTER LICENSE PLATE - STACKED'.
               10  L-VET-LIC                PIC X(14) VALUE
                   'VET LIC PLT - '.
               10  L-INVALID-VET-ORG-CD     PIC X(34) VALUE
                   'INVALID VETERANS ORGANIZATION CODE'.
               10  L-CA-COSTAL-PLT          PIC X(43) VALUE
                   'CA COASTAL COMMISSION LICENSE PLATE        '.
               10  L-YOSEMITE-LIC           PIC X(22) VALUE
                   'YOSEMITE LICENSE PLATE'.
               10  L-REFLCT-LIC-PLT         PIC X(28) VALUE
                   'REFLECTORIZED LICENSE PLATE '.
               10  L-ELP-CONV               PIC X(25) VALUE
                   'ELP CONVERSION IN PROCESS'.
               10  L-PERM-SMOG-EXMP         PIC X(42) VALUE
                   'PERM SMOG EXEMPTION                       '.
               10  L-SMOG-EXMP-ADDR         PIC X(42) VALUE
                   'SMOG EXEMPTION BY ADDRESS                 '.
               10  L-SOMG-CERT-VAL          PIC X(33) VALUE
                   'ELECTRONIC SMOG CERT VALID UNTIL '.
               10  L-SMOG-DUE               PIC X(09) VALUE
                   'SMOG DUE '.
               10  L-SMOG-NOT-VAL           PIC X(21) VALUE
                   'SMOG NOT VALID AFTER '.
               10  L-CA-EMIS-CERT           PIC X(42) VALUE
                   'CA EMISSIONS CERTIFIED                    '.
               10  L-CA-EMIS-NOT-REQ        PIC X(42) VALUE
                   'CA EMISSIONS EVIDENCE NOT REQUIRED        '.
               10  L-VR-INSP-EXMP           PIC X(42) VALUE
                   'VR INSPECTION EXEMPTION                   '.
               10  L-CON-MED-HON            PIC X(29) VALUE
                   'CONGRESSIONAL MEDAL OF HONOR '.
               10  L-OWNR-RESP-CITS         PIC X(26) VALUE
                   'OWNER/RESP. CITS. ON FILE '.
               10  L-SAL                    PIC X(21) VALUE
                   'SALVAGED             '.
               10  L-SAL-RET                PIC X(21) VALUE
                   'SALVAGE RETENTION    '.
               10  L-PRI-TAXI               PIC X(21) VALUE
                   'PRIOR TAXI           '.
               10  L-PRI-POL                PIC X(21) VALUE
                   'PRIOR POLICE         '.
               10  L-ORG-TAXI               PIC X(21) VALUE
                   'ORIGINAL TAXI        '.
               10  L-ORG-POL                PIC X(21) VALUE
                   'ORIGINAL POLICE      '.
               10  L-REMAN-VEH              PIC X(21) VALUE
                   'REMANUFACTURED VEH   '.
               10  L-NON-USA-VEH            PIC X(21) VALUE
                   'NON USA VEHICLE      '.
               10  L-VEH-RET-DLR            PIC X(40) VALUE
                   'VEH RETURNED TO DLR OR MFG DUE TO DEFECT'.
               10  L-PUR-CON-LAW            PIC X(34) VALUE
                   'PURSUANT TO CONSUMER WARRANTY LAWS'.
               10  L-LEMON-LAW              PIC X(21) VALUE
                   'LEMON LAW BUYBACK    '.
               10  L-NC-ATV                 PIC X(06) VALUE
                   'NC ATV'.
               10  L-NC-MC                  PIC X(06) VALUE
                   'NC M/C'.
               10  L-PTI-TRA                PIC X(11) VALUE
                   'PTI TRAILER'.
               10  L-GOLD-PTI-TRA           PIC X(21) VALUE
                   'GOLDENROD PTI TRAILER'.
               10  L-PTI-TRA-INFO           PIC X(43) VALUE
                   'PTI TRAILER-RECORD INFORMATION NOT VERIFIED'.
               10  L-GOLD-PROF-OWR          PIC X(31) VALUE
                   'GOLDENROD/NO PROOF OF OWNERSHIP'.
               10  L-PARK-TRA               PIC X(21) VALUE
                   'PARK TRAILER         '.
               10  L-AUTONOMOUS             PIC X(10) VALUE
                   'AUTONOMOUS'.

               10  L-AUTO-DEPLOY            PIC X(18) VALUE
                   'AUTONOMOUS DEPLOY '.

               10  L-1960-LEGACY            PIC X(10) VALUE
                   '1960LEGACY'.
               10  L-CALIFORNIA-MUSEUM      PIC X(18) VALUE
                   'CALIFORNIA MUSEUMS'.
               10  L-BCA                    PIC X(23) VALUE
                   'BREAST CANCER AWARENESS'.
               10  L-OFF                    PIC X(04) VALUE
                   'OFC:'.
               10  L-MA-CLASS               PIC X(08) VALUE
                   'MA CLASS'.
               10  L-VEH-VAL                PIC X(24) VALUE
                   ' VEHICLE VALUE:         '.
               10  L-FHVUT-PROF-VER         PIC X(20) VALUE
                   'FHVUT PROOF VERIFIED'.
               10  L-FHVUT-EXMPT            PIC X(20) VALUE
                   'FHVUT EXEMPT        '.
               10  L-SPL-TRANS-VEH          PIC X(34) VALUE
                   'SPECIALIZED TRANSPORTATION VEHICLE'.
               10  L-VEH-REG-OS             PIC X(42) VALUE
                   'VEHICLE REGISTERED OUT OF STATE           '.
               10  L-VEH-REG-IRP            PIC X(42) VALUE
                   'VEHICLE REGISTERED IRP                    '.
               10  L-SPL-EQUP-REG           PIC X(42) VALUE
                   'SPECIAL EQUIPMENT, REGISTRATION DEFERRED  '.
               10  L-EXMP-STATUTE           PIC X(42) VALUE
                   'EXEMPT BY STATUTE, REGISTRATION DEFERRED  '.
               10  L-DEALER-INV             PIC X(42) VALUE
                   'DEALER INVENTORY, REGISTRATION DEFERRED   '.
               10  L-UNREC-VEH              PIC X(42) VALUE
                   'UNRECOVERED VEHICLE, REGISTRATION DEFERRED'.
               10  L-AFIDVIT                PIC X(42) VALUE
                   'AFFIDAVIT OF NON-USE RECEIVED             '.
               10  L-DEL-VES-PRO            PIC X(32) VALUE
                   'DELINQUENT VESSEL PROPERTY TAXES'.
               10  L-PRO-VLF-REFUND         PIC X(35) VALUE
                   'PRORATED VLF FIELD REFUND          '.
               10  L-LIEN-PER-FLET          PIC X(46) VALUE
                   'LIEN PERFECTED AGAINST ENTIRE FLEET $         '.
               10  L-LIEN-PER               PIC X(46) VALUE
                   'LIEN PERFECTED $                              '.
               10  L-JUD-FILE               PIC X(17) VALUE
                   'JUDGEMENT ON FILE'.
               10  L-VLT-STOP               PIC X(09) VALUE
                   'VLT STOP '.
               10  L-SUBPLT-ELP             PIC X(13) VALUE
                   'SUBPLATE ELP '.
               10  L-USE-VIN-INQ            PIC X(17) VALUE
                   ' USE VIN INQUIRY '.
               10  L-SHOP                   PIC X(05) VALUE
                   'SHOP '.
               10  L-SRP                    PIC X(04) VALUE
                   'SRP '.
               10  L-MUPS                   PIC X(05) VALUE
                   'MUPS '.
               10  L-DMV-TRAP               PIC X(09) VALUE
                   'DMV TRAP '.
               10  L-PNO-REG-DEF            PIC X(25) VALUE
                   'PNO-REGISTRATION DEFERRED'.
               10  L-REG-DEF                PIC X(28) VALUE
                   'REGISTRATION DEFERRED UNTIL '.
               10  L-NON-RES-SMOG-FEE       PIC X(43) VALUE
                   '$300.00 NON RESIDENT SMOG IMPACT FEE IS DUE'.
               10  L-PROF-CORR-REQ          PIC X(31) VALUE
                   'PROOF OF CORRECTION REQUIRED - '.
               10  L-EMISS-RECAL            PIC X(17) VALUE
                   'EMISSION RECALL# '.
               10  L-NON-RES-FEE            PIC X(15) VALUE
                   'NON RES FEE DUE'.
               10  L-EXP-TEMP               PIC X(20) VALUE
                   'EXPORTED TEMPORARILY'.
               10  L-EXP-PERM               PIC X(20) VALUE
                   'EXPORTED PERMANENTLY'.
               10  L-GROS-POLL-REN          PIC X(36) VALUE
                   'GROSS POLLUTER RENEWAL/TRANSFER HOLD'.
               10  L-GROS-POLL-ANL          PIC X(36) VALUE
                   'GROSS POLLUTER ANNUAL TEST ONLY REQD'.
               10  L-SMOG-INSP-TST          PIC X(40) VALUE
                   'SMOG INSPECTION AT STAR STATION REQD    '.
               10  L-VEH-COMP-BURN          PIC X(32) VALUE
                   'NONREP VEH COMP BURN DATE LOSS  '.
               10  L-OWNR-DEC               PIC X(32) VALUE
                   'NONREP VEH OWNER DEC DATE LOSS  '.
               10  L-NONREP-RET             PIC X(40) VALUE
                   'NONREP RETENTION                        '.
               10  L-VEH-SURG-STP           PIC X(32) VALUE
                   'NONREP VEH SURG STRIP DATE LOSS '.
               10  L-VEH-REG-SUS            PIC X(17) VALUE
                   'VEH REG SUSPENDED'.
               10  L-VEH-REG-SUS-EFF        PIC X(23) VALUE
                   'VEH REG SUSPENDED EFF: '.
               10  L-IRP-ACT-DATA           PIC X(17) VALUE
                   'IRP ACCOUNT DATA '.
               10  L-IRP-ACT                PIC X(10) VALUE
                   'IRP ACCT#:'.
               10  L-IRP-FLEET              PIC X(11) VALUE
                   'IRP FLEET#:'.
               10  L-USDOT-ACT              PIC X(12) VALUE
                   'USDOT ACCT#:'.
               10  L-USDOT-FLEET            PIC X(13) VALUE
                   'USDOT FLEET#:'.
               10  L-USDOT-VEH              PIC X(15) VALUE
                   'USDOT VEHICLE#:'.
               10  L-MX-ACT                 PIC X(09) VALUE
                   'MX ACCT#:'.
               10  L-MX-FLEET               PIC X(10) VALUE
                   'MX FLEET#:'.
               10  L-MX-VEH                 PIC X(12) VALUE
                   'MX VEHICLE#:'.
               10  L-PAPER-LESS             PIC X(15) VALUE
                   'PAPERLESS TITLE'.
               10  L-NO-MAIL-ADDR           PIC X(19) VALUE
                   'NO MAILING ADDRESS '.
               10  L-MAIL-ADDR              PIC X(16) VALUE
                   'MAILING ADDRESS:'.
               10  L-FIRST-LN               PIC X(05) VALUE
                   '1ST: '.
               10  L-SEC-LN                 PIC X(05) VALUE
                   '2ND: '.
               10  L-CITI                   PIC X(06) VALUE
                   'CITY: '.
               10  L-COUNTY                 PIC X(07) VALUE
                   ' C.C.: '.
               10  L-ZIP-CD                 PIC X(06) VALUE
                   ' ZIP: '.
               10  L-PREV-LIC               PIC X(08) VALUE
                   'PREV LIC'.
               10  L-SLASH-VIN              PIC X(04) VALUE
                   '/VIN'.
               10  L-FWD-SLASH              PIC X(01) VALUE
                   '/'.
               10  L-NOTICE-REL-LIA         PIC X(48) VALUE
                   'INCOMPLETE NOTICE OF RELEASE OF LIABILITY       '.
               10  L-POT-RET                PIC X(48) VALUE
                   'POT RETURNED                                    '.
               10  L-POT-RET-OWNR-DEC       PIC X(48) VALUE
                   'POT RETURNED OWNER DECEASED                     '.
               10  L-REG-LET-RET            PIC X(48) VALUE
                   'REGISTERED LETTER RETURNED                      '.
               10  L-REG-OWNR-DEC           PIC X(48) VALUE
                   'REGISTERED LETTER RETURNED OWNER DECEASED       '.
               10  L-LEG-LET-RET            PIC X(48) VALUE
                   'LEGAL LETTER RETURNED                           '.
               10  L-LEG-OWNR-DEC           PIC X(48) VALUE
                   'LEGAL LETTER RETURNED OWNER DECEASED            '.
               10  L-NOT-OWNR-POSS          PIC X(48) VALUE
                   'NOT IN OWNER POSSESSION                         '.
               10  L-VEH-OS                 PIC X(48) VALUE
                   'VEHICLE OUT-OF-STATE                            '.
               10  L-VEH-OWNR-REP-DEC       PIC X(48) VALUE
                   'VEHICLE OWNER REPORTED DECEASED                 '.
               10  L-APP-VEH                PIC X(48) VALUE
                   'APPORTIONED VEHICLE                             '.
               10  L-SPL-EQUP               PIC X(48) VALUE
                   'SPECIAL EQUIPMENT                               '.
               10  L-NCOA-ADDR-DEL          PIC X(48) VALUE
                   'NCOA ADDRESS DELETE - NO BILLING NOTICE MAILED  '.
               10  L-OPEN-COLL              PIC X(14) VALUE
                   'OPEN COLL ACCT'.
               10  L-OPEN-COLL-EV           PIC X(25) VALUE
                   'OPEN COLL ACCT - EVID USE'.
               10  L-OPEN-COLL-PN           PIC X(27) VALUE
                   'OPEN COLL ACCT-PNO EVID USE'.
               10  L-NRL-LETR               PIC X(15) VALUE
                   'NRL LETTER SENT'.
               10  L-RDF-LETR               PIC X(15) VALUE
                   'RDF LETTER SENT'.
               10  L-LIEN-SALE-PRO          PIC X(20) VALUE
                   'LIEN SALE IN PROCESS'.
               10  L-LIEN-SALE-AUTH         PIC X(20) VALUE
                   'LIEN SALE AUTHORIZED'.
               10  L-LIEN-SALE-DEN          PIC X(16) VALUE
                   'LIEN SALE DENIED'.
               10  L-TXT-CURR-FEE-DUE       PIC X(45)
                                            VALUE
                  'IRP REG NOT CURRENT-FEES DUE                 '.
               10  L-TXT-DISHONRD-CHK       PIC X(45)
                                            VALUE
                  'IRP REG NOT CURRENT-DISHONRD-CK              '.
               10  L-TXT-CURR-DOCUMENTS     PIC X(45)
                                            VALUE
                  'IRP REG NOT CURRENT-DOCUMENTS                '.
               10  L-TXT-OTHER-JURSDCTNS    PIC X(45)
                                            VALUE
                  'IRP FEES DUE OTHER JURISDICTIONS             '.
               10  L-TXT-CARIER-FEE-DUE     PIC X(45)
                                            VALUE
                  'SUSPENDED IRP CARRIER-FEES DUE               '.
               10  L-TXT-CURNT-AUDIT        PIC X(45)
                                            VALUE
                  'IRP REG NOT CURRENT-AUDIT                    '.
               10  L-TXT-AUDIT-DOCS         PIC X(45)
                                            VALUE
                  'INTERSTATE AUDIT-DOCUMENTS                   '.
               10  L-TXT-REG-SYS-FEE-DUE    PIC X(45)
                                            VALUE
                  'SINGLE STATE REG SYSTEM-FEES DUE             '.
               10  L-TXT-SALVAGE-RET        PIC X(31)
                                            VALUE
                  'VLT RESTRAINT SALVAGE RETENTION'.
               10  L-TXT-VLT-RET            PIC X(14)
                                            VALUE 'VLT RESTRAINT '.
               10  L-TXT-CARD-CHARGE        PIC X(45)
                                            VALUE
                  'CREDIT CARD CHARGE BACK SUSPENSE TO RPU I    '.
               10  L-TXT-ENFRCMNT           PIC X(45)
                                            VALUE
                  ' - LAW ENFORCEMENT ONLY                      '.
               10  L-TXT-SUSP-RENEWAL       PIC X(48)
                                            VALUE
                  'FR PROOF REQUIRED FOR RENEWAL, SUSPENSE RENEWAL '.
               10  L-TXT-TRANS-RAS          PIC X(19)
                                            VALUE
                  'OR TRANSFER TO RAS '.
               10  L-TXT-CNTFT-SMOG         PIC X(29)
                                            VALUE
                  'REG REVOKED, COUNTERFEIT SMOG'.
               10  L-TXT-REG-SUSPND         PIC X(32)
                                            VALUE
                  'REG SUSPENDED                   '.
               10  L-TXT-REG-REFUSD         PIC X(21)
                                            VALUE
                  'REG. REFUSED 49-STATE'.
               10  L-TXT-ARB-STOP           PIC X(20)
                                            VALUE
                  'ARB ENFORCEMENT STOP'.
               10  L-SUB-PLATE-FLD-IN-ERROR PIC X(30)
                                            VALUE
                  'SUBPLATE FIELD MAY BE IN ERROR'.
               10  L-TXT-S                  PIC X(02)
                                            VALUE 'S:'.
               10  L-TXT-U                  PIC X(02)
                                            VALUE 'U:'.
               10  L-TXT-R                  PIC X(02)
                                            VALUE 'R:'.
               10  L-TXT-H                  PIC X(02)
                                            VALUE 'H:'.
               10  L-TXT-C                  PIC X(02)
                                            VALUE 'C:'.
               10  L-TXT-D                  PIC X(02)
                                            VALUE 'D:'.
               10  L-TXT-DASH               PIC X(03)
                                            VALUE ' - '.
               10  L-TXT-RFR                PIC X(12)
                                            VALUE 'REFER VC5911'.
               10  L-TXT-REG-DIS-CHK        PIC X(40)
                                            VALUE
                  'REG NOT CURRENT PAID BY DISHONORED CHECK'.
               10  L-TXT-REG-REVOKED        PIC X(12)
                                            VALUE 'REG REVOKED '.
               10  L-TXT-DOT                PIC X(01)
                                            VALUE '.'.
               10  L-TXT-COLLECT            PIC X(09)
                                            VALUE 'COLLECT $'.
               10  L-TXT-EXP-YR-INCORRECT   PIC X(43)
                                            VALUE
                  'EXPIRATION YEAR MAY BE INCORRECT. COLLECT $'.
               10  L-TXT-DEALER-STOP        PIC X(12)
                                            VALUE ' DEALER STOP'.
               10  L-TXT-FOR-DC             PIC X(09)
                                            VALUE ' FOR DC. '.
               10  L-SPACE-B                PIC X(04) VALUE '  B:'.
               10  L-U                      PIC X(02) VALUE 'U:'.
               10  L-TR                     PIC X(04) VALUE 'T/R:'.
               10  L-CD                     PIC X(03) VALUE 'CD:'.
               10  L-CL                     PIC X(03) VALUE 'CL:'.
               10  L-CABL                   PIC X(06) VALUE 'CA/BL:'.
               10  L-LOCD                   PIC X(05) VALUE 'LOCD:'.
               10  L-EC                     PIC X(03) VALUE 'EC:'.
               10  L-PEND-APP               PIC X(11) VALUE
                  'PEND APP   '.
               10  L-CIT-TRNSF-TO           PIC X(30) VALUE
                  'CITATIONS TRANSFERRED TO LIC# '.
               10  L-CIT-TRANSFERED         PIC X(32) VALUE
                  'CITATIONS TRANSFERRED FROM LIC# '.
               10  L-VEH-CURR-NOT-REG       PIC X(32) VALUE
                  'VEHICLE CURRENTLY NOT REGISTERED'.
               10  L-CALIF-TITLE            PIC X(18) VALUE
                  'CALIF TITLE ISSUED'.
               10  L-MULT-HULLS             PIC X(16) VALUE
                  'MULTIPLE HULLS: '.
               10  L-MULT-MOB-HOME          PIC X(36) VALUE
                  'MULTIPLE MOBILEHOME ADDITIONAL VINS:'.
               10  L-ADDR-CONF              PIC X(28) VALUE
                  '*** ADDRESS CONFIDENTIAL ***'.
               10  L-REC-NOT-REFLCT         PIC X(38) VALUE
                  'THIS RECORD DOES NOT REFLECT OWNERSHIP'.
               10  L-INFO-USE-VIN-INQ       PIC X(31) VALUE
                  'INFORMATION - USE VIN INQUIRY  '.
               10  L-REF-OWNERSHIP          PIC X(38) VALUE
                  'THIS RECORD DOES NOT REFLECT OWNERSHIP'.
               10 L-USE-VIN-INQUIRY         PIC X(31) VALUE
                  'INFORMATION - USE VIN INQUIRY '.
               10 L-GRS-POLL-REN            PIC X(37) VALUE
                  'GROSS POLLUTER RENEWAL/TRANSFER HOLD'.
               10  L-TST-ONLY-REQ           PIC X(15) VALUE
                  'TEST ONLY REQD '.
               10  L-TST-ONLY-TYP           PIC X(16) VALUE
                  'TEST ONLY TYPE: '.
               10  L-TST-ANNU-INS           PIC X(22) VALUE
                  '# ANNUAL INSPECTIONS: '.
               10  L-LIC-RESER              PIC X(28) VALUE
                  'THIS LICENSE NUMBER RESERVED'.
               10  L-CUR-ON-OTH-VIN         PIC X(23) VALUE
                  ' CURRENTLY ON OTHER VIN'.
               10  L-TOT-RECORDS            PIC X(15) VALUE
                  ' TOTAL RECORDS '.
               10  L-TO-BE-SRCHD            PIC X(15) VALUE
                  ' TO BE SEARCHED'.
               10  L-SRCH-COMPLETED         PIC X(30) VALUE
                  'SEARCH COMPLETED. NO MORE RECS'.
               10  L-ADDL-OPT-FIELD         PIC X(29) VALUE
                  'USE ADDITIONAL OPTIONAL FIELD'.
               10  L-REC-NOT-ON-FILE        PIC X(30) VALUE
                  'RECORD NOT ON FILE            '.
               10  L-VIN-REC-NOT-ON-FILE    PIC X(30) VALUE
                  'VIN RECORD NOT ON FILE.       '.
               10  L-REC-NOT-ON-FILE-VIN    PIC X(22) VALUE
                  'NOT ON FILE (VIN REQ.)'.
               10  L-PWO-NOT-ON-FILE        PIC X(30) VALUE
                  'PWO RECORD NOT ON FILE        '.
               10  L-PWO-REC-EXP-DATE       PIC X(18) VALUE
                  'PWO RECORD - EXP: '.
               10  L-RECORD-UNAVAIL02       PIC X(30) VALUE
                  'RECORD UNAVAILABLE 02         '.
               10  L-INVALREAD-VINSREST     PIC X(45) VALUE
                  'INVALID READ (VIN/RESTRAINT FILE RECORD ONLY)'.
               10  L-NO-RECORD-ON-SUSP      PIC X(30) VALUE
                  'NO RECORD ON SUSP/RDF/ERR FILE'.
               10  L-VEHICLE-NOT-REGSTR     PIC X(30) VALUE
                  'VEHICLE NOT REGISTERED        '.
               10  L-RETRY-48-HRS           PIC X(28) VALUE
                   'T/L TBL ERROR RETRY 48 HOURS'.
               10  L-SUBPLATE-EXMT-MSG      PIC X(42) VALUE
                   'SUBPLATE EXEMPT CONTACT UNIT 25 DMV SACTO '.
               10  L-SUBPLATE-INCOMP-MSG    PIC X(42) VALUE
                   'SUBPLATE INCOMPLETE INFO-CONTACT DMV SACT '.
               10  L-HEADQUARTERS           PIC X(12) VALUE
                   'HEADQUARTERS'.
               10  L-FC-LIC-INCOMPAT        PIC X(30) VALUE
                   'FILE CODE - LIC NOT COMPATIBLE'.
               10  L-QMF-PAID               PIC X(30) VALUE
                   'MUSSEL FEE PAID               '.
               10  L-QMF-EXMPT              PIC X(30) VALUE
                   'MUSSEL FEE EXEMPT             '.
               10  L-TXT-TEST-VEH           PIC X(30) VALUE
                   'TEST VEHICLE DO NOT PROCESS   '.
RA0709         10  L-ARB-NON-COMPLIANCE     PIC X(30) VALUE
RA0709             'ARB NON-COMPLIANT VEHICLE     '.

      * HEADER TABLE FOR BASIC RECORD
          COPY VRCXCF31.

      * HEADER TABLE FOR 'E' SUB-RECORD
          COPY VRCXCF32.

      * HEADER TABLE FOR 'F' TO 'W' SUB-RECORDS
          COPY VRCXCF36.

      * HEADER TABLE FOR 'G'
          COPY VRCXCF34.

      * HEADER TABLE FOR 'L'
          COPY VRCXCF35.
      **************************
      * L/O SEGMENT (INFO CODE 2)
           05  WS-INFO-CD2-LTLS.
               10 FILLER                    PIC X(05) VALUE 'L/O :'.
               10 FILLER                    PIC X(05) VALUE 'CITY:'.
               10 FILLER                    PIC X(05) VALUE 'ZIP :'.
               10 FILLER                    PIC X(05) VALUE 'LPT :'.
      *
           05  FILLER REDEFINES WS-INFO-CD2-LTLS.
               10  TBL-LO-FLD               PIC X(05)
                                            OCCURS 4 TIMES.

      * VEHICLE SEGMENT (INFO CODE 3)
           05  WS-INFO-CD3-LTRLS.
               10  FILLER                   PIC X(05) VALUE 'TYPE:'.
               10  FILLER                   PIC X(05) VALUE 'CYL :'.
               10  FILLER                   PIC X(05) VALUE 'POWR:'.
               10  FILLER                   PIC X(05) VALUE 'AXLE:'.
               10  FILLER                   PIC X(05) VALUE 'WGHT:'.
               10  FILLER                   PIC X(05) VALUE 'VEH :'.
               10  FILLER                   PIC X(05) VALUE 'BODY:'.
               10  FILLER                   PIC X(05) VALUE 'ACCT:'.
               10  FILLER                   PIC X(05) VALUE 'CLAS:'.
               10  FILLER                   PIC X(05) VALUE '*-YR:'.
               10  FILLER                   PIC X(05) VALUE 'FEE :'.
               10  FILLER                   PIC X(05) VALUE 'EQP#:'.
           05  FILLER REDEFINES WS-INFO-CD3-LTRLS.
               10  TBL-INFO-CD3-LTRLS       PIC X(05) OCCURS 12 TIMES.

           05 L-TXT-ADD-LITERALS.
      * INFO CODE 4 SEGMENT
               10  L-TXT-TIP-OFF            PIC X(08)
                                            VALUE 'TIP OFC:'.
               10  L-TXT-SIP-OFF            PIC X(08)
                                            VALUE 'SIP OFC:'.
               10  L-TXT-RIP-OFF            PIC X(08)
                                            VALUE 'RIP OFC:'.
               10  L-TXT-HIP-OFF            PIC X(08)
                                            VALUE 'HIP OFC:'.
               10  L-TXT-EIP-OFF            PIC X(08)
                                            VALUE 'EIP OFC:'.
               10  L-TXT-DT                 PIC X(02) VALUE 'D:'.
               10  L-TXT-IDS                PIC X(05)
                                            VALUE 'ID/S:'.
               10  L-TXT-TRAN               PIC X(02) VALUE 'T:'.
               10  L-TXT-AMT-PAID           PIC X(02) VALUE 'V:'.
               10  L-TXT-REASON-CD          PIC X(02) VALUE 'R:'.
               10  L-TXT-ROUTE-CD           PIC X(03) VALUE 'RT:'.
               10  L-TXT-CREDT-CARD         PIC X(13)
                                                 VALUE 'CREDIT CARD: '.
           05  L-TXT-LITERALS.
               10  L-B                      PIC X(01) VALUE 'B'.
               10  L-L                      PIC X(01) VALUE 'L'.
               10  L-V                      PIC X(01) VALUE 'V'.
               10  L-W1                     PIC X(01) VALUE 'W'.
               10  L-ZZ                     PIC X(02) VALUE 'ZZ'.
               10  L-2DPA                   PIC X(04) VALUE '2DPA'.
               10  L-2VET                   PIC X(04) VALUE '2VET'.
               10  L-ZZ58100                PIC X(07) VALUE 'ZZ58100'.
               10  L-ZZ67099                PIC X(07) VALUE 'ZZ67099'.
               10  L-LIC-DELIMETER          PIC X(03) VALUE 'LIC'.
               10  L-TXT-LICNSE             PIC X(06) VALUE 'LIC #:'.
               10  L-TXT-LAD                PIC X(04) VALUE 'LAD:'.
               10  L-TXT-FEE                PIC X(05) VALUE 'FEE :'.
               10  L-TXT-ERROR              PIC X(04) VALUE ' ERR'.
               10  L-TXT-DATE               PIC X(06) VALUE ' DATE:'.
               10  L-TXT-LBL-DT             PIC X(05) VALUE 'DATE:'.
               10  L-TXT-COUNTY             PIC X(05) VALUE 'CTY :'.
               10  L-TXT-SITUS-ADDR         PIC X(06) VALUE 'SITUS:'.
               10  L-TXT-CITY1              PIC X(06) VALUE ' CITY:'.
               10  L-TXT-HULM               PIC X(05) VALUE 'HULM:'.
               10  L-TXT-PRPL               PIC X(05) VALUE 'PRPL:'.
               10  L-TXT-LEN-FT             PIC X(05) VALUE 'FEET:'.
               10  L-TXT-LEN-IN             PIC X(05) VALUE 'INCH:'.
               10  L-TXT-CERT-IND           PIC X(09) VALUE 'CERT IND:'.
               10  L-TXT-LONG-VIN           PIC X(09) VALUE 'LONG VIN '.
               10  L-TXT-LONG-RO            PIC X(09) VALUE 'LONG R/O '.
               10  L-TXT-LONG-LO            PIC X(09) VALUE 'LONG L/O '.
               10  L-TXT-LONG-ENG           PIC X(09) VALUE 'LONG ENG '.
               10  L-TXT-ODOMTR             PIC X(10)
                                            VALUE '-ODOMETER:'.
               10  L-TXT-INCOMPLT           PIC X(11)
                                            VALUE 'INCOMPLETE:'.
               10  L-TXT-DMVFEES            PIC X(08)
                                            VALUE 'DMVFEES:'.
               10  L-TXT-PARK-BAIL          PIC X(15)
                                            VALUE 'PARKINGBAIL:   '.
               10  L-TXT-TAX-PARK           PIC X(15)
                                            VALUE 'USETAX/PARKING:'.
               10  L-TXT-USE-TAX            PIC X(08)
                                            VALUE 'USETAX: '.
               10  L-TXT-CERT-DATE          PIC X(19)
                                            VALUE 'CERTIFICATION DATE:'.
               10  L-TXT-MILES-ACT          PIC X(31) VALUE
                   'MILES  ACTUAL MILEAGE          '.
               10  L-TXT-MILES-EXCD         PIC X(31) VALUE
                   'MILES EXCEEDS MECHANICAL LIMITS'.
               10  L-TXT-MILES-NOT-ACT      PIC X(31) VALUE
                   'MILES NOT ACTUAL MILEAGE       '.
               10  L-TXT-KM-ACT-MIL         PIC X(36) VALUE
                   'KILOMETERS ACTUAL MILEAGE           '.
               10  L-TXT-KM-EXCD-MIL        PIC X(36) VALUE
                   'KILOMETERS EXCEEDS MECHANICAL LIMITS'.
               10  L-TXT-KM-NOT-ACT         PIC X(36) VALUE
                   'KILOMETERS NOT ACTUAL MILEAGE       '.
               10  L-TXT-VLT-VIN            PIC X(30) VALUE
                   'VLT STOP ON VIN/RESTRAINT FILE'.
               10  L-TXT-DOJ-STOP           PIC X(30) VALUE
                   'DOJ STOP ON VIN/RESTRAINT FILE'.
               10  L-TXT-DOJ-STOP-RFRL      PIC X(36) VALUE
                   'DOJ STOP-REFERRAL VIN/RESTRAINT FILE'.
               10  L-TXT-ELTRNC-SMOG        PIC X(37) VALUE
                   'ELECTRONIC SMOG ON VIN/RESTRAINT FILE'.
               10  L-OUT-OF-STATE-STOP      PIC X(43) VALUE
                   'OUT-OF-STATE LIC FLAG ON VIN/RESTRAINT FILE'.
               10  L-TXT-APP-REVENUE        PIC X(47) VALUE
                   'NO RECORD ON FILE - PEND APP-REVENUE ALLOCATED '.
               10  L-TXT-MAS-FILE-REC       PIC X(40) VALUE
                   'PENDING MASTER FILE RECORD - LIC OR ID: '.
               10  L-TXT-GVW-IND            PIC X(47) VALUE
                   'GVW:  CERT IND:  OPERATING WGHT:      WGT IND: '.
               10  L-TXT-GVW-CERT           PIC X(37) VALUE
                   'GVW:  CERT IND:  OPERATING WGHT:     '.
               10  L-TXT-CL-INFO-RECS       PIC X(30)
                                            VALUE
                   'CLEARANCE INFORMATION RECORDS:'.
               10  L-TXT-CL-INFO-LBLS       PIC X(68)
                                            VALUE
                       'OFFICE   WORK DATE    TECH/ID   SEQ #    VALUE
      -      '  FICHE DATE    TTC '.
               10  L-TXT-RDPVPS             PIC X(50)
                                            VALUE
             'REFLECTORIZED DISABLED PERSON/VETERAN PLATE SERIES'.
               10  L-TXT-FEE-PD-RNTL        PIC X(29)
                                            VALUE
                  'FEE-PAID RENTAL TRAILER FLEET'.
               10  L-TXT-CNCT-CTU           PIC X(32)
                                            VALUE
                  'CONTACT  CTU  - - (916 657-7000)'.
               10  L-TXT-IRP-UNIT           PIC X(16)
                                            VALUE 'CONTACT IRP UNIT'.
               10  L-TXT-PLT-INVALID        PIC X(13)
                                            VALUE 'PLATE INVALID'.
               10  L-TXT-PRIOR-SUSP         PIC X(15)
                                            VALUE 'PRIOR SUSPENSE '.
               10 L-LIC-UN-ACCEPT           PIC X(27)
                                            VALUE
                 'LICENSE NUMBER UNACCEPTABLE'.
               10 L-TXT-MULTI-VINS          PIC X(40)
                                            VALUE
                 'MULTIPLE VIN''S INS FILE NOT CHECKED    '.
               10 L-TXT-PENDING-INS         PIC X(43)
                                            VALUE
                 'PENDING RECORD INSURANCE STATUS NOT CHECKED'.
               10 L-TXT-INS-RETRY           PIC X(42)
                                            VALUE
                 'INSURANCE RECORD UNAVAILABLE-RETRY 15 MINS'.
               10 L-TXT-INS-ON-FILE         PIC X(29)
                                            VALUE
                 'INSURANCE INFORMATION ON FILE'.
               10 L-TXT-INS-UNKNOWN         PIC X(29)
                                            VALUE
                 'INSURANCE INFORMATION UNKNOWN'.
               10 L-TXT-NON-ALPHA           PIC X(21)
                                            VALUE
                 'NON-ALPHA/NUMERIC VIN'.
               10 L-TXT-SPECIAL-COURT       PIC X(32)
                                            VALUE
                 'DMV RECORD FOR CALIFORNIA COURT '.
               10 L-TXT-PEND-MAS-FILE       PIC X(26)
                                            VALUE
                 'PENDING MASTER FILE RECORD'.
               10 L-TXT-PNO                 PIC X(16)
                                            VALUE
                 'PNO VALID FROM: '.
               10 L-TXT-REG                 PIC X(16)
                                            VALUE
                 'REG VALID FROM: '.
               10 L-TXT-REG-TO              PIC X(04)
                                            VALUE ' TO '.
               10 L-DP-PLACARD              PIC X(09) VALUE
                  'DPPLACARD'.
               10 L-TXT-PARK-VOILATIONS     PIC X(26)
                                            VALUE
                 'PARKING VIOLATIONS ON FILE'.
               10 L-TXT-FEE-SUB-REC         PIC X(23)
                                            VALUE
                 'FEE SUB-RECORD ON FILE '.
               10 L-TXT-CAMA                PIC X(02)
                                            VALUE ', '.
               10 L-TXT-BUYER               PIC X(06)
                                            VALUE 'BUYER:'.
               10 L-TXT-SELLER              PIC X(07)
                                            VALUE 'SELLER:'.
               10 L-TXT-RECEIVED            PIC X(09)
                                            VALUE 'RECEIVED '.
               10 L-TXT-REC-DATE            PIC X(13)
                                            VALUE 'RECEIPT DATE:'.
               10 L-TXT-TRANSFER-DATE       PIC X(14)
                                            VALUE 'TRANSFER DATE:'.
               10 L-TXT-SELL-PRICE          PIC X(13)
                                            VALUE '  SELL PRICE:'.
               10 L-TXT-SNI-INQ             PIC X(15)
                                            VALUE 'USE SNI INQUIRY'.
               10 L-TXT-RL-FORM             PIC X(22)
                                            VALUE
                      'NOT SHOWN ON R/L FORM '.
               10 L-TXT-RO-FORM             PIC X(22)
                                            VALUE
                      'SAME AS R/O ON FILE   '.
               10 L-TXT-LO-FORM             PIC X(22)
                                            VALUE
                      'SAME AS L/O ON FILE   '.
               10 L-TXT-SAME-BUYER          PIC X(22)
                                            VALUE
                      'SAME AS PREVIOUS BUYER'.
               10 L-TXT-NOT-SAME-ON-FILE    PIC X(23)
                                            VALUE
                      'NOT THE SAME AS ON FILE'.
               10 L-TXT-NOT-LEGIBLE         PIC X(23)
                                            VALUE
                      'NOT LEGIBLE            '.
               10 L-TXT-ADD-RL-HIS          PIC X(22)
                                            VALUE
                      'ADDITIONAL R/L HISTORY'.
               10 L-TXT-REG-138             PIC X(31)
                                            VALUE
                      'RELEASE OF LIABILITY (REG. 138)'.
               10 L-TXT-RETRY               PIC X(34)
                                            VALUE
                      'UPDATE IN PROCESS, RETRY IN 5 DAYS'.
               10 L-TXT-REL-LIABILITY       PIC X(39)
                                            VALUE
                      'INCOMPLETE RELEASE OF LIABILITY (138)  '.
               10 L-TXT-DMV-INQUIRY         PIC X(44)
                                            VALUE
                      'CONTACT DMV SACRAMENTO FOR OWNER INFORMATION'.

               10 L-TXT-LESSEE-INFO         PIC X(28)
                                            VALUE
                      'LESSEE INFORMATION RECORD(S)'.
               10 L-TXT-EFF-DATE            PIC X(15)
                                            VALUE 'EFFECTIVE DATE:'.
               10 L-TXT-CREATION-DATE       PIC X(14)
                                            VALUE 'CREATION DATE:'.
               10 L-TXT-REMOVAL-DATE        PIC X(13)
                                            VALUE
                                            'REMOVAL DATE:'.
               10 L-TXT-NAME                PIC X(05)
                                            VALUE 'NAME:'.
               10 L-TXT-OS                  PIC X(05)
                                            VALUE ' O/S:'.
               10 L-TXT-FICHE               PIC X(07)
                                            VALUE ' FICHE:'.

      * SBA CONTROL CHARACTERS
           COPY VRCXCF01.
           05  FILLER REDEFINES WS-SBA-TBL.
               10  TBL-SBA-CHR              PIC X(03)
                                            OCCURS 23 TIMES.
      * APPENDAGES FOR 3270 TERMINAL
           COPY VRCXCF02.

       01  FILLER                           PIC X(24)  VALUE
                 'WS-STOP   VRPCCF03      '.

      /*****************************************************************
       LINKAGE SECTION.
      ******************************************************************

      * TDS COMMON FIXED PACKET
       01 ARG-TRFX-PKT.
          COPY OCCXMTRF.

      * IREQ DATA PACKET
       01 ARG-IREQ-PKT.
          COPY OCCXMIRE.

      * FREQ DATA PACKET
       01 ARG-FREQ-PKT.
          COPY OCCXMFRE.

      * IACB DATA PACKET
       01 ARG-IACB-PKT.
          COPY OCCXMIAC.

       01 ARG-VINX-PKT.
          COPY OCCXMVNX.

       01 ARG-VBB-PKT.
          COPY VCCXMVBB.

       01 ARG-VRO-PKT.
          COPY VCCXMVRO.

       01 ARG-VLO-PKT.
          COPY VCCXMVLO.

       01 ARG-VRC-PKTS.
          COPY VCCXMVRC.

       01 ARG-VPO-PKTS.
          COPY VCCXMVPO.

       01 ARG-VPC-PKTS.
          COPY VCCXMVPC.

       01 ARG-VNH-PKT.
          COPY VCCXMVNH.

       01 ARG-VNR-PKTS.
          COPY VCCXMVNR.

       01 ARG-VSA-PKT.
          COPY VCCXMVSA.

       01 ARG-VFP-PKT.
          COPY VCCXMVFP.

       01 ARG-VCI-PKTS.
          COPY VCCXMVCI.

       01 ARG-VFD-PKT.
          COPY VCCXMVFD.

       01 ARG-VLS-PKTS.
          COPY VCCXMVLS.

       01 ARG-VRH-PKTS.
          COPY VCCXMVRH.

       01 ARG-VMG-PKTS.
          COPY VCCXMVMG.

       01 ARG-VDC-PKTS.
          COPY VCCXMVDC.

       01 ARG-VHY-PKTS.
          COPY VCCXMVHY.

       01 ARG-VMP-PKTS.
          COPY VCCXMVMP.

       01 ARG-VYP-PKT.
          COPY VCCXMVYP.

       01 ARG-VIV-PKT.
          COPY VCCXMVIV.

       01 ARG-VVP-PKT.
          COPY VCCXMVVP.

       01 ARG-RAW-DB-RCD.
          COPY OCCXMRDT.

      /*****************************************************************
       PROCEDURE DIVISION.
      ******************************************************************

       0000-MAIN.

           PERFORM 1000-INIT

           IF NO-ERROR
              PERFORM 2000-PROCESS
           END-IF

           GOBACK
           .

      /*****************************************************************
      * 1000-INIT.
      * FUNCTION:
      * INITIALIZE WORK AREA.
      ******************************************************************
       1000-INIT.

           INITIALIZE  WS-SUB-SCRIPTS
                       WS-COUNTERS
                       WS-RESP-OUTPUT
                       SW-SEARCH-COMPLETED
                       SW-WRITE-STOP-MSG
                       SW-FRMT-ZZ-2DPA
                       SW-SEND-PWO-MESSAGE
                       SW-NEXT-LIC-SPACE
                       SW-SUBPLATE
                       SW-IAC-MAIL-ADDR
                       SW-SHORT-REPLY
                       WS-LN-ADDR
                       CTR-WRITE-Q

           MOVE 1                  TO WS-STRT
           MOVE 1                  TO WS-SUB
           MOVE 1                  TO CTR-SPACES

           SET FIRST-PAGE          TO TRUE
           SET MORE-TO-FORMAT      TO TRUE
           SET NO-RETURN-TO-TC     TO TRUE
           SET FRMT-ZZ-2DPA-NO     TO TRUE
           SET SUS-DATA-NOT-FOUND  TO TRUE
           SET REC-STATUS-MSG-NOT-WRITTEN
                                   TO TRUE
           SET E5X-MSG-NOT-WRITTEN TO TRUE
           SET TRC-MSG-NOT-WRITTEN TO TRUE
           SET INS-MSG-NOT-WRITTEN TO TRUE
           SET CUR-ON-OTH-VIN-MSG-NOT-WRTN
                                   TO TRUE
           SET FIRST-TIME-LOOP     TO TRUE
           SET NO-ERROR            TO TRUE

           IF SW-FIRST-CALL
              PERFORM 1010-GET-DATA
           END-IF
           .

      /****************************************************************
      * 1010-GET-DATA
      * FUNCTION:
      * - RETRIEVE THE REQUIRED DATA PACKETS FROM THEIR
      *   RESPECTIVE DATA STRUCTURES.
      *****************************************************************
      *
       1010-GET-DATA.

           INITIALIZE  ARRAY-PKTS
           MOVE +1                  TO IDX-SMG
           MOVE L-TRFX-PKT-ID       TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-IACB-PKT-ID       TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-IREQ-PKT-ID       TO ARRAY-PKT-ID (IDX-SMG)
           MOVE IDX-SMG             TO CTR-SMG-DATA-PKTS

           PERFORM 1020-RETRIEVE-TDS-PKTS
              VARYING IDX-SMG FROM +1 BY +1
                UNTIL IDX-SMG > CTR-SMG-DATA-PKTS
                   OR ERROR-RTN
           .

      /****************************************************************
      * 1020-RETRIEVE-TDS-PKTS.
      * FUNCTION:
      * - SETUP THE CALLING PARAMETERS TO RETRIEVE THE TRFX, IREQ & IACB
      *   DATA PACKETS FROM THE TRANSACTION DATA STRUCTURE BY CALLING
      *   THE STRUCTURE MANAGER.
      * - THE STRUCTURE MANAGER RETURNS THE ADDRESSES OF THESE DATA
      *   PACKETS. THE DATA LAYOUTS ARE IN THE LINKAGE SECTION AND WILL
      *   BE MAPPED TO THE ADDRESS OF THE DATA PACKET.
      *****************************************************************
      *
       1020-RETRIEVE-TDS-PKTS.

           INITIALIZE WS-STRUCT-MGR-PARMS
           SET  SMG-STRUCT-TDS         TO TRUE
           SET  SMG-FUNC-READFIRST     TO TRUE
           MOVE ARRAY-PKT-ID (IDX-SMG) TO SMG-PKT-ID

           PERFORM 8000-CALL-STRUCT-MGR

           IF  SMG-SUCCESSFUL

               EVALUATE TRUE
                   WHEN SMG-PKT-ID = L-TRFX-PKT-ID
                      SET ADDRESS OF ARG-TRFX-PKT TO SMG-ADDR
                   WHEN SMG-PKT-ID = L-IREQ-PKT-ID
                      SET ADDRESS OF ARG-IREQ-PKT TO SMG-ADDR
                   WHEN SMG-PKT-ID = L-IACB-PKT-ID
                      SET ADDRESS OF ARG-IACB-PKT TO SMG-ADDR
                      MOVE SMG-PKT-CNT TO CTR-IACB
               END-EVALUATE

           END-IF
           .

      /*****************************************************************
      * 2000-PROCESS
      * FUNCTION:
      * FORMATS THE RESPONSE OR THE MESSAGE
      ******************************************************************
       2000-PROCESS.

           IF  ERRO-NBR(L-1) = ZEROS OR SPACES
               SET FORMAT-RESPONSE   TO TRUE
           ELSE
               SET FORMAT-ERR-MSG    TO TRUE
           END-IF

           IF  PRKY-FILE-CODE = L-V
           AND PRKY-CURR-PTR  = 1
               PERFORM 6020-STORE-VINX
           END-IF

           IF  PRKY-MNEMONIC = 'VUT'
               SET SUSP-RDF-ERR-READ  TO TRUE
           ELSE
               SET VR-MASTR-READ      TO TRUE
           END-IF

           IF  NO-ERROR
           AND SW-FIRST-CALL
               PERFORM 6000-GET-ADDR-VAR-PKTS-IN-TDS
               SET SW-NOT-FIRST-CALL TO TRUE
               IF  NO-ERROR
                   PERFORM 6015-SEARCH-FLAG-PKT
               END-IF
           END-IF

           IF WS-FIL-CD = L-V
              SET INQUIRY-BY-VIN     TO TRUE
              IF WS-MAKE > SPACES
                 SET INQUIRY-BY-MAKE TO TRUE
              END-IF
              IF WS-YEAR > SPACES
                 SET INQUIRY-BY-YEAR TO TRUE
              END-IF
              IF  WS-YEAR > SPACES
              AND WS-MAKE > SPACES
                 SET INQUIRY-BY-BOTH TO TRUE
              END-IF
           END-IF

           IF NO-ERROR AND NO-RETURN-TO-TC
              PERFORM 2100-FORMAT-BEG-BYTES

              IF FORMAT-RESPONSE
                 IF WS-FIL-CD = L-V
                    IF VR-MASTR-READ
                       PERFORM 3080-FRMT-VLT-STOP-MSGS
                    END-IF
                    IF PRKY-NOT-FOUND
                       PERFORM 2220-FORMAT-VIN-STOPS
                    END-IF
                 END-IF
                 IF PRKY-NOT-FOUND
                 OR PRKY-DUPLICATE
                    IF PRKY-NOT-FOUND
                       IF PRKY-RESTRICT-NOT-FND
                          MOVE LENGTH OF L-RECORD-UNAVAIL02
                                                  TO WS-FLD-LEN
                          MOVE L-RECORD-UNAVAIL02 TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       ELSE
                          PERFORM 2230-FORMAT-REC-NOT-FOUND
                       END-IF
                    ELSE
                       MOVE LENGTH OF L-SUB-PLATE-FLD-IN-ERROR
                                               TO WS-FLD-LEN
                       MOVE L-SUB-PLATE-FLD-IN-ERROR
                                               TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                    PERFORM 2010-CHECK-ZZ-2DPA-FRMT
                    PERFORM 6450-SKIP-A-LINE
                    SET END-OF-FORMAT          TO TRUE
                 ELSE
                    IF WS-FIL-CD = L-V
                       CONTINUE
                    ELSE
                       PERFORM 2010-CHECK-ZZ-2DPA-FRMT
                    END-IF

                    IF WRITE-STOP-MSG
                    OR WRITE-REST-MSG
                    OR FRMT-ZZ-2DPA-YES
                       CONTINUE
                    ELSE
                       PERFORM 2200-FORMAT-RESPONSE
                       PERFORM 2220-FORMAT-VIN-STOPS
                    END-IF
                 END-IF

              ELSE
                 SET ERROR-RTN     TO TRUE
                 SET END-OF-FORMAT TO TRUE
                 PERFORM 4000-FORMAT-ERROR-MSG
                 PERFORM 2010-CHECK-ZZ-2DPA-FRMT
              END-IF

              IF NO-RETURN-TO-TC
                 IF NO-ERROR
                    IF  WS-FIL-CD = L-V
                    AND VR-MASTR-READ
                        PERFORM 6505-CHECK-NEXT-LIC-SPACE
                    END-IF
                    PERFORM 5155-FORMAT-WRAPUP
                 END-IF

                 IF LAST-MOVE-END-BYTES
                    CONTINUE
                 ELSE
                    PERFORM 4500-FORMAT-END-BYTES
                 END-IF

                 INITIALIZE SW-LICENSE-STATUS

                 IF  NO-ERROR
                 AND WS-FIL-CD = L-V
                 AND VR-MASTR-READ
                     PERFORM 6510-CHECK-NEXT-VIN-REC
                     UNTIL LICENSE-NOT-SPACE
                        OR END-OF-VINX
                        OR ERROR-RTN
                     IF NO-ERROR
                        PERFORM 6520-END-OF-SEARCH-MESSAGE
                     END-IF
                 END-IF
              END-IF
           END-IF
           .

      /*****************************************************************
      * 2010-CHECK-ZZ-2DPA-FRMT
      * FUNCTION:
      * VERIFY ZZ99999, 2DPA, 2VET FORMATS FOR LICENSE, IF FOUND FORMAT
      * THE MESSAGE AND RETURN CONTROL TO TC, DO NOT PERFORM PROGRAM
      * MAIN LOGIC
      ******************************************************************
       2010-CHECK-ZZ-2DPA-FRMT.

           IF WS-LIC(1:2) = L-ZZ
               IF WS-LIC(3:5) IS NUMERIC
                  IF WS-LIC >= L-ZZ58100 AND
                            <= L-ZZ67099
                      IF LAST-MOVE-NOT-SBA
                         PERFORM 6450-SKIP-A-LINE
                      END-IF
                      MOVE LENGTH OF L-TXT-FEE-PD-RNTL TO WS-FLD-LEN
                      MOVE L-TXT-FEE-PD-RNTL           TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                      PERFORM 6450-SKIP-A-LINE
                      MOVE LENGTH OF L-TXT-IRP-UNIT    TO WS-FLD-LEN
                      MOVE  L-TXT-IRP-UNIT             TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                      PERFORM 6450-SKIP-A-LINE
                      SET FRMT-ZZ-2DPA-YES             TO TRUE
                  ELSE
                      IF LAST-MOVE-NOT-SBA
                         PERFORM 6450-SKIP-A-LINE
                      END-IF
                      MOVE LENGTH OF L-TXT-PLT-INVALID TO WS-FLD-LEN
                      MOVE  L-TXT-PLT-INVALID          TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                      PERFORM 6450-SKIP-A-LINE
                      MOVE LENGTH OF L-TXT-IRP-UNIT    TO WS-FLD-LEN
                      MOVE  L-TXT-IRP-UNIT             TO WS-MOVE-FLD
                      PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                      PERFORM 6450-SKIP-A-LINE
                      SET FRMT-ZZ-2DPA-YES             TO TRUE
                  END-IF
               END-IF
           END-IF

           IF WS-FIL-CD = L-L OR L-W1
              CONTINUE
           ELSE
             IF WS-LIC(1:4) = L-2DPA OR L-2VET
                IF LAST-MOVE-NOT-SBA
                  PERFORM 6450-SKIP-A-LINE
                END-IF
                MOVE LENGTH OF L-TXT-RDPVPS          TO WS-FLD-LEN
                MOVE  L-TXT-RDPVPS                   TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                PERFORM 6450-SKIP-A-LINE
                MOVE LENGTH OF L-TXT-CNCT-CTU        TO WS-FLD-LEN
                MOVE  L-TXT-CNCT-CTU                 TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
                SET FRMT-ZZ-2DPA-YES                 TO TRUE
             END-IF
           END-IF
           .

      /*****************************************************************
      * 2200-FORMAT-RESPONSE.
      * FUNCTION:
      * FORMATS THE RESPONSE.
      ******************************************************************
       2200-FORMAT-RESPONSE.

           IF SUSP-RDF-ERR-READ
              PERFORM 6055-GET-ADS-DATA-SUSP
           ELSE
              PERFORM 6050-GET-ADS-DATA
           END-IF

           MOVE VBB-TYPE-REC-CD         TO WS-TYPE-RECORD-CD
           PERFORM 6060-SET-SWITCHES
           PERFORM 2205-FORMAT-TRC-MSGS

           IF CTR-VBB = ZERO
              SET RC-CALL-FAIL-WITH-MSG TO TRUE
              SET ERROR-RTN             TO TRUE
              SET RETURN-TO-TC          TO TRUE
           END-IF

           IF CTR-VYP = ZERO
           AND RT-BAS-OWN-SUS
              MOVE  LENGTH OF L-RETRY-48-HRS TO WS-FLD-LEN
              MOVE L-RETRY-48-HRS            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET END-OF-FORMAT              TO TRUE
              SET ERROR-RTN                  TO TRUE
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF NO-ERROR AND TRC-MSG-NOT-WRITTEN

              IF MASTER-FILE-FORMAT
                 PERFORM 5000-FORMAT-BAS-SUB-REC

              ELSE
                 IF VBB-SUB-PLATE
                    PERFORM 2208-FRMT-TRC1-MSGS
                 ELSE
                    IF VBB-VRC-PRESENT(30)
                       IF SYF-R60-INHOUSE1-REQ-YES OR
                          SYF-R60-INHOUSE2-REQ-YES
                         CONTINUE
                       ELSE
                         SET RCC-30 TO TRUE
                         PERFORM 2999-SEARCH-VRC-PKT
                         IF VRC30-REASON-CD  = '01'
                           SET SKIP-VEHICLE-INFO TO TRUE
                         END-IF
                       END-IF
                    END-IF

                    PERFORM 2210-FORMAT-INS-MSG

                    IF SKIP-VEHICLE-INFO
                       CONTINUE
                    ELSE
                       PERFORM 2240-ANI-INFO
                       IF VEH-RO-LO-ADD-INFO AND VBB-PSEUDO
                          CONTINUE
                       ELSE
                          PERFORM 2300-FORMAT-VEH-INFO
                       END-IF

                       EVALUATE TRUE

                         WHEN VEH-RO-INFO
                           PERFORM 2400-FORMAT-RO-INFO

                         WHEN VEH-RO-LO-INFO
                           PERFORM 2400-FORMAT-RO-INFO
                           PERFORM 2500-FORMAT-LO-INFO

                         WHEN VEH-RO-LO-ADD-INFO
                           IF VBB-PSEUDO
                              CONTINUE
                           ELSE
                              PERFORM 2400-FORMAT-RO-INFO
                              PERFORM 2500-FORMAT-LO-INFO
                              PERFORM 2600-FORMAT-ADD-PEN-INFO
                           END-IF

                         WHEN VEH-RO-LO-ADD-PEN-INFO
                           PERFORM 2400-FORMAT-RO-INFO
                           PERFORM 2500-FORMAT-LO-INFO
                           PERFORM 2600-FORMAT-ADD-PEN-INFO

                         WHEN OTHER
                           CONTINUE

                       END-EVALUATE
                     END-IF

                     PERFORM 2900-FORMAT-ESUB-REC
                     SET END-OF-FORMAT TO TRUE
                 END-IF

              END-IF
           END-IF
           .

      /*****************************************************************
      * 2100-FORMAT-BEG-BYTES
      * FUNCTION:
      * FORMATS THE BEGINNING APPENDAGES
      ******************************************************************
       2100-FORMAT-BEG-BYTES.

           IF MASTER-FILE-FORMAT
              SET R67-FORMAT           TO TRUE
           ELSE
              SET R60-FORMAT           TO TRUE
           END-IF

           MOVE 1 TO WS-STRT
           MOVE LENGTH OF WS-BEGN-BYTE TO WS-FLD-LEN
           MOVE WS-BEGN-BYTE           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           MOVE WS-FIX-DATA            TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH              TO WS-FLD-LEN
           MOVE WS-FIX-DATA            TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           IF  SUB-PLATE-LIC
           AND PRKY-DB-KEY(1:7) = WS-SUB-PLATE-LIC
               IF PRKY-DUPLICATE
                  CONTINUE
               ELSE
                  MOVE PRKY-DB-KEY TO WS-LIC
               END-IF
           END-IF

           IF WS-FIL-CD = L-V
              PERFORM 2105-MOVE-VIN-OPT-FLDS
           ELSE
              MOVE WS-LIC                 TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH              TO WS-FLD-LEN
              MOVE WS-LIC                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF FIRST-PAGE
              MOVE LENGTH OF WS-DATE-TIME TO WS-FLD-LEN
              MOVE BDAT-DATE-MM           TO WS-DATE-MM
              MOVE BDAT-DATE-DD           TO WS-DATE-DD
              MOVE BDAT-DATE-YY           TO WS-DATE-YY
              MOVE BDAT-TIME-HH           TO WS-TIME-HR
              MOVE BDAT-TIME-MM           TO WS-TIME-MN
              MOVE WS-DATE-TIME           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /*****************************************************************
      * 2105-MOVE-VIN-OPT-FLDS
      * FUNCTION:
      * THIS ROUTINE WILL FORMAT THE VARIABLE PORTION OF REQUEST HEADER
      * FROM THE IREQ FOR A VIN INQUIRY
      ******************************************************************
       2105-MOVE-VIN-OPT-FLDS.


           MOVE WS-VIN                 TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH              TO WS-VIN-LEN

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF IREQ-DCS-MSG(TRNM-REQUEST-LEN:1) = X'03' OR X'BD'
              COMPUTE WS-LENGTH = TRNM-REQUEST-LEN - L-1
           ELSE
              MOVE TRNM-REQUEST-LEN TO WS-LENGTH
           END-IF
           COMPUTE WS-LENGTH = WS-LENGTH - (LENGTH OF WS-FIX-DATA)
           MOVE L-14 TO L-VIN-START-POS
           IF IREQ-DCS-MSG(L-VIN-START-POS:L-1) = SPACE
              COMPUTE L-VIN-START-POS = L-VIN-START-POS + L-1
              COMPUTE WS-LENGTH = WS-LENGTH - L-1
           END-IF
           MOVE IREQ-DCS-MSG(L-VIN-START-POS:WS-LENGTH) TO WS-MOVE-FLD
           MOVE WS-VIN(1:WS-VIN-LEN) TO WS-MOVE-FLD(1:WS-VIN-LEN)
           MOVE WS-LENGTH            TO WS-FLD-LEN
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 2205-FORMAT-TRC-MSGS
      * FORMATS THE MESSAGES SPECIC TO TYPE RECORD CODE 2 OR 3 OR 4
      *
      ******************************************************************
       2205-FORMAT-TRC-MSGS.

           IF VBB-UNACP-WRD
              IF SYF-R60-INHOUSE5-REQ-YES
                 MOVE LENGTH OF L-LIC-UN-ACCEPT   TO WS-FLD-LEN
                 MOVE L-LIC-UN-ACCEPT             TO WS-MOVE-FLD
              ELSE
                 MOVE LENGTH OF L-REC-NOT-ON-FILE TO WS-FLD-LEN
                 MOVE L-REC-NOT-ON-FILE           TO WS-MOVE-FLD
              END-IF
              PERFORM 6260-MOVE-TEXT-FIELD
              PERFORM 6450-SKIP-A-LINE
              SET ERROR-RTN                 TO TRUE
              SET TRC-MSG-WRITTEN           TO TRUE
              SET END-OF-FORMAT             TO TRUE
           END-IF

           IF VBB-ELP-RESV
              MOVE LENGTH OF L-LIC-RESER    TO WS-FLD-LEN
              MOVE L-LIC-RESER              TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD
      *****************************************
      *  REMEDY 611474 TIP DISPLAY PROBLEM
      *  COMMENT OUT ERROR-RTN LINE
      *****************************************
      *      SET ERROR-RTN                 TO TRUE
              PERFORM 6450-SKIP-A-LINE
              IF VBB-VRC-PRESENT(50)
                 PERFORM 2207-FORMAT-E50-MSG
              END-IF

              SET TRC-MSG-WRITTEN           TO TRUE
              SET END-OF-FORMAT             TO TRUE
           END-IF

           IF VBB-RETENTION
              IF WS-FIL-CD = L-V
                 MOVE L-8                   TO WS-FLD-LEN
                 MOVE PRKY-DB-KEY           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF L-REC-NOT-ON-FILE-VIN
                                            TO WS-FLD-LEN
                 MOVE L-REC-NOT-ON-FILE-VIN TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
                 SET TRC-MSG-WRITTEN        TO TRUE
                 SET END-OF-FORMAT          TO TRUE
              ELSE
                 PERFORM 2206-FRMT-TRC4-PWO-MSGS
              END-IF
           END-IF
           .

      /***************************************************************
      * 2206-FRMT-TRC4-PWO-MSGS
      * FUNCTION: FORMAT MESSAGE WHEN TYPE RECORD CODE IS '4' AND PWO
      *           PRESENT ('F' SUB-RECORD COUNT > 0 ON BASIC).
      ****************************************************************
       2206-FRMT-TRC4-PWO-MSGS.

           IF ZERO-TO-FOUR-INFO
              PERFORM 2210-FORMAT-INS-MSG
           END-IF

           IF SYF-R60-INHOUSE5-REQ-YES
              MOVE LENGTH OF L-PWO-REC-EXP-DATE TO WS-FLD-LEN
              MOVE L-PWO-REC-EXP-DATE           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VBB-ELP-RTN-EXPR-DT          TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6450-SKIP-A-LINE

              IF VBB-VRC-PRESENT(50)
                 PERFORM 2207-FORMAT-E50-MSG
              END-IF

              SET TRC-MSG-WRITTEN            TO TRUE
              SET END-OF-FORMAT              TO TRUE

           ELSE
              IF VBB-F-SUB-REC-CNT = 0
                 MOVE LENGTH OF L-REC-NOT-ON-FILE
                                                TO WS-FLD-LEN
                 MOVE L-REC-NOT-ON-FILE         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
                 SET TRC-MSG-WRITTEN            TO TRUE
                 SET END-OF-FORMAT              TO TRUE
              END-IF
              IF VBB-F-SUB-REC-CNT > 0
                 SET TRC-MSG-WRITTEN            TO TRUE
                 SET RETURN-TO-TC               TO TRUE
              END-IF
           END-IF
           .

      /***************************************************************
      * 2207-FORMAT-E50-MSG
      * FUNCTION: FORMATS THE E50 SUB RECORD
      *
      ****************************************************************
       2207-FORMAT-E50-MSG.

           SET RCC-50 TO TRUE
           PERFORM 2999-SEARCH-VRC-PKT

           MOVE LENGTH OF L-TXT-TIP-OFF            TO WS-FLD-LEN
           MOVE L-TXT-TIP-OFF                      TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE LENGTH OF VRC50-TIP-OFF-ID  TO WS-FLD-LEN
           MOVE VRC50-TIP-OFF-ID                   TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TXT-DT                 TO WS-FLD-LEN
           MOVE L-TXT-DT                           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           IF  VRC50-TIP-WRK-DT      > ZEROS
               MOVE VRC50-TIP-WRK-DT    TO WS-FRMAT-YMD
               PERFORM 6310-MOVE-FORMATTED-DATE
           ELSE
               MOVE LENGTH OF WS-TEST-DATE       TO WS-FLD-LEN
               MOVE WS-TEST-DATE                 TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TXT-IDS             TO WS-FLD-LEN
           MOVE L-TXT-IDS                       TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE LENGTH OF VRC50-TIP-TECH-ID
                                                TO WS-FLD-LEN
           MOVE VRC50-TIP-TECH-ID               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VRC50-TIP-TRANSACTION-TME
                                                TO WS-FLD-LEN
           IF VRC50-TIP-TRANSACTION-TME   > ZEROS
              MOVE VRC50-TIP-TRANSACTION-TME   TO         WS-MOVE-FLD
           ELSE
              MOVE SPACES TO  WS-MOVE-FLD
           END-IF
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TXT-TRAN            TO WS-FLD-LEN
           MOVE L-TXT-TRAN                      TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE LENGTH OF VRC50-TIP-TYPE-TRAN-CD
                                                TO WS-FLD-LEN
           MOVE VRC50-TIP-TYPE-TRAN-CD   TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VRC50-PRI-TRAN-CREDIT-CARD-IND   = 'C'
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-TXT-CREDT-CARD    TO WS-FLD-LEN
              MOVE L-TXT-CREDT-CARD              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC50-PRI-TRAN-CREDIT-CARD-IND
                                                        TO WS-FLD-LEN
              MOVE VRC50-PRI-TRAN-CREDIT-CARD-IND
                                                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           PERFORM 6450-SKIP-A-LINE
           .

      /***************************************************************
      * 2208-FRMT-TRC1-MSGS
      * FUNCTION: FORMATS THE MESSAGES FOR TYPE RECOD CODE 1
      *
      ****************************************************************
       2208-FRMT-TRC1-MSGS.

           IF WS-FIL-CD = L-V
              CONTINUE

           ELSE
              IF VBB-VRC-PRESENT(02)

                 SET RCC-02 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 IF VRC02-FILE-CD  = 'L'

                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-SUBPLT-ELP   TO WS-FLD-LEN
                    MOVE L-SUBPLT-ELP             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF WS-LIC-NUM     TO WS-FLD-LEN
                    MOVE VRC02-VEH-VSL-LIC-NBR
                                                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF L-USE-VIN-INQ  TO WS-FLD-LEN
                    MOVE L-USE-VIN-INQ            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE

                 END-IF

              END-IF

           END-IF

           PERFORM 6450-SKIP-A-LINE
           MOVE LENGTH OF L-TXT-LICNSE    TO WS-FLD-LEN
           MOVE L-TXT-LICNSE              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE LENGTH OF WS-LIC-NUM      TO WS-FLD-LEN
           IF WS-FIL-CD = L-V
              MOVE SPACES                 TO WS-MOVE-FLD
           ELSE
              MOVE VBB-KEY-VEH-VSL-LIC-NBR TO WS-MOVE-FLD
           END-IF
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TXT-LAD       TO WS-FLD-LEN
           MOVE L-TXT-LAD                 TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE VBB-REDUCED-SUB-PLT-PURGE-DT TO WS-FORMAT-DT
           PERFORM 6310-MOVE-FORMATTED-DATE
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-TYP1-HDR3     TO WS-FLD-LEN
           MOVE L-TYP1-HDR3               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           IF VBB-VRC-PRESENT(02)

              SET RCC-02 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF WS-LIC-NUM          TO WS-FLD-LEN
              MOVE VRC02-VEH-VSL-LIC-NBR  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           ELSE
              MOVE LENGTH OF WS-LIC-NUM   TO WS-FLD-LEN
              MOVE SPACES                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           SET END-OF-FORMAT         TO TRUE

           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 2210-FORMAT-INS-MSG.
      * FUNCTION:FORMAT INSURANCE INFORMATION MAIN LOGIC.EVALUATES
      * TYPE RECORD, SPECIAL COURT FLAG, ANI INFORMATION
      ******************************************************************
       2210-FORMAT-INS-MSG.

           PERFORM 2215-FORMAT-MULT-INS-MSG

           IF MULT-VIN-MSG-NOT-WRITEN
              IF VBB-SUSP-RDF OR
                 VBB-PSEUDO
                 IF SUSP-RDF-ERR-READ
                   CONTINUE
                 ELSE
                   SET INS-MSG-WRITTEN TO TRUE
                   MOVE LENGTH OF L-TXT-PENDING-INS TO WS-FLD-LEN
                   MOVE L-TXT-PENDING-INS           TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE
                 END-IF
              ELSE
                IF SUS-DATA-FOUND
                   SET INS-MSG-WRITTEN TO TRUE
                   MOVE LENGTH OF L-TXT-PENDING-INS TO WS-FLD-LEN
                   MOVE L-TXT-PENDING-INS           TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE
                END-IF

                IF INS-MSG-NOT-WRITTEN
                   PERFORM 2020-EVAL-VEH-VSL-CD
                END-IF

              END-IF
           END-IF

           IF (SYF-R60-SF-COURT-YES  AND
               SPL-COURT-MSG-NOT-WRITEN)

               MOVE LENGTH OF L-TXT-SPECIAL-COURT  TO WS-FLD-LEN
               MOVE L-TXT-SPECIAL-COURT            TO WS-MOVE-FLD
               PERFORM 6260-MOVE-TEXT-FIELD
               PERFORM 6450-SKIP-A-LINE
               SET SPL-COURT-MSG-WRITEN TO TRUE
           END-IF

           IF VBB-SUSP-RDF OR
             (VEH-RO-LO-ADD-PEN-INFO AND VBB-PSEUDO)

             MOVE LENGTH OF L-TXT-PEND-MAS-FILE  TO WS-FLD-LEN
             MOVE L-TXT-PEND-MAS-FILE            TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             PERFORM 6450-SKIP-A-LINE

           END-IF

           .

      /*****************************************************************
      * 2215-FORMAT-MULT-INS-MSG.
      * FUNCTION:FORMAT INSURANCE INFORMATION MAIN LOGIC.
      ******************************************************************
       2215-FORMAT-MULT-INS-MSG.

           IF WS-FIL-CD = L-V  AND
              WS-VIN-CTR > L-1 AND
              MULT-VIN-MSG-NOT-WRITEN

              MOVE LENGTH OF L-TXT-MULTI-VINS     TO WS-FLD-LEN
              MOVE L-TXT-MULTI-VINS               TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD
              PERFORM 6450-SKIP-A-LINE
              SET MULT-VIN-MSG-WRITEN TO TRUE
           END-IF
           .

      /*****************************************************************
      * 2220-FORMAT-VIN-STOPS
      * FUNCTION:
      * FORMATS THE VIN STOP MESSAGE AT THE END OF RESPONSE.
      ******************************************************************
       2220-FORMAT-VIN-STOPS.

           IF  STOP-NOT-WRITTEN
           AND ZERO-TO-FOUR-INFO
              IF VINX-STAT-VLT-STOP OF WS-VINX-PKT(WS-SUB2)
                 IF SYF-R60-ALLOW-VLT-YES
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TXT-VLT-VIN    TO WS-FLD-LEN
                    MOVE L-TXT-VLT-VIN              TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF VINX-MAKE-OF-VEH
                            OF WS-VINX-PKT(WS-SUB2) TO WS-FLD-LEN
                    MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                    TO WS-MOVE-FLD
                 ELSE
                    MOVE LENGTH OF L-VEHICLE-NOT-REGSTR
                                                    TO WS-FLD-LEN
                    MOVE L-VEHICLE-NOT-REGSTR       TO WS-MOVE-FLD
                 END-IF
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VINX-STAT-DOJ-STOP-STLN OF WS-VINX-PKT(WS-SUB2)
                 IF VINX-STAT-DOJ-STOP-REFR OF WS-VINX-PKT(WS-SUB2)
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TXT-DOJ-STOP-RFRL TO WS-FLD-LEN
                    MOVE L-TXT-DOJ-STOP-RFRL        TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF VINX-MAKE-OF-VEH
                           OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                    MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TXT-DOJ-STOP   TO WS-FLD-LEN
                    MOVE L-TXT-DOJ-STOP             TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF VINX-MAKE-OF-VEH
                           OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                    MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              END-IF

              IF VINX-STAT-BAR-SMOG-CERT OF WS-VINX-PKT(WS-SUB2)
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-TXT-ELTRNC-SMOG TO WS-FLD-LEN
                 MOVE L-TXT-ELTRNC-SMOG          TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF VINX-MAKE-OF-VEH
                        OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                 MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VINX-STAT-OS-LIC-FLG-STOP OF WS-VINX-PKT(WS-SUB2)
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-OUT-OF-STATE-STOP
                                                 TO WS-FLD-LEN
                 MOVE L-OUT-OF-STATE-STOP        TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF VINX-MAKE-OF-VEH
                        OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                 MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 2230-FORMAT-REC-NOT-FOUND
      * FUNCTION:
      * FORMATS THE MESSAGE WHEN PRKY-NOT-FOUND ON THE KEY DATA PACKET
      ******************************************************************
       2230-FORMAT-REC-NOT-FOUND.

           IF SUSP-RDF-ERR-READ
              MOVE LENGTH OF L-NO-RECORD-ON-SUSP
                                               TO WS-FLD-LEN
              MOVE L-NO-RECORD-ON-SUSP         TO WS-MOVE-FLD
           ELSE
              IF PRKY-DB-KEY(8:1) = SPACES
                 IF WS-FIL-CD = L-V
                    MOVE L-8                   TO WS-FLD-LEN
                    MOVE PRKY-DB-KEY           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-REC-NOT-ON-FILE-VIN
                                               TO WS-FLD-LEN
                    MOVE L-REC-NOT-ON-FILE-VIN TO WS-MOVE-FLD
                 ELSE
                    IF WS-FIL-CD = PRKY-FILE-CODE
                        MOVE LENGTH OF L-REC-NOT-ON-FILE
                                                    TO WS-FLD-LEN
                        MOVE L-REC-NOT-ON-FILE      TO WS-MOVE-FLD
                    ELSE
                        MOVE LENGTH OF L-FC-LIC-INCOMPAT
                                                    TO WS-FLD-LEN
                        MOVE L-FC-LIC-INCOMPAT      TO WS-MOVE-FLD
                    END-IF
                 END-IF
              ELSE
                 IF WS-FIL-CD = L-V
                    MOVE LENGTH OF L-VIN-REC-NOT-ON-FILE
                                                TO WS-FLD-LEN
                    MOVE L-VIN-REC-NOT-ON-FILE  TO WS-MOVE-FLD
                 ELSE
                    MOVE LENGTH OF L-PWO-NOT-ON-FILE
                                                TO WS-FLD-LEN
                    MOVE L-PWO-NOT-ON-FILE      TO WS-MOVE-FLD
                    SET RC-RF-RESPONSE-COMPLETE TO TRUE
                 END-IF
              END-IF
           END-IF
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           .

      /****************************************************************
      * 2240-ANI-INFO
      * FUNCTION: FORMATS ANI INFO
      *****************************************************************
       2240-ANI-INFO.
           IF VBB-SUB-PLATE OR VBB-RETENTION
              CONTINUE
           ELSE
             IF VEH-RO-LO-ADD-INFO AND VBB-PSEUDO
                CONTINUE
             ELSE
                IF WS-ANI-INFO = SPACES
                   CONTINUE
                ELSE
                   MOVE LENGTH OF WS-ANI-INFO        TO WS-FLD-LEN
                   MOVE WS-ANI-INFO                  TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                   PERFORM 6450-SKIP-A-LINE
                END-IF
                PERFORM 2030-PNO-REG-DATES
             END-IF
           END-IF
           .

      /****************************************************************
      * 2020-EVAL-VEH-VSL-CD
      * FUNCTION: FORMATS INSURED, NOT INSURED, UNKNOWN, INVALID KEY
      *           MESSAGES FOR INSURANCE INFORMATION
      *****************************************************************
       2020-EVAL-VEH-VSL-CD.

           MOVE VBB-TYPE-VEH-VSL-CD  TO WS-TYPE-VEH-VSL-CD

           IF VEH-CD-11 OR
              VEH-CD-20 OR
              VEH-CD-31

              EVALUATE TRUE

                 WHEN VIV-VIN-FOUND
                   MOVE LENGTH OF L-TXT-INS-ON-FILE TO WS-FLD-LEN
                   MOVE L-TXT-INS-ON-FILE           TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE

                 WHEN VIV-VIN-NOT-FOUND
                   MOVE LENGTH OF L-TXT-INS-UNKNOWN TO WS-FLD-LEN
                   MOVE L-TXT-INS-UNKNOWN           TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE

                 WHEN VIV-DB2-ERROR
                   MOVE LENGTH OF L-TXT-INS-RETRY   TO WS-FLD-LEN
                   MOVE L-TXT-INS-RETRY             TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE

                 WHEN VIV-VIN-INVALID
                   MOVE LENGTH OF L-TXT-NON-ALPHA   TO WS-FLD-LEN
                   MOVE L-TXT-NON-ALPHA             TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   PERFORM 6450-SKIP-A-LINE

              END-EVALUATE

           END-IF
           .

      /****************************************************************
      * 2030-PNO-REG-DATES
      * FUNCTION: DETERMINES WHETHER PNO AND REGISTRATION DATES
      *           TO FORMAT OR NOT FOR INSURANCE INFO.
      *****************************************************************
       2030-PNO-REG-DATES.

           IF VBB-SUB-PLATE
              CONTINUE

           ELSE
             IF VBB-VRC-PRESENT(69)
               SET RCC-69 TO TRUE
               PERFORM 2999-SEARCH-VRC-PKT
               PERFORM 2040-PNO-DATES
               PERFORM 6450-SKIP-A-LINE
             END-IF

           END-IF

           IF VBB-SUSP-RDF OR
              VBB-PSEUDO
              CONTINUE

           ELSE
              IF VBB-VRC-PRESENT(09)
                 SET RCC-09 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 MOVE LENGTH OF L-TXT-REG        TO WS-FLD-LEN
                 MOVE L-TXT-REG                  TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD

                 IF VRC09-HONOR-NOTHING-DT  > ZEROS
                    MOVE VRC09-HONOR-NOTHING-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                 ELSE
                    MOVE ZEROS                   TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                 END-IF
              ELSE
                 MOVE LENGTH OF L-TXT-REG        TO WS-FLD-LEN
                 MOVE L-TXT-REG                  TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 PERFORM 2050-EVAL-TYPE-LIC-CD
              END-IF
              MOVE LENGTH OF L-TXT-REG-TO     TO WS-FLD-LEN
              MOVE L-TXT-REG-TO               TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD

              MOVE VBB-REG-EXPR-DT            TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /****************************************************************
      * 2040-PNO-DATES
      * FUNCTION: FORMAT PNO FROM AND TO DATES FOR INSURANCE INFO
      *****************************************************************
       2040-PNO-DATES.

           MOVE LENGTH OF L-TXT-PNO              TO WS-FLD-LEN
           MOVE L-TXT-PNO                        TO WS-MOVE-FLD
           PERFORM 6260-MOVE-TEXT-FIELD

           IF VRC69-REASON-CD  = '02'
              MOVE VRC69-PNO-CREATE-DT    TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

           ELSE
              MOVE VRC69-PNO-CREATE-DT    TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE LENGTH OF L-TXT-REG-TO        TO WS-FLD-LEN
              MOVE L-TXT-REG-TO                  TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD

              IF VRC69-PNO-EXPR-YY-DT   = ZEROS
                 MOVE SPACES                     TO WS-FORMAT-DT(1:4)
              ELSE
                 MOVE VRC69-PNO-EXPR-YY-DT
                                                 TO WS-FORMAT-DT(1:4)
              END-IF
              MOVE VBB-REG-EXPR-MM               TO WS-FORMAT-DT(5:2)
              MOVE VBB-REG-EXPR-DD               TO WS-FORMAT-DT(7:2)
              PERFORM 6310-MOVE-FORMATTED-DATE
           END-IF
           .

      /****************************************************************
      * 2050-EVAL-TYPE-LIC-CD
      * FUNCTION: EVLUATES LIC CODE FOR REGISTRATIN FROM AND TO DATES
      *           FOR INSURANCE INFORMATION
      *****************************************************************
       2050-EVAL-TYPE-LIC-CD.

           EVALUATE  VBB-TYPE-LIC-CD
              WHEN  L-F0 THRU L-F8
              WHEN  L-2T THRU L-2Y
              WHEN  L-CA
              WHEN  L-N1
              WHEN  L-N3
                IF VBB-REG-EXPR-DT > ZEROS
                  MOVE VBB-REG-EXPR-DT       TO WS-FORMAT-DT
                  COMPUTE  WS-FRMAT-DAT3-CCYY =
                                          WS-FRMAT-DAT3-CCYY - 2
                  PERFORM 6310-MOVE-FORMATTED-DATE
                ELSE
                  MOVE ZEROS               TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                END-IF
              WHEN L-N2
                IF VBB-REG-ISS-DT > ZEROS
                  MOVE VBB-REG-ISS-DT      TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                ELSE
                  MOVE ZEROS               TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                END-IF
              WHEN L-1L THRU L-1P
              WHEN L-2L THRU L-2P
              WHEN L-3L THRU L-3P
              WHEN L-4L THRU L-4P
              WHEN L-13 THRU L-17
              WHEN L-23 THRU L-27
              WHEN L-33 THRU L-37
              WHEN L-43 THRU L-47
              WHEN L-EA THRU L-EH
              WHEN L-EJ
                MOVE ZEROS                 TO WS-FORMAT-DT
                PERFORM 6310-MOVE-FORMATTED-DATE
              WHEN L-E0 THRU L-E9
              WHEN L-C9
                IF VBB-REG-EXPR-DT > ZEROS
                  MOVE VBB-REG-EXPR-DT       TO WS-FORMAT-DT
                  COMPUTE WS-FRMAT-DAT3-CCYY =
                                           WS-FRMAT-DAT3-CCYY - 5
                  PERFORM 6310-MOVE-FORMATTED-DATE
                ELSE
                  MOVE ZEROS               TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                END-IF
              WHEN OTHER
                IF VYP-PLT-TYPE-CD = 'PT'
                   IF VBB-REG-EXPR-DT > ZEROS
                      MOVE VBB-REG-EXPR-DT     TO WS-FORMAT-DT
                      COMPUTE WS-FRMAT-DAT3-CCYY =
                                           WS-FRMAT-DAT3-CCYY - 5
                      PERFORM 6310-MOVE-FORMATTED-DATE
                   ELSE
                      MOVE ZEROS               TO WS-FORMAT-DT
                      PERFORM 6310-MOVE-FORMATTED-DATE
                   END-IF
                ELSE
                   IF VBB-TYPE-LIC-CD(1:1) = L-V
                     IF VBB-REG-EXPR-DT > ZEROS
                       MOVE VBB-REG-EXPR-DT    TO WS-FORMAT-DT
                       IF WS-FRMAT-DAT3-CCYY < 1999
                         COMPUTE WS-FRMAT-DAT3-CCYY =
                                             WS-FRMAT-DAT3-CCYY - 1
                         PERFORM 6310-MOVE-FORMATTED-DATE
                       ELSE
                         COMPUTE WS-FRMAT-DAT3-CCYY =
                                             WS-FRMAT-DAT3-CCYY - 2
                         PERFORM 6310-MOVE-FORMATTED-DATE
                       END-IF
                     ELSE
                       MOVE ZEROS              TO WS-FORMAT-DT
                       PERFORM 6310-MOVE-FORMATTED-DATE
                     END-IF
                   ELSE
                     IF VBB-REG-EXPR-DT > ZEROS
                       MOVE VBB-REG-EXPR-DT    TO WS-FORMAT-DT
                       COMPUTE WS-FRMAT-DAT3-CCYY =
                                             WS-FRMAT-DAT3-CCYY - 1
                       PERFORM 6310-MOVE-FORMATTED-DATE
                     ELSE
                       MOVE ZEROS              TO WS-FORMAT-DT
                       PERFORM 6310-MOVE-FORMATTED-DATE
                     END-IF
                   END-IF
                END-IF
           END-EVALUATE
           .

      /*****************************************************************
      * 2300-FORMAT-VEH-INFO.
      * FUNCTION: FORMATS VEHICLE BASIC INFORMATION LIKE
      * LICENSE NUMBER
      * YEAR MODEL
      * VEHICLE MAKE
      * BODY TYPE MODEL
      * VIN
      ******************************************************************
       2300-FORMAT-VEH-INFO.

           MOVE ZEROS TO WS-ACCU-LEN
           MOVE ZEROS TO WS-GRP-LEN

           MOVE 1                          TO WS-BASI
           PERFORM 6160-MOVE-BASIC-FLDS
           MOVE LENGTH OF WS-LIC-NUM       TO WS-FLD-LEN
           ADD WS-FLD-LEN                  TO WS-GRP-LEN

           IF VBB-SUSP-RDF
              MOVE SPACES                  TO WS-MOVE-FLD
           ELSE
              MOVE VBB-KEY-VEH-VSL-LIC-NBR TO WS-MOVE-FLD
           END-IF

           IF PRKY-FILE-CODE = 'P'
             IF VBB-KEY-VEH-VSL-LIC-NBR <= ' 390000'
               IF VBB-KEY-VEH-VSL-LIC-NBR(1:1) = SPACES
                  IF VBB-KEY-VEH-VSL-LIC-NBR(2:6) > SPACES
                    MOVE 'Q'                     TO WS-Q
                    MOVE VBB-KEY-VEH-VSL-LIC-NBR(2:6) TO WS-Q-LIC-NUM
                    MOVE WS-Q-LIC-FRMT           TO WS-MOVE-FLD
                    ADD +1                       TO WS-GRP-LEN
                  END-IF
               END-IF
             END-IF
           END-IF

           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           ADD L-FLD-LEN                   TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-YR-MDL-CC = ZEROS AND
              VBB-YR-MDL-YY = ZEROS
              ADD 1 TO WS-BASI
           ELSE
             ADD 1 TO WS-BASI
             MOVE ZEROS                      TO WS-GRP-LEN
             PERFORM 6160-MOVE-BASIC-FLDS
             MOVE LENGTH OF VBB-YR-MDL-YY    TO WS-FLD-LEN
             ADD WS-FLD-LEN                  TO WS-GRP-LEN
             MOVE VBB-YR-MDL-YY              TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             ADD L-FLD-LEN                   TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           ADD  1                          TO WS-BASI
           PERFORM 6160-MOVE-BASIC-FLDS
           MOVE ZEROS                      TO WS-GRP-LEN

           IF VBB-TYPE-VEH-VSL-CD  = 81 OR 82 OR 83
             MOVE VBB-VSL-BLDR-NME         TO WS-TEST-FIELD
           ELSE
             MOVE VBB-VEH-MAKE-NME         TO WS-TEST-FIELD
           END-IF

           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH                  TO WS-FLD-LEN
           ADD WS-FLD-LEN                  TO WS-GRP-LEN

           IF VBB-TYPE-VEH-VSL-CD  = 81 OR 82 OR 83
              MOVE VBB-VSL-BLDR-NME        TO WS-MOVE-FLD
           ELSE
              MOVE VBB-VEH-MAKE-NME        TO WS-MOVE-FLD
           END-IF

           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           ADD L-FLD-LEN                   TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           ADD  1                          TO WS-BASI
           PERFORM 6160-MOVE-BASIC-FLDS
           MOVE ZEROS                      TO WS-GRP-LEN
           MOVE VBB-BDY-TYP-MDL-CD         TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH                  TO WS-FLD-LEN
           ADD WS-FLD-LEN                  TO WS-GRP-LEN
           MOVE VBB-BDY-TYP-MDL-CD         TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           ADD L-FLD-LEN                   TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
           MOVE 01 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           ADD  1                          TO WS-BASI

           MOVE ZEROS                   TO WS-GRP-LEN
           MOVE VBB-VIN-OR-HIN-NBR      TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH               TO WS-FLD-LEN
           ADD WS-FLD-LEN               TO WS-GRP-LEN
           ADD L-FLD-LEN                TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
           PERFORM 6110-LINE-LENGTH-CAL
           PERFORM 6160-MOVE-BASIC-FLDS
           MOVE WS-LENGTH               TO WS-FLD-LEN
           MOVE VBB-VIN-OR-HIN-NBR      TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           PERFORM 2310-OVERRIDE-INPUT-INFO-CODE

           IF VEH-INFO
              IF VBB-VRC-PRESENT(30)
                 CONTINUE

              ELSE
                 MOVE LENGTH OF L-RCID     TO WS-FLD-LEN
                 MOVE L-RCID               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE VBB-REG-ISS-DT       TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 2310-OVERRIDE-INPUT-INFO-CODE
      * FUNCTION: OVERRIDES THE INFORMATION CODE FROM THE REQUEST.
      ******************************************************************
       2310-OVERRIDE-INPUT-INFO-CODE.


           IF (VBB-VRC-PRESENT(10)  OR
               VBB-VRC-PRESENT(28)  OR
               VBB-VRC-PRESENT(30)  OR
               VBB-VRC-PRESENT(37))

                IF (SYF-R60-INHOUSE1-REQ-YES   OR
                    SYF-R60-PRIV-REQ3-YES      OR
                    SYF-R60-INHOUSE2-REQ-YES)

                   CONTINUE

                ELSE
                   SET VEH-INFO  TO TRUE
                END-IF

           END-IF

           IF ((VBB-VRC-PRESENT(50)  OR
                VBB-VRC-PRESENT(51)  OR
                VBB-VRC-PRESENT(52)  OR
                VBB-VRC-PRESENT(53)  OR
                VBB-VRC-PRESENT(54)) AND
               (VEH-INFO             OR
                VEH-RO-INFO          OR
                VEH-RO-LO-INFO))

              SET VEH-INFO  TO TRUE
           END-IF

           IF VBB-VRC-PRESENT(18)

              IF SYF-R60-INHOUSE4-REQ-YES
                 CONTINUE

              ELSE
                 IF VBB-VRC-PRESENT(29)
                    IF SYF-R60-INHOUSE2-REQ-YES
                       CONTINUE
                    ELSE
                       SET VEH-INFO  TO TRUE
                    END-IF
                 ELSE
                    SET VEH-INFO  TO TRUE
                 END-IF

              END-IF

           END-IF
           .

      /*****************************************************************
      * 2400-FORMAT-RO-INFO.
      * FUNCTION: FORMATS VEHICLE R/O INFORMATION LIKE
      * R/O NAME
      * R/O NAME/ADDRESS 2ND LINE
      * R/O NAME/ADDRESS 3RD & 4TH LINES
      * R/O RESIDENCE CITY
      * R/O  COUNTY  CODE
      * ALLOCATED COUNTY
      * R/O ZIP CODE
      * DATE FIRST SOLD - CCYYMMDD FORMAT TO YYMMDD
      * REGISTRATION  ISSUE DATE
      * LAST OWNERSHIP DATE
      * LAST PAPER ISSUED CODE
      * SUB PLATE
      * ENGINE  NUMBER
      ******************************************************************
       2400-FORMAT-RO-INFO.

           MOVE ZEROS TO WS-ACCU-LEN
           MOVE ZEROS TO WS-GRP-LEN

           ADD 1 TO WS-BASI
           PERFORM 6160-MOVE-BASIC-FLDS
           MOVE VRO-LN-1-NME               TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH                  TO WS-FLD-LEN
           MOVE VRO-LN-1-NME               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           ADD  WS-LENGTH                  TO WS-GRP-LEN
           ADD  L-FLD-LEN                  TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN

           IF VRO-COUNTY-CD = '60'
              EVALUATE TRUE
                 WHEN VRO-RES-LN-1-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME  TO VRO-RES-LN-1-ADDR
                 WHEN VRO-RES-LN-2-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME  TO VRO-RES-LN-2-ADDR
                 WHEN VRO-RES-LN-3-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME  TO VRO-RES-LN-3-ADDR
                 WHEN VRO-RES-LN-4-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME  TO VRO-RES-LN-4-ADDR
              END-EVALUATE
           END-IF

           IF VRO-LN-2-NME = SPACES

              IF VRO-RES-LN-1-ADDR = SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              ELSE
                 MOVE ZEROS                TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                     TO WS-GRP-LEN
                 MOVE VRO-RES-LN-1-ADDR    TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 ADD  WS-LENGTH            TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH            TO WS-FLD-LEN
                 MOVE VRO-RES-LN-1-ADDR    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

           ELSE
              MOVE ZEROS                   TO WS-GRP-LEN
              PERFORM 6150-MOVE-COMMA-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ADD 2                        TO WS-GRP-LEN
              MOVE VRO-LN-2-NME            TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              ADD  WS-LENGTH               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              MOVE WS-LENGTH               TO WS-FLD-LEN
              MOVE VRO-LN-2-NME            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRO-LN-2-NME = SPACES

              IF VRO-RES-LN-2-ADDR = SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              ELSE
                 MOVE ZEROS                TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                     TO WS-GRP-LEN
                 MOVE VRO-RES-LN-2-ADDR    TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 ADD  WS-LENGTH            TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH            TO WS-FLD-LEN
                 MOVE VRO-RES-LN-2-ADDR    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRO-RES-LN-3-ADDR = SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 ELSE
                    MOVE ZEROS             TO WS-GRP-LEN
                    PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    ADD 2                  TO WS-GRP-LEN
                    MOVE VRO-RES-LN-3-ADDR TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    ADD  WS-LENGTH         TO WS-GRP-LEN
                    COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                    PERFORM 6110-LINE-LENGTH-CAL
                    MOVE WS-LENGTH         TO WS-FLD-LEN
                    MOVE VRO-RES-LN-3-ADDR TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

              END-IF

           ELSE
              IF VRO-LN-3-NME = SPACES

                 IF VRO-RES-LN-1-ADDR = SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 ELSE
                    MOVE ZEROS             TO  WS-GRP-LEN
                    PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    ADD 2                  TO WS-GRP-LEN
                    MOVE VRO-RES-LN-1-ADDR TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    ADD  WS-LENGTH         TO WS-GRP-LEN
                    COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                    PERFORM 6110-LINE-LENGTH-CAL
                    MOVE WS-LENGTH         TO WS-FLD-LEN
                    MOVE VRO-RES-LN-1-ADDR TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    IF VRO-RES-LN-2-ADDR = SPACES
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    ELSE
                       MOVE ZEROS               TO WS-GRP-LEN
                       PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       ADD 2                    TO WS-GRP-LEN
                       MOVE VRO-RES-LN-2-ADDR   TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       ADD  WS-LENGTH           TO WS-GRP-LEN
                       COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                       PERFORM 6110-LINE-LENGTH-CAL
                       MOVE WS-LENGTH           TO WS-FLD-LEN
                       MOVE VRO-RES-LN-2-ADDR   TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                 END-IF

              ELSE

                 MOVE ZEROS                   TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                        TO WS-GRP-LEN
                 MOVE VRO-LN-3-NME            TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 ADD  WS-LENGTH               TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VRO-LN-3-NME            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRO-LN-4-NME        = SPACES
                    IF VRO-RES-LN-1-ADDR = SPACES
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    ELSE
                       MOVE ZEROS                   TO WS-GRP-LEN
                       PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       ADD 2                        TO WS-GRP-LEN
                       MOVE VRO-RES-LN-1-ADDR       TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       ADD  WS-LENGTH               TO WS-GRP-LEN
                       COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                       PERFORM 6110-LINE-LENGTH-CAL
                       MOVE WS-LENGTH               TO WS-FLD-LEN
                       MOVE VRO-RES-LN-1-ADDR       TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                 ELSE
                    MOVE ZEROS                   TO WS-GRP-LEN
                    PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    ADD 2                        TO WS-GRP-LEN
                    MOVE VRO-LN-4-NME            TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    ADD  WS-LENGTH               TO WS-GRP-LEN
                    COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                    PERFORM 6110-LINE-LENGTH-CAL
                    MOVE WS-LENGTH               TO WS-FLD-LEN
                    MOVE VRO-LN-4-NME            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 END-IF

              END-IF

           END-IF

           ADD 1 TO WS-BASI
           IF VRO-COUNTY-CD = '60'

              IF VRO-RES-COUNTRY-NME = SPACES
                 MOVE ZEROS                   TO WS-GRP-LEN
                 ADD  LENGTH OF VRO-RES-STATE-CD TO WS-GRP-LEN
                 ADD  L-FLD-LEN               TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 PERFORM 6160-MOVE-BASIC-FLDS

                 MOVE LENGTH OF VRO-RES-STATE-CD TO WS-FLD-LEN
                 MOVE VRO-RES-STATE-CD           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              ELSE
                 MOVE ZEROS                   TO WS-GRP-LEN
                 MOVE VRO-RES-COUNTRY-NME     TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 ADD  WS-LENGTH               TO WS-GRP-LEN
                 ADD  L-FLD-LEN               TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 PERFORM 6160-MOVE-BASIC-FLDS

                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VRO-RES-COUNTRY-NME     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

           ELSE
              IF VRO-RES-CITY-NME > SPACES
                MOVE ZEROS                      TO WS-GRP-LEN
                MOVE VRO-RES-CITY-NME           TO WS-TEST-FIELD
                PERFORM 6100-FIELD-LENGTH-CAL
                ADD  WS-LENGTH                  TO WS-GRP-LEN
                ADD  L-FLD-LEN                  TO WS-GRP-LEN
                COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                PERFORM 6110-LINE-LENGTH-CAL
                PERFORM 6160-MOVE-BASIC-FLDS
                MOVE WS-LENGTH                  TO WS-FLD-LEN
                MOVE VRO-RES-CITY-NME           TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF

           IF VRO-COUNTY-CD = SPACES
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                   TO WS-GRP-LEN
              ADD  LENGTH OF VRO-COUNTY-CD TO WS-GRP-LEN
              ADD  L-FLD-LEN               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE LENGTH OF VRO-COUNTY-CD TO WS-FLD-LEN
              MOVE VRO-COUNTY-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-ALLOC-CNTY-CD = SPACES
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                       TO WS-GRP-LEN
              ADD  LENGTH OF VBB-ALLOC-CNTY-CD TO WS-GRP-LEN
              ADD  L-FLD-LEN                   TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE LENGTH OF VBB-ALLOC-CNTY-CD TO WS-FLD-LEN
              MOVE VBB-ALLOC-CNTY-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRO-ZIP-CD = SPACES OR ZEROS
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                   TO WS-GRP-LEN
              ADD  LENGTH OF VRO-ZIP-CD    TO WS-GRP-LEN
              ADD  L-FLD-LEN               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE LENGTH OF VRO-ZIP-CD    TO WS-FLD-LEN
              MOVE VRO-ZIP-CD              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           PERFORM 6450-SKIP-A-LINE
           MOVE ZEROS TO WS-ACCU-LEN
           MOVE ZEROS TO WS-GRP-LEN

           IF VBB-TYPE-LIC-CD(1:1) = 'N'
              SET  BD    TO TRUE
           END-IF

           IF VBB-VEH-1ST-SOLD-DT = ZEROS
              IF VBB-DISABLED-PLACARD-DOB-DT = ZEROS
                 ADD 1 TO WS-BASI
              ELSE
                 ADD 1 TO WS-BASI
                 ADD  L-DTE-LEN               TO WS-GRP-LEN
                 ADD  L-FLD-LEN               TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 PERFORM 6160-MOVE-BASIC-FLDS
                 MOVE VBB-DISABLED-PLACARD-DOB-DT TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF

           ELSE
              ADD 1 TO WS-BASI
              ADD  L-DTE-LEN               TO WS-GRP-LEN
              ADD  L-FLD-LEN               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE VBB-VEH-1ST-SOLD-DT          TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-REG-ISS-DT    = ZEROS
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                   TO WS-GRP-LEN
              ADD  L-DTE-LEN               TO WS-GRP-LEN
              ADD  L-FLD-LEN               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE VBB-REG-ISS-DT               TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-LAST-OWNR-ISS-DT = ZEROS
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                   TO WS-GRP-LEN
              ADD  L-DTE-LEN               TO WS-GRP-LEN
              ADD  L-FLD-LEN               TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE VBB-LAST-OWNR-ISS-DT       TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-LAST-PAPER-ISS-CD = SPACE
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS                           TO WS-GRP-LEN
              ADD LENGTH OF VBB-LAST-PAPER-ISS-CD  TO WS-GRP-LEN
              ADD L-FLD-LEN                        TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE LENGTH OF VBB-LAST-PAPER-ISS-CD TO WS-FLD-LEN
              MOVE  VBB-LAST-PAPER-ISS-CD          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-VRC-PRESENT(02)

              SET RCC-02 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC02-VEH-VSL-LIC-NBR  = SPACE
                 ADD 1 TO WS-BASI
              ELSE
                 ADD 1 TO WS-BASI
                 MOVE ZEROS                         TO WS-GRP-LEN
                 ADD LENGTH OF WS-LIC-NUM           TO WS-GRP-LEN
                 ADD L-FLD-LEN                      TO WS-GRP-LEN
                 COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 PERFORM 6160-MOVE-BASIC-FLDS
                 MOVE LENGTH OF WS-LIC-NUM          TO WS-FLD-LEN
                 MOVE VRC02-VEH-VSL-LIC-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           ELSE
              ADD 1 TO WS-BASI
           END-IF

           IF VBB-ENG-NBR  = SPACES
              ADD 1 TO WS-BASI
           ELSE
              ADD 1 TO WS-BASI
              MOVE ZEROS       TO WS-GRP-LEN
              ADD L-FLD-LEN    TO WS-GRP-LEN
              MOVE VBB-ENG-NBR TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              ADD WS-LENGTH    TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
              PERFORM 6110-LINE-LENGTH-CAL
              PERFORM 6160-MOVE-BASIC-FLDS
              MOVE WS-LENGTH   TO WS-FLD-LEN
              MOVE VBB-ENG-NBR TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /*****************************************************************
      * 2500-FORMAT-LO-INFO.
      * FUNCTION: 'D' SUB RECORD,LEGAL OWNER INFORMATION
      ******************************************************************
       2500-FORMAT-LO-INFO.

           MOVE ZEROS    TO WS-ACCU-LEN
           MOVE ZEROS    TO WS-GRP-LEN

           IF VLO-LN-1-NME EQUAL TO SPACES
             MOVE  2                               TO WS-BASD
           ELSE
             MOVE  1                               TO WS-BASD
             MOVE LENGTH OF TBL-LO-FLD(WS-BASD)    TO WS-FLD-LEN
             PERFORM 6245-MOVE-LO-FIELD
             MOVE LENGTH OF VLO-LN-1-NME           TO WS-FLD-LEN
             MOVE VLO-LN-1-NME                     TO WS-TEST-FIELD
             PERFORM 6100-FIELD-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             MOVE VLO-LN-1-NME                     TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             ADD L-FLD-LEN                         TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
           END-IF

           IF VLO-LGL-OWNR-OUT-OF-STATE-IND = '6'
              EVALUATE TRUE
                 WHEN VLO-LN-1-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-1-ADDR
                 WHEN VLO-LN-2-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-2-ADDR
                 WHEN VLO-LN-3-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-3-ADDR
                 WHEN VLO-LN-4-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-4-ADDR
              END-EVALUATE
           END-IF

           IF  VLO-LN-2-NME        EQUAL TO SPACES
               IF  VLO-LN-1-ADDR   EQUAL TO SPACES
                 CONTINUE
               ELSE
                 MOVE ZEROS                            TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                                 TO WS-GRP-LEN
                 MOVE LENGTH OF VLO-LN-1-ADDR          TO WS-FLD-LEN
                 MOVE VLO-LN-1-ADDR                    TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                        TO WS-FLD-LEN
                 ADD WS-FLD-LEN                        TO WS-GRP-LEN
                 MOVE VLO-LN-1-ADDR                    TO WS-MOVE-FLD
                 COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN

                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH                        TO WS-FLD-LEN
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ADD 1                                 TO WS-ACCU-LEN
                 SET  LN1-ADDR-WRITTEN                 TO TRUE
               END-IF
           ELSE
             MOVE ZEROS                            TO WS-GRP-LEN
             PERFORM 6150-MOVE-COMMA-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             ADD 2                                 TO WS-GRP-LEN
             MOVE LENGTH OF VLO-LN-2-NME           TO WS-FLD-LEN
             MOVE VLO-LN-2-NME                     TO WS-TEST-FIELD
             PERFORM 6100-FIELD-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             MOVE VLO-LN-2-NME                     TO WS-MOVE-FLD
             COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
             PERFORM 6110-LINE-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF  VLO-LN-3-NME    EQUAL TO SPACES
               IF VLO-LN-1-ADDR > SPACES
                 IF LN1-ADDR-WRITTEN
                   IF VLO-LN-2-ADDR > SPACES
                      MOVE VLO-LN-2-ADDR      TO WS-LN-ADDR
                      SET LN2-ADDR-WRITTEN    TO TRUE
                   ELSE
                     IF VLO-LN-3-ADDR > SPACES
                       MOVE VLO-LN-3-ADDR      TO WS-LN-ADDR
                       SET LN3-ADDR-WRITTEN    TO TRUE
                     ELSE
                       IF VLO-LN-4-ADDR > SPACES
                          MOVE VLO-LN-4-ADDR      TO WS-LN-ADDR
                          SET LN4-ADDR-WRITTEN    TO TRUE
                       END-IF
                     END-IF
                   END-IF
                 ELSE
                   MOVE VLO-LN-1-ADDR      TO WS-LN-ADDR
                   SET LN1-ADDR-WRITTEN    TO TRUE
                 END-IF
               END-IF

               IF WS-LN-ADDR > SPACES
                 MOVE ZEROS                            TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                                 TO WS-GRP-LEN
                 MOVE LENGTH OF WS-LN-ADDR             TO WS-FLD-LEN
                 MOVE WS-LN-ADDR                       TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                        TO WS-FLD-LEN
                 ADD WS-FLD-LEN                        TO WS-GRP-LEN
                 MOVE WS-LN-ADDR                       TO WS-MOVE-FLD
                 COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH                        TO WS-FLD-LEN
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ADD 1                                 TO WS-ACCU-LEN
               END-IF
           ELSE
             MOVE ZEROS                            TO WS-GRP-LEN
             PERFORM 6150-MOVE-COMMA-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             ADD 2                                 TO WS-GRP-LEN
             MOVE LENGTH OF VLO-LN-3-NME           TO WS-FLD-LEN
             MOVE VLO-LN-3-NME                     TO WS-TEST-FIELD
             PERFORM 6100-FIELD-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             MOVE VLO-LN-3-NME                     TO WS-MOVE-FLD
             COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
             PERFORM 6110-LINE-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF  VLO-LN-4-NME    EQUAL TO SPACES
               MOVE SPACES           TO WS-LN-ADDR
               IF LN1-ADDR-WRITTEN
                  CONTINUE
               ELSE
                 IF VLO-LN-1-ADDR > SPACES
                    MOVE VLO-LN-1-ADDR     TO WS-LN-ADDR
                 END-IF
               END-IF

               IF LN2-ADDR-WRITTEN
                  CONTINUE
               ELSE
                 IF VLO-LN-2-ADDR > SPACES
                    MOVE VLO-LN-2-ADDR     TO WS-LN-ADDR
                 END-IF
               END-IF

               IF LN3-ADDR-WRITTEN
                  CONTINUE
               ELSE
                 IF VLO-LN-3-ADDR > SPACES
                    MOVE VLO-LN-3-ADDR     TO WS-LN-ADDR
                 END-IF
               END-IF

               IF LN4-ADDR-WRITTEN
                  CONTINUE
               ELSE
                 IF VLO-LN-4-ADDR > SPACES
                    MOVE VLO-LN-4-ADDR     TO WS-LN-ADDR
                 END-IF
               END-IF

               IF WS-LN-ADDR > SPACES
                 MOVE ZEROS                        TO WS-GRP-LEN
                 PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 2                             TO WS-GRP-LEN
                 MOVE LENGTH OF WS-LN-ADDR         TO WS-FLD-LEN
                 MOVE WS-LN-ADDR                   TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                    TO WS-FLD-LEN
                 ADD WS-FLD-LEN                    TO WS-GRP-LEN
                 MOVE WS-LN-ADDR                   TO WS-MOVE-FLD
                 COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
                 PERFORM 6110-LINE-LENGTH-CAL
                 MOVE WS-LENGTH                    TO WS-FLD-LEN
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ADD 1                             TO WS-ACCU-LEN
               END-IF
           ELSE
             MOVE ZEROS                            TO WS-GRP-LEN
             PERFORM 6150-MOVE-COMMA-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             ADD 2                                 TO WS-GRP-LEN
             MOVE LENGTH OF VLO-LN-4-NME           TO WS-FLD-LEN
             MOVE VLO-LN-4-NME                     TO WS-TEST-FIELD
             PERFORM 6100-FIELD-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             MOVE VLO-LN-4-NME                     TO WS-MOVE-FLD
             COMPUTE WS-ACCU-LEN = WS-GRP-LEN + WS-ACCU-LEN
             PERFORM 6110-LINE-LENGTH-CAL
             MOVE WS-LENGTH                        TO WS-FLD-LEN
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF


           IF VLO-LGL-OWNR-OUT-OF-STATE-IND = '6'
              IF VLO-COUNTRY-NME   = SPACES
                 AND VLO-STATE-CD  = SPACES
                 ADD 1  TO WS-BASD
              ELSE
                 IF LAST-MOVE-NOT-SPACE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
                 IF VLO-COUNTRY-NME = SPACES
                    MOVE ZEROS               TO WS-GRP-LEN
                    PERFORM 6245-MOVE-LO-FIELD
                    MOVE LENGTH OF VLO-STATE-CD TO WS-FLD-LEN
                    MOVE VLO-STATE-CD           TO WS-MOVE-FLD
                    ADD WS-FLD-LEN           TO WS-GRP-LEN
                    ADD L-FLD-LEN            TO WS-GRP-LEN
                    COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                    PERFORM 6110-LINE-LENGTH-CAL
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ELSE
                    MOVE ZEROS                  TO WS-GRP-LEN
                    PERFORM 6245-MOVE-LO-FIELD
                    MOVE VLO-COUNTRY-NME        TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH              TO WS-FLD-LEN
                    MOVE VLO-COUNTRY-NME        TO WS-MOVE-FLD
                    ADD WS-LENGTH               TO WS-GRP-LEN
                    ADD L-FLD-LEN               TO WS-GRP-LEN
                    COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
                    PERFORM 6110-LINE-LENGTH-CAL
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           ELSE
             IF VLO-CITY-NME EQUAL TO SPACES
               ADD 1  TO WS-BASD
             ELSE
               IF LAST-MOVE-NOT-SPACE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
               END-IF
               MOVE ZEROS                         TO WS-GRP-LEN
               MOVE LENGTH OF VLO-CITY-NME        TO WS-FLD-LEN
               MOVE VLO-CITY-NME                  TO WS-TEST-FIELD
               PERFORM 6100-FIELD-LENGTH-CAL
               MOVE WS-LENGTH                     TO WS-FLD-LEN
               ADD WS-FLD-LEN                     TO WS-GRP-LEN
               ADD L-FLD-LEN                      TO WS-GRP-LEN
               COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN

               PERFORM 6110-LINE-LENGTH-CAL
               PERFORM 6245-MOVE-LO-FIELD
               MOVE WS-LENGTH                     TO WS-FLD-LEN
               MOVE VLO-CITY-NME                  TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6400-MOVE-SPACE-TO-OUTPUT
               ADD 1                              TO WS-ACCU-LEN
             END-IF
           END-IF

           IF VLO-ZIP-CD EQUAL TO SPACES
             ADD 1  TO WS-BASD
           ELSE
             IF LAST-MOVE-NOT-SPACE
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF
             MOVE ZEROS                            TO WS-GRP-LEN
             MOVE LENGTH OF VLO-ZIP-CD             TO WS-FLD-LEN
             MOVE VLO-ZIP-CD                       TO WS-MOVE-FLD
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             ADD L-FLD-LEN                         TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
             PERFORM 6110-LINE-LENGTH-CAL
             IF WS-BASD = ZEROS
               MOVE  3                             TO WS-BASD
             END-IF
             PERFORM 6245-MOVE-LO-FIELD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             ADD 1                                 TO WS-ACCU-LEN
           END-IF

           IF VLO-LIENHLDR-PPRLES-ID-NBR EQUAL TO SPACES
             CONTINUE
           ELSE
             IF LAST-MOVE-NOT-SPACE
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF
             MOVE ZEROS                            TO WS-GRP-LEN
             MOVE LENGTH OF VLO-LIENHLDR-PPRLES-ID-NBR TO WS-FLD-LEN
             MOVE VLO-LIENHLDR-PPRLES-ID-NBR       TO WS-MOVE-FLD
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             ADD L-FLD-LEN                         TO WS-GRP-LEN
             MOVE LENGTH OF VLO-LIENHLDR-PPRLES-ID-YMD TO WS-FLD-LEN
             ADD WS-FLD-LEN                        TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN = WS-ACCU-LEN + WS-GRP-LEN
             PERFORM 6110-LINE-LENGTH-CAL

             PERFORM 6245-MOVE-LO-FIELD
             MOVE LENGTH OF VLO-LIENHLDR-PPRLES-ID-NBR TO WS-FLD-LEN
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT

             MOVE LENGTH OF VLO-LIENHLDR-PPRLES-ID-YMD TO WS-FLD-LEN
             MOVE VLO-LIENHLDR-PPRLES-ID-YMD       TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /****************************************************************
      * 2600-FORMAT-ADD-PEN-INFO
      * FUNCTION: MASTER PARAGRAPH FOR INFO CODE 3 AND 4.
      *           FORMATS THE VEHICLE ADITIONAL INFORMATION.
      *****************************************************************
       2600-FORMAT-ADD-PEN-INFO.

           PERFORM 2610-FRMT-VEH-ADD-INFO
           IF SYF-R60-USETAX-YES
              PERFORM 2620-FRMT-FEE-TAX
           ELSE
              PERFORM 2625-PROCESS-VEH-VESSL-INFO
              PERFORM 2680-FRMT-K-SUB-REC
           END-IF
           .

      /*****************************************************************
      * 2610-FRMT-VEH-ADD-INFO
      * FUNCTION: BASIC, B, C  SUB RECORDS, VEHICLE ADDITIONAL INFO.
      * FORMATS THE FOLLOWING FIELDS:
      * TYPE LICENSE CODE
      * NUMBER OF CYLINDERS
      * POWR
      * NUMBER OF AXLES
      * UNLADEN VEHICLE WEIGHT
      * VEH
      * BODY
      * PRORATE OPERATOR/PFR NUMBER
      * VLF CLASS
      * YEAR BUILT VESSEL
      * FEE
      * EQUIPMENT/MISC/PASSENGER NUMBER
      ******************************************************************
       2610-FRMT-VEH-ADD-INFO.

           MOVE ZEROS               TO WS-ACCU-LEN
           IF VBB-TYPE-LIC-CD EQUAL TO SPACES
             ADD +1  TO WS-SUB
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             MOVE +1 TO WS-SUB
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-TYPE-LIC-CD       TO WS-FLD-LEN
             MOVE VBB-TYPE-LIC-CD                 TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT

             ADD L-8                              TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           IF VBB-NBR-OF-CYL-CNT EQUAL TO SPACES
             ADD +1                               TO WS-SUB
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-NBR-OF-CYL-CNT    TO WS-FLD-LEN
             MOVE VBB-NBR-OF-CYL-CNT              TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT

             ADD L-8                              TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           IF VBB-VEH-MOTIVE-PWR-CD EQUAL TO SPACES
              IF VBB-VSL-FUEL-CD EQUAL TO SPACES
                ADD +1                               TO WS-SUB
              ELSE
                MOVE ZEROS                           TO WS-GRP-LEN
                PERFORM 6250-MOVE-TEXT-FIELD
                MOVE LENGTH OF VBB-VSL-FUEL-CD       TO WS-FLD-LEN
                MOVE VBB-VSL-FUEL-CD                 TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                ADD L-7                              TO WS-GRP-LEN
                COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
              END-IF
           ELSE
                MOVE ZEROS                           TO WS-GRP-LEN
                PERFORM 6250-MOVE-TEXT-FIELD
                MOVE LENGTH OF VBB-VEH-MOTIVE-PWR-CD TO WS-FLD-LEN
                MOVE VBB-VEH-MOTIVE-PWR-CD           TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                ADD L-7                              TO WS-GRP-LEN
                COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           IF VBB-AXLE-CNT EQUAL TO SPACES
             IF VBB-UNLDN-WGT EQUAL TO SPACES
               ADD +1                               TO WS-SUB
             ELSE
               MOVE ZEROS                           TO WS-GRP-LEN
               PERFORM 6250-MOVE-TEXT-FIELD
               MOVE LENGTH OF VBB-AXLE-CNT          TO WS-FLD-LEN
               MOVE VBB-AXLE-CNT                    TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6400-MOVE-SPACE-TO-OUTPUT

               ADD L-7                              TO WS-GRP-LEN
               COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
             END-IF
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-AXLE-CNT          TO WS-FLD-LEN
             MOVE VBB-AXLE-CNT                    TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT

             ADD L-7                              TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           IF VBB-UNLDN-WGT EQUAL TO SPACES
              IF VBB-AXLE-CNT EQUAL TO SPACES
                 ADD +1                               TO WS-SUB
              ELSE
                MOVE ZEROS                           TO WS-GRP-LEN
                PERFORM 6250-MOVE-TEXT-FIELD
                MOVE LENGTH OF VBB-UNLDN-WGT         TO WS-FLD-LEN
                MOVE VBB-UNLDN-WGT                   TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                ADD L-11                             TO WS-GRP-LEN
                COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
              END-IF
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-UNLDN-WGT         TO WS-FLD-LEN
             MOVE VBB-UNLDN-WGT                   TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT

             ADD L-11                             TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           PERFORM 6250-MOVE-TEXT-FIELD
           MOVE LENGTH OF VBB-TYPE-VEH-VSL-CD     TO WS-FLD-LEN
           MOVE VBB-TYPE-VEH-VSL-CD               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE ZEROS                           TO WS-GRP-LEN
           ADD L-8                              TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN

           PERFORM 6250-MOVE-TEXT-FIELD
           IF VBB-VSL-HULL-TYPE-CD = SPACES
              MOVE LENGTH OF VBB-VEH-BODY-TYPE-CD TO WS-FLD-LEN
              MOVE VBB-VEH-BODY-TYPE-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE ZEROS                           TO WS-GRP-LEN
              ADD L-7                              TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           ELSE
              MOVE LENGTH OF VBB-VSL-HULL-TYPE-CD TO WS-FLD-LEN
              MOVE VBB-VSL-HULL-TYPE-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE ZEROS                           TO WS-GRP-LEN
              ADD L-7                              TO WS-GRP-LEN
              COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           IF VBB-ACCOUNT-NBR EQUAL TO SPACES
             ADD +1                               TO WS-SUB
           ELSE
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-ACCOUNT-NBR       TO WS-FLD-LEN
             MOVE VBB-ACCOUNT-NBR                 TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             MOVE ZEROS                           TO WS-GRP-LEN
             ADD L-10                             TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           END-IF

           MOVE ZEROS                           TO WS-GRP-LEN
           ADD L-8                              TO WS-GRP-LEN
           COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
           PERFORM 6110-LINE-LENGTH-CAL

           PERFORM 6250-MOVE-TEXT-FIELD
           MOVE LENGTH OF VBB-VLF-CLASS-CD        TO WS-FLD-LEN
           MOVE VBB-VLF-CLASS-CD                  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-TYPE-VEH-VSL-CD  = 81 OR 82 OR 83
             IF VBB-VSL-BUILT-CC EQUAL TO ZEROS
                ADD +1                            TO WS-SUB
             ELSE
               MOVE ZEROS                           TO WS-GRP-LEN
               ADD L-8                              TO WS-GRP-LEN
               COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
               PERFORM 6110-LINE-LENGTH-CAL

               PERFORM 6250-MOVE-TEXT-FIELD
               MOVE LENGTH OF VBB-VSL-BUILT-YY    TO WS-FLD-LEN
               MOVE VBB-VSL-BUILT-YY              TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF
           ELSE
             IF  VBB-VEH-ASTRSK-CC EQUAL TO ZEROS
               ADD +1                             TO WS-SUB
             ELSE
               MOVE ZEROS                           TO WS-GRP-LEN
               ADD L-8                              TO WS-GRP-LEN
               COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
               PERFORM 6110-LINE-LENGTH-CAL

               PERFORM 6250-MOVE-TEXT-FIELD
               MOVE LENGTH OF VBB-VEH-ASTRSK-YY   TO WS-FLD-LEN
               MOVE VBB-VEH-ASTRSK-YY             TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF
           END-IF

           IF VBB-TOT-FEE-AMT EQUAL TO ZEROS
             ADD +1                                TO WS-SUB
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             ADD L-10                             TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
             PERFORM 6110-LINE-LENGTH-CAL

             MOVE LENGTH OF L-TXT-FEE              TO WS-FLD-LEN
             MOVE L-TXT-FEE                        TO WS-MOVE-FLD
             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-TOT-FEE-AMT        TO WS-FLD-LEN
             MOVE VBB-TOT-FEE-AMT                  TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-EQP-MISC-PSG-NBR EQUAL TO SPACES
              ADD +1                                TO WS-SUB
           ELSE
             MOVE ZEROS                           TO WS-GRP-LEN
             ADD L-13                             TO WS-GRP-LEN
             COMPUTE WS-ACCU-LEN  = WS-ACCU-LEN + WS-GRP-LEN
             PERFORM 6110-LINE-LENGTH-CAL

             PERFORM 6250-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-EQP-MISC-PSG-NBR   TO WS-FLD-LEN
             MOVE VBB-EQP-MISC-PSG-NBR             TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /***************************************************************
      * 2620-FRMT-FEE-TAX
      * FUNCTION:
      * IF CALCULATED FEE IS NEGATIVE DISPLAY AN ERROR
      ****************************************************************
       2620-FRMT-FEE-TAX.

           IF VBB-TOT-FEE-AMT EQUAL TO ZEROS
              CONTINUE
           ELSE
             ADD +1                                TO WS-SUB
             MOVE LENGTH OF L-TXT-DMVFEES          TO WS-FLD-LEN
             MOVE L-TXT-DMVFEES                    TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             COMPUTE WS-DMVFEES-VAL =
                                 VBB-TOT-FEE-AMT - VBB-USE-TAX-AMT
             MOVE LENGTH OF WS-DMVFEES-VAL         TO WS-FLD-LEN
             MOVE WS-DMVFEES-VAL                   TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             PERFORM 2630-EVAL-TX-CD
             IF WS-DMVFEES-VAL < ZEROS
                 MOVE LENGTH OF L-TXT-ERROR       TO WS-FLD-LEN
                 MOVE L-TXT-ERROR                 TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 MOVE LENGTH OF VBB-TOT-FEE-AMT   TO WS-FLD-LEN
                 MOVE VBB-TOT-FEE-AMT             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
             END-IF
             PERFORM 2625-PROCESS-VEH-VESSL-INFO
             PERFORM 2680-FRMT-K-SUB-REC
           END-IF
           .

      /***************************************************************
      * 2625-PROCESS-VEH-VESSL-INFO
      * FUNCTION: PROCESS VEHICLE, VESSEL INFORMATION.
      *
      ****************************************************************
       2625-PROCESS-VEH-VESSL-INFO.

           IF VBB-VSL-HULL-MAT-CD > SPACES OR
              VBB-CVRA-CERT-IND   > SPACES
              IF LAST-MOVE-NOT-SBA
                 PERFORM 6450-SKIP-A-LINE
              END-IF
              IF VBB-TYPE-VEH-VSL-CD  = 81 OR 82 OR 83
                 PERFORM 2640-VESSEL-INFO
              ELSE
                PERFORM 2650-TYPE-VEH-NOT-VESSEL
                PERFORM 2660-UNLDN-DEFLT-80THLBS
                PERFORM 2670-UNLDN-UNDR-10THLBS
              END-IF
           END-IF

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /****************************************************************
      * 2630-EVAL-TX-CD
      * FUNCTION: EVALUATES TAX CODE TO FORMAT
      * PARKINGBAIL/USETAX MESSAGES
      *****************************************************************
       2630-EVAL-TX-CD.

           EVALUATE VBB-USE-TAX-CD
              WHEN L-D
                  MOVE LENGTH OF L-TXT-PARK-BAIL   TO WS-FLD-LEN
                  MOVE L-TXT-PARK-BAIL             TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
              WHEN L-E
              WHEN L-F
              WHEN L-G
              WHEN L-H
              WHEN L-J
              WHEN L-K
                  MOVE LENGTH OF L-TXT-TAX-PARK    TO WS-FLD-LEN
                  MOVE L-TXT-TAX-PARK              TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
              WHEN OTHER
                  MOVE LENGTH OF L-TXT-USE-TAX     TO WS-FLD-LEN
                  MOVE L-TXT-USE-TAX               TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  IF VBB-USE-TAX-AMT > ZEROS
                    MOVE LENGTH OF VBB-USE-TAX-CD  TO WS-FLD-LEN
                    MOVE VBB-USE-TAX-CD            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VBB-USE-TAX-AMT TO WS-FLD-LEN
                    MOVE VBB-USE-TAX-AMT           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  ELSE
                    MOVE LENGTH OF VBB-USE-TAX-AMT TO WS-FLD-LEN
                    MOVE SPACES                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE 02 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  END-IF
           END-EVALUATE
           .

      /*************************************************************
      * 2640-VESSEL-INFO
      * FORMATS THE VESSEL INFORMATION
      **************************************************************
       2640-VESSEL-INFO.

           IF VBB-VSL-HULL-MAT-CD EQUAL TO SPACES
              CONTINUE
           ELSE
             MOVE LENGTH OF L-TXT-HULM             TO WS-FLD-LEN
             MOVE L-TXT-HULM                       TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-VSL-HULL-MAT-CD    TO WS-FLD-LEN
             MOVE VBB-VSL-HULL-MAT-CD              TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-PROPLSN-CD EQUAL TO SPACES
              CONTINUE
           ELSE
             MOVE LENGTH OF L-TXT-PRPL             TO WS-FLD-LEN
             MOVE L-TXT-PRPL                       TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-PROPLSN-CD         TO WS-FLD-LEN
             MOVE VBB-PROPLSN-CD                   TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-VSL-LGTH-FT EQUAL TO SPACES
              CONTINUE
           ELSE
             MOVE LENGTH OF L-TXT-LEN-FT           TO WS-FLD-LEN
             MOVE L-TXT-LEN-FT                     TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-VSL-LGTH-FT        TO WS-FLD-LEN
             MOVE VBB-VSL-LGTH-FT                  TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-VSL-LGTH-INCHS EQUAL TO SPACES
              CONTINUE
           ELSE
             MOVE LENGTH OF L-TXT-LEN-IN           TO WS-FLD-LEN
             MOVE L-TXT-LEN-IN                     TO WS-MOVE-FLD
             PERFORM 6260-MOVE-TEXT-FIELD
             MOVE LENGTH OF VBB-VSL-LGTH-INCHS     TO WS-FLD-LEN
             MOVE VBB-VSL-LGTH-INCHS               TO WS-MOVE-FLD
             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
             PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           .

      /*************************************************************
      * 2650-TYPE-VEH-NOT-VESSEL WILL BE PERFORMED
      *   IF TYPE VEHICLE IS NOT A (VESSEL)81/82/83
      *   IF CERTIFIED BY OWNER 'C'
      *   IF CERTIFICATION DATE IS PRESENT
      **************************************************************
       2650-TYPE-VEH-NOT-VESSEL.

           MOVE VBB-CVRA-CERT-IND TO WS-PROPLSN-CD
           IF WS-PROPLSN-CD        = L-C
              IF VBB-CERT-DT        > ZEROS
                MOVE LENGTH OF L-TXT-GVW-IND        TO WS-FLD-LEN
                MOVE L-TXT-GVW-IND                  TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                COMPUTE WS-STRT = WS-STRT - 43
                MOVE LENGTH OF VBB-CGW-GVW-CD       TO WS-FLD-LEN
                MOVE VBB-CGW-GVW-CD                 TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                COMPUTE WS-STRT = WS-STRT + 10
                MOVE LENGTH OF WS-PROPLSN-CD        TO WS-FLD-LEN
                MOVE WS-PROPLSN-CD                  TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                COMPUTE WS-STRT = WS-STRT + 16

                MOVE LENGTH OF VBB-VSL-LGTH-FT
                                                      TO WS-FLD-LEN
                MOVE VBB-GROSS-WGT-HIGHEST-IN-RANGE(1:3)
                                                      TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE LENGTH OF VBB-VSL-LGTH-INCHS
                                                      TO WS-FLD-LEN
                MOVE VBB-GROSS-WGT-HIGHEST-IN-RANGE(4:2)
                                                      TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                COMPUTE WS-STRT = WS-STRT + 9
                MOVE LENGTH OF VBB-CGW-GVW-IND      TO WS-FLD-LEN
                MOVE VBB-CGW-GVW-IND                TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE

                MOVE LENGTH OF L-TXT-CERT-DATE      TO WS-FLD-LEN
                MOVE L-TXT-CERT-DATE                TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                MOVE LENGTH OF VBB-CERT-DT          TO WS-FLD-LEN
                MOVE VBB-CERT-DT                    TO WS-FORMAT-DT
                PERFORM 6330-FRMT-DATE
                PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF
           .
      ***************************************************************
      *2660-UNLDN-DEFLT-80THLBS WILL BE PERFORMED
      *   IF UNLADEN DEFAULTS TO 80,000 POUNDS
      *   IF CERTIFICATON DATE IS NOT PRESENT
      ***************************************************************
       2660-UNLDN-DEFLT-80THLBS.

           MOVE VBB-CVRA-CERT-IND TO WS-PROPLSN-CD
           IF WS-PROPLSN-CD  = L-D
              IF VBB-CERT-DT  = ZEROS
                 MOVE LENGTH OF L-TXT-GVW-CERT       TO WS-FLD-LEN
                 MOVE L-TXT-GVW-CERT                 TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 COMPUTE WS-STRT = WS-STRT - 33
                 MOVE LENGTH OF VBB-CGW-GVW-CD       TO WS-FLD-LEN
                 MOVE VBB-CGW-GVW-CD                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 COMPUTE WS-STRT = WS-STRT + 10
                 MOVE LENGTH OF WS-PROPLSN-CD        TO WS-FLD-LEN
                 MOVE WS-PROPLSN-CD                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 COMPUTE WS-STRT = WS-STRT + 16
                 MOVE LENGTH OF VBB-VSL-LGTH-FT
                                                     TO WS-FLD-LEN
                 MOVE VBB-GROSS-WGT-HIGHEST-IN-RANGE(1:3)
                                                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VBB-VSL-LGTH-INCHS
                                                     TO WS-FLD-LEN
                 MOVE VBB-GROSS-WGT-HIGHEST-IN-RANGE(4:2)
                                                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF
           .

      /***************************************************************
      * 2670-UNLDN-UNDR-10THLBS WILL BE PERFORMED
      *     IF UNLADEN UNDER 10,000 POUNDS
      *     IF CERTIFICATION DATE IS PRESENT
      ****************************************************************
       2670-UNLDN-UNDR-10THLBS.

           MOVE VBB-CVRA-CERT-IND TO WS-PROPLSN-CD
           IF WS-PROPLSN-CD = L-U-SP
             IF VBB-CERT-DT  > ZEROS
                MOVE LENGTH OF L-TXT-CERT-IND       TO WS-FLD-LEN
                MOVE L-TXT-CERT-IND                 TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD

                MOVE LENGTH OF WS-PROPLSN-CD        TO WS-FLD-LEN
                MOVE WS-PROPLSN-CD                  TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE 01 TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE

                MOVE LENGTH OF L-TXT-CERT-DATE      TO WS-FLD-LEN
                MOVE L-TXT-CERT-DATE                TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD

                MOVE LENGTH OF VBB-CERT-DT       TO WS-FLD-LEN
                MOVE VBB-CERT-DT                 TO WS-FORMAT-DT
                PERFORM 6330-FRMT-DATE
                MOVE 01 TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
             END-IF
           END-IF
           .

      /***************************************************************
      * 2680-FRMT-K-SUB-REC
      * FUNCTION: 'K' SUB RECORD, SITUS ADDRESS
      ****************************************************************
       2680-FRMT-K-SUB-REC.

           IF VBB-K-SUB-REC-CNT > ZEROS
              IF VSA-SITUS-ADDR-DT = ZEROS
                 CONTINUE
              ELSE
                IF WS-FIL-CD = L-B
                  MOVE LENGTH OF L-TXT-DATE       TO WS-FLD-LEN
                  MOVE L-TXT-DATE                 TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                ELSE
                  IF LAST-MOVE-NOT-SBA
                     PERFORM 6450-SKIP-A-LINE
                  END-IF
                  MOVE LENGTH OF L-TXT-LBL-DT     TO WS-FLD-LEN
                  MOVE L-TXT-LBL-DT               TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                END-IF
                MOVE VSA-SITUS-ADDR-DT            TO WS-FORMAT-DT
                PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF

              IF VSA-SITUS-COUNTY-CD EQUAL TO SPACES
                CONTINUE
              ELSE
                MOVE 01 TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                MOVE LENGTH OF L-TXT-COUNTY       TO WS-FLD-LEN
                MOVE L-TXT-COUNTY                 TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD

                MOVE LENGTH OF VSA-SITUS-COUNTY-CD  TO WS-FLD-LEN
                MOVE VSA-SITUS-COUNTY-CD            TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

              IF VSA-SITUS-ADDR EQUAL TO SPACES
                CONTINUE
              ELSE
                MOVE LENGTH OF L-TXT-SITUS-ADDR   TO WS-FLD-LEN
                MOVE L-TXT-SITUS-ADDR             TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                MOVE VSA-SITUS-ADDR               TO WS-TEST-FIELD
                PERFORM 6100-FIELD-LENGTH-CAL
                MOVE WS-LENGTH                    TO WS-FLD-LEN
                MOVE VSA-SITUS-ADDR               TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VSA-SITUS-CITY-NME EQUAL TO SPACES
                CONTINUE
              ELSE
                MOVE 01 TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                MOVE LENGTH OF L-TXT-CITY1        TO WS-FLD-LEN
                MOVE L-TXT-CITY1                  TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                MOVE LENGTH OF VSA-SITUS-CITY-NME TO WS-FLD-LEN
                MOVE VSA-SITUS-CITY-NME           TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
            PERFORM 6450-SKIP-A-LINE
           END-IF



           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /*****************************************************************
      * 2900-FORMAT-ESUB-REC.
      * FUNCTION:
      * FORMATS ESUB RECORDS
      ******************************************************************
       2900-FORMAT-ESUB-REC.

           IF VBB-VRC-PRESENT(22) OR
              VBB-VRC-PRESENT(23) OR
              VBB-VRC-PRESENT(24) OR
              VBB-VRC-PRESENT(25)

              MOVE LENGTH OF L-INCOM       TO WS-FLD-LEN
              MOVE L-INCOM                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VBB-VRC-PRESENT(22)
                 MOVE LENGTH OF L-LONG-VIN TO WS-FLD-LEN
                 MOVE L-LONG-VIN           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VBB-VRC-PRESENT(23)
                 MOVE LENGTH OF L-LONG-RO  TO WS-FLD-LEN
                 MOVE L-LONG-RO            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VBB-VRC-PRESENT(24)
                 MOVE LENGTH OF L-LONG-LO  TO WS-FLD-LEN
                 MOVE L-LONG-LO            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VBB-VRC-PRESENT(25)
                 MOVE LENGTH OF L-LONG-ENG TO WS-FLD-LEN
                 MOVE L-LONG-ENG           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF




           IF ((VEH-RO-LO-ADD-INFO )
                AND  VBB-PSEUDO
                AND  NO-ERROR)
                 PERFORM 2950-FORMAT-V-STATUS-MSGS
           ELSE
                 PERFORM 2910-FORMAT-R-STATUS-MSGS
                 IF NO-ERROR
                     PERFORM 2950-FORMAT-V-STATUS-MSGS
                 END-IF
           END-IF

           .

      /*****************************************************************
      * 2905-FORMAT-TXT-REC-STATUS.
      * FUNCTION: FORMATS THE 'REC STATUS' MESSAGE
      *
      ******************************************************************
       2905-FORMAT-TXT-REC-STATUS.

           IF SKIP-VEHICLE-INFO
             CONTINUE
           ELSE
             IF REC-STATUS-MSG-NOT-WRITTEN

                IF LAST-MOVE-NOT-SBA
                    PERFORM 6450-SKIP-A-LINE
                END-IF

                MOVE LENGTH OF L-REC-STAT   TO WS-FLD-LEN
                MOVE L-REC-STAT             TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
                SET REC-STATUS-MSG-WRITTEN  TO TRUE

             END-IF
           END-IF
           .

      /*****************************************************************
      * 2910-FORMAT-R-STATUS-MSGS.
      * FUNCTION: FORMATS ESUB RECORDS
      *
      ******************************************************************
       2910-FORMAT-R-STATUS-MSGS.

           IF SW-INHOUSE-E30-PRESENT
              PERFORM 2930-FORMAT-R-STATUS-MSGS2

           ELSE
              PERFORM 2920-FORMAT-R-STATUS-MSGS1
              PERFORM 2930-FORMAT-R-STATUS-MSGS2
              PERFORM 2940-FORMAT-R-STATUS-MSGS3
           END-IF
           .

      /*****************************************************************
      * PERFORM 2920-FORMAT-R-STATUS-MSGS1
      * FUNCTION: FORMATS ESUB RECORDS
      *
      ******************************************************************
       2920-FORMAT-R-STATUS-MSGS1.

           IF VBB-VRC-PRESENT(01)

              SET RCC-01 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC01-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC01-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-JUNK              TO WS-FLD-LEN
              MOVE L-JUNK                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(02)

              SET RCC-02 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC02-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC02-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-SUB-PLATE         TO WS-FLD-LEN
              MOVE L-SUB-PLATE                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(03)

              SET RCC-03 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC03-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC03-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC03-REASON-CD  = '01'
                 MOVE LENGTH OF L-REG-OUT-STATE  TO WS-FLD-LEN
                 MOVE L-REG-OUT-STATE            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-SUR-TITLE      TO WS-FLD-LEN
                 MOVE L-SUR-TITLE                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VRC03-SURR-OF-TITLE-STATE-CD  = SPACE
                 CONTINUE
              ELSE
                 MOVE LENGTH OF VRC03-SURR-OF-TITLE-STATE-CD
                                                 TO WS-FLD-LEN
                 MOVE VRC03-SURR-OF-TITLE-STATE-CD
                                                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(04)

              SET RCC-04 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC04-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC04-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-LIC-CANCEL        TO WS-FLD-LEN
              MOVE L-LIC-CANCEL                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(06)

              SET RCC-06 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC06-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC06-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-DOJ-STOP          TO WS-FLD-LEN
              MOVE L-DOJ-STOP                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VRC06-UNIT-CD  = SPACES
                 MOVE 9 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-REFERRAL       TO WS-FLD-LEN
                 MOVE L-REFERRAL                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(07)

              SET RCC-07 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC07-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC07-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-VEH-REREG         TO WS-FLD-LEN
              MOVE L-VEH-REREG                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VRC07-VEH-LIC-NBR   TO WS-FLD-LEN
              MOVE VRC07-VEH-LIC-NBR             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(08)

              SET RCC-08 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC08-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC08-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-RES-MILT          TO WS-FLD-LEN
              MOVE L-RES-MILT                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(09)

              SET RCC-09 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC09-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC09-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-PAR-YEAR          TO WS-FLD-LEN
              MOVE L-PAR-YEAR                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF ((VBB-VRC-PRESENT(10))     AND
               (SYF-R60-INHOUSE1-REQ-YES OR
                SYF-R60-INHOUSE2-REQ-YES))

              SET RCC-10 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC10-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC10-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-REL-LIABILITY     TO WS-FLD-LEN
              MOVE L-REL-LIABILITY               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(11)

              SET RCC-11 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC11-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC11-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-DEL-NOTICE        TO WS-FLD-LEN
              MOVE L-DEL-NOTICE                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(12)

              SET RCC-12 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC12-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC12-REC-COND-DT              TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC12-REASON-CD  = '01'
                 MOVE LENGTH OF L-ELP-SUR-PUC-REV    TO WS-FLD-LEN
                 MOVE L-ELP-SUR-PUC-REV              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 IF PRKY-FILE-CODE   = 'L'    OR
                    PRKY-DB-KEY(8:1) > SPACES
                    MOVE LENGTH OF L-PLT-SUR-OR-CAN  TO WS-FLD-LEN
                    MOVE L-PLT-SUR-OR-CAN            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF L-PLT-SUR-FOR-YOM    TO WS-FLD-LEN
                    MOVE L-PLT-SUR-FOR-YOM              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(13)

              SET RCC-13 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC13-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC13-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-DISMAN            TO WS-FLD-LEN
              MOVE L-DISMAN                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(14)

              SET RCC-14 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC14-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC14-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-CAUTION           TO WS-FLD-LEN
              MOVE L-CAUTION                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(15)

              SET RCC-15 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC15-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC15-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VYP-PLT-TYPE-CD = 'OH'
                 MOVE LENGTH OF L-VR-TITLE       TO WS-FLD-LEN
                 MOVE L-VR-TITLE                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-OHV-TITLE      TO WS-FLD-LEN
                 MOVE L-OHV-TITLE                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(16)

              SET RCC-16 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC16-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC16-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VYP-PLT-TYPE-CD = 'OH'
                 MOVE LENGTH OF L-PRI-VR-REC     TO WS-FLD-LEN
                 MOVE L-PRI-VR-REC               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-OHV-ID         TO WS-FLD-LEN
                 MOVE L-OHV-ID                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(17)

              SET RCC-17 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC17-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC17-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-DUP-PLATE         TO WS-FLD-LEN
              MOVE L-DUP-PLATE                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF ((VBB-VRC-PRESENT(30))    AND
               (SYF-R60-INHOUSE1-REQ-NO AND
                SYF-R60-INHOUSE2-REQ-NO))

              SET RCC-30 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC30-REASON-CD  = '01'
                 CONTINUE

              ELSE
                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC30-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC30-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-PEN-SUB-PLATE     TO WS-FLD-LEN
                 MOVE L-PEN-SUB-PLATE               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC30-VEH-VSL-LIC-NBR   > SPACES

                    MOVE LENGTH OF VRC30-VEH-VSL-LIC-NBR
                                                    TO WS-FLD-LEN
                    MOVE VRC30-VEH-VSL-LIC-NBR      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 ELSE
                    MOVE 8  TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-POS-RO-TRANS      TO WS-FLD-LEN
                 MOVE L-POS-RO-TRANS                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF (((VBB-VRC-PRESENT(50)     OR
                 VBB-VRC-PRESENT(51)     OR
                 VBB-VRC-PRESENT(52)     OR
                 VBB-VRC-PRESENT(53)     OR
                 VBB-VRC-PRESENT(54))    AND
                (VEH-INFO                OR
                 VEH-RO-INFO             OR
                 VEH-RO-LO-INFO)         AND
                (SYF-R60-INHOUSE3-REQ-NO AND
                 SYF-R60-INHOUSE4-REQ-NO))  OR
               ((VBB-VRC-PRESENT(18))    AND
                (SYF-R60-INHOUSE3-REQ-NO AND
                 SYF-R60-INHOUSE4-REQ-NO)))

              IF VBB-VRC-PRESENT(18)

                 SET RCC-18 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC18-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC18-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VBB-VRC-PRESENT(50)

                 SET RCC-50 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC50-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC50-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VBB-VRC-PRESENT(51)

                 SET RCC-51 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC51-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC51-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VBB-VRC-PRESENT(52)

                 SET RCC-52 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC52-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC52-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VBB-VRC-PRESENT(53)

                 SET RCC-53 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC53-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC53-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              IF VBB-VRC-PRESENT(54)

                 SET RCC-54 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC54-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC54-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-APP-IN-PRO      TO WS-FLD-LEN
                 MOVE L-APP-IN-PRO                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

           END-IF

           IF VBB-VRC-PRESENT(28)

              SET RCC-28 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC28-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC28-REC-COND-DT              TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-SAL-CERT              TO WS-FLD-LEN
              MOVE L-SAL-CERT                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 01  TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC28-HONOR-NOTHING-DT  = ZEROS
                 MOVE 19 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE VRC28-HONOR-NOTHING-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF L-WRECK-DT           TO WS-FLD-LEN
                 MOVE L-WRECK-DT                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VRC-ADDITIONAL-DATA-UNFRMT   > SPACES
                 MOVE LENGTH OF L-ADD-RECPT-INFO  TO WS-FLD-LEN
                 MOVE L-ADD-RECPT-INFO            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE 16 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              PERFORM 6450-SKIP-A-LINE

              IF (SYF-R60-INHOUSE1-REQ-NO  AND
                  SYF-R60-INHOUSE2-REQ-NO)

                 IF VBB-VRC-PRESENT(10)
                    CONTINUE

                 ELSE
                    MOVE LENGTH OF L-CONTACT-DMV  TO WS-FLD-LEN
                    MOVE L-CONTACT-DMV              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              END-IF

           END-IF

           IF ((VBB-VRC-PRESENT(10))    AND
               (SYF-R60-INHOUSE1-REQ-NO AND
                SYF-R60-INHOUSE2-REQ-NO))

              SET RCC-10 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC10-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC10-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-VEH-SOLD          TO WS-FLD-LEN
              MOVE L-VEH-SOLD                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(21)

              SET RCC-21 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC21-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC21-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-PRE-JUD-ATCH      TO WS-FLD-LEN
              MOVE L-PRE-JUD-ATCH                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF ((VBB-VRC-PRESENT(30))     AND
               (SYF-R60-INHOUSE1-REQ-YES OR
                SYF-R60-INHOUSE2-REQ-YES))

              SET RCC-30 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC30-REASON-CD  = '01'
                 CONTINUE

              ELSE
                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC30-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC30-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-PEN-PLT-LIC       TO WS-FLD-LEN
                 MOVE L-PEN-PLT-LIC                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC30-VEH-VSL-LIC-NBR   > SPACES

                    MOVE LENGTH OF VRC30-VEH-VSL-LIC-NBR
                                                    TO WS-FLD-LEN
                    MOVE VRC30-VEH-VSL-LIC-NBR
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 ELSE
                    MOVE 8  TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-REG-OWR-CHG    TO WS-FLD-LEN
                 MOVE L-REG-OWR-CHG              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(32)

              SET RCC-32 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC32-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC32-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-IND-RESER         TO WS-FLD-LEN
              MOVE L-IND-RESER                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(33)

              SET RCC-33 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC33-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC33-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE VRC33-REASON-CD               TO WS-REASON-CD-E33

              EVALUATE TRUE
                WHEN RCD-02-E33
                  MOVE LENGTH OF L-PLA-LOST      TO WS-FLD-LEN
                  MOVE L-PLA-LOST                TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-03-E33
                  MOVE LENGTH OF L-PLA-DEC       TO WS-FLD-LEN
                  MOVE L-PLA-DEC                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-04-E33
                  MOVE LENGTH OF L-PLA-RET       TO WS-FLD-LEN
                  MOVE L-PLA-RET                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-05-E33
                  MOVE LENGTH OF L-PLA-OS        TO WS-FLD-LEN
                  MOVE L-PLA-OS                  TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-06-E33
                  MOVE LENGTH OF L-PLA-SUR       TO WS-FLD-LEN
                  MOVE L-PLA-SUR                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-07-E33
                  MOVE LENGTH OF L-PWO-CAN-DMV   TO WS-FLD-LEN
                  MOVE L-PWO-CAN-DMV             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-08-E33
                  MOVE LENGTH OF L-SPL-PLATE     TO WS-FLD-LEN
                  MOVE L-SPL-PLATE               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-09-E33
                  MOVE LENGTH OF L-PLA-CAN-DMV   TO WS-FLD-LEN
                  MOVE L-PLA-CAN-DMV             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN OTHER
                  MOVE LENGTH OF L-PLATE-LOST    TO WS-FLD-LEN
                  MOVE L-PLATE-LOST              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              END-EVALUATE
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(34)

              SET RCC-34 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC34-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC34-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC34-REASON-CD  = '02'
                 MOVE LENGTH OF L-PFR-DEL        TO WS-FLD-LEN
                 MOVE L-PFR-DEL                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-PRO-DEL        TO WS-FLD-LEN
                 MOVE L-PRO-DEL                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF
           .

      /*****************************************************************
      * 2925-MOVE-NO-DATE-RES.
      * FUNCTION:
      * MOVES 'NO DATE  ' TO RESPONSE.
      ******************************************************************
       2925-MOVE-NO-DATE-RES.

           MOVE LENGTH OF L-NO-DATE        TO WS-FLD-LEN
           MOVE L-NO-DATE                  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           .

      /*****************************************************************
      * 2930-FORMAT-R-STATUS-MSGS2
      * FUNCTION: FORMATS ESUB RECORDS
      *
      ******************************************************************
       2930-FORMAT-R-STATUS-MSGS2.

           IF VBB-VRC-PRESENT(39)

              SET RCC-39 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC39-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC39-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-REG-EXP        TO WS-FLD-LEN
              MOVE L-REG-EXP                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(36)

              SET RCC-36 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC36-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC36-REC-COND-DT            TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC36-REASON-CD  = '01'
                 MOVE LENGTH OF L-DV-REG-EXMP      TO WS-FLD-LEN
                 MOVE L-DV-REG-EXMP                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              ELSE
                 IF VRC36-REASON-CD  = '02'
                    MOVE LENGTH OF L-EXPOW-LIC     TO WS-FLD-LEN
                    MOVE L-EXPOW-LIC               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 ELSE
                    MOVE LENGTH OF L-DIS-VET-EXMP  TO WS-FLD-LEN
                    MOVE L-DIS-VET-EXMP            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE VRC36-HOUSE-TRAILER-EXMPT-CD
                                                 TO WS-EXMP-PCT-36(1:1)
                    MOVE VRC36-OWNERSHIP-PCT  TO
                                                    WS-EXMP-PCT-36(2:2)
                    MOVE LENGTH OF WS-EXMP-PCT-36  TO WS-FLD-LEN
                    MOVE WS-EXMP-PCT-36            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(37)

              SET RCC-37 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC37-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC37-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-CERT-VOID      TO WS-FLD-LEN
              MOVE L-CERT-VOID                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF ((VBB-VRC-PRESENT(30))     AND
               (SYF-R60-INHOUSE1-REQ-YES OR
                SYF-R60-INHOUSE2-REQ-YES))

              SET RCC-30 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC30-REASON-CD  = '01'

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC30-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC30-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-PEN-REASIGN-PLT   TO WS-FLD-LEN
                 MOVE L-PEN-REASIGN-PLT             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF L-SEE-LIC-NUM       TO WS-FLD-LEN
                 MOVE L-SEE-LIC-NUM                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 IF VRC30-VEH-VSL-LIC-NBR   > SPACES
                    MOVE LENGTH OF VRC30-VEH-VSL-LIC-NBR
                                                    TO WS-FLD-LEN
                    MOVE VRC30-VEH-VSL-LIC-NBR
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 ELSE
                    MOVE 8  TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF ((VBB-VRC-PRESENT(30))    AND
               (SYF-R60-INHOUSE1-REQ-NO AND
                SYF-R60-INHOUSE2-REQ-NO))

              SET RCC-30 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC30-REASON-CD  = '01'

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 PERFORM 6450-SKIP-A-LINE
                 IF VRC30-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC30-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
                 MOVE LENGTH OF L-PEN-REASIGN-PLT1  TO WS-FLD-LEN
                 MOVE L-PEN-REASIGN-PLT1            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF
           .

      /*****************************************************************
      * 2940-FORMAT-R-STATUS-MSGS3
      * FUNCTION: FORMATS ESUB RECORDS
      *
      ******************************************************************
       2940-FORMAT-R-STATUS-MSGS3.

           IF VBB-VRC-PRESENT(40)

              SET RCC-40 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC40-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC40-REC-COND-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC40-OFF-ID  = 725 OR 726
                 MOVE LENGTH OF L-INCOM-REN     TO WS-FLD-LEN
                 MOVE L-INCOM-REN               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-DMV-FEE-DEP   TO WS-FLD-LEN
                 MOVE L-DMV-FEE-DEP             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(41)

              SET RCC-41 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC41-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC41-REC-COND-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-DOC              TO WS-FLD-LEN
              MOVE L-DOC                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(42)

              SET RCC-42 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC42-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC42-REC-COND-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-REG-OUT-STA      TO WS-FLD-LEN
              MOVE L-REG-OUT-STA                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(19)

              SET RCC-19 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC19-REC-COND-DT  (1:2) = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC19-REC-COND-DT           TO WS-FORMAT-DT
                 SET MMDDCCYY-FRMT TO TRUE
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC19-SURR-OF-TITLE-STATE-CD  = SPACES
                 MOVE 3 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-NC              TO WS-FLD-LEN
                 MOVE L-NC                        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              MOVE VRC19-REASON-CD                TO WS-REASON-CD-E19

              EVALUATE TRUE
                WHEN RCD-00-E19
                WHEN RCD-02-E19
                WHEN RCD-SP-E19
                  MOVE LENGTH OF L-ADD-CHG-REN    TO WS-FLD-LEN
                  MOVE L-ADD-CHG-REN              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-01-E19
                  MOVE LENGTH OF L-REN-NOT-EXP    TO WS-FLD-LEN
                  MOVE L-REN-NOT-EXP              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-03-E19
                  MOVE LENGTH OF L-DEL-NOT-EXT    TO WS-FLD-LEN
                  MOVE L-DEL-NOT-EXT              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-04-E19
                  MOVE LENGTH OF L-REN-NOT-REQ    TO WS-FLD-LEN
                  MOVE L-REN-NOT-REQ              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-05-E19
                  MOVE LENGTH OF L-DEL-NOT-REQ    TO WS-FLD-LEN
                  MOVE L-DEL-NOT-REQ              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-06-E19
                  MOVE LENGTH OF L-INV-TO-REN     TO WS-FLD-LEN
                  MOVE L-INV-TO-REN               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-07-E19
                  MOVE LENGTH OF L-ITR-ADD-CHG    TO WS-FLD-LEN
                  MOVE L-ITR-ADD-CHG              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-08-E19
                  MOVE LENGTH OF L-ITR-NOT-MUT    TO WS-FLD-LEN
                  MOVE L-ITR-NOT-MUT              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              END-EVALUATE
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(44)

              SET RCC-44 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC44-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC44-REC-COND-DT              TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC44-SURR-OF-TITLE-STATE-CD  = SPACES
                 MOVE VRC44-UNIT-CD                  TO WS-UNIT-CD
                 MOVE WS-UNIT-CD(1:1)                TO WS-UNIT-CD-E44

                 EVALUATE TRUE
                   WHEN UCD-A-E44
                     MOVE LENGTH OF L-ARTS-LIC       TO WS-FLD-LEN
                     MOVE L-ARTS-LIC                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 41 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN UCD-C-E44
                     MOVE LENGTH OF L-COL-LIC        TO WS-FLD-LEN
                     MOVE L-COL-LIC                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-D-E44
                     MOVE LENGTH OF L-CALAG-LIC      TO WS-FLD-LEN
                     MOVE L-CALAG-LIC                TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-E-E44
                     MOVE LENGTH OF L-FOREIGN-LIC    TO WS-FLD-LEN
                     MOVE L-FOREIGN-LIC              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-F-E44
                     MOVE LENGTH OF L-CA-FIRE-LIC    TO WS-FLD-LEN
                     MOVE L-CA-FIRE-LIC              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 20 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN UCD-G-E44
                     MOVE LENGTH OF L-CA-MEM-PLT     TO WS-FLD-LEN
                     MOVE L-CA-MEM-PLT               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-H-E44
                     MOVE LENGTH OF L-LAKE-LIC       TO WS-FLD-LEN
                     MOVE L-LAKE-LIC                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-I-E44
                     MOVE LENGTH OF L-PET-LOVERS     TO WS-FLD-LEN
                     MOVE L-PET-LOVERS               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-K-E44
                     MOVE LENGTH OF L-KIDS-LIC       TO WS-FLD-LEN
                     MOVE L-KIDS-LIC                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE LENGTH OF VRC44-SYMBOL-NME   TO
                                                        WS-FLD-LEN
                     MOVE VRC44-SYMBOL-NME           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE LENGTH OF L-SLASH          TO WS-FLD-LEN
                     MOVE L-SLASH                    TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-L-E44
                     MOVE LENGTH OF L-PUC-LIC        TO WS-FLD-LEN
                     MOVE L-PUC-LIC                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-M-E44
                     MOVE LENGTH OF L-GOLD-STAR-FAMILY
                                                     TO WS-FLD-LEN
                     MOVE L-GOLD-STAR-FAMILY         TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

3545               WHEN UCD-J-E44
3545                 MOVE LENGTH OF L-CALIFORNIA-MUSEUM TO WS-FLD-LEN
3545                 MOVE L-CALIFORNIA-MUSEUM           TO WS-MOVE-FLD
3545                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-P-E44
                     MOVE LENGTH OF L-OLYMPIC        TO WS-FLD-LEN
                     MOVE L-OLYMPIC                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-Q-E44
                     MOVE LENGTH OF L-BCA            TO WS-FLD-LEN
                     MOVE L-BCA                      TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-S-E44
                     MOVE LENGTH OF L-STA-OLYMPIC    TO WS-FLD-LEN
                     MOVE L-STA-OLYMPIC              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-T-E44
                     MOVE LENGTH OF L-OLYM-TRAN-LIC  TO WS-FLD-LEN
                     MOVE L-OLYM-TRAN-LIC            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-U-E44
                     MOVE LENGTH OF L-STA-OLYM-TRAN-LIC TO WS-FLD-LEN
                     MOVE L-STA-OLYM-TRAN-LIC        TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-V-E44
                     MOVE LENGTH OF L-VET-LIC        TO WS-FLD-LEN
                     MOVE L-VET-LIC                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 2945-READ-CODE-TBL

                   WHEN UCD-W-E44
                     MOVE LENGTH OF L-CA-COSTAL-PLT  TO WS-FLD-LEN
                     MOVE L-CA-COSTAL-PLT            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

10002              WHEN UCD-Z-E44
10002                MOVE LENGTH OF L-1960-LEGACY    TO WS-FLD-LEN
10002                MOVE L-1960-LEGACY              TO WS-MOVE-FLD
10002                PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN UCD-Y-E44
                     MOVE LENGTH OF L-YOSEMITE-LIC   TO WS-FLD-LEN
                     MOVE L-YOSEMITE-LIC             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN OTHER
                     MOVE LENGTH OF L-REFLCT-LIC-PLT TO WS-FLD-LEN
                     MOVE L-REFLCT-LIC-PLT           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 34 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 END-EVALUATE

              ELSE
                 MOVE LENGTH OF L-ELP-CONV       TO WS-FLD-LEN
                 MOVE L-ELP-CONV                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6451-SKIP-A-LINE-2-TIMES

           END-IF

           IF NO-ERROR
              PERFORM 2941-FORMAT-R-STATUS-MSGS4
           END-IF
           .

      /*****************************************************************
      * 2941-FORMAT-R-STATUS-MSGS4
      * FUNCTION: FORMATS ESUB RECORDS
      *
      ******************************************************************
       2941-FORMAT-R-STATUS-MSGS4.

           IF VBB-VRC-PRESENT(46)

              SET RCC-46 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC46-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC46-REC-COND-DT             TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE VRC46-REASON-CD                  TO WS-REASON-CD-E46
              EVALUATE TRUE
                WHEN RCD-01-E46
                  MOVE LENGTH OF L-PERM-SMOG-EXMP   TO WS-FLD-LEN
                  MOVE L-PERM-SMOG-EXMP             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-02-E46
                  MOVE LENGTH OF L-SMOG-EXMP-ADDR   TO WS-FLD-LEN
                  MOVE L-SMOG-EXMP-ADDR             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-03-E46
                  MOVE LENGTH OF L-SOMG-CERT-VAL    TO WS-FLD-LEN
                  MOVE L-SOMG-CERT-VAL              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC46-SMOG-CERT-EXPR-DT      TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                WHEN RCD-04-E46
                  MOVE LENGTH OF L-SMOG-DUE         TO WS-FLD-LEN
                  MOVE L-SMOG-DUE                   TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC46-HONOR-NOTHING-DT  TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  MOVE 25 TO CTR-SPACES
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                WHEN RCD-09-E46
                  MOVE LENGTH OF L-SMOG-NOT-VAL     TO WS-FLD-LEN
                  MOVE L-SMOG-NOT-VAL               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC46-SMOG-CERT-EXPR-DT      TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  MOVE 13 TO CTR-SPACES
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                WHEN RCD-10-E46
                  MOVE LENGTH OF L-CA-EMIS-CERT     TO WS-FLD-LEN
                  MOVE L-CA-EMIS-CERT               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-11-E46
                  MOVE LENGTH OF L-CA-EMIS-NOT-REQ  TO WS-FLD-LEN
                  MOVE L-CA-EMIS-NOT-REQ            TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN OTHER
                  MOVE LENGTH OF L-VR-INSP-EXMP     TO WS-FLD-LEN
                  MOVE L-VR-INSP-EXMP               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              END-EVALUATE
              PERFORM 6451-SKIP-A-LINE-2-TIMES

           END-IF

           IF VBB-VRC-PRESENT(47)

              SET RCC-47 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC47-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC47-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-CON-MED-HON       TO WS-FLD-LEN
              MOVE L-CON-MED-HON                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(48)

              SET RCC-48 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC48-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC48-REC-COND-DT              TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF VRC48-REASON-CD  TO WS-FLD-LEN
              MOVE VRC48-REASON-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-OWNR-RESP-CITS        TO WS-FLD-LEN
              MOVE L-OWNR-RESP-CITS                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(49)

              SET RCC-49 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS
              IF VRC49-REASON-CD  = '10'
                 MOVE LENGTH OF L-VEH-RET-DLR     TO WS-FLD-LEN
                 MOVE L-VEH-RET-DLR               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

                 MOVE LENGTH OF L-PUR-CON-LAW     TO WS-FLD-LEN
                 MOVE L-PUR-CON-LAW               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 IF VRC49-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC49-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE VRC49-REASON-CD              TO WS-REASON-CD-E49
                 EVALUATE TRUE
                   WHEN RCD-01-E49
                   WHEN RCD-02-E49
                     MOVE LENGTH OF L-SAL             TO WS-FLD-LEN
                     MOVE L-SAL                       TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-03-E49
                     MOVE LENGTH OF L-SAL-RET         TO WS-FLD-LEN
                     MOVE L-SAL-RET                   TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-04-E49
                     MOVE LENGTH OF L-PRI-TAXI        TO WS-FLD-LEN
                     MOVE L-PRI-TAXI                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-05-E49
                     MOVE LENGTH OF L-PRI-POL         TO WS-FLD-LEN
                     MOVE L-PRI-POL                   TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-06-E49
                     MOVE LENGTH OF L-ORG-TAXI        TO WS-FLD-LEN
                     MOVE L-ORG-TAXI                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-07-E49
                     MOVE LENGTH OF L-ORG-POL         TO WS-FLD-LEN
                     MOVE L-ORG-POL                   TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-08-E49
                     MOVE LENGTH OF L-REMAN-VEH       TO WS-FLD-LEN
                     MOVE L-REMAN-VEH                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-09-E49
                     MOVE LENGTH OF L-NON-USA-VEH     TO WS-FLD-LEN
                     MOVE L-NON-USA-VEH               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT


                   WHEN RCD-11-E49
                     MOVE LENGTH OF L-LEMON-LAW       TO WS-FLD-LEN
                     MOVE L-LEMON-LAW                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-12-E49
                     IF VYP-TYPE-LIC-CD = '2V' OR '2W'
                        MOVE LENGTH OF L-NC-ATV       TO WS-FLD-LEN
                        MOVE L-NC-ATV                 TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     ELSE
                        MOVE LENGTH OF L-NC-MC        TO WS-FLD-LEN
                        MOVE L-NC-MC                  TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     END-IF

                   WHEN RCD-13-E49
                     MOVE LENGTH OF L-PARK-TRA        TO WS-FLD-LEN
                     MOVE L-PARK-TRA                  TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-14-E49
                     MOVE LENGTH OF L-AUTONOMOUS      TO WS-FLD-LEN
                     MOVE L-AUTONOMOUS                TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN RCD-16-E49
                     MOVE LENGTH OF L-AUTO-DEPLOY     TO WS-FLD-LEN
                     MOVE L-AUTO-DEPLOY               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 END-EVALUATE
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF ((VBB-VRC-PRESENT(50)  OR
                VBB-VRC-PRESENT(51)  OR
                VBB-VRC-PRESENT(52)  OR
                VBB-VRC-PRESENT(53)  OR
                VBB-VRC-PRESENT(54)) AND
               (VEH-INFO             OR
                VEH-RO-INFO          OR
                VEH-RO-LO-INFO)      AND
               (SYF-R60-INHOUSE3-REQ-YES OR
                SYF-R60-INHOUSE4-REQ-YES))

               PERFORM 2905-FORMAT-TXT-REC-STATUS

               MOVE LENGTH OF L-PEND-APP             TO WS-FLD-LEN
               MOVE L-PEND-APP                       TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT

               IF VBB-VRC-PRESENT(50)
                  SET RCC-50 TO TRUE
                  PERFORM 2999-SEARCH-VRC-PKT

                  MOVE LENGTH OF L-OFF               TO WS-FLD-LEN
                  MOVE L-OFF                         TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC50-TIP-OFF-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC50-TIP-OFF-ID              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-DT            TO WS-FLD-LEN
                  MOVE L-TXT-DT                      TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC50-TIP-WRK-DT              TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-IDS           TO WS-FLD-LEN
                  MOVE L-TXT-IDS                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC50-TIP-TECH-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC50-TIP-TECH-ID             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  MOVE LENGTH OF VRC50-TIP-TRANSACTION-TME
                                                     TO WS-FLD-LEN
                  MOVE VRC50-TIP-TRANSACTION-TME
                                                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-TRAN          TO WS-FLD-LEN
                  MOVE L-TXT-TRAN                    TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC50-TIP-TYPE-TRAN-CD
                                                     TO WS-FLD-LEN
                  MOVE VRC50-TIP-TYPE-TRAN-CD
                                                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  PERFORM 6450-SKIP-A-LINE

               END-IF

               IF VBB-VRC-PRESENT(51)
                  SET RCC-51 TO TRUE
                  PERFORM 2999-SEARCH-VRC-PKT

                  MOVE LENGTH OF L-OFF               TO WS-FLD-LEN
                  MOVE L-OFF                         TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC51-OFF-ID  TO WS-FLD-LEN
                  MOVE VRC51-OFF-ID                   TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-DT            TO WS-FLD-LEN
                  MOVE L-TXT-DT                      TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC51-WRK-DT                  TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-IDS           TO WS-FLD-LEN
                  MOVE L-TXT-IDS                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC51-TECH-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC51-TECH-ID                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  MOVE LENGTH OF VRC51-SEQ-NBR
                                                     TO WS-FLD-LEN
                  MOVE VRC51-SEQ-NBR                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-TRAN          TO WS-FLD-LEN
                  MOVE L-TXT-TRAN                    TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC51-TYPE-TRAN-CD
                                                     TO WS-FLD-LEN
                  MOVE VRC51-TYPE-TRAN-CD            TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  PERFORM 6450-SKIP-A-LINE
                  SET LAST-MOVE-NOT-SBA  TO TRUE

               END-IF

               IF VBB-VRC-PRESENT(52)
                  SET RCC-52 TO TRUE
                  PERFORM 2999-SEARCH-VRC-PKT

                  MOVE LENGTH OF L-OFF                TO WS-FLD-LEN
                  MOVE L-OFF                          TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC52-OFF-ID  TO WS-FLD-LEN
                  MOVE VRC52-OFF-ID                   TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-DT            TO WS-FLD-LEN
                  MOVE L-TXT-DT                      TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC52-WRK-DT                  TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-IDS           TO WS-FLD-LEN
                  MOVE L-TXT-IDS                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC52-TECH-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC52-TECH-ID                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  MOVE LENGTH OF VRC52-SEQ-NBR
                                                     TO WS-FLD-LEN
                  MOVE VRC52-SEQ-NBR                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-TRAN          TO WS-FLD-LEN
                  MOVE L-TXT-TRAN                    TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC52-TYPE-TRAN-CD
                                                     TO WS-FLD-LEN
                  MOVE VRC52-TYPE-TRAN-CD            TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  PERFORM 6450-SKIP-A-LINE

               END-IF

               IF VBB-VRC-PRESENT(53)
                  SET RCC-53 TO TRUE
                  PERFORM 2999-SEARCH-VRC-PKT

                  MOVE LENGTH OF L-OFF                TO WS-FLD-LEN
                  MOVE L-OFF                          TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC53-OFF-ID  TO WS-FLD-LEN
                  MOVE VRC53-OFF-ID                   TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-DT            TO WS-FLD-LEN
                  MOVE L-TXT-DT                      TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC53-WRK-DT                  TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-IDS           TO WS-FLD-LEN
                  MOVE L-TXT-IDS                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC53-TECH-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC53-TECH-ID                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  MOVE LENGTH OF VRC53-SEQ-NBR
                                                     TO WS-FLD-LEN
                  MOVE VRC53-SEQ-NBR                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-TRAN          TO WS-FLD-LEN
                  MOVE L-TXT-TRAN                    TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC53-TYPE-TRAN-CD
                                                     TO WS-FLD-LEN
                  MOVE VRC53-TYPE-TRAN-CD            TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  PERFORM 6450-SKIP-A-LINE

               END-IF

               IF VBB-VRC-PRESENT(54)
                  SET RCC-54 TO TRUE
                  PERFORM 2999-SEARCH-VRC-PKT

                  MOVE LENGTH OF L-OFF                TO WS-FLD-LEN
                  MOVE L-OFF                          TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC54-OFF-ID  TO WS-FLD-LEN
                  MOVE VRC54-OFF-ID                   TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-DT            TO WS-FLD-LEN
                  MOVE L-TXT-DT                      TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE VRC54-WRK-DT                  TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-IDS           TO WS-FLD-LEN
                  MOVE L-TXT-IDS                     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC54-TECH-ID
                                                     TO WS-FLD-LEN
                  MOVE VRC54-TECH-ID                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  MOVE LENGTH OF VRC54-SEQ-NBR
                                                     TO WS-FLD-LEN
                  MOVE VRC54-SEQ-NBR                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                  MOVE LENGTH OF L-TXT-TRAN          TO WS-FLD-LEN
                  MOVE L-TXT-TRAN                    TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                  MOVE LENGTH OF VRC54-TYPE-TRAN-CD
                                                     TO WS-FLD-LEN
                  MOVE VRC54-TYPE-TRAN-CD            TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  PERFORM 6450-SKIP-A-LINE

               END-IF

           END-IF

           IF ((VBB-VRC-PRESENT(18))     AND
               (SYF-R60-INHOUSE3-REQ-YES OR
                SYF-R60-INHOUSE4-REQ-YES))

              SET RCC-18 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC-ADDITIONAL-DATA-UNFRMT  > SPACES

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC18-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC18-REC-COND-DT           TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-PEND-APP           TO WS-FLD-LEN
                 MOVE L-PEND-APP                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC18-BATCH-UNIT-IND
                    MOVE LENGTH OF L-SPACE-B         TO WS-FLD-LEN
                    MOVE L-SPACE-B                   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC18-BATCH-ID
                                                     TO WS-FLD-LEN
                    MOVE VRC18-BATCH-ID              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF L-U               TO WS-FLD-LEN
                    MOVE  L-U                        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF VRC18-UNIT
                                                     TO WS-FLD-LEN
                    MOVE VRC18-UNIT-CD               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE 32 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 IF VRC18-CLR-IND

                    MOVE 2 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-TR              TO WS-FLD-LEN
                    MOVE  L-TR                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC18-TYPE-CD
                                                     TO WS-FLD-LEN
                    MOVE VRC18-TYPE-CD               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-CD              TO WS-FLD-LEN
                    MOVE  L-CD                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE VRC18-WRK-DT                TO WS-FORMAT-DT
                    MOVE LENGTH OF WS-FRMAT-DAT-YMD  TO WS-FLD-LEN
                    MOVE WS-FRMAT-DAT-YMD            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-CL              TO WS-FLD-LEN
                    MOVE  L-CL                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC18-CLEAR-SUB
                                                     TO WS-FLD-LEN
                    MOVE VRC18-CLEAR-SUB             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-CABL            TO WS-FLD-LEN
                    MOVE  L-CABL                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC18-CASH-BLK
                                                     TO WS-FLD-LEN
                    MOVE VRC18-CASH-BLK              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    IF VRC18-LEGAL-OWNR-PAPER-ISS-CD   > SPACES
                       MOVE LENGTH OF L-LOCD         TO WS-FLD-LEN
                       MOVE  L-LOCD                  TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                       MOVE LENGTH OF VRC18-LEGAL-OWNR-PAPER-ISS-CD

                                                     TO WS-FLD-LEN
                       MOVE VRC18-LEGAL-OWNR-PAPER-ISS-CD
                                                     TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                    IF VRC18-ERROR-CD  > SPACES
                       PERFORM 6450-SKIP-A-LINE
                       MOVE LENGTH OF L-EC           TO WS-FLD-LEN
                       MOVE  L-EC                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                       MOVE LENGTH OF VRC18-ERROR-CD
                                                     TO WS-FLD-LEN
                       MOVE VRC18-ERROR-CD           TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF

                 END-IF
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(55)

              SET RCC-55 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC55-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC55-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VBB-SUSP-RDF OR VBB-PSEUDO
                 MOVE 8 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-MA-CLASS       TO WS-FLD-LEN
                 MOVE L-MA-CLASS                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VRC55-MA-VEH-VALUE-AMT   = ZEROS
                 MOVE LENGTH OF L-VEH-VAL        TO WS-FLD-LEN
                 MOVE L-VEH-VAL                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE VRC55-MA-VEH-VALUE-AMT
                                                 TO L-VEH-VAL(17:7)
                 MOVE LENGTH OF L-VEH-VAL        TO WS-FLD-LEN
                 MOVE L-VEH-VAL                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(57)

              SET RCC-57 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC57-REASON-CD  = '01' OR '02'

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC57-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC57-REC-COND-DT           TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 IF VRC57-REASON-CD  = '01'
                    MOVE LENGTH OF L-FHVUT-PROF-VER  TO WS-FLD-LEN
                    MOVE L-FHVUT-PROF-VER            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF L-FHVUT-EXMPT     TO WS-FLD-LEN
                    MOVE L-FHVUT-EXMPT               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(59)

              SET RCC-59 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC59-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC59-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-SPL-TRANS-VEH     TO WS-FLD-LEN
              MOVE L-SPL-TRANS-VEH               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(62)

              SET RCC-62 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC62-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC62-REC-COND-DT           TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE VRC62-REASON-CD                TO WS-REASON-CD-E62
              EVALUATE TRUE
                WHEN RCD-01-E62
                  MOVE LENGTH OF L-VEH-REG-OS     TO WS-FLD-LEN
                  MOVE L-VEH-REG-OS               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-02-E62
                  MOVE LENGTH OF L-VEH-REG-IRP    TO WS-FLD-LEN
                  MOVE L-VEH-REG-IRP              TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-03-E62
                  MOVE LENGTH OF L-SPL-EQUP-REG   TO WS-FLD-LEN
                  MOVE L-SPL-EQUP-REG             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-04-E62
                  MOVE LENGTH OF L-EXMP-STATUTE   TO WS-FLD-LEN
                  MOVE L-EXMP-STATUTE             TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-05-E62
                  MOVE LENGTH OF L-DEALER-INV     TO WS-FLD-LEN
                  MOVE L-DEALER-INV               TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-06-E62
                  MOVE LENGTH OF L-UNREC-VEH      TO WS-FLD-LEN
                  MOVE L-UNREC-VEH                TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-07-E62
                  MOVE LENGTH OF L-AFIDVIT        TO WS-FLD-LEN
                  MOVE L-AFIDVIT                  TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN OTHER
                  MOVE 42 TO CTR-SPACES
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              END-EVALUATE
              PERFORM 6451-SKIP-A-LINE-2-TIMES

           END-IF

           IF VBB-VRC-PRESENT(68)

              SET RCC-68 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              MOVE VRC68-NOTIFICATION-DT         TO WS-FORMAT-DT
              SET  MMDDCCYY-FRMT                 TO TRUE
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-DEL-VES-PRO       TO WS-FLD-LEN
              MOVE L-DEL-VES-PRO                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VRC68-COUNTY-CD     TO WS-FLD-LEN
              MOVE VRC68-COUNTY-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(70)

              SET RCC-70 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC70-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC70-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE VRC70-VLF-REFUND-AMT          TO WS-VRC70-AMT
              MOVE WS-VRC70-AMT(1:2)             TO WS-VLF-T-E70
              MOVE WS-VRC70-AMT(3:3)             TO WS-VLF-U-E70
              MOVE WS-VRC70-AMT(6:2)             TO WS-VLF-C-E70
              MOVE WS-VLF-RFND-AMT-E70           TO
                   L-PRO-VLF-REFUND(27:9)
              MOVE LENGTH OF L-PRO-VLF-REFUND    TO WS-FLD-LEN
              MOVE L-PRO-VLF-REFUND              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(71)

              SET RCC-71 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC71-REC-COND-DT  = ZEROS
                 PERFORM 2925-MOVE-NO-DATE-RES
              ELSE
                 MOVE VRC71-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC71-LIEN-TYPE-CD   = 'F'

                 MOVE VRC71-LIEN-AMT             TO WS-AMT
                 MOVE WS-AMT(1:1)                TO WS-LIEN-M-E71
                 MOVE WS-AMT(2:3)                TO WS-LIEN-T-E71
                 MOVE WS-AMT(5:3)                TO WS-LIEN-U-E71
                 MOVE WS-LIEN-AMT-E71            TO
                      L-LIEN-PER-FLET(38:9)
                 MOVE LENGTH OF L-LIEN-PER-FLET  TO WS-FLD-LEN
                 MOVE L-LIEN-PER-FLET            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              ELSE

                 MOVE VRC71-LIEN-AMT             TO WS-AMT
                 MOVE WS-AMT(1:1)                TO WS-LIEN-M-E71
                 MOVE WS-AMT(2:3)                TO WS-LIEN-T-E71
                 MOVE WS-AMT(5:3)                TO WS-LIEN-U-E71
                 MOVE WS-LIEN-AMT-E71            TO L-LIEN-PER(17:9)
                 MOVE LENGTH OF L-LIEN-PER       TO WS-FLD-LEN
                 MOVE L-LIEN-PER                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(72)

              SET RCC-72 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC72-JDGMNT-SATISFIED-DT   = ZEROS

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 IF VRC72-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC72-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-JUD-FILE          TO WS-FLD-LEN
                 MOVE L-JUD-FILE                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

           END-IF

           IF VBB-VRC-PRESENT(05)
              SET RCC-05 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF SYF-R60-ALLOW-VLT-YES
                     OR
                 VRC05-REASON-CD  = ('59' OR
                                     '61' OR
                                     '62' OR
                                     '63' OR
                                     '64' OR
                                     '65' OR
                                     '66' OR
                                     '94')

                 PERFORM 2905-FORMAT-TXT-REC-STATUS
                 PERFORM 6450-SKIP-A-LINE

                 IF VRC05-REC-COND-DT  = ZEROS
                    PERFORM 2925-MOVE-NO-DATE-RES
                 ELSE
                    MOVE VRC05-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 MOVE LENGTH OF L-VLT-STOP          TO WS-FLD-LEN
                 MOVE L-VLT-STOP                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC05-REASON-CD  = '94'
                    MOVE LENGTH OF VRC05-REASON-CD   TO WS-FLD-LEN
                    MOVE VRC05-REASON-CD             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-TXT-DASH        TO WS-FLD-LEN
                    MOVE L-TXT-DASH                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-TXT-TEST-VEH    TO WS-FLD-LEN
                    MOVE L-TXT-TEST-VEH              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
                 PERFORM 6450-SKIP-A-LINE
              END-IF

           END-IF
           .

      /*****************************************************************
      * 2945-READ-CODE-TBL
      * FUNCTION: READS CODE TABLE TO GET VETERANS ORGANIZATION NAME
      *
      ******************************************************************
       2945-READ-CODE-TBL.

           MOVE SPACES                  TO WS-KEY
           SET DA-READ-FNC              TO TRUE
           MOVE VRC44-ORG-CD            TO CODE-TBL-KEY-DATA
           SET  VETERANS-ASSOC-NAME-TBL TO TRUE
           MOVE CODE-TBL-KEY-DATA       TO WS-KEY-DATA
           MOVE CODE-TABLE-NAME         TO WS-TABLE-NAME

           PERFORM 7500-CALL-CODE-TBL-DA

           EVALUATE TRUE

              WHEN ERHN-CALL-OKAY
                  SET ADDRESS OF ARG-RAW-DB-RCD TO DA-DATA-POINTER
                  MOVE RDB-CTB-DATA1-TRANS-TEXT TO WS-TEST-FIELD
                  PERFORM 6100-FIELD-LENGTH-CAL
                  MOVE WS-LENGTH                TO WS-FLD-LEN
                  MOVE RDB-CTB-DATA1-TRANS-TEXT TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT


              WHEN RC-REC-NOT-FOUND
                  MOVE LENGTH OF L-INVALID-VET-ORG-CD
                                                TO WS-FLD-LEN
                  MOVE L-INVALID-VET-ORG-CD     TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  INITIALIZE ERHN-DATA

              WHEN OTHER
                  SET EM-RF-DB2-CODE-TBL-FAIL (1) TO TRUE
                  MOVE DA-SQLCODE                 TO WS-SQLCODE
                  MOVE WS-SQL-CODE                TO
                       ERHN-ERR-VARIABLE (1 1)
                  PERFORM 8910-SET-ALERT
           END-EVALUATE
           .
      /*****************************************************************
      * 2950-FORMAT-V-STATUS-MSGS
      * FUNCTION:
      * FORMATS RECORD CONDITION DATE AND RECORD STATUS MESSAGES.
      ******************************************************************
       2950-FORMAT-V-STATUS-MSGS.

           IF WS-FIL-CD = L-V
              CONTINUE

           ELSE
              IF VBB-VRC-PRESENT(02)

                 SET RCC-02 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 IF VRC02-FILE-CD  = 'L'

                    MOVE LENGTH OF L-SUBPLT-ELP   TO WS-FLD-LEN
                    MOVE L-SUBPLT-ELP             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF WS-LIC-NUM     TO WS-FLD-LEN
                    MOVE VRC02-VEH-VSL-LIC-NBR
                                                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF L-USE-VIN-INQ  TO WS-FLD-LEN
                    MOVE L-USE-VIN-INQ            TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE

                 END-IF

              END-IF

           END-IF

           IF ((VEH-RO-LO-ADD-INFO      OR
                VEH-RO-LO-ADD-PEN-INFO) AND
                VBB-PSEUDO)
              PERFORM 2970-FORMAT-TYPE7-MSGS

           ELSE
              PERFORM 2960-FORMAT-V-STATUS-MSGS1
              PERFORM 3000-FORMAT-OTHER-SUB-REC
           END-IF
           .

      /****************************************************************
      * 2960-FORMAT-V-STATUS-MSGS1
      * FORMATS ESUB RECORDS
      *
      *****************************************************************
       2960-FORMAT-V-STATUS-MSGS1.

           PERFORM 2965-FORMAT-V-STATUS-MSGS2

           IF ((VEH-RO-LO-ADD-INFO      OR
                VEH-RO-LO-ADD-PEN-INFO) AND
               (VBB-BASIC               OR
                VBB-VEH-WITHOUT-PLATE))

              IF (VBB-VRC-PRESENT(50) OR
                  VBB-VRC-PRESENT(51) OR
                  VBB-VRC-PRESENT(52) OR
                  VBB-VRC-PRESENT(53) OR
                  VBB-VRC-PRESENT(54))

                  PERFORM 2905-FORMAT-TXT-REC-STATUS
                  PERFORM 2966-FORMAT-V-STATUS-E5X-MSGS
              END-IF

           END-IF

           IF VLO-LIENHLDR-PPRLES-ID-NBR = SPACE
              CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-PAPER-LESS        TO WS-FLD-LEN
              MOVE L-PAPER-LESS                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VBB-VRC-PRESENT(64)

              IF SYF-R60-PRIV-REQ2-NO
                 SET RCC-64 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 MOVE LENGTH OF L-MAIL-ADDR         TO WS-FLD-LEN
                 MOVE L-MAIL-ADDR                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

                 IF VRC64-MAIL-LN-1-ADDR  = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-FIRST-LN          TO WS-FLD-LEN
                    MOVE L-FIRST-LN                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE VRC64-MAIL-LN-1-ADDR          TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                     TO WS-FLD-LEN
                    MOVE VRC64-MAIL-LN-1-ADDR          TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF VRC64-MAIL-LN-2-ADDR   = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-SEC-LN            TO WS-FLD-LEN
                    MOVE L-SEC-LN                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE VRC64-MAIL-LN-2-ADDR   TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                     TO WS-FLD-LEN
                    MOVE VRC64-MAIL-LN-2-ADDR   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF VRC64-MAIL-ADDR-CITY-NME   = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-CITI              TO WS-FLD-LEN
                    MOVE L-CITI                        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC64-MAIL-ADDR-CITY-NME
                                                       TO WS-FLD-LEN
                    MOVE VRC64-MAIL-ADDR-CITY-NME
                                                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF VRC64-MAIL-ADDR-COUNTY-CD   = ZEROS
                 OR SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-COUNTY            TO WS-FLD-LEN
                    MOVE L-COUNTY                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC64-MAIL-ADDR-COUNTY-CD
                                                       TO WS-FLD-LEN
                    MOVE VRC64-MAIL-ADDR-COUNTY-CD
                                                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF VRC64-MAIL-ADDR-ZIP-CD   = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-ZIP-CD            TO WS-FLD-LEN
                    MOVE L-ZIP-CD                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC64-MAIL-ADDR-ZIP-CD
                                                       TO WS-FLD-LEN
                    MOVE VRC64-MAIL-ADDR-ZIP-CD   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              END-IF

           ELSE
             IF IAC-MAIL-ADDR
                PERFORM 6450-SKIP-A-LINE
                MOVE LENGTH OF L-NO-MAIL-ADDR   TO WS-FLD-LEN
                MOVE L-NO-MAIL-ADDR             TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
             END-IF

           END-IF

           IF VBB-VRC-PRESENT(31)

              IF VBB-SUB-PLATE
                 CONTINUE

              ELSE
                 SET RCC-31 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT

                 IF LAST-MOVE-NOT-SBA
                    PERFORM 6450-SKIP-A-LINE
                 END-IF

                 IF VRC31-REC-COND-DT  > ZEROS
                    MOVE VRC31-REC-COND-DT  TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                 ELSE
                    MOVE LENGTH OF WS-TEST-DATE1   TO WS-FLD-LEN
                    MOVE WS-TEST-DATE1             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF L-PREV-LIC       TO WS-FLD-LEN
                 MOVE L-PREV-LIC                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC31-VEH-VSL-LIC-NBR   > SPACES

                    IF VRC31-PRIOR-VIN-NBR   > SPACES

                       MOVE LENGTH OF L-SLASH-VIN   TO WS-FLD-LEN
                       MOVE L-SLASH-VIN             TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                       MOVE LENGTH OF WS-LIC-NUM    TO WS-FLD-LEN
                       MOVE VRC31-VEH-VSL-LIC-NBR
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                       MOVE LENGTH OF L-FWD-SLASH   TO WS-FLD-LEN
                       MOVE L-FWD-SLASH             TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                       MOVE LENGTH OF VRC31-PRIOR-VIN-NBR
                                                    TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH               TO WS-FLD-LEN
                       MOVE VRC31-PRIOR-VIN-NBR
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    ELSE
                       MOVE 5 TO CTR-SPACES
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       MOVE LENGTH OF WS-LIC-NUM    TO WS-FLD-LEN
                       MOVE VRC31-VEH-VSL-LIC-NBR
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF

                 END-IF
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(49)

              SET RCC-49 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              PERFORM 2961-FORMAT-E49-MSGS
           ELSE
              PERFORM 2961-FORMAT-E49-MSGS
           END-IF

           IF  VBB-VRC-PRESENT(02)
           AND VRC02-FILE-CD   = X'FE'

               PERFORM 6450-SKIP-A-LINE

               IF VRC02-FILLER   (1:1) = ZERO
                  MOVE LENGTH OF L-SUBPLATE-INCOMP-MSG
                                                     TO WS-FLD-LEN
                  MOVE L-SUBPLATE-INCOMP-MSG         TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               ELSE
                  MOVE LENGTH OF L-SUBPLATE-EXMT-MSG TO WS-FLD-LEN
                  MOVE L-SUBPLATE-EXMT-MSG           TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               END-IF

               MOVE LENGTH OF L-HEADQUARTERS         TO WS-FLD-LEN
               MOVE L-HEADQUARTERS                   TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VYP-PLT-TYPE-CD = 'TI' OR 'TO'
               PERFORM 6450-SKIP-A-LINE
               MOVE LENGTH OF L-VEH-CURR-NOT-REG TO WS-FLD-LEN
               MOVE L-VEH-CURR-NOT-REG           TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VBB-TYPE-LIC-CD = '74' OR '78'
               PERFORM 2975-FRMT-CALIF-TITLE
           END-IF

           IF VBB-VRC-PRESENT(38)
              SET RCC-38 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF WS-FIL-CD = L-B
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-MULT-HULLS    TO WS-FLD-LEN
                 MOVE L-MULT-HULLS              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-MULT-MOB-HOME TO WS-FLD-LEN
                 MOVE L-MULT-MOB-HOME           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              PERFORM 6450-SKIP-A-LINE
              MOVE VRC-ADDITIONAL-DATA-UNFRMT
                                                TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                    TO WS-FLD-LEN
              MOVE VRC-ADDITIONAL-DATA-UNFRMT
                                                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           END-IF

           IF VBB-VRC-PRESENT(35)       AND
              ((SYF-R60-PRIV-LINE5-YES  OR
                SYF-R60-PRIV-LINE1-YES  OR
                SYF-R60-PRIV-LINE3-YES) AND
                SYF-R60-PRIV-REQ1-YES)

              MOVE LENGTH OF L-ADDR-CONF        TO WS-FLD-LEN
              MOVE L-ADDR-CONF                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF CTR-FLD > ZERO
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /****************************************************************
      * 2961-FORMAT-E49-MSGS
      * FORMATS GOLDENROD MESAGES WHEN AN E49 NOT PRESENT IN DATABASE
      * OR WHEN PRESENT AND THE REASON CODE NOT = '12'
      *****************************************************************
       2961-FORMAT-E49-MSGS.

           IF VBB-VRC-PRESENT(49)    AND
              VRC49-REASON-CD  = '12'
              CONTINUE
           ELSE
             IF VYP-TYPE-LIC-CD = '2T' OR '2U'
                MOVE LENGTH OF L-NC-MC        TO WS-FLD-LEN
                MOVE L-NC-MC                  TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
             END-IF

             IF VYP-TYPE-LIC-CD = '2V' OR '2W'
                MOVE LENGTH OF L-NC-ATV       TO WS-FLD-LEN
                MOVE L-NC-ATV                 TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6450-SKIP-A-LINE
             END-IF
           END-IF

           IF VBB-SUB-PLATE OR VBB-PSEUDO
              CONTINUE
           ELSE
              IF VYP-PLT-TYPE-CD = 'PT'

                 EVALUATE VYP-CA-TITLE-IND

                   WHEN 'Y'
                     PERFORM 6450-SKIP-A-LINE
                     MOVE LENGTH OF L-PTI-TRA      TO WS-FLD-LEN
                     MOVE L-PTI-TRA                TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN 'N'
                     MOVE LENGTH OF L-GOLD-PTI-TRA TO WS-FLD-LEN
                     MOVE L-GOLD-PTI-TRA           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN 'U'
                     MOVE LENGTH OF L-PTI-TRA-INFO TO WS-FLD-LEN
                     MOVE L-PTI-TRA-INFO           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN OTHER
                     CONTINUE

                 END-EVALUATE

              ELSE
                 IF VYP-CA-TITLE-IND = 'N'
                    MOVE LENGTH OF L-GOLD-PROF-OWR TO WS-FLD-LEN
                    MOVE L-GOLD-PROF-OWR           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              END-IF
           END-IF
           .

      /****************************************************************
      * 2965-FORMAT-V-STATUS-MSGS2
      * FORMATS ESUB RECORDS
      *
      *****************************************************************
       2965-FORMAT-V-STATUS-MSGS2.

           IF VBB-VRC-PRESENT(05)

              SET RCC-05 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF ((VRC05-REASON-CD  = ('59' OR
                                       '61' OR
                                       '62' OR
                                       '63' OR
                                       '64' OR
                                       '65' OR
                                       '66' OR
                                       '94')) OR
                   SYF-R60-ALLOW-VLT-YES)

                 IF  VRC05-REASON-CD    > SPACES
                 AND VRC05-REC-COND-DT  > ZEROS

                 EVALUATE VRC05-REASON-CD

                   WHEN '04'
                     MOVE LENGTH OF L-TXT-CURR-FEE-DUE TO WS-FLD-LEN
                     MOVE L-TXT-CURR-FEE-DUE          TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '05'
                     MOVE LENGTH OF L-TXT-DISHONRD-CHK TO WS-FLD-LEN
                     MOVE L-TXT-DISHONRD-CHK          TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '06'
                     MOVE LENGTH OF L-TXT-CURR-DOCUMENTS
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-CURR-DOCUMENTS        TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '07'
                     MOVE LENGTH OF L-TXT-OTHER-JURSDCTNS
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-OTHER-JURSDCTNS       TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '08'
                     MOVE LENGTH OF L-TXT-CARIER-FEE-DUE
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-CARIER-FEE-DUE        TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '09'
                     MOVE LENGTH OF L-TXT-CURNT-AUDIT
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-CURNT-AUDIT           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '10'
                     MOVE LENGTH OF L-TXT-AUDIT-DOCS  TO WS-FLD-LEN
                     MOVE L-TXT-AUDIT-DOCS            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '11'
                     MOVE LENGTH OF L-TXT-REG-SYS-FEE-DUE
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-REG-SYS-FEE-DUE       TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '28'
                     MOVE VRC05-REC-COND-DT  TO WS-FORMAT-DT
                     IF WS-FORMAT-DT >= L-COMP-DATE2
                        MOVE LENGTH OF L-TXT-SALVAGE-RET
                                                      TO WS-FLD-LEN
                        MOVE L-TXT-SALVAGE-RET        TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     ELSE
                        MOVE LENGTH OF L-TXT-VLT-RET  TO WS-FLD-LEN
                        MOVE L-TXT-VLT-RET            TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE LENGTH OF VBB-VEH-MAKE-NME
                                                      TO WS-FLD-LEN
                        MOVE VBB-VEH-MAKE-NME         TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     END-IF
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '56'
                     MOVE LENGTH OF L-TXT-S           TO WS-FLD-LEN
                     MOVE L-TXT-S                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE VRC05-REC-COND-DT           TO
                                                       WS-FORMAT-DT
                     PERFORM 6310-MOVE-FORMATTED-DATE
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF L-TXT-U           TO WS-FLD-LEN
                     MOVE L-TXT-U                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE LENGTH OF VRC05-UNIT-CD
                                                      TO WS-FLD-LEN
                     MOVE VRC05-UNIT-CD               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF L-TXT-R           TO WS-FLD-LEN
                     MOVE L-TXT-R                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE LENGTH OF VRC05-REASON-CD
                                                      TO WS-FLD-LEN
                     MOVE VRC05-REASON-CD             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF L-TXT-RFR         TO WS-FLD-LEN
                     MOVE L-TXT-RFR                   TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '67'
                     MOVE LENGTH OF L-TXT-CARD-CHARGE TO WS-FLD-LEN
                     MOVE L-TXT-CARD-CHARGE           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '68'
                     MOVE LENGTH OF L-TXT-ENFRCMNT    TO WS-FLD-LEN
                     MOVE L-TXT-ENFRCMNT              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '72'
                     MOVE LENGTH OF L-TXT-SUSP-RENEWAL
                                                      TO WS-FLD-LEN
                     MOVE L-TXT-SUSP-RENEWAL          TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE LENGTH OF L-TXT-TRANS-RAS   TO WS-FLD-LEN
                     MOVE L-TXT-TRANS-RAS             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '74'
                     MOVE LENGTH OF L-TXT-CNTFT-SMOG  TO WS-FLD-LEN
                     MOVE L-TXT-CNTFT-SMOG            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '78'
                     MOVE LENGTH OF L-TXT-REG-SUSPND  TO WS-FLD-LEN
                     MOVE L-TXT-REG-SUSPND            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '90'
                     MOVE LENGTH OF L-TXT-REG-REFUSD  TO WS-FLD-LEN
                     MOVE L-TXT-REG-REFUSD            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN '91'
                     MOVE LENGTH OF L-TXT-ARB-STOP    TO WS-FLD-LEN
                     MOVE L-TXT-ARB-STOP              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE

                   WHEN OTHER

                     IF VRC05-HONOR-NOTHING-DT  = ZEROS

                        MOVE LENGTH OF L-TXT-S         TO WS-FLD-LEN
                        MOVE L-TXT-S                   TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE VRC05-REC-COND-DT  TO WS-FORMAT-DT
                        PERFORM 6310-MOVE-FORMATTED-DATE
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        MOVE LENGTH OF L-TXT-U         TO WS-FLD-LEN
                        MOVE L-TXT-U                   TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE LENGTH OF VRC05-UNIT-CD
                                                       TO WS-FLD-LEN
                        MOVE VRC05-UNIT-CD             TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        MOVE LENGTH OF L-TXT-R         TO WS-FLD-LEN
                        MOVE L-TXT-R                   TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE LENGTH OF VRC05-REASON-CD
                                                       TO WS-FLD-LEN
                        MOVE VRC05-REASON-CD           TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                        PERFORM 6450-SKIP-A-LINE

                        IF VRC05-REASON-CD  = '59'
                           MOVE LENGTH OF L-TXT-REG-DIS-CHK
                                                       TO WS-FLD-LEN
                           MOVE L-TXT-REG-DIS-CHK      TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           PERFORM 6450-SKIP-A-LINE

                        ELSE
                          IF VRC05-NEW-FRMT-IND   AND
                             VRC05-REASON-CD  =
                         ('61' OR '62' OR '63' OR '64' OR '65' OR '66')

                             MOVE LENGTH OF L-TXT-EXP-YR-INCORRECT
                                                         TO WS-FLD-LEN
                             MOVE L-TXT-EXP-YR-INCORRECT TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                             IF VRC05-REMAINDER-DUE-AMT  > ZEROS
                                MOVE VRC05-REMAINDER-DUE-AMT  (1:5)
                                                 TO WS-SUPRS-ZEROS-DOL
                                MOVE VRC05-REMAINDER-DUE-AMT  (6:2)
                                                 TO WS-CENTS
                                MOVE LENGTH OF WS-SUPRS-ZEROS-AMT
                                                        TO WS-FLD-LEN
                                MOVE WS-SUPRS-ZEROS-AMT TO WS-MOVE-FLD
                                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             END-IF

                             MOVE LENGTH OF L-TXT-FOR-DC TO WS-FLD-LEN
                             MOVE L-TXT-FOR-DC           TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             PERFORM 6450-SKIP-A-LINE
                          END-IF
                        END-IF

                     END-IF

                     IF VRC05-HONOR-NOTHING-DT  > ZEROS

                        MOVE LENGTH OF L-TXT-S         TO WS-FLD-LEN
                        MOVE L-TXT-S                   TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE VRC05-REC-COND-DT  TO WS-FORMAT-DT
                        PERFORM 6310-MOVE-FORMATTED-DATE
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        MOVE LENGTH OF L-TXT-U       TO WS-FLD-LEN
                        MOVE L-TXT-U                 TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE LENGTH OF VRC05-UNIT-CD
                                                     TO WS-FLD-LEN
                        MOVE VRC05-UNIT-CD           TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        MOVE LENGTH OF L-TXT-R       TO WS-FLD-LEN
                        MOVE L-TXT-R                 TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        MOVE LENGTH OF VRC05-REASON-CD
                                                     TO WS-FLD-LEN
                        MOVE VRC05-REASON-CD  TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        IF VRC05-REASON-CD  = '55' OR '87' OR
                                                     '88'
                           MOVE LENGTH OF L-TXT-C    TO WS-FLD-LEN
                           MOVE L-TXT-C              TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                           MOVE LENGTH OF WS-FRMAT-DAT-YMD
                                                     TO WS-FLD-LEN
                           MOVE WS-FRMAT-DAT-YMD     TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           PERFORM 6450-SKIP-A-LINE
                        END-IF

                        IF VRC05-REASON-CD  = '59'
                           MOVE LENGTH OF L-TXT-C    TO WS-FLD-LEN
                           MOVE L-TXT-C              TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                           MOVE LENGTH OF WS-FRMAT-DAT-YMD TO
                                                        WS-FLD-LEN
                           MOVE WS-FRMAT-DAT-YMD     TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           PERFORM 6450-SKIP-A-LINE

                           MOVE LENGTH OF L-TXT-REG-DIS-CHK
                                                     TO WS-FLD-LEN
                           MOVE L-TXT-REG-DIS-CHK    TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           PERFORM 6450-SKIP-A-LINE
                        END-IF

                        IF VRC05-REASON-CD  = '65' AND
                           VRC05-OLD-FRMT-IND
                           MOVE LENGTH OF L-TXT-D    TO WS-FLD-LEN
                           MOVE L-TXT-D              TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                           MOVE LENGTH OF WS-FRMAT-DAT-YMD
                                                     TO WS-FLD-LEN
                           MOVE WS-FRMAT-DAT-YMD     TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           MOVE 02 TO CTR-SPACES
                           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                           MOVE LENGTH OF L-TXT-DEALER-STOP TO
                                                        WS-FLD-LEN
                           MOVE L-TXT-DEALER-STOP    TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           PERFORM 6450-SKIP-A-LINE
                        END-IF

                        IF VRC05-REASON-CD  = ('62' OR '63' OR
                                               '64' OR '65') AND
                           VRC05-NEW-FRMT-IND

                           MOVE VRC05-HONOR-NOTHING-DT  TO
                                                        WS-FORMAT-DT

                           IF WS-FORMAT-DT >= L-COMP-DATE1
                              MOVE LENGTH OF L-TXT-C  TO WS-FLD-LEN
                              MOVE L-TXT-C            TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              MOVE VRC05-HONOR-NOTHING-DT
                                                      TO WS-FORMAT-DT
                              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO
                                                           WS-FLD-LEN
                              MOVE WS-FRMAT-DAT-YMD   TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              PERFORM 6450-SKIP-A-LINE

                              MOVE LENGTH OF L-TXT-REG-REVOKED
                                                     TO WS-FLD-LEN
                              MOVE L-TXT-REG-REVOKED TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                              MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                              PERFORM 6310-MOVE-FORMATTED-DATE
                              MOVE LENGTH OF L-TXT-DOT
                                                     TO WS-FLD-LEN
                              MOVE L-TXT-DOT         TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                              MOVE LENGTH OF L-TXT-COLLECT
                                                     TO WS-FLD-LEN
                              MOVE L-TXT-COLLECT     TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                              IF VRC05-REMAINDER-DUE-AMT   > ZEROS
                                 MOVE VRC05-REMAINDER-DUE-AMT
                                                 TO WS-SUPRS-ZEROS-DOL
                                 MOVE VRC05-REMAINDER-DUE-AMT (6:2)

                                                 TO WS-CENTS
                                 MOVE LENGTH OF WS-SUPRS-ZEROS-AMT
                                                         TO WS-FLD-LEN
                                 MOVE WS-SUPRS-ZEROS-AMT TO WS-MOVE-FLD
                                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              END-IF

                              MOVE LENGTH OF L-TXT-FOR-DC
                                                     TO WS-FLD-LEN
                              MOVE L-TXT-FOR-DC      TO WS-MOVE-FLD
                              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                              PERFORM 6450-SKIP-A-LINE

                           ELSE
                             MOVE LENGTH OF L-TXT-C  TO WS-FLD-LEN
                             MOVE L-TXT-C            TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                             MOVE LENGTH OF WS-FRMAT-DAT-YMD TO
                                                          WS-FLD-LEN
                             MOVE WS-FRMAT-DAT-YMD   TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                             PERFORM 6450-SKIP-A-LINE
                             MOVE LENGTH OF L-TXT-EXP-YR-INCORRECT
                                                     TO WS-FLD-LEN
                             MOVE L-TXT-EXP-YR-INCORRECT
                                                     TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                             IF VRC05-REMAINDER-DUE-AMT
                                                      > ZEROS
                                MOVE VRC05-REMAINDER-DUE-AMT
                                                          (1:5)
                                                 TO WS-SUPRS-ZEROS-DOL
                                MOVE VRC05-REMAINDER-DUE-AMT
                                                          (6:2)
                                                 TO WS-CENTS
                                MOVE LENGTH OF WS-SUPRS-ZEROS-AMT
                                                     TO WS-FLD-LEN
                                MOVE WS-SUPRS-ZEROS-AMT TO WS-MOVE-FLD
                                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             END-IF

                             MOVE LENGTH OF L-TXT-FOR-DC
                                                     TO WS-FLD-LEN
                             MOVE L-TXT-FOR-DC       TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             MOVE LENGTH OF VRC05-CHK-WRITER-IND

                                                     TO WS-FLD-LEN
                             MOVE VRC05-CHK-WRITER-IND
                                                     TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             PERFORM 6450-SKIP-A-LINE

                           END-IF
                        END-IF

                        IF VRC05-REASON-CD  = ('61' OR '66')
                           MOVE LENGTH OF L-TXT-C    TO WS-FLD-LEN
                           MOVE L-TXT-C              TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                           MOVE VRC05-HONOR-NOTHING-DT
                                                     TO WS-FORMAT-DT
                           MOVE LENGTH OF WS-FRMAT-DAT-YMD TO
                                                        WS-FLD-LEN
                           MOVE WS-FRMAT-DAT-YMD     TO WS-MOVE-FLD
                           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                           PERFORM 6450-SKIP-A-LINE
                        END-IF

                        IF VRC05-REASON-CD  = '55' OR '59' OR
                           '61' OR '62' OR '63' OR '64' OR '65' OR
                           '66' OR '87' OR '88'
                           CONTINUE

                        ELSE
                          MOVE LENGTH OF L-TXT-H TO WS-FLD-LEN
                          MOVE L-TXT-H           TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          MOVE VRC05-HONOR-NOTHING-DT
                                                 TO WS-FORMAT-DT
                          PERFORM 6310-MOVE-FORMATTED-DATE
                          PERFORM 6450-SKIP-A-LINE
                        END-IF

                     END-IF

                 END-EVALUATE

                 END-IF

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(20)

              SET RCC-20 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE 6     TO WS-SUB
              PERFORM UNTIL CURRNT-REC-FOUND OR WS-SUB < 1

              IF VRC20-UNCLMD-OR-RTRN-STAT-CD (WS-SUB) = SPACES AND
                 VRC20-STAT-ENTERED-DT (WS-SUB)        = ZEROS
                 COMPUTE WS-SUB = WS-SUB - 1

              ELSE
                 SET CURRNT-REC-FOUND TO TRUE
                 IF LAST-MOVE-NOT-SBA
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
                 MOVE VRC20-STAT-ENTERED-DT (WS-SUB)    TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 EVALUATE VRC20-UNCLMD-OR-RTRN-STAT-CD (WS-SUB)
                   WHEN 'SD'
                     MOVE LENGTH OF L-NOTICE-REL-LIA    TO WS-FLD-LEN
                     MOVE L-NOTICE-REL-LIA              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'PR'
                     MOVE LENGTH OF L-POT-RET           TO WS-FLD-LEN
                     MOVE L-POT-RET                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'PD'
                     MOVE LENGTH OF L-POT-RET-OWNR-DEC  TO WS-FLD-LEN
                     MOVE L-POT-RET-OWNR-DEC            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'RR'
                     MOVE LENGTH OF L-REG-LET-RET       TO WS-FLD-LEN
                     MOVE L-REG-LET-RET                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'RD'
                     MOVE LENGTH OF L-REG-OWNR-DEC      TO WS-FLD-LEN
                     MOVE L-REG-OWNR-DEC                TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'LR'
                     MOVE LENGTH OF L-LEG-LET-RET       TO WS-FLD-LEN
                     MOVE L-LEG-LET-RET                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'LD'
                     MOVE LENGTH OF L-LEG-OWNR-DEC      TO WS-FLD-LEN
                     MOVE L-LEG-OWNR-DEC                TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'UV'
                     MOVE LENGTH OF L-NOT-OWNR-POSS     TO WS-FLD-LEN
                     MOVE L-NOT-OWNR-POSS               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'OS'
                     MOVE LENGTH OF L-VEH-OS            TO WS-FLD-LEN
                     MOVE L-VEH-OS                      TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'DE'
                     MOVE LENGTH OF L-VEH-OWNR-REP-DEC  TO WS-FLD-LEN
                     MOVE L-VEH-OWNR-REP-DEC            TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'AP'
                     MOVE LENGTH OF L-APP-VEH           TO WS-FLD-LEN
                     MOVE L-APP-VEH                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'SE'
                     MOVE LENGTH OF L-SPL-EQUP          TO WS-FLD-LEN
                     MOVE L-SPL-EQUP                    TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                   WHEN 'NC'
                     MOVE LENGTH OF L-NCOA-ADDR-DEL     TO WS-FLD-LEN
                     MOVE L-NCOA-ADDR-DEL               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 END-EVALUATE

              END-IF

              END-PERFORM
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(26)

              SET RCC-26 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC26-UNIT-CD  = SPACES

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 MOVE VRC26-REASON-CD              TO WS-REASON-CD-E26

                 EVALUATE TRUE
                   WHEN RCD-01-E26
                   WHEN RCD-02-E26
                     MOVE LENGTH OF L-OPEN-COLL    TO WS-FLD-LEN
                     MOVE L-OPEN-COLL              TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN RCD-16-E26
                   WHEN RCD-17-E26
                     MOVE LENGTH OF L-OPEN-COLL-EV TO WS-FLD-LEN
                     MOVE L-OPEN-COLL-EV           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN RCD-21-E26
                     MOVE LENGTH OF L-OPEN-COLL-PN TO WS-FLD-LEN
                     MOVE L-OPEN-COLL-PN           TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN RCD-31-E26
                     MOVE LENGTH OF L-NRL-LETR     TO WS-FLD-LEN
                     MOVE L-NRL-LETR               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                   WHEN OTHER
                     MOVE LENGTH OF L-RDF-LETR     TO WS-FLD-LEN
                     MOVE L-RDF-LETR               TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     MOVE 01 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 END-EVALUATE
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(61)

              SET RCC-61 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              MOVE VRC61-REC-COND-DT               TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VRC61-REASON-CD                 TO WS-REASON-CD-E61
              EVALUATE  TRUE
                 WHEN RCD-01-E61
                   MOVE LENGTH OF L-LIEN-SALE-PRO  TO WS-FLD-LEN
                   MOVE L-LIEN-SALE-PRO            TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 WHEN RCD-02-E61
                   MOVE LENGTH OF L-LIEN-SALE-AUTH TO WS-FLD-LEN
                   MOVE L-LIEN-SALE-AUTH           TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 WHEN RCD-03-E61
                   MOVE LENGTH OF L-LIEN-SALE-DEN  TO WS-FLD-LEN
                   MOVE L-LIEN-SALE-DEN            TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(65)

              SET RCC-65 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC65-REASON-CD  = '01' AND
                 SYF-R60-PRIV-LINE2-YES

                 IF VRC65-SHOP-CASE-ID  > SPACES
                    PERFORM 2905-FORMAT-TXT-REC-STATUS
                    PERFORM 6450-SKIP-A-LINE

                    MOVE VRC65-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-SHOP           TO WS-FLD-LEN
                    MOVE L-SHOP                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC65-SHOP-CASE-ID
                                                    TO WS-FLD-LEN
                    MOVE VRC65-SHOP-CASE-ID  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF

                 IF VRC65-SRP-CASE-ID  > SPACES
                    PERFORM 2905-FORMAT-TXT-REC-STATUS
                    PERFORM 6450-SKIP-A-LINE

                    MOVE VRC65-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-SRP            TO WS-FLD-LEN
                    MOVE L-SRP                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC65-SRP-CASE-ID
                                                    TO WS-FLD-LEN
                    MOVE VRC65-SRP-CASE-ID          TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF

                 IF VRC65-MUPS-CASE-ID  > SPACES
                    PERFORM 2905-FORMAT-TXT-REC-STATUS
                    PERFORM 6450-SKIP-A-LINE

                    MOVE VRC65-REC-COND-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-MUPS           TO WS-FLD-LEN
                    MOVE L-MUPS                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                    MOVE LENGTH OF VRC65-MUPS-CASE-ID
                                                    TO WS-FLD-LEN
                    MOVE VRC65-MUPS-CASE-ID  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF

              END-IF

              IF VRC65-REASON-CD  = '02' AND
                 SYF-R60-PRIV-LINE4-YES

                 PERFORM 2905-FORMAT-TXT-REC-STATUS

                 MOVE VRC65-REC-COND-DT          TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF L-DMV-TRAP       TO WS-FLD-LEN
                 MOVE L-DMV-TRAP                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

              END-IF

           END-IF

           IF VBB-VRC-PRESENT(69)

              SET RCC-69 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC69-REASON-CD  = '02'
                 MOVE LENGTH OF L-PNO-REG-DEF     TO WS-FLD-LEN
                 MOVE L-PNO-REG-DEF               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              ELSE
                 MOVE LENGTH OF L-REG-DEF         TO WS-FLD-LEN
                 MOVE L-REG-DEF                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VRC69-PNO-EXPR-YY-DT  = ZEROS
                    MOVE SPACES                   TO WS-FORMAT-DT(1:4)
                 ELSE
                    MOVE VRC69-PNO-EXPR-YY-DT     TO WS-FORMAT-DT(1:4)
                 END-IF
                 MOVE VBB-REG-EXPR-MM             TO WS-FORMAT-DT(5:2)
                 MOVE VBB-REG-EXPR-DD             TO WS-FORMAT-DT(7:2)
                 PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(66)

              SET RCC-66 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

            PERFORM 6450-SKIP-A-LINE
            PERFORM VARYING WS-SUB FROM 1 BY +1 UNTIL WS-SUB > L-5
              IF VRC66-VEH-LIC-NBR (WS-SUB)          > SPACES
                IF VRC66-VEH-LIC-NBR (WS-SUB) = WS-SAVE-LIC-NBR
                   IF VRC66-CITATION-DT (WS-SUB) > ZEROS
                      MOVE VRC66-CITATION-DT (WS-SUB)
                                                   TO WS-FORMAT-DT
                      COMPUTE WS-STRT = WS-STRT - 48
                      PERFORM 6310-MOVE-FORMATTED-DATE
                      COMPUTE WS-STRT = WS-STRT + 40
                   ELSE
                      CONTINUE
                   END-IF
                ELSE
                   PERFORM 6450-SKIP-A-LINE
                   MOVE VRC66-VEH-LIC-NBR (WS-SUB)   TO WS-SAVE-LIC-NBR
                   IF VRC66-CITATION-DT (WS-SUB) > ZEROS
                      MOVE VRC66-CITATION-DT (WS-SUB)
                                                     TO WS-FORMAT-DT
                                                        WS-SAVE-DATE
                   ELSE
                      IF VRC66-IND-3 (WS-SUB)
                         MOVE WS-SAVE-DATE           TO WS-FORMAT-DT
                      ELSE
                         MOVE ZEROS                  TO WS-FORMAT-DT
                      END-IF
                   END-IF
                   PERFORM 6310-MOVE-FORMATTED-DATE
                   PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                   MOVE LENGTH OF L-CIT-TRNSF-TO     TO WS-FLD-LEN
                   MOVE L-CIT-TRNSF-TO               TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   MOVE LENGTH OF VRC66-VEH-LIC-NBR (WS-SUB)
                                                     TO WS-FLD-LEN
                   MOVE VRC66-VEH-LIC-NBR (WS-SUB)   TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                END-IF
              END-IF
            END-PERFORM
           END-IF

           IF VBB-VRC-PRESENT(67)

             SET RCC-67 TO TRUE
             PERFORM 2999-SEARCH-VRC-PKT

             MOVE SPACES        TO WS-SAVE-LIC-NBR

             PERFORM VARYING WS-SUB FROM 1 BY +1 UNTIL WS-SUB > L-5
               IF  VRC67-VEH-LIC-NBR (WS-SUB)          > SPACES
               AND NOT VRC66-IND-3 (WS-SUB)
                 PERFORM 6450-SKIP-A-LINE
                 IF VRC67-VEH-LIC-NBR (WS-SUB) = WS-SAVE-LIC-NBR
                    IF VRC66-CITATION-DT (WS-SUB) > ZEROS
                       MOVE VRC66-CITATION-DT (WS-SUB)
                                                      TO WS-FORMAT-DT
                       COMPUTE WS-STRT = WS-STRT - 48
                       PERFORM 6310-MOVE-FORMATTED-DATE
                       COMPUTE WS-STRT = WS-STRT + 40
                    ELSE
                       CONTINUE
                    END-IF
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE VRC67-VEH-LIC-NBR (WS-SUB)
                                                      TO WS-SAVE-LIC-NBR
                    IF VRC67-CITATION-DT (WS-SUB) > ZEROS
                       MOVE VRC67-CITATION-DT (WS-SUB)
                                                      TO WS-FORMAT-DT
                    ELSE
                       MOVE ZEROS                     TO WS-FORMAT-DT
                    END-IF
                    PERFORM 6310-MOVE-FORMATTED-DATE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF L-CIT-TRANSFERED   TO WS-FLD-LEN
                    MOVE L-CIT-TRANSFERED             TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE LENGTH OF VRC67-VEH-LIC-NBR (WS-SUB)
                                                      TO WS-FLD-LEN
                    MOVE VRC67-VEH-LIC-NBR (WS-SUB)
                                                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
               END-IF
             END-PERFORM
            PERFORM 6451-SKIP-A-LINE-2-TIMES
           END-IF

           IF VBB-VRC-PRESENT(73)

              SET RCC-73 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-NON-RES-SMOG-FEE   TO WS-FLD-LEN
              MOVE L-NON-RES-SMOG-FEE             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(74)

              SET RCC-74 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-PROF-CORR-REQ      TO WS-FLD-LEN
              MOVE L-PROF-CORR-REQ                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-EMISS-RECAL        TO WS-FLD-LEN
              MOVE L-EMISS-RECAL                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC74-RECALL-ID      TO WS-FLD-LEN
              MOVE VRC74-RECALL-ID                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(77)

              SET RCC-77 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-NON-RES-FEE       TO WS-FLD-LEN
              MOVE L-NON-RES-FEE                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(78)

              SET RCC-78 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              PERFORM 2905-FORMAT-TXT-REC-STATUS

              IF VRC78-REASON-CD  = '02'
                 MOVE LENGTH OF L-EXP-TEMP       TO WS-FLD-LEN
                 MOVE L-EXP-TEMP                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-EXP-PERM       TO WS-FLD-LEN
                 MOVE L-EXP-PERM                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(79)

              SET RCC-79 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              MOVE VRC79-REC-COND-DT             TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-GROS-POLL-REN     TO WS-FLD-LEN
              MOVE L-GROS-POLL-REN               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(80)

              SET RCC-80 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              PERFORM 2905-FORMAT-TXT-REC-STATUS

              MOVE VRC80-REC-COND-DT             TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC80-REASON-CD  = '01'
                 MOVE LENGTH OF L-GROS-POLL-ANL  TO WS-FLD-LEN
                 MOVE L-GROS-POLL-ANL            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-SMOG-INSP-TST  TO WS-FLD-LEN
                 MOVE L-SMOG-INSP-TST            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(81)

              SET RCC-81 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              PERFORM 2905-FORMAT-TXT-REC-STATUS

              MOVE VRC81-REC-COND-DT               TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VRC81-REASON-CD                 TO WS-REASON-CD-E81
              EVALUATE TRUE
                WHEN RCD-02-E81
                   MOVE LENGTH OF L-VEH-COMP-BURN  TO WS-FLD-LEN
                   MOVE L-VEH-COMP-BURN            TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-03-E81
                   MOVE LENGTH OF L-OWNR-DEC       TO WS-FLD-LEN
                   MOVE L-OWNR-DEC                 TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN RCD-04-E81
                   MOVE LENGTH OF L-NONREP-RET     TO WS-FLD-LEN
                   MOVE L-NONREP-RET               TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                WHEN OTHER
                   MOVE LENGTH OF L-VEH-SURG-STP   TO WS-FLD-LEN
                   MOVE L-VEH-SURG-STP             TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              END-EVALUATE

              IF RCD-04-E81
                 CONTINUE

              ELSE
                 MOVE VRC81-HONOR-NOTHING-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(83)

              SET RCC-83 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              PERFORM 2905-FORMAT-TXT-REC-STATUS
              PERFORM 6450-SKIP-A-LINE

              IF VRC83-REC-COND-DT  > ZEROS
                MOVE VRC83-REC-COND-DT            TO WS-FORMAT-DT
                PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                MOVE LENGTH OF WS-TEST-DATE1      TO WS-FLD-LEN
                MOVE WS-TEST-DATE1                TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC83-SUSP-DT  = ZEROS
                 MOVE LENGTH OF L-VEH-REG-SUS      TO WS-FLD-LEN
                 MOVE L-VEH-REG-SUS                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              ELSE
                 MOVE LENGTH OF L-VEH-REG-SUS-EFF  TO WS-FLD-LEN
                 MOVE L-VEH-REG-SUS-EFF            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE VRC83-SUSP-DT                TO WS-FORMAT-DT
                 SET MMDDCCYY-FRMT                 TO TRUE
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(84)

              SET RCC-84 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE VRC84-REC-COND-DT              TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-IRP-ACT-DATA       TO WS-FLD-LEN
              MOVE L-IRP-ACT-DATA                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              IF VRC-ADDITIONAL-DATA-UNFRMT  > SPACES

                 MOVE LENGTH OF L-IRP-ACT         TO WS-FLD-LEN
                 MOVE L-IRP-ACT                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-ACCT-NBR
                                                  TO WS-FLD-LEN
                 MOVE VRC84-IRP-ACCT-NBR          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-IRP-FLEET       TO WS-FLD-LEN
                 MOVE L-IRP-FLEET                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-FLEET-NBR
                                                  TO WS-FLD-LEN
                 MOVE VRC84-IRP-FLEET-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

                 MOVE LENGTH OF L-USDOT-ACT       TO WS-FLD-LEN
                 MOVE L-USDOT-ACT                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-ACCT-USDOT-NBR
                                                  TO WS-FLD-LEN
                 MOVE VRC84-IRP-ACCT-USDOT-NBR
                                                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 01 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-USDOT-FLEET     TO WS-FLD-LEN
                 MOVE L-USDOT-FLEET               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-FLEET-USDOT-NBR
                                                  TO WS-FLD-LEN
                 MOVE VRC84-IRP-FLEET-USDOT-NBR
                                                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 01 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-USDOT-VEH       TO WS-FLD-LEN
                 MOVE L-USDOT-VEH                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-VEH-USDOT-NBR
                                                  TO WS-FLD-LEN
                 MOVE VRC84-IRP-VEH-USDOT-NBR
                                                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE

                 MOVE LENGTH OF L-MX-ACT          TO WS-FLD-LEN
                 MOVE L-MX-ACT                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-ACCT-MX-NBR
                                                    TO WS-FLD-LEN
                 MOVE VRC84-IRP-ACCT-MX-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 05 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-MX-FLEET          TO WS-FLD-LEN
                 MOVE L-MX-FLEET                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-FLEET-MX-NBR
                                                     TO WS-FLD-LEN
                 MOVE VRC84-IRP-FLEET-MX-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 05 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-MX-VEH           TO WS-FLD-LEN
                 MOVE L-MX-VEH                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC84-IRP-VEH-MX-NBR
                                                   TO WS-FLD-LEN
                 MOVE VRC84-IRP-VEH-MX-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

           END-IF
RA0709* START
RA0709     IF VBB-VRC-PRESENT(85)
RA0709
RA0709     SET RCC-85 TO TRUE
RA0709     PERFORM 2999-SEARCH-VRC-PKT
RA0709     PERFORM 2905-FORMAT-TXT-REC-STATUS
RA0709
RA0709     EVALUATE VRC85-REASON-CD
RA0709        WHEN '02'
RA0709
RA0709           MOVE VRC85-REC-COND-DT              TO WS-FORMAT-DT
RA0709           PERFORM 6310-MOVE-FORMATTED-DATE
RA0709           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
RA0709
RA0709           MOVE LENGTH OF L-ARB-NON-COMPLIANCE TO WS-FLD-LEN
RA0709           MOVE L-ARB-NON-COMPLIANCE           TO WS-MOVE-FLD
RA0709           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
RA0709           PERFORM 6450-SKIP-A-LINE
RA0709        WHEN OTHER
RA0709           CONTINUE
RA0709     END-EVALUATE
RA0709
RA0709     END-IF
RA0709
RA0709* END
           .

      /*****************************************************************
      * 2966-FORMAT-V-STATUS-E5X-MSGS
      * FUNCTION: FORMATS MESSAGES WHEN AN E50/E51/E52/E53/E54 PRESENT
      *
      ******************************************************************
       2966-FORMAT-V-STATUS-E5X-MSGS.

           IF VBB-VRC-PRESENT(50)

              SET E5X-MSG-WRITTEN TO TRUE
              PERFORM 6450-SKIP-A-LINE
              SET RCC-50 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-TXT-TIP-OFF            TO WS-FLD-LEN
              MOVE L-TXT-TIP-OFF                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC50-TIP-OFF-ID  TO WS-FLD-LEN
              MOVE VRC50-TIP-OFF-ID                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-DT                 TO WS-FLD-LEN
              MOVE L-TXT-DT                           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF  VRC50-TIP-WRK-DT      > ZEROS
                  MOVE VRC50-TIP-WRK-DT    TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                  MOVE LENGTH OF WS-TEST-DATE       TO WS-FLD-LEN
                  MOVE WS-TEST-DATE                 TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-IDS             TO WS-FLD-LEN
              MOVE L-TXT-IDS                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC50-TIP-TECH-ID
                                                   TO WS-FLD-LEN
              MOVE VRC50-TIP-TECH-ID               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC50-TIP-TRANSACTION-TME
                                                   TO WS-FLD-LEN
              IF VRC50-TIP-TRANSACTION-TME   > ZEROS
                 MOVE VRC50-TIP-TRANSACTION-TME    TO  WS-MOVE-FLD
              ELSE
                 MOVE SPACES TO  WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-TRAN            TO WS-FLD-LEN
              MOVE L-TXT-TRAN                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC50-TIP-TYPE-TRAN-CD
                                                   TO WS-FLD-LEN
              MOVE VRC50-TIP-TYPE-TRAN-CD          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(51) AND
              E5X-MSG-NOT-WRITTEN

              SET E5X-MSG-WRITTEN  TO TRUE
              PERFORM 6450-SKIP-A-LINE
              SET RCC-51 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-TXT-SIP-OFF           TO WS-FLD-LEN
              MOVE L-TXT-SIP-OFF                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-OFF-ID            TO WS-FLD-LEN
              MOVE VRC51-OFF-ID                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-DT                TO WS-FLD-LEN
              MOVE L-TXT-DT                          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VRC51-WRK-DT              >  ZEROS
                 MOVE VRC51-WRK-DT                  TO WS-FRMAT-YMD
                 PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                 MOVE LENGTH OF WS-TEST-DATE         TO WS-FLD-LEN
                 MOVE WS-TEST-DATE                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-IDS               TO WS-FLD-LEN
              MOVE L-TXT-IDS                         TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-TECH-ID           TO WS-FLD-LEN
              MOVE VRC51-TECH-ID                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC51-SEQ-NBR     TO WS-FLD-LEN
              IF VRC51-SEQ-NBR     > ZEROS
                 MOVE VRC51-SEQ-NBR                   TO WS-MOVE-FLD
              ELSE
                 MOVE SPACES TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-TRAN              TO WS-FLD-LEN
              MOVE L-TXT-TRAN                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-TYPE-TRAN-CD
                                                       TO WS-FLD-LEN
              MOVE VRC51-TYPE-TRAN-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-AMT-PAID          TO WS-FLD-LEN
              MOVE L-TXT-AMT-PAID                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-PAID-AMT   TO WS-FLD-LEN
              IF VRC51-PAID-AMT   > ZEROS
                MOVE VRC51-PAID-AMT                 TO WS-AMOUNT1
                MOVE WS-AMOUNT                      TO WS-MOVE-FLD
              ELSE
                MOVE ZEROS                          TO WS-MOVE-FLD
              END-IF

              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-REASON-CD         TO WS-FLD-LEN
              MOVE L-TXT-REASON-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-SUSP-REASON-CD  TO WS-FLD-LEN
              MOVE VRC51-SUSP-REASON-CD                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-ROUTE-CD         TO WS-FLD-LEN
              MOVE L-TXT-ROUTE-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC51-SUSP-ROUTE-CD   TO WS-FLD-LEN
              MOVE VRC51-SUSP-ROUTE-CD                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC51-CREDIT-CARD-IND   = 'C'
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-TXT-CREDT-CARD    TO WS-FLD-LEN
                 MOVE L-TXT-CREDT-CARD              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC51-CREDIT-CARD-IND
                                                       TO WS-FLD-LEN
                 MOVE VRC51-CREDIT-CARD-IND   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(52) AND
              E5X-MSG-NOT-WRITTEN

              SET E5X-MSG-WRITTEN TO TRUE
              PERFORM 6450-SKIP-A-LINE
              SET RCC-52 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-TXT-RIP-OFF           TO WS-FLD-LEN
              MOVE L-TXT-RIP-OFF                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-OFF-ID            TO WS-FLD-LEN
              MOVE VRC52-OFF-ID                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-DT                TO WS-FLD-LEN
              MOVE L-TXT-DT                          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF  VRC52-WRK-DT      > ZEROS
                  MOVE VRC52-WRK-DT                  TO WS-FRMAT-YMD
                  PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                  MOVE LENGTH OF WS-TEST-DATE        TO WS-FLD-LEN
                  MOVE WS-TEST-DATE                  TO WS-MOVE-FLD
                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-IDS               TO WS-FLD-LEN
              MOVE L-TXT-IDS                         TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-TECH-ID           TO WS-FLD-LEN
              MOVE VRC52-TECH-ID                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC52-SEQ-NBR     TO WS-FLD-LEN
              IF VRC52-SEQ-NBR     > ZEROS
                 MOVE VRC52-SEQ-NBR                   TO WS-MOVE-FLD
              ELSE
                 MOVE SPACES TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-TRAN              TO WS-FLD-LEN
              MOVE L-TXT-TRAN                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-TYPE-TRAN-CD   TO WS-FLD-LEN
              MOVE VRC52-TYPE-TRAN-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-AMT-PAID          TO WS-FLD-LEN
              MOVE L-TXT-AMT-PAID                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-PAID-AMT   TO WS-FLD-LEN
              IF VRC52-PAID-AMT   > ZEROS
                 MOVE VRC52-PAID-AMT                 TO WS-AMOUNT1
                 MOVE WS-AMOUNT                      TO WS-MOVE-FLD
              ELSE
                 MOVE ZEROS  TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-REASON-CD         TO WS-FLD-LEN
              MOVE L-TXT-REASON-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-RDF-REASON-CD   TO WS-FLD-LEN
              MOVE VRC52-RDF-REASON-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-ROUTE-CD         TO WS-FLD-LEN
              MOVE L-TXT-ROUTE-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC52-FILLER-1   TO WS-FLD-LEN
              MOVE VRC52-FILLER-1                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC52-CREDIT-CARD-IND   = 'C'
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-TXT-CREDT-CARD    TO WS-FLD-LEN
                 MOVE L-TXT-CREDT-CARD              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC52-CREDIT-CARD-IND
                                                       TO WS-FLD-LEN
                 MOVE VRC52-CREDIT-CARD-IND   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(53) AND
              E5X-MSG-NOT-WRITTEN

              SET E5X-MSG-WRITTEN TO TRUE
              PERFORM 6450-SKIP-A-LINE
              SET RCC-53 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-TXT-HIP-OFF           TO WS-FLD-LEN
              MOVE L-TXT-HIP-OFF                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-OFF-ID            TO WS-FLD-LEN
              MOVE VRC53-OFF-ID                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-DT                TO WS-FLD-LEN
              MOVE L-TXT-DT                          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VRC53-WRK-DT      > ZEROS
                 MOVE VRC53-WRK-DT                  TO WS-FRMAT-YMD
                 PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                 MOVE LENGTH OF WS-TEST-DATE         TO WS-FLD-LEN
                 MOVE WS-TEST-DATE                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-IDS               TO WS-FLD-LEN
              MOVE L-TXT-IDS                         TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-TECH-ID           TO WS-FLD-LEN
              MOVE VRC53-TECH-ID                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC53-SEQ-NBR      TO WS-FLD-LEN
              IF VRC53-SEQ-NBR      >         ZEROS
                 MOVE VRC53-SEQ-NBR                    TO WS-MOVE-FLD
              ELSE
                 MOVE SPACES TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-TRAN              TO WS-FLD-LEN
              MOVE L-TXT-TRAN                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-TYPE-TRAN-CD   TO WS-FLD-LEN
              MOVE VRC53-TYPE-TRAN-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-AMT-PAID          TO WS-FLD-LEN
              MOVE L-TXT-AMT-PAID                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-PAID-AMT          TO WS-FLD-LEN
              IF VRC53-PAID-AMT  > ZEROS
                 MOVE VRC53-PAID-AMT                 TO WS-AMOUNT1
                 MOVE WS-AMOUNT                      TO WS-MOVE-FLD
              ELSE
                 MOVE ZEROS  TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-REASON-CD         TO WS-FLD-LEN
              MOVE L-TXT-REASON-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-HOLDOUT-REASON-CD
                                                     TO WS-FLD-LEN
              MOVE VRC53-HOLDOUT-REASON-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-ROUTE-CD         TO WS-FLD-LEN
              MOVE L-TXT-ROUTE-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC53-ROUTE-CD   TO WS-FLD-LEN
              MOVE VRC53-ROUTE-CD                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC53-CREDIT-CARD-IND   = 'C'
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-TXT-CREDT-CARD    TO WS-FLD-LEN
                 MOVE L-TXT-CREDT-CARD              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC53-CREDIT-CARD-IND
                                                       TO WS-FLD-LEN
                 MOVE VRC53-CREDIT-CARD-IND            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF

           IF VBB-VRC-PRESENT(54) AND
              E5X-MSG-NOT-WRITTEN

              SET E5X-MSG-WRITTEN TO TRUE
              PERFORM 6450-SKIP-A-LINE
              SET RCC-54 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              MOVE LENGTH OF L-TXT-EIP-OFF           TO WS-FLD-LEN
              MOVE L-TXT-EIP-OFF                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-OFF-ID            TO WS-FLD-LEN
              MOVE VRC54-OFF-ID                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-DT                TO WS-FLD-LEN
              MOVE L-TXT-DT                          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VRC54-WRK-DT              > ZEROS
                 MOVE VRC54-WRK-DT                  TO WS-FRMAT-YMD
                 PERFORM 6310-MOVE-FORMATTED-DATE
              ELSE
                 MOVE LENGTH OF WS-TEST-DATE         TO WS-FLD-LEN
                 MOVE WS-TEST-DATE                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-IDS               TO WS-FLD-LEN
              MOVE L-TXT-IDS                         TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-TECH-ID           TO WS-FLD-LEN
              MOVE VRC54-TECH-ID                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC54-SEQ-NBR     TO WS-FLD-LEN
              IF VRC54-SEQ-NBR     > ZEROS
                 MOVE VRC54-SEQ-NBR                   TO WS-MOVE-FLD
              ELSE
                 MOVE SPACES TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-TRAN              TO WS-FLD-LEN
              MOVE L-TXT-TRAN                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-TYPE-TRAN-CD  TO WS-FLD-LEN
              MOVE VRC54-TYPE-TRAN-CD                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-AMT-PAID          TO WS-FLD-LEN
              MOVE L-TXT-AMT-PAID                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-PAID-AMT   TO WS-FLD-LEN
              IF VRC54-PAID-AMT   > ZEROS
                 MOVE VRC54-PAID-AMT                 TO WS-AMOUNT1
                 MOVE WS-AMOUNT                      TO WS-MOVE-FLD
              ELSE
                 MOVE ZEROS  TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-REASON-CD         TO WS-FLD-LEN
              MOVE L-TXT-REASON-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-ERROR-REASON-CD
                                                     TO WS-FLD-LEN
              MOVE VRC54-ERROR-REASON-CD             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TXT-ROUTE-CD         TO WS-FLD-LEN
              MOVE L-TXT-ROUTE-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VRC54-ROUTE-CD  TO WS-FLD-LEN
              MOVE VRC54-ROUTE-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC54-CREDIT-CARD-IND   = 'C'
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-TXT-CREDT-CARD    TO WS-FLD-LEN
                 MOVE L-TXT-CREDT-CARD              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE LENGTH OF VRC54-CREDIT-CARD-IND
                                                       TO WS-FLD-LEN
                 MOVE VRC54-CREDIT-CARD-IND   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              PERFORM 6450-SKIP-A-LINE

           END-IF
           .

      /*****************************************************************
      * 2970-FORMAT-TYPE7-MSGS
      * FUNCTION: FORMATS MESSAGES FOR TYPE RECORD 7
      *
      ******************************************************************
       2970-FORMAT-TYPE7-MSGS.

           IF VBB-VRC-PRESENT(50)  OR
              VBB-VRC-PRESENT(51)  OR
              VBB-VRC-PRESENT(52)  OR
              VBB-VRC-PRESENT(53)  OR
              VBB-VRC-PRESENT(54)
              CONTINUE

           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-TXT-APP-REVENUE   TO WS-FLD-LEN
              MOVE  L-TXT-APP-REVENUE            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF ((VEH-RO-LO-ADD-INFO)  AND
               (VBB-VRC-PRESENT(50)  OR
                VBB-VRC-PRESENT(51)  OR
                VBB-VRC-PRESENT(52)  OR
                VBB-VRC-PRESENT(53)  OR
                VBB-VRC-PRESENT(54)))

               PERFORM 6450-SKIP-A-LINE
               MOVE LENGTH OF L-TXT-MAS-FILE-REC TO WS-FLD-LEN
               MOVE  L-TXT-MAS-FILE-REC          TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT

               MOVE LENGTH OF WS-LIC-NUM         TO WS-FLD-LEN
               MOVE VBB-KEY-VEH-VSL-LIC-NBR      TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 2966-FORMAT-V-STATUS-E5X-MSGS

           END-IF

           IF ((VEH-RO-LO-ADD-PEN-INFO) AND
               (VBB-VRC-PRESENT(50)     OR
                VBB-VRC-PRESENT(51)     OR
                VBB-VRC-PRESENT(52)     OR
                VBB-VRC-PRESENT(53)     OR
                VBB-VRC-PRESENT(54)))

                PERFORM 2905-FORMAT-TXT-REC-STATUS
                PERFORM 2966-FORMAT-V-STATUS-E5X-MSGS
           END-IF
           .

      /*****************************************************************
      * 2975-FRMT-CALIF-TITLE
      * FUNCTION: FORMATS MESSAGES FOR VEHCILE TYPE 74/78
      ******************************************************************
       2975-FRMT-CALIF-TITLE.

           PERFORM 6450-SKIP-A-LINE
           MOVE LENGTH OF L-CALIF-TITLE   TO WS-FLD-LEN
           MOVE L-CALIF-TITLE             TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 2999-SEARCH-VRC-PKT.
      * FUNCTION:
      * SEARCHES VRC DATA PACKET TO GET THE REQUIRED ESUB RECORD
      ******************************************************************
       2999-SEARCH-VRC-PKT.

           INITIALIZE WS-STRUCT-MGR-PARMS
           SET SW-PKT-SRCH-MORE TO TRUE
           SET SMG-STRUCT-ADS       TO TRUE
           SET SMG-FUNC-READFIRST   TO TRUE

           IF SUSP-RDF-ERR-READ
              MOVE L-URC-PKT-ID        TO SMG-PKT-ID
           ELSE
              MOVE L-VRC-PKT-ID        TO SMG-PKT-ID
           END-IF

           SET SW-EREC-NOT-FOUND  TO TRUE
           MOVE 1 TO WS-PKT

           PERFORM 2999A-PROCESS-VRC-PKT
             UNTIL SW-EREC-FOUND
                OR SW-PKT-SRCH-EXIT OR ERROR-RTN
           .

      /*****************************************************************
      * 2999A-PROCESS-VRC-PKT.
      * FUNCTION:
      * CALLS THE STRUCTURE MANAGER TO RETRIEVE VRC PACKET
      ******************************************************************
       2999A-PROCESS-VRC-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL

              SET ADDRESS OF ARG-VRC-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              IF VRC-REC-COND-CD  = WS-REC-COND-CD
                 SET SW-EREC-FOUND TO TRUE
              END-IF

           END-IF
           .

      /****************************************************************
      * 3000-FORMAT-OTHER-SUB-REC
      * FUNCTION: MASTER PARAGRAPH FOR L,J,P,M,W SUB RECORDS
      *           ALSO FORMATS MSGS FOR VLT STOP, FILE CODES AND
      *           DRINVING LICENSE TYPES
      *****************************************************************
       3000-FORMAT-OTHER-SUB-REC.

           PERFORM 3010-COMMON-MSGS
           PERFORM 3020-J-SUB-RECORD
           PERFORM 3030-P-SUB-RECORD

           IF VEH-RO-LO-ADD-INFO     OR
              VEH-RO-LO-ADD-PEN-INFO
              IF WS-FIL-CD = L-B
                 PERFORM 3045-FRMT-QMF
              END-IF
              PERFORM 3040-FRMT-M-SUB-REC
           END-IF

           PERFORM 3060-FRMT-W-SUB-REC
           .

      /****************************************************************
      * 3010-COMMON-MSGS
      * FUNCTION:  FORMAT L-SUB RECORD
      *****************************************************************
       3010-COMMON-MSGS.

           IF PRKY-FILE-CODE = L-I

              MOVE LENGTH OF L-REC-NOT-REFLCT   TO WS-FLD-LEN
              MOVE L-REC-NOT-REFLCT             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-INFO-USE-VIN-INQ TO WS-FLD-LEN
              MOVE L-INFO-USE-VIN-INQ           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF WS-FIL-CD  = L-V AND
              VBB-VEH-WITHOUT-PLATE

              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF WS-LIC-NUM        TO WS-FLD-LEN
              MOVE VBB-KEY-VEH-VSL-LIC-NBR     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-CUR-ON-OTH-VIN  TO WS-FLD-LEN
              MOVE L-CUR-ON-OTH-VIN            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET CUR-ON-OTH-VIN-MSG-WRTN      TO TRUE

           END-IF

           IF VBB-UNACP-WRD OR
              VBB-ELP-RESV  OR
              VBB-RETENTION
              CONTINUE

           ELSE

              IF VBB-G-SUB-REC-CNT > 0

                 IF VBB-VRC-PRESENT(02)
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TXT-PARK-VOILATIONS
                                                     TO WS-FLD-LEN
                    MOVE L-TXT-PARK-VOILATIONS       TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6450-SKIP-A-LINE
                 END-IF

              END-IF

           END-IF

           IF VBB-L-SUB-REC-CNT > 0

              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-TXT-FEE-SUB-REC    TO WS-FLD-LEN
              MOVE L-TXT-FEE-SUB-REC              TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD
              PERFORM 6450-SKIP-A-LINE

           END-IF
           .

      /****************************************************************
      * 3020-J-SUB-RECORD
      * FUNCTION:  FORMAT J-SUB RECORD
      *****************************************************************
       3020-J-SUB-RECORD.

           MOVE L-1                   TO WS-SUB
           IF VBB-J-SUB-REC-CNT EQUAL TO ZEROS
             CONTINUE
           ELSE
              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UNR-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VNR-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 3025-SEARCH-VNR-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

              IF OVER-8-NTCS-WRTEN
                AND LAST-MOVE-NOT-SBA
                PERFORM 6450-SKIP-A-LINE
              END-IF

           END-IF
           .

      /****************************************************************
      * 3025-SEARCH-VNR-PKT.
      * FUNCTION:  CALL STRUCTURE MANAGER TO RETRIEVE VNR PACKET
      *****************************************************************
       3025-SEARCH-VNR-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VNR-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

               MOVE L-22 TO CTR-LIN
               SET FORCE-PAGE-BREAK TO TRUE
               PERFORM 6451-SKIP-A-LINE-2-TIMES
               IF VNR-SELLER-NAME-MATCH-CD = 'P'
                  MOVE LENGTH OF L-TXT-REG-138      TO WS-FLD-LEN
                  MOVE L-TXT-REG-138                TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  PERFORM 6450-SKIP-A-LINE
                  MOVE LENGTH OF L-TXT-REC-DATE     TO WS-FLD-LEN
                  MOVE L-TXT-REC-DATE               TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  IF VNR-DEPT-RECEIPT-DT   > ZEROS
                    MOVE VNR-DEPT-RECEIPT-DT         TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE
                  ELSE
                    MOVE LENGTH OF WS-TEST-DATE1      TO WS-FLD-LEN
                    MOVE WS-TEST-DATE1                TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  END-IF

                  MOVE 2 TO CTR-SPACES
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  MOVE LENGTH OF L-TXT-TRANSFER-DATE TO WS-FLD-LEN
                  MOVE L-TXT-TRANSFER-DATE          TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  MOVE VNR-RPTD-SALE-DT             TO WS-FORMAT-DT
                  PERFORM 6310-MOVE-FORMATTED-DATE

                  IF VNR-PRCHS-PRICE-AMT   > ZEROS
                    MOVE LENGTH OF L-TXT-SELL-PRICE   TO WS-FLD-LEN
                    MOVE L-TXT-SELL-PRICE             TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE LENGTH OF VNR-PRCHS-PRICE-AMT TO WS-FLD-LEN
                    MOVE VNR-PRCHS-PRICE-AMT          TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                  END-IF

                  PERFORM 6450-SKIP-A-LINE
                  MOVE LENGTH OF L-TXT-REG-138        TO WS-FLD-LEN
                  MOVE L-TXT-REG-138                  TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                  MOVE LENGTH OF L-TXT-RETRY          TO WS-FLD-LEN
                  MOVE L-TXT-RETRY                    TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                  PERFORM 6450-SKIP-A-LINE

                  MOVE VNR-OVR-8-NOTC-ON-FILE-FLG
                                      TO WS-OVR-8-NTCS-ON-FILE
                  SET OVER-8-NTCS-NOT-WRTEN    TO TRUE
                  IF WS-OVR-8-NTCS-ON-FILE = ZEROS
                     CONTINUE
                  ELSE
                    SET OVER-8-NTCS-WRTEN               TO TRUE
                    MOVE LENGTH OF L-TXT-ADD-RL-HIS     TO WS-FLD-LEN
                    MOVE L-TXT-ADD-RL-HIS               TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    IF SYF-R60-INHOUSE1-REQ-YES OR
                       SYF-R60-INHOUSE2-REQ-YES
                      MOVE LENGTH OF L-TXT-SNI-INQ      TO WS-FLD-LEN
                      MOVE L-TXT-SNI-INQ                TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                    ELSE
                      MOVE LENGTH OF L-TXT-DMV-INQUIRY TO WS-FLD-LEN
                      MOVE L-TXT-DMV-INQUIRY           TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                    END-IF
                  END-IF
               ELSE
                 IF VNR-SELLER-NAME-MATCH-CD = L-I OR
                    VNR-INCMPLT-CD           = L-I
                    MOVE LENGTH OF L-TXT-RECEIVED       TO WS-FLD-LEN
                    MOVE L-TXT-RECEIVED                 TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE VNR-DEPT-RECEIPT-DT          TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE

                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF L-TXT-REL-LIABILITY  TO WS-FLD-LEN
                    MOVE L-TXT-REL-LIABILITY            TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6450-SKIP-A-LINE
                 ELSE


                    MOVE LENGTH OF L-TXT-REG-138      TO WS-FLD-LEN
                    MOVE L-TXT-REG-138                TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    PERFORM 6450-SKIP-A-LINE

                    MOVE LENGTH OF L-TXT-REC-DATE     TO WS-FLD-LEN
                    MOVE L-TXT-REC-DATE               TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    IF VNR-DEPT-RECEIPT-DT   > ZEROS
                      MOVE VNR-DEPT-RECEIPT-DT         TO WS-FORMAT-DT
                      PERFORM 6310-MOVE-FORMATTED-DATE
                    ELSE
                      MOVE LENGTH OF WS-TEST-DATE1      TO WS-FLD-LEN
                      MOVE WS-TEST-DATE1                TO WS-MOVE-FLD
                      PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF

                    MOVE 2 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF L-TXT-TRANSFER-DATE TO WS-FLD-LEN
                    MOVE L-TXT-TRANSFER-DATE          TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE VNR-RPTD-SALE-DT             TO WS-FORMAT-DT
                    PERFORM 6310-MOVE-FORMATTED-DATE

                    IF VNR-PRCHS-PRICE-AMT   > ZEROS
                       MOVE LENGTH OF L-TXT-SELL-PRICE  TO WS-FLD-LEN
                       MOVE L-TXT-SELL-PRICE            TO WS-MOVE-FLD
                       PERFORM 6260-MOVE-TEXT-FIELD
                       MOVE LENGTH OF VNR-PRCHS-PRICE-AMT
                                                        TO WS-FLD-LEN
                       MOVE VNR-PRCHS-PRICE-AMT         TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF

                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TXT-BUYER       TO WS-FLD-LEN
                    MOVE L-TXT-BUYER                 TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE VNR-RPTD-NEW-OWNR-NME
                                                     TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                   TO WS-FLD-LEN
                    MOVE VNR-RPTD-NEW-OWNR-NME         TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-TXT-CAMA        TO WS-FLD-LEN
                    MOVE L-TXT-CAMA                  TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                    MOVE VNR-RPTD-NEW-OWNR-ADDR
                                                     TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                   TO WS-FLD-LEN
                    MOVE VNR-RPTD-NEW-OWNR-ADDR
                                                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE

                    IF VNR-RPTD-NEW-OWNR-CITY-NME         > SPACES
                       MOVE  L-7                     TO WS-BASI
                       PERFORM 6160-MOVE-BASIC-FLDS

                       MOVE VNR-RPTD-NEW-OWNR-CITY-NME
                                                     TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH                   TO WS-FLD-LEN
                       IF VNR-RPTD-NEW-OWNR-STATE-CD > SPACES
                          MOVE VNR-RPTD-NEW-OWNR-STATE-CD TO
                               VNR-RPTD-NEW-OWNR-CITY-NME (14:2)
                          IF VNR-RPTD-NEW-OWNR-STATE-CD (2:1) > SPACES
                             ADD +2                  TO WS-LENGTH
                             MOVE WS-LENGTH          TO WS-FLD-LEN
                          ELSE
                             ADD +1                  TO WS-LENGTH
                             MOVE WS-LENGTH          TO WS-FLD-LEN
                          END-IF
                       END-IF
                       MOVE VNR-RPTD-NEW-OWNR-CITY-NME
                                                     TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       MOVE 03                       TO CTR-SPACES
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                    MOVE LENGTH OF L-TXT-SELLER      TO WS-FLD-LEN
                    MOVE L-TXT-SELLER                TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD

                    EVALUATE VNR-SELLER-NAME-MATCH-CD
                       WHEN ' '
                          MOVE LENGTH OF L-TXT-RL-FORM
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-RL-FORM         TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                       WHEN L-1
                          MOVE LENGTH OF L-TXT-RO-FORM
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-RO-FORM         TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                       WHEN L-2
                          MOVE LENGTH OF L-TXT-LO-FORM
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-LO-FORM         TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                       WHEN L-3
                          MOVE LENGTH OF L-TXT-SAME-BUYER
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-SAME-BUYER      TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                       WHEN L-4
                          MOVE LENGTH OF L-TXT-NOT-SAME-ON-FILE
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-NOT-SAME-ON-FILE TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                       WHEN L-5
                          MOVE LENGTH OF L-TXT-NOT-LEGIBLE
                                                     TO WS-FLD-LEN
                          MOVE L-TXT-NOT-LEGIBLE     TO WS-MOVE-FLD
                          PERFORM 6260-MOVE-TEXT-FIELD
                    END-EVALUATE
                    PERFORM 6450-SKIP-A-LINE

                    MOVE VNR-OVR-8-NOTC-ON-FILE-FLG
                                          TO WS-OVR-8-NTCS-ON-FILE
                    SET OVER-8-NTCS-NOT-WRTEN    TO TRUE
                    IF WS-OVR-8-NTCS-ON-FILE = ZEROS
                       CONTINUE
                    ELSE
                      SET OVER-8-NTCS-WRTEN              TO TRUE
                      MOVE LENGTH OF L-TXT-ADD-RL-HIS    TO WS-FLD-LEN
                      MOVE L-TXT-ADD-RL-HIS              TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                      PERFORM 6150-MOVE-COMMA-TO-OUTPUT
                      PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                      IF SYF-R60-INHOUSE1-REQ-YES OR
                         SYF-R60-INHOUSE2-REQ-YES
                        MOVE LENGTH OF L-TXT-SNI-INQ     TO WS-FLD-LEN
                        MOVE L-TXT-SNI-INQ               TO WS-MOVE-FLD
                        PERFORM 6260-MOVE-TEXT-FIELD
                      ELSE
                        MOVE LENGTH OF L-TXT-DMV-INQUIRY TO WS-FLD-LEN
                        MOVE L-TXT-DMV-INQUIRY           TO WS-MOVE-FLD
                        PERFORM 6260-MOVE-TEXT-FIELD
                      END-IF
                    END-IF
                 END-IF
               END-IF
               PERFORM 6450-SKIP-A-LINE

           END-IF
           .
      /****************************************************************
      * 3030-P-SUB-RECORD
      * FUNCTION:  FORMAT P-SUB RECORD
      *****************************************************************
       3030-P-SUB-RECORD.

           IF VBB-P-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
             IF SYF-R60-COURT1-YES

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-ULS-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VLS-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 3035-SEARCH-VLS-PKT
                UNTIL SEARCH-DONE      OR
                      SW-PKT-SRCH-EXIT OR ERROR-RTN

               IF VLS-LESSEE-REMOVAL-DT  = ZEROS AND NO-ERROR
                 MOVE L-22 TO CTR-LIN
                 PERFORM 6451-SKIP-A-LINE-2-TIMES
                 MOVE LENGTH OF L-TXT-LESSEE-INFO TO  WS-FLD-LEN
                 MOVE L-TXT-LESSEE-INFO           TO  WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 PERFORM 6450-SKIP-A-LINE

                 MOVE LENGTH OF L-TXT-EFF-DATE    TO WS-FLD-LEN
                 MOVE L-TXT-EFF-DATE              TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 MOVE VLS-LESSEE-EFF-DT           TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF L-TXT-CREATION-DATE TO WS-FLD-LEN
                 MOVE L-TXT-CREATION-DATE           TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD

                 IF VLS-CREATE-DT  > ZEROS
                   MOVE VLS-CREATE-DT  TO WS-FORMAT-DT
                   PERFORM 6310-MOVE-FORMATTED-DATE
                   PERFORM 6450-SKIP-A-LINE
                 ELSE
                   MOVE LENGTH OF WS-TEST-DATE1      TO WS-FLD-LEN
                   MOVE WS-TEST-DATE1                TO WS-MOVE-FLD
                   PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                   PERFORM 6450-SKIP-A-LINE
                 END-IF

                 MOVE LENGTH OF L-TXT-NAME    TO WS-FLD-LEN
                 MOVE L-TXT-NAME              TO WS-MOVE-FLD
                 PERFORM 6260-MOVE-TEXT-FIELD
                 MOVE VLS-LESSEE-NME(L-1)
                                              TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VLS-LESSEE-NME(L-1)
                                              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ADD +1                       TO WS-LINE-CNT
                 MOVE LENGTH OF WS-SEP-COMMA  TO WS-FLD-LEN
                 MOVE WS-SEP-COMMA            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 IF VLS-LESSEE-NME(L-2) = SPACES
                    IF VLS-LESSEE-ADDR(L-1) = SPACES
                       CONTINUE
                    ELSE
                       MOVE VLS-LESSEE-ADDR(L-1) TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH            TO WS-FLD-LEN
                       MOVE VLS-LESSEE-ADDR(L-1) TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       IF VLS-LESSEE-ADDR(L-2) = SPACES
                          CONTINUE
                       ELSE
                          PERFORM 6450-SKIP-A-LINE
                          MOVE VLS-LESSEE-ADDR(L-2)
                                                   TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH           TO WS-FLD-LEN
                          MOVE VLS-LESSEE-ADDR(L-2)
                                                   TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                       IF VLS-LESSEE-ADDR(L-3) = SPACES
                          CONTINUE
                       ELSE
                          MOVE LENGTH OF WS-SEP-COMMA
                                                  TO WS-FLD-LEN
                          MOVE WS-SEP-COMMA       TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          MOVE VLS-LESSEE-ADDR(L-3)
                                                  TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH          TO WS-FLD-LEN
                          MOVE VLS-LESSEE-ADDR(L-3)
                                                  TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                    END-IF
                 ELSE
                    MOVE VLS-LESSEE-NME(L-2) TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH               TO WS-FLD-LEN
                    MOVE VLS-LESSEE-NME(L-2) TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                    IF VLS-LESSEE-NME(L-3) = SPACES
                       IF VLS-LESSEE-ADDR(L-1) = SPACES
                          CONTINUE
                       ELSE
                          MOVE VLS-LESSEE-ADDR(L-1)
                                                    TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH            TO WS-FLD-LEN
                          MOVE VLS-LESSEE-ADDR(L-1)
                                                    TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          IF VLS-LESSEE-ADDR(L-2) = SPACES
                             CONTINUE
                          ELSE
                             MOVE LENGTH OF WS-SEP-COMMA
                                                     TO WS-FLD-LEN
                             MOVE WS-SEP-COMMA       TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                             MOVE VLS-LESSEE-ADDR(L-2)
                                                      TO WS-TEST-FIELD
                             PERFORM 6100-FIELD-LENGTH-CAL
                             MOVE WS-LENGTH           TO WS-FLD-LEN
                             MOVE VLS-LESSEE-ADDR(L-2)
                                                      TO WS-MOVE-FLD
                             PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          END-IF
                       END-IF
                    ELSE
                       MOVE VLS-LESSEE-NME(L-3) TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH           TO WS-FLD-LEN
                       MOVE VLS-LESSEE-NME(L-3) TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       IF VLS-LESSEE-ADDR(L-1) = SPACES
                          CONTINUE
                       ELSE
                          MOVE LENGTH OF WS-SEP-COMMA
                                                  TO WS-FLD-LEN
                          MOVE WS-SEP-COMMA       TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          MOVE VLS-LESSEE-ADDR(L-1)
                                                       TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH               TO WS-FLD-LEN
                          MOVE VLS-LESSEE-ADDR(L-1)
                                                       TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                    END-IF
                 END-IF

                 IF VBB-VRC-PRESENT(35)
                   CONTINUE
                 ELSE
                    IF VLS-CITY-NME  = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6450-SKIP-A-LINE
                       MOVE L-7                  TO WS-BASI
                       PERFORM 6160-MOVE-BASIC-FLDS
                       MOVE VLS-CITY-NME  TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH            TO WS-FLD-LEN
                       MOVE VLS-CITY-NME  TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                    IF VLS-COUNTY-CD  = SPACES
                       CONTINUE
                    ELSE
                       MOVE L-8                      TO WS-BASI
                       PERFORM 6160-MOVE-BASIC-FLDS
                       MOVE LENGTH OF VLS-COUNTY-CD  TO WS-FLD-LEN
                       MOVE VLS-COUNTY-CD            TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                    IF VLS-ZIP-CD  = SPACES OR ZEROES
                       CONTINUE
                    ELSE
                       MOVE L-3                      TO WS-BASD
                       MOVE LENGTH OF TBL-LO-FLD(WS-BASD)
                                                     TO WS-FLD-LEN
                       PERFORM 6245-MOVE-LO-FIELD
                       MOVE LENGTH OF VLS-ZIP-CD
                                                     TO WS-FLD-LEN
                       MOVE VLS-ZIP-CD               TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF

                    IF VLS-STATE-CD  = SPACES
                       CONTINUE
                    ELSE
                       MOVE LENGTH OF L-TXT-OS       TO WS-FLD-LEN
                       MOVE L-TXT-OS                 TO WS-MOVE-FLD
                       PERFORM 6260-MOVE-TEXT-FIELD
                       MOVE LENGTH OF VLS-STATE-CD
                                                     TO WS-FLD-LEN
                       MOVE VLS-STATE-CD                TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF
                 END-IF

                 IF VLS-FICHE-DT  > ZEROS
                   IF VBB-VRC-PRESENT(35)
                     PERFORM 6450-SKIP-A-LINE
                   END-IF
                   MOVE LENGTH OF L-TXT-FICHE   TO WS-FLD-LEN
                   MOVE L-TXT-FICHE             TO WS-MOVE-FLD
                   PERFORM 6260-MOVE-TEXT-FIELD
                   MOVE VLS-FICHE-DT            TO WS-FORMAT-DT
                   PERFORM 6310-MOVE-FORMATTED-DATE
                 END-IF
                 PERFORM 6450-SKIP-A-LINE
               END-IF
             END-IF
           END-IF
           .

      /****************************************************************
      * 3035-SEARCH-VLS-PKT
      * FUNCTION:  CALL STRUCTURE MANAGER TO RETRIEVE VLS PACKET
      *****************************************************************
       3035-SEARCH-VLS-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VLS-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              IF VLS-LESSEE-REMOVAL-DT  = ZEROS
                 SET SEARCH-DONE TO TRUE
              END-IF

           END-IF
           .

      /*****************************************************************
      * 3040-FRMT-M-SUB-REC
      * FUNCTION: 'M' SUB RECORD, CLEARANCE INFORMATION RECORDS
      ******************************************************************
       3040-FRMT-M-SUB-REC.

           IF VBB-M-SUB-REC-CNT > 0
             IF VBB-SUB-PLATE
                CONTINUE
             ELSE
                MOVE L-22 TO CTR-LIN
                PERFORM 6451-SKIP-A-LINE-2-TIMES
                PERFORM 6450-SKIP-A-LINE
                MOVE LENGTH OF L-TXT-CL-INFO-RECS   TO WS-FLD-LEN
                MOVE L-TXT-CL-INFO-RECS             TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                PERFORM 6450-SKIP-A-LINE
                MOVE LENGTH OF L-TXT-CL-INFO-LBLS   TO WS-FLD-LEN
                MOVE L-TXT-CL-INFO-LBLS             TO WS-MOVE-FLD
                PERFORM 6260-MOVE-TEXT-FIELD
                PERFORM 3050-MOVE-M-SUB-DATA
                PERFORM 6450-SKIP-A-LINE
             END-IF
           END-IF
           .

      /*****************************************************************
      * 3045-FRMT-QMF
      * FUNCTION: 'E' SUB RECORD, QUAGGA MUSSEL FEE
      ******************************************************************
       3045-FRMT-QMF.

           SET SW-PKT-SRCH-MORE   TO TRUE
           SET SMG-FUNC-READFIRST TO TRUE
           SET SMG-STRUCT-ADS     TO TRUE

           MOVE L-VRC-PKT-ID      TO SMG-PKT-ID

           PERFORM 3045A-FORMAT-E-SUBRECORDS
              UNTIL SW-PKT-SRCH-EXIT
           .

      /*****************************************************************
      * 3045A-FORMAT-E-SUBRECORDS.
      * FUNCTION:
      * FORMATS THE 'E' SUB RECORDS RCC 82 QUAGGA MUSSEL
      ******************************************************************
       3045A-FORMAT-E-SUBRECORDS.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VRC-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              MOVE VRC-REC-COND-CD            TO WS-REC-COND-CD

              IF RCC-82
      *          MOVE VRC82-ADDITIONAL-DATA       TO WS-VRC82-DATA
      *          IF WS-VRC82-QMF-FEE-PD = SPACES
                 IF VRC82-MUSSEL-FEE-PAID-CD = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
      *             IF WS-VRC82-QMF-FEE-PD = 'Y'
                    IF VRC82-MUSSEL-FEE-PAID
                       MOVE LENGTH OF L-QMF-PAID   TO WS-FLD-LEN
                       MOVE L-QMF-PAID             TO WS-MOVE-FLD
                    ELSE
                       MOVE LENGTH OF L-QMF-EXMPT  TO WS-FLD-LEN
                       MOVE L-QMF-EXMPT            TO WS-MOVE-FLD
                    END-IF
                    PERFORM 6260-MOVE-TEXT-FIELD
                 END-IF
              END-IF
           END-IF
           .
      /****************************************************************
      * 3050-MOVE-M-SUB-DATA
      * FUNCTION:  MOVE M-SUB RECORD DATA TO MAP
      *****************************************************************
       3050-MOVE-M-SUB-DATA.

           MOVE   +1    TO WS-SUB
           SET SW-PKT-SRCH-MORE TO TRUE
           SET SMG-FUNC-READFIRST TO TRUE
           SET SMG-STRUCT-ADS TO TRUE

           IF SUSP-RDF-ERR-READ
              MOVE L-UCI-PKT-ID TO SMG-PKT-ID
           ELSE
              MOVE L-VCI-PKT-ID TO SMG-PKT-ID
           END-IF


           PERFORM 3055-SEARCH-VCI-PKT
             UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN
           .

      /****************************************************************
      * 3055-SEARCH-VCI-PKT.
      * FUNCTION: CALL STRUCTURE MANAGER TO RETRIEVE VCI PACKET
      *****************************************************************
       3055-SEARCH-VCI-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VCI-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              PERFORM 6450-SKIP-A-LINE
              MOVE L-1                          TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              MOVE LENGTH OF VCI-OFF-ID         TO WS-FLD-LEN
              MOVE VCI-OFF-ID                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE L-6                          TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-WRK-DT                   TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE L-6                            TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-TECH-ID          TO WS-FLD-LEN
              MOVE VCI-TECH-ID                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE L-7                            TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-SEQ-NBR          TO WS-FLD-LEN
              MOVE VCI-SEQ-NBR                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE L-3                            TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-TRAN-AMT                TO WS-FORMAT-AMT2
              MOVE LENGTH OF WS-FORMAT-AMT2    TO WS-FLD-LEN
              MOVE WS-FORMAT-AMT2              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE L-3                         TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-PRIOR-FICHE-DT                 TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              MOVE L-5                                TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-TYPE-TRAN-CD         TO WS-FLD-LEN
              MOVE VCI-TYPE-TRAN-CD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 04 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VCI-PRIOR-SUSP-RDF-TECH-ID         = SPACES
                 CONTINUE
              ELSE
                PERFORM 6450-SKIP-A-LINE
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-OFF-ID
                                                     TO WS-FLD-LEN
                MOVE VCI-PRIOR-SUSP-RDF-OFF-ID         TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE L-6                             TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                MOVE VCI-PRIOR-SUSP-RDF-WRK-DT         TO WS-FORMAT-DT
                PERFORM 6310-MOVE-FORMATTED-DATE

                MOVE L-6                             TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-TECH-ID
                                                     TO WS-FLD-LEN
                MOVE VCI-PRIOR-SUSP-RDF-TECH-ID
                                                     TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE L-7                             TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-SEQ-NBR
                                                     TO WS-FLD-LEN
                MOVE VCI-PRIOR-SUSP-RDF-SEQ-NBR
                                                     TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE L-3                             TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                MOVE VCI-PRIOR-SUSP-RDF-AMT         TO WS-FORMAT-AMT2
                MOVE LENGTH OF WS-FORMAT-AMT2     TO WS-FLD-LEN
                MOVE WS-FORMAT-AMT2               TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                MOVE L-3                          TO CTR-SPACES
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                MOVE LENGTH OF L-TXT-PRIOR-SUSP   TO WS-FLD-LEN
                MOVE L-TXT-PRIOR-SUSP             TO WS-MOVE-FLD
                PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF
           .

      /*****************************************************************
      * 3060-FRMT-W-SUB-REC
      * FUNCTION: 'W' SUB RECORD - ODOMETER
      ******************************************************************
       3060-FRMT-W-SUB-REC.

           IF VBB-UNACP-WRD  OR
              VBB-ELP-RESV   OR
              VBB-RETENTION

              CONTINUE
           ELSE
              IF VBB-W-SUB-REC-CNT EQUAL TO ZEROS
                 CONTINUE
              ELSE

                 SET SW-PKT-SRCH-MORE   TO TRUE
                 SET SMG-FUNC-READFIRST TO TRUE
                 SET SMG-STRUCT-ADS     TO TRUE
                 SET SW-VMP-NOT-FOUND   TO TRUE

                 IF SUSP-RDF-ERR-READ
                    MOVE L-UMP-PKT-ID TO SMG-PKT-ID
                 ELSE
                    MOVE L-VMP-PKT-ID TO SMG-PKT-ID
                 END-IF

                 MOVE SPACES        TO WS-LAST-VMP-001-READ
                 PERFORM 3065-SEARCH-VMP-PKT
      *            UNTIL SW-VMP-FOUND
                   UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN
      *               OR SW-PKT-SRCH-EXIT OR ERROR-RTN

      *         IF SW-VMP-FOUND
                IF WS-LST-VMP-001-ODOM-DT  > SPACES
                OR WS-LST-VMP-001-ODOM-RDG > SPACES
                   MOVE +1          TO WS-SUB
                   PERFORM 6450-SKIP-A-LINE
                   IF VEH-INFO OR VEH-RO-INFO OR VEH-RO-LO-INFO
                      PERFORM 6450-SKIP-A-LINE
                   END-IF

      *            IF VMP-001-ODOM-DT         EQUAL TO SPACES
                   IF WS-LST-VMP-001-ODOM-DT  EQUAL TO SPACES
                       CONTINUE
                   ELSE
                       SET MMDDCCYY-FRMT            TO TRUE
      *                MOVE VMP-001-ODOM-DT         TO WS-FORMAT-DT
                       MOVE WS-LST-VMP-001-ODOM-DT  TO WS-FORMAT-DT
                       PERFORM 6310-MOVE-FORMATTED-DATE
                   END-IF

      *            IF VMP-001-ODOM-READING         EQUAL TO SPACES
                   IF WS-LST-VMP-001-ODOM-RDG      EQUAL TO SPACES
                       CONTINUE
                   ELSE
                       MOVE LENGTH OF L-TXT-ODOMTR  TO WS-FLD-LEN
                       MOVE L-TXT-ODOMTR            TO WS-MOVE-FLD
                       PERFORM 6260-MOVE-TEXT-FIELD
                       MOVE LENGTH OF WS-VMP-ODOM-READ-QUAN
                                                    TO WS-FLD-LEN
      *                MOVE VMP-001-ODOM-READING    TO
                       MOVE WS-LST-VMP-001-ODOM-RDG TO
                                    WS-VMP-ODOM-READ-QUAN
                       MOVE WS-VMP-ODOM-READ-QUAN   TO
                                    WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
                       COMPUTE WS-STRT  =  WS-STRT + WS-FLD-LEN
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                   END-IF
                   PERFORM 3070-EVAL-ODO-IND-CD
                END-IF
              END-IF
           END-IF
           .

      /****************************************************************
      * 3065-SEARCH-VMP-PKT
      * FUNCTION: CALL STRUCTURE MANAGER TO RETRIEVE VMP PACKET
      *****************************************************************
       3065-SEARCH-VMP-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VMP-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              IF VMP-001-MULT-PURP-CD = 001
      *          SET SW-VMP-FOUND TO TRUE
                 MOVE SPACES              TO WS-LAST-VMP-001-READ
                 MOVE VMP-001-ODOM-DT     TO WS-LST-VMP-001-ODOM-DT
                 MOVE VMP-001-ODOM-READING
                                          TO WS-LST-VMP-001-ODOM-RDG
                 MOVE VMP-001-ODOM-IND    TO WS-LST-VMP-001-ODOM-IND
                 MOVE VMP-001-ODOM-CD     TO WS-LST-VMP-001-ODOM-CD
              END-IF

           END-IF
           .

      /****************************************************************
      * 3070-EVAL-ODO-IND-CD
      * FUNCTION: W-SUB RECORD,ODOMETER.EVALUATES ODOMETER INDICATOR
      *          AND CODE FOR TEXT MESSAGES
      *****************************************************************
       3070-EVAL-ODO-IND-CD.

      *    EVALUATE VMP-001-ODOM-IND
           EVALUATE WS-LST-VMP-001-ODOM-IND
              WHEN 'M'
      *         IF VMP-001-ODOM-CD = 'A'
                IF WS-LST-VMP-001-ODOM-CD = 'A'
                  MOVE LENGTH OF L-TXT-MILES-ACT   TO WS-FLD-LEN
                  MOVE L-TXT-MILES-ACT             TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                ELSE
      *           IF VMP-001-ODOM-CD = 'E'
                  IF WS-LST-VMP-001-ODOM-CD = 'E'
                    MOVE LENGTH OF L-TXT-MILES-EXCD
                                                   TO WS-FLD-LEN
                    MOVE L-TXT-MILES-EXCD          TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                  ELSE
      *             IF VMP-001-ODOM-CD = 'N'
                    IF WS-LST-VMP-001-ODOM-CD = 'N'
                      MOVE LENGTH OF L-TXT-MILES-NOT-ACT
                                                   TO WS-FLD-LEN
                      MOVE L-TXT-MILES-NOT-ACT     TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                    END-IF
                  END-IF
                END-IF
              WHEN OTHER
      *         IF VMP-001-ODOM-CD = 'A'
                IF WS-LST-VMP-001-ODOM-CD = 'A'
                  MOVE LENGTH OF L-TXT-KM-ACT-MIL  TO WS-FLD-LEN
                  MOVE L-TXT-KM-ACT-MIL            TO WS-MOVE-FLD
                  PERFORM 6260-MOVE-TEXT-FIELD
                ELSE
      *           IF VMP-001-ODOM-CD = 'E'
                  IF WS-LST-VMP-001-ODOM-CD = 'E'
                    MOVE LENGTH OF L-TXT-KM-EXCD-MIL TO WS-FLD-LEN
                    MOVE L-TXT-KM-EXCD-MIL           TO WS-MOVE-FLD
                    PERFORM 6260-MOVE-TEXT-FIELD
                  ELSE
      *             IF VMP-001-ODOM-CD = 'N'
                    IF WS-LST-VMP-001-ODOM-CD = 'N'
                      MOVE LENGTH OF L-TXT-KM-NOT-ACT TO WS-FLD-LEN
                      MOVE L-TXT-KM-NOT-ACT           TO WS-MOVE-FLD
                      PERFORM 6260-MOVE-TEXT-FIELD
                    END-IF
                  END-IF
                END-IF
           END-EVALUATE
           MOVE L-22 TO CTR-LIN
           PERFORM 6450-SKIP-A-LINE
           .

      /***************************************************************
      * 3080-FRMT-VLT-STOP-MSGS
      * FUNCTION: VINX FLAGS VERIFICATION FOR VLT/DOJ/STOP/SMOG
      *           MESSAGES.
      ****************************************************************
       3080-FRMT-VLT-STOP-MSGS.

           IF  VINX-STAT-VLT-STOP        OF WS-VINX-PKT(WS-SUB2)
           OR  VINX-STAT-DOJ-STOP-STLN   OF WS-VINX-PKT(WS-SUB2)
           OR  VINX-STAT-DOJ-STOP-REFR   OF WS-VINX-PKT(WS-SUB2)
           OR  VINX-STAT-BAR-SMOG-CERT   OF WS-VINX-PKT(WS-SUB2)
               SET CURR-LIC-HAS-STOP     TO TRUE
           ELSE
               SET CURR-LIC-HAS-NO-STOP  TO TRUE
           END-IF

           MOVE VINX-FILE-KEY-CODE OF WS-VINX-PKT(WS-SUB2)
                                TO WS-VALID-VIN-FILE-CD
           SET VINX-SEARCH-NOT-DONE               TO TRUE
           IF ZERO-TO-FOUR-INFO
              PERFORM 2215-FORMAT-MULT-INS-MSG
              IF  INS-MSG-NOT-WRITTEN
              AND MULT-VIN-MSG-NOT-WRITEN
                 PERFORM 2020-EVAL-VEH-VSL-CD
              END-IF
           END-IF

           IF  VINX-INVAL-KEY OF WS-VINX-PKT(WS-SUB2)
           AND CURR-LIC-HAS-NO-STOP
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-INVALREAD-VINSREST TO WS-FLD-LEN
              MOVE L-INVALREAD-VINSREST           TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD
              PERFORM 6450-SKIP-A-LINE
              SET WRITE-REST-MSG TO TRUE
           ELSE
              IF  VINX-VEH-LIC-NBR OF WS-VINX-PKT(WS-SUB2) > SPACES
              AND VIN-FILE-CD-VALID
              AND PRKY-READY
                 IF  VINX-STAT-VLT-STOP        OF WS-VINX-PKT(WS-SUB2)
                 OR  VINX-STAT-DOJ-STOP-STLN   OF WS-VINX-PKT(WS-SUB2)
                 OR  VINX-STAT-DOJ-STOP-REFR   OF WS-VINX-PKT(WS-SUB2)
                 OR  VINX-STAT-BAR-SMOG-CERT   OF WS-VINX-PKT(WS-SUB2)
                     SET STOP-NOT-WRITTEN      TO TRUE
                 ELSE
                     IF VINX-STAT-SLVG-CERT    OF WS-VINX-PKT(WS-SUB2)
                        PERFORM 6450-SKIP-A-LINE
                        MOVE LENGTH OF L-SAL-CERT       TO WS-FLD-LEN
                        MOVE L-SAL-CERT                 TO WS-MOVE-FLD
                        PERFORM 6260-MOVE-TEXT-FIELD
                        MOVE LENGTH OF VINX-MAKE-OF-VEH
                                OF WS-VINX-PKT(WS-SUB2) TO WS-FLD-LEN
                        MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                        TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6450-SKIP-A-LINE
                        SET WRITE-STOP-MSG SHORT-REPLY  TO TRUE
                     END-IF
                     IF VINX-STAT-OS-LIC-FLG-STOP
                                               OF WS-VINX-PKT(WS-SUB2)
                        PERFORM 6450-SKIP-A-LINE
                        MOVE LENGTH OF L-OUT-OF-STATE-STOP
                                                        TO WS-FLD-LEN
                        MOVE L-OUT-OF-STATE-STOP        TO WS-MOVE-FLD
                        PERFORM 6260-MOVE-TEXT-FIELD
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                        MOVE LENGTH OF VINX-MAKE-OF-VEH
                                OF WS-VINX-PKT(WS-SUB2) TO WS-FLD-LEN
                        MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                        TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                        PERFORM 6450-SKIP-A-LINE
                        SET WRITE-STOP-MSG SHORT-REPLY  TO TRUE
                     END-IF
                 END-IF
              ELSE
                  IF VINX-STAT-VLT-STOP OF WS-VINX-PKT(WS-SUB2)
                     IF SYF-R60-ALLOW-VLT-YES
                        PERFORM 6450-SKIP-A-LINE
                        MOVE LENGTH OF L-TXT-VLT-VIN    TO WS-FLD-LEN
                        MOVE L-TXT-VLT-VIN              TO WS-MOVE-FLD
                        PERFORM 6260-MOVE-TEXT-FIELD
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                        MOVE LENGTH OF VINX-MAKE-OF-VEH
                                OF WS-VINX-PKT(WS-SUB2) TO WS-FLD-LEN
                        MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                        TO WS-MOVE-FLD
                     ELSE
                        MOVE LENGTH OF L-VEHICLE-NOT-REGSTR
                                                        TO WS-FLD-LEN
                        MOVE L-VEHICLE-NOT-REGSTR       TO WS-MOVE-FLD
                     END-IF
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE
                     SET WRITE-STOP-MSG              TO TRUE
                  END-IF

                  IF VINX-STAT-DOJ-STOP-STLN OF WS-VINX-PKT(WS-SUB2)
                     PERFORM 6450-SKIP-A-LINE
                     MOVE LENGTH OF L-TXT-DOJ-STOP   TO WS-FLD-LEN
                     MOVE L-TXT-DOJ-STOP             TO WS-MOVE-FLD
                     PERFORM 6260-MOVE-TEXT-FIELD
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                     MOVE LENGTH OF VINX-MAKE-OF-VEH
                            OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                     MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE
                     SET WRITE-STOP-MSG              TO TRUE
                  END-IF

                  IF VINX-STAT-DOJ-STOP-REFR OF WS-VINX-PKT(WS-SUB2)
                     PERFORM 6450-SKIP-A-LINE
                     MOVE LENGTH OF L-TXT-DOJ-STOP-RFRL TO WS-FLD-LEN
                     MOVE L-TXT-DOJ-STOP-RFRL        TO WS-MOVE-FLD
                     PERFORM 6260-MOVE-TEXT-FIELD
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                     MOVE LENGTH OF VINX-MAKE-OF-VEH
                            OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                     MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE
                     SET WRITE-STOP-MSG              TO TRUE
                  END-IF

                  IF VINX-STAT-BAR-SMOG-CERT OF WS-VINX-PKT(WS-SUB2)
                     PERFORM 6450-SKIP-A-LINE
                     MOVE LENGTH OF L-TXT-ELTRNC-SMOG TO WS-FLD-LEN
                     MOVE L-TXT-ELTRNC-SMOG          TO WS-MOVE-FLD
                     PERFORM 6260-MOVE-TEXT-FIELD
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                     MOVE LENGTH OF VINX-MAKE-OF-VEH
                            OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                     MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE
                     SET WRITE-STOP-MSG              TO TRUE
                  END-IF

                  IF VINX-STAT-OS-LIC-FLG-STOP OF WS-VINX-PKT(WS-SUB2)
                     PERFORM 6450-SKIP-A-LINE
                     MOVE LENGTH OF L-OUT-OF-STATE-STOP
                                                     TO WS-FLD-LEN
                     MOVE L-OUT-OF-STATE-STOP        TO WS-MOVE-FLD
                     PERFORM 6260-MOVE-TEXT-FIELD
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                     MOVE LENGTH OF VINX-MAKE-OF-VEH
                            OF WS-VINX-PKT(WS-SUB2)  TO WS-FLD-LEN
                     MOVE VINX-MAKE-OF-VEH OF WS-VINX-PKT(WS-SUB2)
                                                     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     PERFORM 6450-SKIP-A-LINE
                     SET WRITE-STOP-MSG              TO TRUE
                  END-IF
              END-IF
           END-IF

           IF  VINX-INVAL-KEY OF WS-VINX-PKT(WS-SUB2)
           AND CURR-LIC-HAS-STOP
               SET LICENSE-STOP-ONLY TO TRUE
           END-IF

           IF (WRITE-STOP-MSG AND (LICENSE-SPACES OR LICENSE-STOP-ONLY
           OR  SHORT-REPLY))
           OR (WRITE-REST-MSG AND WS-SUB2 > 1)
              PERFORM 6505-CHECK-NEXT-LIC-SPACE
              PERFORM 5155-FORMAT-WRAPUP
              SET END-OF-FORMAT TO TRUE
              SET MSG-WRITTEN   TO TRUE
              PERFORM 4500-FORMAT-END-BYTES
           END-IF
           .

      /*****************************************************************
      * 4000-FORMAT-ERROR-MSG
      * FUNCTION:
      * FORMATS THE ERROR MESSAGE
      ******************************************************************
       4000-FORMAT-ERROR-MSG.

           IF SYF-R60-SF-COURT-YES AND ZERO-TO-FOUR-INFO
              MOVE LENGTH OF L-TXT-SPECIAL-COURT  TO WS-FLD-LEN
              MOVE L-TXT-SPECIAL-COURT            TO WS-MOVE-FLD
              PERFORM 6260-MOVE-TEXT-FIELD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           MOVE 1 TO WS-SUB
           PERFORM UNTIL ERROR-MSG-SEARCH-DONE OR WS-SUB > 10

             IF ERRO-MSG(WS-SUB) = SPACES
               SET ERROR-MSG-SEARCH-DONE  TO TRUE

             ELSE
               MOVE ERRO-MSG(WS-SUB)      TO WS-TEST-FIELD
               PERFORM 6100-FIELD-LENGTH-CAL
               MOVE WS-LENGTH             TO WS-FLD-LEN
               MOVE ERRO-MSG(WS-SUB)      TO WS-MOVE-FLD
               PERFORM 6300-MOVE-FIELD-TO-OUTPUT
               PERFORM 6450-SKIP-A-LINE
               ADD 1 TO WS-SUB
             END-IF

           END-PERFORM
           .

      /*****************************************************************
      * 4500-FORMAT-END-BYTES
      * FUNCTION:
      * FORMATS THE ENDING APPENDAGES
      ******************************************************************
       4500-FORMAT-END-BYTES.

           IF LAST-MOVE-NOT-SBA
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF MORE-TO-FORMAT

              SET TXT-MORE TO TRUE
              MOVE LENGTH OF WS-END-CHAR    TO WS-FLD-LEN
              MOVE WS-END-CHAR              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-END-OF-MSG   TO WS-FLD-LEN
              MOVE L-END-OF-MSG             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF CTR-WRITE-Q >= WS-MAX-Q-CNT
                 SET ERROR-RTN              TO TRUE
                 SET RC-RF-FAILURE          TO TRUE
                 SET ERHN-ALERT-ONLY(1)     TO TRUE
                 SET EM-RF-MAX-TSQ-CNT-REACHED(1) TO TRUE
                 MOVE WS-TSQ-NAME           TO
                      ERHN-ERR-VARIABLE(1 1)
              ELSE
                 PERFORM 7000-WRITE-TSQ
                 SET LAST-MOVE-END-BYTES     TO TRUE
                 MOVE SPACES                 TO WS-RESP-OUTPUT
                 PERFORM 2100-FORMAT-BEG-BYTES
              END-IF

           ELSE
              IF ERROR-RTN OR RC-RF-RESPONSE-COMPLETE
                 SET TXT-END TO TRUE
              ELSE
                 IF PRKY-KEY-CNT = PRKY-CURR-PTR
                    IF WS-FIL-CD = L-V
                       IF NEXT-IS-VINX-END
                          SET TXT-END TO TRUE
                       ELSE
                          SET TXT-MORE TO TRUE
                       END-IF
                    ELSE
                       SET TXT-END TO TRUE
                    END-IF
                 ELSE
                    SET TXT-MORE TO TRUE
                 END-IF
              END-IF

              MOVE LENGTH OF WS-END-CHAR    TO WS-FLD-LEN
              MOVE WS-END-CHAR              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-END-OF-MSG   TO WS-FLD-LEN
              MOVE L-END-OF-MSG             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF CTR-WRITE-Q >= WS-MAX-Q-CNT
                 SET ERROR-RTN              TO TRUE
                 SET RC-RF-FAILURE          TO TRUE
                 SET ERHN-ALERT-ONLY(1)     TO TRUE
                 SET EM-RF-MAX-TSQ-CNT-REACHED(1) TO TRUE
                 MOVE WS-TSQ-NAME           TO
                      ERHN-ERR-VARIABLE(1 1)
              ELSE
                 PERFORM 7000-WRITE-TSQ
              END-IF

              SET LAST-MOVE-END-BYTES TO TRUE

           END-IF

           .

      /*****************************************************************
      * 5000-FORMAT-BAS-SUB-REC.
      * FUNCTION:FORMAT BASIC AND SUB-RECORDS FOR INFORMATION CODE 8
      ******************************************************************
       5000-FORMAT-BAS-SUB-REC.

           IF NO-ERROR
              PERFORM 5100-FORMAT-BASIC-RECORD
              IF PROCESS-SUBRECORDS
                 PERFORM 5150-FORMAT-SUB-RECORDS
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5100-FORMAT-BASIC-RECORD
      * FUNCTION:FORMAT BASIC RECORD BASED ON TYPE RECORD
      ******************************************************************
       5100-FORMAT-BASIC-RECORD.

           MOVE VBB-TYPE-REC-CD           TO WS-TYPE-RECORD-CD

           EVALUATE TRUE

              WHEN REC-TYP-SUBPL
                   SET DONOT-PROCESS-SUBS TO TRUE
                   PERFORM 5110-FORMAT-SUBPLATE
              WHEN RT-BAS-RET-OWN-SUS-PSE
                   SET PROCESS-SUBRECORDS TO TRUE
                   PERFORM 5115-FORMAT-BASIC

           END-EVALUATE
           .

      /*****************************************************************
      * 5110-FORMAT-SUBPLATE
      * FUNCTION:FORMAT SUBPLATE RECORD
      ******************************************************************
       5110-FORMAT-SUBPLATE.

           MOVE LENGTH OF L-TYP1-HDR1      TO WS-FLD-LEN
           MOVE L-TYP1-HDR1                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF WS-LIC-NUM       TO WS-FLD-LEN
           IF WS-FIL-CD = L-V
              MOVE SPACES                  TO WS-MOVE-FLD
           ELSE
              MOVE VBB-KEY-VEH-VSL-LIC-NBR TO WS-MOVE-FLD
           END-IF
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TYP1-HDR2      TO WS-FLD-LEN
           MOVE L-TYP1-HDR2                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE VBB-REDUCED-SUB-PLT-PURGE-DT TO WS-FORMAT-DT
           MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
           MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-TYP1-HDR3      TO WS-FLD-LEN
           MOVE L-TYP1-HDR3                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           IF VBB-VRC-PRESENT(02)
              PERFORM VARYING WS-PKT FROM 1 BY 1
               UNTIL SUBPLATE-FOUND
                 OR SW-PKT-SRCH-EXIT
                 IF VRC-SUB-PLT-CD
                    MOVE LENGTH OF WS-LIC-NUM  TO WS-FLD-LEN
                    MOVE VRC02-VEH-VSL-LIC-NBR TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    SET SUBPLATE-FOUND TO TRUE
                 ELSE
                    INITIALIZE WS-STRUCT-MGR-PARMS
                    MOVE L-VRC-PKT-ID  TO SMG-PKT-ID
                    SET SMG-STRUCT-ADS TO TRUE
                    SET SMG-FUNC-READ  TO TRUE

                    PERFORM 8000-CALL-STRUCT-MGR

                    IF SMG-SUCCESSFUL
                       SET ADDRESS OF ARG-VRC-PKTS TO SMG-ADDR
                    END-IF
                 END-IF
              END-PERFORM
           ELSE
              MOVE LENGTH OF WS-LIC-NUM TO WS-FLD-LEN
              MOVE SPACES TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           SET END-OF-FORMAT         TO TRUE

           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 5115-FORMAT-BASIC
      * FUNCTION:
      * FORMATS THE BASIC RECORDS '0', '5', '6' AND '7'
      * FORMATS THE FOLLOWING FIELDS FROM BASIC RECORD
      * 1.LICENSE NUMBER          13.FEE
      * 2.TYPE RECORD CODE        14.YEAR MODEL
      * 3.VEHICLE TYPE BODY       15.LAST TRANSACTION DATE
      * 4.TYPE LICENSE            16.REGISTRATION ISSUE DATE
      * 5.VLF CLASS               17.LAST OWNERSHIP DATE
      * 6.PAPER ISSUED CODE       18.NAME ADDRESS
      * 7.LAST TRANSACTION CODE   19.VIN
      * 8.EXPIRATION DATE         20.BODY TYPE MODEL
      * 9.TYPE VEHICLE            21.VEHICLE MAKE
      * 10.R/O COUNTY CODE        22.R/O NAME
      * 11.R/O ZIP CODE           23.R/O NAME/ADDRESS 2ND LINE
      * 12.DATE FIRST SOLD        24.R/O RESIDENCE CITY
      ******************************************************************
       5115-FORMAT-BASIC.

           MOVE 1                        TO WS-BASI
           IF REC-TYP-SUSPENSE
              SET SUSP                   TO TRUE
              PERFORM 6200-MOVE-BASIC-FIELD
              SET LICP                   TO TRUE
              IF SUSP-RDF-ERR-READ
                 MOVE LENGTH OF VBB-KEY     TO WS-FLD-LEN
                 MOVE VBB-KEY               TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-KEY-VEH-VSL-LIC-NBR TO WS-8BYT-LIC
                 MOVE LENGTH OF WS-SUSP-KEY TO WS-FLD-LEN
                 MOVE WS-SUSP-KEY           TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           ELSE
              IF VBB-KEY-VEH-VSL-LIC-NBR = SPACES
                 ADD 1                   TO WS-BASI
              ELSE
                 PERFORM 6200-MOVE-BASIC-FIELD
                 MOVE LENGTH OF VBB-KEY-VEH-VSL-LIC-NBR TO WS-FLD-LEN
                 MOVE VBB-KEY-VEH-VSL-LIC-NBR           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF

           IF VBB-TYPE-REC-CD   = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-TYPE-REC-CD TO WS-FLD-LEN
              MOVE VBB-TYPE-REC-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

              PERFORM 6200-MOVE-BASIC-FIELD
              IF VBB-VSL-HULL-TYPE-CD = SPACES
                 MOVE LENGTH OF VBB-VEH-BODY-TYPE-CD
                                             TO WS-FLD-LEN
                 MOVE VBB-VEH-BODY-TYPE-CD   TO WS-MOVE-FLD
              ELSE
                 MOVE LENGTH OF VBB-VSL-HULL-TYPE-CD
                                             TO WS-FLD-LEN
                 MOVE VBB-VSL-HULL-TYPE-CD   TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-TYPE-LIC-CD     = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-TYPE-LIC-CD TO WS-FLD-LEN
              MOVE VBB-TYPE-LIC-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           PERFORM 6200-MOVE-BASIC-FIELD
           MOVE LENGTH OF VBB-VLF-CLASS-CD TO WS-FLD-LEN
           MOVE VBB-VLF-CLASS-CD           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-LAST-PAPER-ISS-CD = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-LAST-PAPER-ISS-CD TO WS-FLD-LEN
              MOVE VBB-LAST-PAPER-ISS-CD     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-LAST-TRAN-CD      = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-LAST-TRAN-CD          TO WS-LAST-TRAN-CD
              MOVE LENGTH OF WS-LAST-TRAN-CD TO WS-FLD-LEN
              MOVE WS-LAST-TRAN-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-REG-EXPR-DT       = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-REG-EXPR-DT           TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VBB-TYPE-VEH-VSL-CD   = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-TYPE-VEH-VSL-CD   TO WS-FLD-LEN
              MOVE VBB-TYPE-VEH-VSL-CD   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRO-COUNTY-CD    = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VRO-COUNTY-CD TO WS-FLD-LEN
              MOVE VRO-COUNTY-CD         TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRO-ZIP-PLUS4-CD = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VRO-ZIP-CD  TO WS-FLD-LEN
              MOVE VRO-ZIP-CD            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-TYPE-LIC-CD (1:1) =  'N'
              SET BDATE TO TRUE
           END-IF

           IF VBB-VEH-1ST-SOLD-DT = ZEROS
              IF VBB-VSL-PRCHS-DT = ZEROS
                 PERFORM 6200-MOVE-BASIC-FIELD
                 MOVE LENGTH OF VBB-DISABLED-PLACARD-DOB-YMD
                                                 TO WS-FLD-LEN
                 MOVE VBB-DISABLED-PLACARD-DOB-YMD TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 PERFORM 6200-MOVE-BASIC-FIELD
                 MOVE LENGTH OF VBB-VSL-PRCHS-YMD  TO WS-FLD-LEN
                 MOVE VBB-VSL-PRCHS-YMD            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-VEH-1ST-SOLD-YMD TO WS-FLD-LEN
              MOVE VBB-VEH-1ST-SOLD-YMD        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           PERFORM 6200-MOVE-BASIC-FIELD
           MOVE LENGTH OF VBB-TOT-FEE-AMT  TO WS-FLD-LEN
           MOVE VBB-TOT-FEE-AMT            TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           PERFORM 6200-MOVE-BASIC-FIELD
           MOVE LENGTH OF VBB-YR-MDL-YY    TO WS-FLD-LEN
           MOVE VBB-YR-MDL-YY              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-LAST-TRAN-DT  = ZEROS
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-LAST-TRAN-DT           TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-REG-ISS-DT             TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           PERFORM 6200-MOVE-BASIC-FIELD
           MOVE VBB-LAST-OWNR-ISS-DT       TO WS-FORMAT-DT
           MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
           MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VBB-NAME-ADDR-IND          = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE LENGTH OF VBB-NAME-ADDR-IND TO WS-FLD-LEN
              MOVE VBB-NAME-ADDR-IND           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VBB-VIN-OR-HIN-NBR         = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-VIN-OR-HIN-NBR        TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                 TO WS-FLD-LEN
              MOVE VBB-VIN-OR-HIN-NBR     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-BDY-TYP-MDL-CD         = SPACES
              ADD 1                          TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VBB-BDY-TYP-MDL-CD        TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                 TO WS-FLD-LEN
              MOVE VBB-BDY-TYP-MDL-CD        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-VEH-MAKE-NME = SPACES
              AND VBB-VSL-BLDR-NME = SPACES
              ADD 1 TO WS-BASI
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              IF VBB-VEH-MAKE-NME = SPACES
                 MOVE VBB-VSL-BLDR-NME TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH        TO WS-FLD-LEN
                 MOVE VBB-VSL-BLDR-NME TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-VEH-MAKE-NME TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH        TO WS-FLD-LEN
                 MOVE VBB-VEH-MAKE-NME TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VRO-LN-1-NME = SPACES
              ADD 1 TO WS-BASI
           ELSE
              IF WS-FIL-CD   =  L-I
                 SET REG TO TRUE
                 PERFORM 6200-MOVE-BASIC-FIELD
              ELSE
                 PERFORM 6200-MOVE-BASIC-FIELD
              END-IF
              MOVE VRO-LN-1-NME              TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                 TO WS-FLD-LEN
              MOVE VRO-LN-1-NME              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRO-COUNTY-CD = '60'
              EVALUATE TRUE
                 WHEN VRO-RES-LN-1-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME TO VRO-RES-LN-1-ADDR
                 WHEN VRO-RES-LN-2-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME TO VRO-RES-LN-2-ADDR
                 WHEN VRO-RES-LN-3-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME TO VRO-RES-LN-3-ADDR
                 WHEN VRO-RES-LN-4-ADDR = SPACES
                    MOVE VRO-RES-CITY-NME TO VRO-RES-LN-4-ADDR
              END-EVALUATE
           END-IF

           IF VRO-LN-2-NME = SPACES
              IF VRO-RES-LN-1-ADDR   = SPACES
                 ADD 1 TO WS-BASI
              ELSE
                 PERFORM 6200-MOVE-BASIC-FIELD
                 MOVE VRO-RES-LN-1-ADDR      TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRO-RES-LN-1-ADDR      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           ELSE
              PERFORM 6200-MOVE-BASIC-FIELD
              MOVE VRO-LN-2-NME              TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                 TO WS-FLD-LEN
              MOVE VRO-LN-2-NME              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VRO-COUNTY-CD = '60'
              IF VRO-RES-COUNTRY-NME = SPACES
                 AND VRO-RES-STATE-CD = SPACES
                 ADD 1 TO WS-BASI
              ELSE
                 IF VRO-RES-COUNTRY-NME = SPACES
                    PERFORM 6200-MOVE-BASIC-FIELD
                    MOVE LENGTH OF VRO-RES-STATE-CD
                                             TO WS-FLD-LEN
                    MOVE VRO-RES-STATE-CD    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ELSE
                    PERFORM 6200-MOVE-BASIC-FIELD
                    MOVE VRO-RES-COUNTRY-NME    TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH              TO WS-FLD-LEN
                    MOVE VRO-RES-COUNTRY-NME    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           ELSE
              IF VRO-RES-CITY-NME = SPACES
                 ADD 1 TO WS-BASI
              ELSE
                 PERFORM 6200-MOVE-BASIC-FIELD
                 MOVE VRO-RES-CITY-NME       TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRO-RES-CITY-NME       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF

           IF CTR-FLD >       ZERO
           OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           PERFORM 6450-SKIP-A-LINE

      **********************************************************
      * FORMAT RATING LINE INFORMATION
      * FORMATS THE FOLLOWING FIELD:
      * BIRTH DATE
      * DATE OF FIRST SOLD
      * VLF CLASS
      * VEHICLE ASTERIX YEAR
      * AXLE
      * WEIGHT
      **********************************************************

           MOVE LENGTH OF L-RAT-INFO-HDR1    TO WS-FLD-LEN
           MOVE L-RAT-INFO-HDR1              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           IF VBB-TYPE-LIC-CD (1:1) = 'N'
              MOVE LENGTH OF L-RAT-INFO-HDR2 TO WS-FLD-LEN
              MOVE L-RAT-INFO-HDR2           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              IF VBB-VEH-1ST-SOLD-DT = ZEROS
                 MOVE VBB-DISABLED-PLACARD-DOB-DT
                                             TO WS-FORMAT-DT
              ELSE
                 MOVE VBB-VEH-1ST-SOLD-DT    TO WS-FORMAT-DT
              END-IF
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           ELSE
              MOVE 1 TO WS-RATI
              PERFORM 6210-MOVE-RATING-FIELD
              MOVE VBB-VEH-1ST-SOLD-DT       TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              PERFORM 6210-MOVE-RATING-FIELD
              MOVE LENGTH OF VBB-VLF-CLASS-CD TO WS-FLD-LEN
              MOVE VBB-VLF-CLASS-CD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              PERFORM 6210-MOVE-RATING-FIELD
              IF VBB-TYPE-LIC-CD (1:1) = L-V
                 IF VBB-VSL-BUILT-YR  = ZEROS
                    MOVE 3 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF VBB-VSL-BUILT-YY
                                                 TO WS-FLD-LEN
                    MOVE VBB-VSL-BUILT-YY        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              ELSE
                 IF VBB-VEH-ASTRSK-YR = ZEROS
                    MOVE 3 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF VBB-VEH-ASTRSK-YY
                                                 TO WS-FLD-LEN
                    MOVE VBB-VEH-ASTRSK-YY       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF

              PERFORM 6210-MOVE-RATING-FIELD
              MOVE LENGTH OF VBB-AXLE-CNT  TO WS-FLD-LEN
              IF VBB-AXLE-CNT = SPACES
                 MOVE SPACES                  TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-AXLE-CNT            TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              PERFORM 6210-MOVE-RATING-FIELD
              MOVE LENGTH OF VBB-UNLDN-WGT TO WS-FLD-LEN
              IF VBB-UNLDN-WGT = SPACES
                 MOVE SPACES                  TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-UNLDN-WGT           TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

CR8899     PERFORM 6451-SKIP-A-LINE-2-TIMES
      **********************************************************
      * FORMAT GOLDENROD AND TRAILER INFORMATION
      **********************************************************

           MOVE VYP-CA-TITLE-IND          TO WS-CA-TITLE-FLAG
           IF VYP-PLT-TYPE-CD   =  'PT'
              EVALUATE TRUE
              WHEN CA-TITLE-FLAG-Y
                 MOVE LENGTH OF L-PTI-TRLR         TO WS-FLD-LEN
                 MOVE L-PTI-TRLR                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              WHEN CA-TITLE-FLAG-N
                 MOVE LENGTH OF L-GROD-PTI-TRLR    TO WS-FLD-LEN
                 MOVE L-GROD-PTI-TRLR              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              WHEN CA-TITLE-FLAG-U
                 MOVE LENGTH OF L-PTI-TRLR-NOT-VER TO WS-FLD-LEN
                 MOVE L-PTI-TRLR-NOT-VER           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES
           ELSE
              IF CA-TITLE-FLAG-N
                 MOVE LENGTH OF L-GROD             TO WS-FLD-LEN
                 MOVE L-GROD                       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
CR8899           PERFORM 6451-SKIP-A-LINE-2-TIMES
              END-IF
           END-IF

           IF NO-ERROR
              PERFORM 5120-FORMATSUB-RECORD-B
              PERFORM 5125-FORMATSUB-RECORD-C
              PERFORM 5130-FORMATSUB-RECORD-D
           END-IF
           .

      /*****************************************************************
      * 5120-FORMATSUB-RECORD-B.
      * FUNCTION:
      * FORMATS THE FOLLOWING FIELDS OF REGISTERED OWNER
      * (CODE B) SUB RECORD
      * 1. AXLES AND UNLADEN WEIGHT
      * 2. MOTIVE POWER
      * 3. PRORATE OPERATOR NUMBER
      * 4. USE TAX AMOUNT
      * 5. R/O 3RD LINE ADDRESS
      * 6. R/O 4TH LINE ADDRESS
      * 7. EQUIPMENT/MISC/PSG NUMBER
      * 8. VESSEL HULL MATERIAL
      ******************************************************************
       5120-FORMATSUB-RECORD-B.

           MOVE 1 TO WS-BASB
           PERFORM 6220-MOVE-BASICB-FIELD
           MOVE ZERO TO CTR-FLD
           SET SUB-REC-B TO TRUE
           MOVE LENGTH OF WS-SUB-RECORD    TO WS-FLD-LEN
           MOVE WS-SUB-RECORD              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           IF VBB-AXLE-CNT      = SPACES
              AND VBB-UNLDN-WGT = SPACES
              ADD 1 TO WS-BASB
           ELSE
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE LENGTH OF VBB-AXLE-CNT  TO WS-FLD-LEN
              IF VBB-AXLE-CNT  = SPACES
                 MOVE SPACES               TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-AXLE-CNT         TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF VBB-UNLDN-WGT TO WS-FLD-LEN
              IF VBB-UNLDN-WGT = SPACES
                 MOVE SPACES               TO WS-MOVE-FLD
              ELSE
                 MOVE VBB-UNLDN-WGT        TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-VEH-MOTIVE-PWR-CD = SPACES
              IF VBB-VSL-FUEL-CD = SPACES
                 ADD 1 TO WS-BASB
              ELSE
                 PERFORM 6220-MOVE-BASICB-FIELD
                 MOVE LENGTH OF VBB-VSL-FUEL-CD
                                       TO WS-FLD-LEN
                 MOVE VBB-VSL-FUEL-CD  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           ELSE
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE LENGTH OF VBB-VEH-MOTIVE-PWR-CD
                                       TO WS-FLD-LEN
              MOVE VBB-VEH-MOTIVE-PWR-CD TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-ACCOUNT-NBR    = SPACES
              ADD 1 TO WS-BASB
           ELSE
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE LENGTH OF VBB-ACCOUNT-NBR   TO WS-FLD-LEN
              MOVE VBB-ACCOUNT-NBR     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-USE-TAX-CD        = SPACES
              AND VBB-USE-TAX-AMT   = ZEROS
              ADD 1 TO WS-BASB
           ELSE
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE LENGTH OF VBB-USE-TAX-CD  TO WS-FLD-LEN
              MOVE VBB-USE-TAX-CD   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VBB-USE-TAX-AMT TO WS-FLD-LEN
              MOVE VBB-USE-TAX-AMT  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VRO-LN-2-NME = SPACES
              IF VRO-RES-LN-2-ADDR   = SPACES
                 ADD 2 TO WS-BASB
              ELSE
                 PERFORM 6220-MOVE-BASICB-FIELD
                 MOVE VRO-RES-LN-2-ADDR   TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH TO WS-FLD-LEN
                 MOVE VRO-RES-LN-2-ADDR   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 IF VRO-RES-LN-3-ADDR   = SPACES
                    ADD 1 TO WS-BASB
                 ELSE
                    PERFORM 6220-MOVE-BASICB-FIELD
                    MOVE VRO-RES-LN-3-ADDR   TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VRO-RES-LN-3-ADDR   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           ELSE
              IF VRO-LN-3-NME        = SPACES
                 IF VRO-RES-LN-1-ADDR = SPACES
                    ADD 2 TO WS-BASB
                 ELSE
                    PERFORM 6220-MOVE-BASICB-FIELD
                    MOVE VRO-RES-LN-1-ADDR   TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VRO-RES-LN-1-ADDR   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    IF VRO-RES-LN-2-ADDR = SPACES
                       ADD 1 TO WS-BASB
                    ELSE
                       PERFORM 6220-MOVE-BASICB-FIELD
                       MOVE VRO-RES-LN-2-ADDR TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH TO WS-FLD-LEN
                       MOVE VRO-RES-LN-2-ADDR TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF
                 END-IF
              ELSE
                 PERFORM 6220-MOVE-BASICB-FIELD
                 MOVE VRO-LN-3-NME        TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH TO WS-FLD-LEN
                 MOVE VRO-LN-3-NME        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 IF VRO-LN-4-NME        = SPACES
                    IF VRO-RES-LN-1-ADDR = SPACES
                       ADD 1 TO WS-BASB
                    ELSE
                       PERFORM 6220-MOVE-BASICB-FIELD
                       MOVE VRO-RES-LN-1-ADDR TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH TO WS-FLD-LEN
                       MOVE VRO-RES-LN-1-ADDR TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF
                 ELSE
                    PERFORM 6220-MOVE-BASICB-FIELD
                    MOVE VRO-LN-4-NME        TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VRO-LN-4-NME        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VBB-EQP-MISC-PSG-NBR    = SPACES
              ADD 1 TO WS-BASB
           ELSE
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE VBB-EQP-MISC-PSG-NBR     TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH TO WS-FLD-LEN
              MOVE VBB-EQP-MISC-PSG-NBR   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           MOVE VBB-TYPE-VEH-VSL-CD TO WS-TYP-VEHICLE
           IF VBB-VSL-HULL-MAT-CD = SPACES
              MOVE VBB-CGW-GVW-CD TO WS-HULL-CGW-GVW-CD
           ELSE
              MOVE VBB-VSL-HULL-MAT-CD TO WS-HULL-CGW-GVW-CD
           END-IF
           IF VBB-PROPLSN-CD =  SPACES
              MOVE VBB-CVRA-CERT-IND   TO WS-PROPCERT-IND
           ELSE
              MOVE VBB-PROPLSN-CD TO WS-PROPCERT-IND
           END-IF
           IF VBB-GROSS-WGT-HIGHEST-IN-RANGE = SPACES
              MOVE VBB-VSL-LGTH-FT        TO WS-VSL-LTH-FT
              MOVE VBB-VSL-LGTH-INCHS     TO WS-VSL-LTH-INCHS
           ELSE
              MOVE VBB-GROSS-WGT-HIGHEST-IN-RANGE
                                     TO WS-GROSS-WGT-HIGH-RN
           END-IF
           MOVE VBB-CGW-GVW-IND  TO WS-CGW-GVW-IND
           IF WS-VES-GVW-FLD = SPACES
              ADD 1 TO WS-BASB
           ELSE
              IF TYPE-VESSEL
                 SET VES TO TRUE
              END-IF
              PERFORM 6220-MOVE-BASICB-FIELD
              MOVE LENGTH OF WS-VES-GVW-FLD  TO WS-FLD-LEN
              MOVE WS-VES-GVW-FLD   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 5125-FORMATSUB-RECORD-C.
      * FUNCTION:
      * FORMATS THE FOLLOWING FIELDS OF REGISTERED OWNER
      * (CODE C) SUB RECORD
      * 1. ALLOCATED COUNTY
      * 2. CYLINDERS
      * 3. TRAILER SIZE
      * 4. VEHICLE ASTERISK YEAR
      * 5. ENGINE NUMBER
      * 6. MAIL ADDRESS
      * 7. MAIL CITY
      * 8. CERTIFICATION DATE
      ******************************************************************
       5125-FORMATSUB-RECORD-C.

           MOVE 1 TO WS-BASC
           PERFORM 6230-MOVE-BASICC-FIELD
           MOVE ZEROS TO CTR-FLD
           SET SUB-REC-C TO TRUE
           MOVE LENGTH OF WS-SUB-RECORD    TO WS-FLD-LEN
           MOVE WS-SUB-RECORD              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           IF VBB-ALLOC-CNTY-CD = SPACES
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE LENGTH OF VBB-ALLOC-CNTY-CD   TO WS-FLD-LEN
              MOVE VBB-ALLOC-CNTY-CD TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-NBR-OF-CYL-CNT = SPACES
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE LENGTH OF VBB-NBR-OF-CYL-CNT TO WS-FLD-LEN
              MOVE VBB-NBR-OF-CYL-CNT TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-TRLR-LGTH     = ZEROS
           AND VBB-TRLR-WDTH    = ZEROS
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE LENGTH OF VBB-TRLR-LGTH           TO WS-FLD-LEN
              MOVE VBB-TRLR-LGTH           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VBB-TRLR-WDTH TO WS-FLD-LEN
              MOVE VBB-TRLR-WDTH           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VBB-TYPE-LIC-CD (1:1) = L-V
              IF VBB-VSL-BUILT-YR  = ZEROS
                 ADD 1 TO WS-BASC
              ELSE
                 PERFORM 6230-MOVE-BASICC-FIELD
                 MOVE LENGTH OF VBB-VSL-BUILT-YY
                                              TO WS-FLD-LEN
                 MOVE VBB-VSL-BUILT-YY        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           ELSE
              IF VBB-VEH-ASTRSK-YR = ZEROS
                 ADD 1 TO WS-BASC
              ELSE
                 PERFORM 6230-MOVE-BASICC-FIELD
                 MOVE VBB-VEH-ASTRSK-YR       TO WS-FORMAT-CCYY
                 MOVE LENGTH OF WS-FORMAT-YY  TO WS-FLD-LEN
                 MOVE WS-FORMAT-YY            TO WS-MOVE-FLD
                 MOVE LENGTH OF VBB-VEH-ASTRSK-YY
                                              TO WS-FLD-LEN
                 MOVE VBB-VEH-ASTRSK-YY       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF


           IF VBB-ENG-NBR   = SPACES
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE VBB-ENG-NBR TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH   TO WS-FLD-LEN
              MOVE VBB-ENG-NBR TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VRO-MAIL-ADDR    = SPACES
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE VRO-MAIL-ADDR    TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH   TO WS-FLD-LEN
              MOVE VRO-MAIL-ADDR    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRO-MAIL-CITY-NME = SPACES
              ADD 1 TO WS-BASC
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE VRO-MAIL-CITY-NME   TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH   TO WS-FLD-LEN
              MOVE VRO-MAIL-CITY-NME   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VBB-CERT-DT  = ZEROS
              CONTINUE
           ELSE
              PERFORM 6230-MOVE-BASICC-FIELD
              MOVE LENGTH OF VBB-CERT-DT TO WS-FLD-LEN
              MOVE VBB-CERT-DT  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF
           PERFORM 6450-SKIP-A-LINE
           .

      /*****************************************************************
      * 5130-FORMATSUB-RECORD-D.
      * FUNCTION:
      * FORMATS THE FOLLOWING FIELDS OF LEGAL OWNER INFORMATION
      * (CODE D) SUB RECORD
      * 1. L/O NAME
      * 2. L/O NAME/ADDRESS 2ND LINE
      * 3. L/O RESIDENCE CITY
      * 4. L/O 3RD LINE ADDRESS
      * 5. L/O 4TH LINE ADDRESS
      * 6. L/O OUT-OF-STATE
      * 7. L/O ZIP CODE
      * 8. L/O LIENHOLDER PAPERLESS ID
      ******************************************************************
       5130-FORMATSUB-RECORD-D.

           MOVE 1         TO WS-BASD
           PERFORM 6240-MOVE-BASICD-FIELD
           MOVE ZEROS TO CTR-FLD
           SET SUB-REC-D  TO TRUE
           MOVE LENGTH OF WS-SUB-RECORD    TO WS-FLD-LEN
           MOVE WS-SUB-RECORD              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           IF VLO-LN-1-NME = SPACES
              ADD 1       TO WS-BASD
           ELSE
              PERFORM 6240-MOVE-BASICD-FIELD
              MOVE VLO-LN-1-NME            TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH               TO WS-FLD-LEN
              MOVE VLO-LN-1-NME            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VLO-LGL-OWNR-OUT-OF-STATE-IND = '6'
              EVALUATE TRUE
                 WHEN VLO-LN-1-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-1-ADDR
                 WHEN VLO-LN-2-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-2-ADDR
                 WHEN VLO-LN-3-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-3-ADDR
                 WHEN VLO-LN-4-ADDR = SPACES
                    MOVE VLO-CITY-NME TO VLO-LN-4-ADDR
              END-EVALUATE
           END-IF

           IF VLO-LN-2-NME = SPACES
              IF VLO-LN-1-ADDR   = SPACES
                 ADD 1    TO WS-BASD
              ELSE
                 PERFORM 6240-MOVE-BASICD-FIELD
                 MOVE VLO-LN-1-ADDR        TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH            TO WS-FLD-LEN
                 MOVE VLO-LN-1-ADDR        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           ELSE
              PERFORM 6240-MOVE-BASICD-FIELD
              MOVE VLO-LN-2-NME            TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH               TO WS-FLD-LEN
              MOVE VLO-LN-2-NME            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF CTR-FLD >       ZERO
              OR CONT-PRINTER
              MOVE ZERO TO CTR-FLD
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VLO-LGL-OWNR-OUT-OF-STATE-IND = '6'
              IF VLO-COUNTRY-NME   = SPACES
                 AND VLO-STATE-CD  = SPACES
                 ADD 1 TO WS-BASD
              ELSE
                 IF VLO-COUNTRY-NME = SPACES
                    PERFORM 6240-MOVE-BASICD-FIELD
                    MOVE LENGTH OF VLO-STATE-CD TO WS-FLD-LEN
                    MOVE VLO-STATE-CD        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 ELSE
                    PERFORM 6240-MOVE-BASICD-FIELD
                    MOVE VLO-COUNTRY-NME        TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH              TO WS-FLD-LEN
                    MOVE VLO-COUNTRY-NME        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           ELSE
              IF VLO-CITY-NME     = SPACES
                 ADD 1 TO WS-BASD
              ELSE
                 PERFORM 6240-MOVE-BASICD-FIELD
                 MOVE VLO-CITY-NME           TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VLO-CITY-NME           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF

           IF VLO-LN-2-NME = SPACES
              IF VLO-LN-2-ADDR   = SPACES
                 ADD 2 TO WS-BASD
                 IF CTR-FLD >       ZERO
                    OR CONT-PRINTER
                    MOVE ZERO TO CTR-FLD
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              ELSE
                 PERFORM 6240-MOVE-BASICD-FIELD
                 MOVE VLO-LN-2-ADDR        TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH            TO WS-FLD-LEN
                 MOVE VLO-LN-2-ADDR        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
                 IF VLO-LN-3-ADDR   = SPACES
                    ADD 1 TO WS-BASD
                 ELSE
                    PERFORM 6240-MOVE-BASICD-FIELD
                    MOVE VLO-LN-3-ADDR     TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH         TO WS-FLD-LEN
                    MOVE VLO-LN-3-ADDR     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           ELSE
              IF VLO-LN-3-NME = SPACES
                 IF VLO-LN-1-ADDR   = SPACES
                    ADD 1 TO WS-BASD
                    IF CTR-FLD >       ZERO
                       OR CONT-PRINTER
                       MOVE ZERO TO CTR-FLD
                       PERFORM 6450-SKIP-A-LINE
                    END-IF
                 ELSE
                    PERFORM 6240-MOVE-BASICD-FIELD
                    MOVE VLO-LN-1-ADDR     TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH         TO WS-FLD-LEN
                    MOVE VLO-LN-1-ADDR     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                    IF VLO-LN-2-ADDR   = SPACES
                       ADD 1 TO WS-BASD
                    ELSE
                       PERFORM 6240-MOVE-BASICD-FIELD
                       MOVE VLO-LN-2-ADDR  TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH      TO WS-FLD-LEN
                       MOVE VLO-LN-2-ADDR  TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF
                 END-IF
              ELSE
                 PERFORM 6240-MOVE-BASICD-FIELD
                 MOVE VLO-LN-3-NME         TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH            TO WS-FLD-LEN
                 MOVE VLO-LN-3-NME         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
                 IF VLO-LN-4-NME = SPACES
                    IF VLO-LN-1-ADDR = SPACES
                       ADD 1 TO WS-BASD
                    ELSE
                       PERFORM 6240-MOVE-BASICD-FIELD
                       MOVE VLO-LN-1-ADDR  TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH      TO WS-FLD-LEN
                       MOVE VLO-LN-1-ADDR  TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    END-IF
                 ELSE
                    PERFORM 6240-MOVE-BASICD-FIELD
                    MOVE VLO-LN-4-NME         TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH            TO WS-FLD-LEN
                    MOVE VLO-LN-4-NME         TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF
           END-IF

           IF VLO-LGL-OWNR-OUT-OF-STATE-IND = SPACES
              ADD 1 TO WS-BASD
           ELSE
              PERFORM 6240-MOVE-BASICD-FIELD
              MOVE LENGTH OF VLO-LGL-OWNR-OUT-OF-STATE-IND
                                                   TO WS-FLD-LEN
              MOVE VLO-LGL-OWNR-OUT-OF-STATE-IND TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VLO-ZIP-PLUS4-CD = SPACES
              ADD 1 TO WS-BASD
           ELSE
              PERFORM 6240-MOVE-BASICD-FIELD
              MOVE VLO-ZIP-PLUS4-CD        TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH               TO WS-FLD-LEN
              MOVE VLO-ZIP-PLUS4-CD        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VLO-LIENHLDR-PPRLES-ID-NBR = SPACES
           AND VLO-LIENHLDR-PPRLES-ID-DT = ZEROS
              CONTINUE
           ELSE
              PERFORM 6240-MOVE-BASICD-FIELD
              MOVE LENGTH OF VLO-LIENHLDR-PPRLES-ID-NBR
                                                TO WS-FLD-LEN
              MOVE VLO-LIENHLDR-PPRLES-ID-NBR   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VLO-LIENHLDR-PPRLES-ID-DT    TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD   TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF
           .

      /*****************************************************************
      * 5150-FORMAT-SUB-RECORDS
      * FUNCTION:FORMAT SUB-RECORDS
      ******************************************************************
       5150-FORMAT-SUB-RECORDS.

           IF NO-ERROR
                PERFORM 5200-FORMATSUB-RECORD-E
           END-IF
           IF NO-ERROR
                PERFORM 5250-FORMATSUB-RECORD-F
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5300-FORMATSUB-RECORD-G
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5350-FORMATSUB-RECORD-H
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5400-FORMATSUB-RECORD-J
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5450-FORMATSUB-RECORD-K
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5500-FORMATSUB-RECORD-L
           END-IF
           IF RT-BAS-SUB-ELP-RET-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5550-FORMATSUB-RECORD-M
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5600-FORMATSUB-RECORD-N
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5650-FORMATSUB-RECORD-P
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5700-FORMATSUB-RECORD-R
           END-IF
           IF RT-BAS-SUB-ELP-RET-OWN-SUS-PSE
              AND NO-ERROR
                PERFORM 5750-FORMATSUB-RECORD-S
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5800-FORMATSUB-RECORD-T
           END-IF
           IF RT-BAS-SUB-RET-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5850-FORMATSUB-RECORD-U
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5900-FORMATSUB-RECORD-V
           END-IF
           IF RT-BAS-SUB-OWN-SUS-PSE AND NO-ERROR
                PERFORM 5950-FORMATSUB-RECORD-W
           END-IF

           SET END-OF-FORMAT TO TRUE
           SET R60-FORMAT    TO TRUE
           .

      /*****************************************************************
      * 5200-FORMATSUB-RECORD-E.
      * FUNCTION:
      * FORMATS THE 'E' SUB RECORDS
      ******************************************************************
       5200-FORMATSUB-RECORD-E.

           IF VBB-E-SUB-REC-CNT  =  ZERO
              OR CTR-VRC         =  ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              SET SW-PKT-SRCH-MORE   TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS     TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-URC-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VRC-PKT-ID TO SMG-PKT-ID
              END-IF

              MOVE ZERO TO WS-VRC-CNT
              PERFORM 5200A-FORMAT-E-SUBRECORDS
                UNTIL SW-PKT-SRCH-EXIT
                   OR ERROR-RTN

              SET NOT-END-OF-E TO TRUE
           END-IF
           .

      /*****************************************************************
      * 5200A-FORMAT-E-SUBRECORDS.
      * FUNCTION:
      * FORMATS THE 'E' SUB RECORDS
      ******************************************************************
       5200A-FORMAT-E-SUBRECORDS.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VRC-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              IF WS-VRC-CNT < CTR-VRC
                 ADD 1 TO WS-VRC-CNT
              END-IF

              MOVE VRC-REC-COND-CD            TO WS-REC-COND-CD

      * DISPALY E-65 IF LINE FROM RAD1 OR CRU1
              IF  RCC-65
                  IF SYF-R60-PRIV-LINE2-YES
                  OR SYF-R60-PRIV-LINE4-YES
                     SET DISPLAY-E65      TO TRUE
                  ELSE
                     SET DONT-DISPLAY-E65 TO TRUE
                  END-IF
              END-IF

              IF DONT-DISPLAY-E65
                 SET DISPLAY-E65      TO TRUE
              ELSE
                 IF WS-VRC-CNT = 01
                    MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
                    MOVE L-SUB                   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    SET SUB-REC-E TO TRUE
                    MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
                    MOVE WS-SUB-RECORD           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
CR8899           IF WS-VRC-CNT = 1
                    PERFORM 6450-SKIP-A-LINE
CR8899           ELSE
CR8899              PERFORM 6451-SKIP-A-LINE-2-TIMES
CR8899           END-IF
                 PERFORM 5205-FORMATE-REC-COND-CD
              END-IF

           END-IF
           .

      /*****************************************************************
      * 5205-FORMATE-REC-COND-CD
      * FUNCTION:
      * FORMATS THE 'E' SUB RECORDS
      ******************************************************************
       5205-FORMATE-REC-COND-CD.

           MOVE LENGTH OF L-RCC            TO WS-FLD-LEN
           MOVE L-RCC                      TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VRC-REC-COND-CD  TO WS-FLD-LEN
           MOVE VRC-REC-COND-CD            TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           MOVE VRC-REC-COND-CD            TO WS-REC-COND-CD

           IF RCC-79 OR RCC-80 OR RCC-82
              CONTINUE
           ELSE
              MOVE LENGTH OF L-RCD            TO WS-FLD-LEN
              MOVE L-RCD                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC-REC-COND-DT            TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           EVALUATE TRUE

              WHEN RCC-33
                   PERFORM 5210-FORMATE-RCC-33
              WHEN RCC-36
                   PERFORM 5215-FORMATE-RCC-36
              WHEN RCC-44
                   PERFORM 5220-FORMATE-RCC-44
              WHEN RCC-46
                   PERFORM 5225-FORMATE-RCC-46
              WHEN RCC-48
                   PERFORM 5230-FORMATE-RCC-48
              WHEN RCC-69
                   PERFORM 5235-FORMATE-RCC-69
              WHEN RCC-79 OR RCC-80
                   PERFORM 5240-FORMATE-RCC-79-80
              WHEN RCC-82
                   PERFORM 5245-FORMATE-RCC-82
              WHEN OTHER
                   PERFORM 5249-FORMATE-RCC-COMMON

           END-EVALUATE
           .

      /*****************************************************************
      * 5210-FORMATE-RCC-33.
      * FUNCTION:
      * FORMATS THE 'E-33' SUB RECORD
      ******************************************************************
       5210-FORMATE-RCC-33.

           IF VRC33-REASON-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-RSN          TO WS-FLD-LEN
              MOVE L-RSN                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC33-REASON-CD
                                            TO WS-FLD-LEN
              MOVE VRC33-REASON-CD
                                            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRC33-UNIT-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-UNT       TO WS-FLD-LEN
              MOVE L-UNT                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC33-UNIT-CD
                                            TO WS-FLD-LEN
              MOVE VRC33-UNIT-CD
                                            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

CR8668     IF VRC33-HONOR-NOTHING-DT = ZEROS
CR8668        CONTINUE
CR8668     ELSE
              MOVE LENGTH OF L-HND            TO WS-FLD-LEN
              MOVE L-HND                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC33-HONOR-NOTHING-DT
                                              TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
CR8668     END-IF

           IF VRC33-SURR-OF-TITLE-STATE-CD  = SPACES
              CONTINUE
           ELSE
              IF VRC33-SURR-OF-TITLE-STATE-CD  = 'VS'
                 MOVE LENGTH OF L-NTF          TO WS-FLD-LEN
                 MOVE L-NTF                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC33-SURR-OF-TITLE-STATE-CD
                                               TO WS-FLD-LEN
                 MOVE VRC33-SURR-OF-TITLE-STATE-CD
                                               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF L-SUR-CRA      TO WS-FLD-LEN
                 MOVE L-SUR-CRA                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC33-SURR-OF-TITLE-STATE-CD
                                               TO WS-FLD-LEN
                 MOVE VRC33-SURR-OF-TITLE-STATE-CD
                                               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD          TO WS-FLD-LEN
              MOVE L-ADD                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5215-FORMATE-RCC-36.
      * FUNCTION:
      * FORMATS THE 'E-36' SUB RECORD
      ******************************************************************
       5215-FORMATE-RCC-36.

           IF VRC36-REASON-CD  = SPACES
              CONTINUE
           ELSE
              IF VRC36-REASON-CD  EQUAL TO '01'
                 MOVE LENGTH OF L-DVE          TO WS-FLD-LEN
                 MOVE L-DVE                    TO WS-MOVE-FLD
              ELSE
                 MOVE LENGTH OF L-RSN          TO WS-FLD-LEN
                 MOVE L-RSN                    TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC36-REASON-CD
                                               TO WS-FLD-LEN
              MOVE VRC36-REASON-CD             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRC36-UNIT-CD   = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-UNT          TO WS-FLD-LEN
              MOVE L-UNT                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC36-UNIT-CD
                                            TO WS-FLD-LEN
              MOVE VRC36-UNIT-CD
                                            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

CR8668     IF VRC36-HONOR-NOTHING-DT = ZEROS
CR8668        CONTINUE
CR8668     ELSE
              MOVE LENGTH OF L-HND          TO WS-FLD-LEN
              MOVE L-HND                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC36-HONOR-NOTHING-DT
                                              TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
CR8668     END-IF

           IF VRC36-SURR-OF-TITLE-STATE-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-SUR-CRA      TO WS-FLD-LEN
              MOVE L-SUR-CRA                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC36-SURR-OF-TITLE-STATE-CD
                                            TO WS-FLD-LEN
              MOVE VRC36-SURR-OF-TITLE-STATE-CD
                                            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD          TO WS-FLD-LEN
              MOVE L-ADD                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5220-FORMATE-RCC-44.
      * FUNCTION:
      * FORMATS THE 'E-44' SUB RECORD
      ******************************************************************
       5220-FORMATE-RCC-44.

           IF VRC44-UNIT-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-SPC             TO WS-FLD-LEN
              MOVE L-SPC                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC44-UNIT-CD
                                               TO WS-FLD-LEN
              MOVE VRC44-UNIT-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRC44-SURR-OF-TITLE-STATE-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-CV              TO WS-FLD-LEN
              MOVE L-CV                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC44-SURR-OF-TITLE-STATE-CD
                                               TO WS-FLD-LEN
              MOVE VRC44-SURR-OF-TITLE-STATE-CD
                                               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD             TO WS-FLD-LEN
              MOVE L-ADD                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5225-FORMATE-RCC-46.
      * FUNCTION:
      * FORMATS THE 'E-46' SUB RECORD
      ******************************************************************
       5225-FORMATE-RCC-46.

           IF VRC46-REASON-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-SMG-CD          TO WS-FLD-LEN
              MOVE L-SMG-CD                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC46-REASON-CD
                                               TO WS-FLD-LEN
              MOVE VRC46-REASON-CD
                                               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VRC46-REASON-CD  = '04'
                 MOVE LENGTH OF L-SMG-DU    TO WS-FLD-LEN
                 MOVE L-SMG-DU              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRC46-HONOR-NOTHING-DT
                                            TO WS-FORMAT-DT
                 MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
                 MOVE WS-FRMAT-DAT-YMD      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 CONTINUE
              END-IF
              IF VRC46-SURR-OF-TITLE-STATE-CD  = SPACES
                 CONTINUE
              ELSE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-SMG-TY    TO WS-FLD-LEN
                 MOVE L-SMG-TY              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC46-SURR-OF-TITLE-STATE-CD
                                            TO WS-FLD-LEN
                 MOVE VRC46-SURR-OF-TITLE-STATE-CD
                                            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD             TO WS-FLD-LEN
              MOVE L-ADD                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5230-FORMATE-RCC-48.
      * FUNCTION:
      * FORMATS THE 'E-48' SUB RECORD
      ******************************************************************
       5230-FORMATE-RCC-48.

           IF VRC48-REASON-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-CIT             TO WS-FLD-LEN
              MOVE L-CIT                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC48-REASON-CD
                                               TO WS-FLD-LEN
              MOVE VRC48-REASON-CD             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

           IF VRC48-UNIT-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-UNT             TO WS-FLD-LEN
              MOVE L-UNT                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC48-UNIT-CD
                                               TO WS-FLD-LEN
              MOVE VRC48-UNIT-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

CR8668     IF VRC48-HONOR-NOTHING-DT = ZEROS
CR8668        CONTINUE
CR8668     ELSE
              MOVE LENGTH OF L-HND             TO WS-FLD-LEN
              MOVE L-HND                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC48-HONOR-NOTHING-DT
                                               TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD  TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
CR8668     END-IF

           IF VRC48-SURR-OF-TITLE-STATE-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-SUR-CRA         TO WS-FLD-LEN
              MOVE L-SUR-CRA                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC48-SURR-OF-TITLE-STATE-CD
                                               TO WS-FLD-LEN
              MOVE VRC48-SURR-OF-TITLE-STATE-CD
                                               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD             TO WS-FLD-LEN
              MOVE L-ADD                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5235-FORMATE-RCC-69.
      * FUNCTION:
      * FORMATS THE 'E-69' SUB RECORD
      ******************************************************************
       5235-FORMATE-RCC-69.

           IF VRC69-REASON-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-PNO-TY          TO WS-FLD-LEN
              MOVE L-PNO-TY                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC69-REASON-CD
                                               TO WS-FLD-LEN
              MOVE VRC69-REASON-CD             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD             TO WS-FLD-LEN
              MOVE L-ADD                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5240-FORMATE-RCC-79-80.
      * FUNCTION:
      * FORMATS THE 'E-79' AND 'E-80' SUB RECORDS
      ******************************************************************
       5240-FORMATE-RCC-79-80.

           IF VRC-REC-COND-DT  = ZEROS
              IF VRC-REASON-CD  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-RSN          TO WS-FLD-LEN
                 MOVE L-RSN                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC-REASON-CD
                                               TO WS-FLD-LEN
                 MOVE VRC-REASON-CD            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

CR8668        IF VRC-UNIT-CD    = SPACES
CR8668           CONTINUE
CR8668        ELSE
                 MOVE LENGTH OF L-UNT             TO WS-FLD-LEN
                 MOVE L-UNT                       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC-UNIT-CD
                                               TO WS-FLD-LEN
                 MOVE VRC-UNIT-CD                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
CR8668        END-IF

CR8668        IF VRC-HONOR-NOTHING-DT = ZEROS
CR8668           CONTINUE
CR8668        ELSE
                 MOVE LENGTH OF L-HND            TO WS-FLD-LEN
                 MOVE L-HND                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRC-HONOR-NOTHING-DT
                                                 TO WS-FORMAT-DT
                 MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
                 MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
CR8668           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRC-SURR-OF-TITLE-STATE-CD  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-SUR-CRA       TO WS-FLD-LEN
                 MOVE L-SUR-CRA                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC-SURR-OF-TITLE-STATE-CD
                                                 TO WS-FLD-LEN
                 MOVE VRC-SURR-OF-TITLE-STATE-CD
                                                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

           ELSE
              IF RCC-79
                 MOVE LENGTH OF L-GRS-POLL-REN TO WS-FLD-LEN
                 MOVE L-GRS-POLL-REN           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              IF RCC-80
                 MOVE LENGTH OF L-TST-ONLY-REQ TO WS-FLD-LEN
                 MOVE L-TST-ONLY-REQ           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
              MOVE LENGTH OF L-RCD            TO WS-FLD-LEN
              MOVE L-RCD                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC-REC-COND-DT            TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              IF RCC-80
                 MOVE LENGTH OF L-TST-ONLY-TYP   TO WS-FLD-LEN
                 MOVE L-TST-ONLY-TYP             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRC80-REASON-CD
                                                 TO WS-FLD-LEN
                 MOVE VRC80-REASON-CD            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 IF VRC80-REASON-CD  = L-01
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-TST-ANNU-INS TO WS-FLD-LEN
                    MOVE L-TST-ANNU-INS           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF
                    VRC80-SURR-OF-TITLE-STATE-CD
                                                  TO WS-FLD-LEN
                    MOVE VRC80-SURR-OF-TITLE-STATE-CD
                                                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-IF
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD             TO WS-FLD-LEN
              MOVE L-ADD                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
           END-IF
           .

      /*****************************************************************
      * 5245-FORMATE-RCC-82.
      * FUNCTION:
      * FORMATS THE 'E-82' SUB RECORD
      ******************************************************************
       5245-FORMATE-RCC-82.

           IF VRC82-REC-COND-CD       = SPACES
              CONTINUE
           ELSE
             IF WS-FIL-CD             = L-B
                PERFORM 5245-A-FORMATE-QMF-FEE
             ELSE
                PERFORM 5249-FORMATE-RCC-COMMON
             END-IF
           END-IF
           .

      /*****************************************************************
      * 5245-A-FORMATE-QMF-FEE.
      * FUNCTION:
      * FORMATS THE QUAGGA MUSSEL FEE (E-82) SUB RECORD
      ******************************************************************
       5245-A-FORMATE-QMF-FEE.

           PERFORM 6450-SKIP-A-LINE
           MOVE LENGTH OF L-QMF             TO WS-FLD-LEN
           MOVE L-QMF                       TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
   *       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
   *       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
   *       PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF VRC82-MUSSEL-FEE-PAID-CD
                                            TO WS-FLD-LEN
           MOVE VRC82-MUSSEL-FEE-PAID-CD    TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-QMF-DT          TO WS-FLD-LEN
           MOVE L-QMF-DT                    TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VRC82-MUSSEL-FEE-PAID-DT
                                            TO WS-FLD-LEN
           MOVE VRC82-MUSSEL-FEE-PAID-DT    TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           .

      /*****************************************************************
      * 5249-FORMATE-RCC-COMMON.
      * FUNCTION:
      * FORMATS THE FOLLOWING FOR SUB-RECORDS OTHER THAN ABOVE
      * 1. REASON CODE
      * 2. UNIT CODE
      * 3. HONOR NOTHING DATE
      * 4. SUR OF TITLE
      * 5. ADDITIONAL DATA
      ******************************************************************
       5249-FORMATE-RCC-COMMON.

           IF VRC-REASON-CD  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-RSN             TO WS-FLD-LEN
              MOVE L-RSN                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC-REASON-CD
                                               TO WS-FLD-LEN
              MOVE VRC-REASON-CD               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           END-IF

CR8668     IF VRC-UNIT-CD    = SPACES
744408        IF RCC-26
744408           MOVE LENGTH OF L-UNT          TO WS-FLD-LEN
744408           MOVE L-UNT                    TO WS-MOVE-FLD
744408           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
744408           MOVE LENGTH OF VRC-UNIT-CD
744408                                         TO WS-FLD-LEN
744408           MOVE VRC-UNIT-CD              TO WS-MOVE-FLD
744408           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
744408           PERFORM 6400-MOVE-SPACE-TO-OUTPUT
744408        END-IF
CR8668     ELSE
              IF RCC-65
                 MOVE LENGTH OF L-DEP          TO WS-FLD-LEN
                 MOVE L-DEP                    TO WS-MOVE-FLD
              ELSE
                 MOVE LENGTH OF L-UNT          TO WS-FLD-LEN
                 MOVE L-UNT                    TO WS-MOVE-FLD
              END-IF

              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRC-UNIT-CD
                                               TO WS-FLD-LEN
              MOVE VRC-UNIT-CD                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
CR8668     END-IF


CR8668     IF VRC-HONOR-NOTHING-DT = ZEROS
CR8668        CONTINUE
CR8668     ELSE
              MOVE LENGTH OF L-HND            TO WS-FLD-LEN
              MOVE L-HND                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRC-HONOR-NOTHING-DT
                                              TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
CR8668     END-IF

           IF VRC-SURR-OF-TITLE-STATE-CD  = SPACES
              CONTINUE
           ELSE
              IF RCC-19
                 IF VRC-SURR-OF-TITLE-STATE-CD  = 'NC'
                    MOVE LENGTH OF L-NCO-FL        TO WS-FLD-LEN
                    MOVE L-NCO-FL                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VRC-SURR-OF-TITLE-STATE-CD
                                                    TO WS-FLD-LEN
                    MOVE VRC-SURR-OF-TITLE-STATE-CD
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              ELSE
                 IF RCC-03
                    MOVE LENGTH OF L-SUR           TO WS-FLD-LEN
                    MOVE L-SUR                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VRC-SURR-OF-TITLE-STATE-CD
                                                   TO WS-FLD-LEN
                    MOVE VRC-SURR-OF-TITLE-STATE-CD
                                                   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF L-SUR-CRA       TO WS-FLD-LEN
                    MOVE L-SUR-CRA                 TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VRC-SURR-OF-TITLE-STATE-CD
                                                    TO WS-FLD-LEN
                    MOVE VRC-SURR-OF-TITLE-STATE-CD
                                                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-IF
           END-IF

           IF VRC-ADDITIONAL-DATA-UNFRMT  = SPACES
CR8899        CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-ADD       TO WS-FLD-LEN
              MOVE L-ADD                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              IF RCC-64
                 PERFORM 6285-MOVE-ADDL-DATA-TO-OUT-E64
              ELSE
                 PERFORM 6280-MOVE-ADDL-DATA-TO-OUT
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5250-FORMATSUB-RECORD-F.
      * FUNCTION:
      * FORMATS THE FOLLOWING FIELDS OF 'F' SUB RECORDS
      * 1.SUFIX
      * 2.VIN
      * 3.MAKE
      ******************************************************************
       5250-FORMATSUB-RECORD-F.

           IF VBB-F-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB TO WS-FLD-LEN
              MOVE L-SUB              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-F TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


              MOVE 01 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UPO-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VPO-PKT-ID TO SMG-PKT-ID
              END-IF


              PERFORM 5260-SEARCH-VPO-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN
           END-IF
           .

      /***************************************************************
      * 5260-SEARCH-VPO-PKT.
      * FUNCTION: CALL STRUCTURE MANAGER TO RETRIEVE VPO PACKET
      ****************************************************************
       5260-SEARCH-VPO-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VPO-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
CR8899        PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-SUF TO WS-FLD-LEN
              MOVE L-SUF                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VPO-OWNR-PLT-SUFFIX-CD
                                        TO WS-FLD-LEN
              MOVE VPO-OWNR-PLT-SUFFIX-CD
                                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-VIN TO WS-FLD-LEN
              MOVE L-VIN                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VPO-LAST3-VIN-NBR
                                        TO WS-FLD-LEN
              MOVE VPO-LAST3-VIN-NBR
                                        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-MAK TO WS-FLD-LEN
              MOVE L-MAK                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VPO-MAKE-NME          TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH            TO WS-FLD-LEN
              MOVE VPO-MAKE-NME          TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


           END-IF
           .

      /*****************************************************************
      * 5300-FORMATSUB-RECORD-G.
      * FUNCTION:
      * FORMATS THE FOLLOWING FIELDS OF 'G' SUB RECORDS
      * 1.CITATION NUMBER
      * 2.VIOLATION DATE
      * 3.COURT CODE
      * 4.BAIL AMOUNT
      * 5.POT PRINT IND
      * 6.DISPOSITION IND
      * 7.BILL IND
      * 8.DISPOSITON DATE
      * 9.DATE OF ADDITION
      ******************************************************************
       5300-FORMATSUB-RECORD-G.

           IF VBB-G-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-G TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-UPV         TO WS-FLD-LEN
              MOVE L-UPV                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VBB-G-SUB-REC-CNT
                                           TO WS-FLD-LEN
              MOVE VBB-G-SUB-REC-CNT       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-GHDR1       TO WS-FLD-LEN
              MOVE L-GHDR1                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-GHDR2       TO WS-FLD-LEN
              MOVE L-GHDR2                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE 01 TO WS-PKT
              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UPC-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VPC-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5310-SEARCH-VPC-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /****************************************************************
      * 5310-SEARCH-VPC-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VPC PACKET
      *****************************************************************
       5310-SEARCH-VPC-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VPC-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ      TO TRUE

              MOVE LENGTH OF VPC-CITATION-NBR
                                     TO WS-FLD-LEN
              MOVE VPC-CITATION-NBR  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VPC-VIOL-DT       TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VPC-COURT-CD
                                     TO WS-FLD-LEN
              MOVE VPC-COURT-CD      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VPC-BAIL-AMT
                                     TO WS-FLD-LEN
              MOVE VPC-BAIL-AMT      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VPC-POT-PRINT-IND  = SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 SET POT-PRT-PRES TO TRUE
                 MOVE LENGTH OF WS-PRT-IND
                                     TO WS-FLD-LEN
                 MOVE WS-PRT-IND     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VPC-DISPOSITION-IND  = SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF VPC-DISPOSITION-IND
                                           TO WS-FLD-LEN
                 MOVE VPC-DISPOSITION-IND  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VPC-BILLING-IND  = SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 SET BILL-IND-PRES TO TRUE
                 MOVE LENGTH OF WS-BILL-IND
                                  TO WS-FLD-LEN
                 MOVE WS-BILL-IND TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VPC-PLT-XREF7-NBR  = SPACES
                 MOVE LENGTH OF VPC-PLT-XREF7-NBR
                                              TO WS-FLD-LEN
                 MOVE VBB-KEY-VEH-VSL-LIC-NBR TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              ELSE
                 MOVE LENGTH OF VPC-PLT-XREF7-NBR
                                              TO WS-FLD-LEN
                 MOVE VPC-PLT-XREF-NBR  (2:7) TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VPC-DISPOSITION-DT  = ZEROS
                 MOVE 09 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              ELSE
                 MOVE VPC-DISPOSITION-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VPC-ADDITION-DT  = ZEROS
                 CONTINUE
              ELSE
                 MOVE VPC-ADDITION-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF SMG-PKT-CNT > WS-PKT
                 PERFORM 6450-SKIP-A-LINE
              END-IF

              ADD +1 TO WS-PKT
           END-IF
           .

      /*****************************************************************
      * 5350-FORMATSUB-RECORD-H.
      * FUNCTION:
      * FORMATS THE HISTORY SUB-RECORDS
      ******************************************************************
       5350-FORMATSUB-RECORD-H.

           IF VBB-H-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-H TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

               PERFORM VARYING WS-SUBH FROM 1 BY 1 UNTIL NO-MORE-DATES
                 OR WS-SUBH > 15

                 IF (VNH-OPTIONAL-DEPT-RECEIPT-DT(WS-SUBH) > ZEROS
                    OR VNH-DEPT-RECEIPT-DT > ZEROS)
                    AND  (WS-SUBH = 01)


                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-REC-DT         TO WS-FLD-LEN
                    MOVE L-REC-DT                   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF WS-SUBH = 1
                    MOVE VNH-DEPT-RECEIPT-DT        TO WS-FORMAT-DT
                    MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
                    MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 IF WS-SUBH = 8
                    PERFORM 6450-SKIP-A-LINE
                    MOVE 01                         TO CTR-SPACES
                 ELSE
                    MOVE 02                         TO CTR-SPACES
                 END-IF

                 IF VNH-OPTIONAL-DEPT-RECEIPT-DT(WS-SUBH) = ZEROS
                    SET NO-MORE-DATES               TO TRUE
                    MOVE 01                         TO CTR-SPACES
                 ELSE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE VNH-OPTIONAL-DEPT-RECEIPT-DT(WS-SUBH)
                                                    TO WS-FORMAT-DT
                    MOVE LENGTH OF WS-FRMAT-DAT-YMD TO WS-FLD-LEN
                    MOVE WS-FRMAT-DAT-YMD           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-PERFORM
           END-IF
           .

      /*****************************************************************
      * 5400-FORMATSUB-RECORD-J.
      * FUNCTION:
      * FORMATS THE 'J' SUB RECORDS
      ******************************************************************
       5400-FORMATSUB-RECORD-J.

           IF VBB-J-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-J TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE 1 TO WS-PKT
              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UNR-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VNR-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5410-SEARCH-VNR-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /*****************************************************************
      * 5410-SEARCH-VNR-PKT.
      * FUNCTION:
      * CALL THE STRUCTURE MANAGER TO RETRIEVE VNR PACKET
      ******************************************************************
       5410-SEARCH-VNR-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VNR-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              MOVE LENGTH OF L-RCD         TO WS-FLD-LEN
              MOVE L-RCD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VNR-DEPT-RECEIPT-DT          TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-TRD         TO WS-FLD-LEN
              MOVE L-TRD                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VNR-RPTD-SALE-DT             TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VNR-DLR-NOTC-OF-PRCHS-CD  = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-DLR         TO WS-FLD-LEN
                 MOVE L-DLR                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VNR-DLR-NOTC-OF-PRCHS-CD
                                              TO WS-FLD-LEN
                 MOVE VNR-DLR-NOTC-OF-PRCHS-CD
                                              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-SELL-PR TO WS-FLD-LEN
              MOVE L-SELL-PR                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VNR-PRCHS-PRICE-AMT
                                            TO WS-FLD-LEN
              MOVE VNR-PRCHS-PRICE-AMT  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

MWDCM3        IF VNR-SELLER-NAME-MATCH-CD          =  'P'
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 IF VNR-RPTD-NEW-OWNR-NME  = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-NAM          TO WS-FLD-LEN
                    MOVE L-NAM                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE VNR-RPTD-NEW-OWNR-NME
                                                  TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VNR-RPTD-NEW-OWNR-NME
                                                     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 PERFORM 6450-SKIP-A-LINE

                 IF VNR-RPTD-NEW-OWNR-ADDR  = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-ADR          TO WS-FLD-LEN
                    MOVE L-ADR                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE VNR-RPTD-NEW-OWNR-ADDR
                                                  TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VNR-RPTD-NEW-OWNR-ADDR
                                                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE 02 TO CTR-SPACES
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 IF VNR-RPTD-NEW-OWNR-CITY-NME  = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-CIT-STAT TO WS-FLD-LEN
                    MOVE L-CIT-STAT                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE VNR-RPTD-NEW-OWNR-CITY-NME
                                               TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VNR-RPTD-NEW-OWNR-CITY-NME
                                               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VNR-RPTD-NEW-OWNR-STATE-CD  = SPACES
                       CONTINUE
                    ELSE
                       MOVE VNR-RPTD-NEW-OWNR-STATE-CD
                                                  TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH TO WS-FLD-LEN
                       MOVE VNR-RPTD-NEW-OWNR-STATE-CD
                                                  TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF
              END-IF

              IF VBB-H-SUB-REC-CNT     = ZERO
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-NOTE-TRAN1 TO WS-FLD-LEN
                 MOVE L-NOTE-TRAN1               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF L-NOTE-TRAN2 TO WS-FLD-LEN
                 MOVE L-NOTE-TRAN2               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              PERFORM 6450-SKIP-A-LINE

              PERFORM 5445-SUB-RECORD-J-MSG

              IF SMG-PKT-CNT > WS-PKT
CR8899           PERFORM 6451-SKIP-A-LINE-2-TIMES
              END-IF
              ADD +1 TO WS-PKT

           END-IF
           .

      /*****************************************************************
      * 5445-SUB-RECORD-J-MSG
      * FUNCTION: READS CODE TABLE TO GET SUB RECORD J MESSAGE
      ******************************************************************
       5445-SUB-RECORD-J-MSG.

           MOVE SPACES                  TO WS-KEY
           SET  DA-READ-FNC             TO TRUE
           SET  SUB-RECORD-J-MSG        TO TRUE
           MOVE VNR-SELLER-NAME-MATCH-CD
                                        TO CODE-TBL-KEY-DATA
           MOVE CODE-TBL-KEY-DATA       TO WS-KEY-DATA
           MOVE CODE-TABLE-NAME         TO WS-TABLE-NAME

           PERFORM 7500-CALL-CODE-TBL-DA

           EVALUATE TRUE

                 WHEN ERHN-CALL-OKAY
                      SET ADDRESS OF ARG-RAW-DB-RCD TO DA-DATA-POINTER
                      MOVE RDB-CTB-DATA1-TRANS-TEXT TO WS-JMSG
                      MOVE LENGTH OF WS-JMSG       TO WS-FLD-LEN
                      MOVE WS-JMSG                 TO WS-MOVE-FLD
                      PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 WHEN RC-REC-NOT-FOUND
                      CONTINUE

                 WHEN OTHER
                      SET EM-RF-DB2-CODE-TBL-FAIL (1) TO TRUE
                      MOVE DA-SQLCODE                 TO WS-SQLCODE
                      MOVE WS-SQL-CODE                TO
                           ERHN-ERR-VARIABLE (1 1)
                      PERFORM 8910-SET-ALERT

           END-EVALUATE
           .

      /*****************************************************************
      * 5450-FORMATSUB-RECORD-K.
      * FUNCTION:
      * FORMATS THE 'K' SUB RECORDS
      ******************************************************************
       5450-FORMATSUB-RECORD-K.

           IF VBB-K-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-K TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-DATE        TO WS-FLD-LEN
              MOVE L-DATE                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VSA-SITUS-ADDR-DT       TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VSA-SITUS-COUNTY-CD = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-CTY         TO WS-FLD-LEN
                 MOVE L-CTY                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VSA-SITUS-COUNTY-CD TO WS-FLD-LEN
                 MOVE VSA-SITUS-COUNTY-CD       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VSA-SITUS-CITY-NME = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-CITY        TO WS-FLD-LEN
                 MOVE L-CITY                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VSA-SITUS-CITY-NME      TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VSA-SITUS-CITY-NME      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              PERFORM 6450-SKIP-A-LINE

              IF VSA-SITUS-ADDR    = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-SITUS       TO WS-FLD-LEN
                 MOVE L-SITUS                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VSA-SITUS-ADDR          TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VSA-SITUS-ADDR          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5500-FORMATSUB-RECORD-L.
      * FUNCTION:
      * FORMATS THE 'L' SUB RECORDS
      ******************************************************************
       5500-FORMATSUB-RECORD-L.

           IF VBB-L-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-L TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE ZERO TO WS-SUB
              PERFORM 6270-MOVE-SUBL-FIELD
              MOVE VFP-CREATE-DT           TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              PERFORM 6270-MOVE-SUBL-FIELD
              MOVE VFP-CLEARANCE-DT        TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              PERFORM 6270-MOVE-SUBL-FIELD
              MOVE LENGTH OF VFP-CLEARANCE-NBR   TO WS-FLD-LEN
              MOVE VFP-CLEARANCE-NBR       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VFP-CLEARANCE-SUB-NBR  = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-CLEARANCE-SUB-NBR TO WS-FLD-LEN
                 MOVE VFP-CLEARANCE-SUB-NBR   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF



              IF VFP-REG-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-REG-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-REG-FEE-AMT         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-VLF-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-VLF-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-VLF-FEE-AMT         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-WGT-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-WGT-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-WGT-FEE-AMT         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-PEN-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-PEN-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-PEN-FEE-AMT         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-01-SERV-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-01-SERV-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-01-SERV-FEE-AMT     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-02-FEE-AMT     = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-02-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-02-FEE-AMT          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-03-ELP-OHV-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-03-ELP-OHV-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-03-ELP-OHV-FEE-AMT  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-04-CIT-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH OF VFP-04-CIT-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-04-CIT-FEE-AMT      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-05-RFLCTRZE-LIC-FEE-AMT = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH VFP-05-RFLCTRZE-LIC-FEE-AMT TO WS-FLD-LEN
                 MOVE VFP-05-RFLCTRZE-LIC-FEE-AMT TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF


              IF VFP-REG-OWNR-NME            = SPACES
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE

                 MOVE LENGTH OF L-NAM         TO WS-FLD-LEN
                 MOVE L-NAM                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE VFP-REG-OWNR-NME        TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH               TO WS-FLD-LEN
                 MOVE VFP-REG-OWNR-NME        TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF


              IF VFP-USE-TAX-CD              = SPACES
                 ADD 1 TO WS-SUB
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH VFP-USE-TAX-CD   TO WS-FLD-LEN
                 MOVE VFP-USE-TAX-CD          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-USE-TAX-AMT             = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH VFP-USE-TAX-AMT  TO WS-FLD-LEN
                 MOVE VFP-USE-TAX-AMT         TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-REFUND-DT               = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE VFP-REFUND-DT           TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-REFUND-AMT              = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH VFP-REFUND-AMT TO WS-FLD-LEN
                 MOVE VFP-REFUND-AMT       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFP-REFUND-ORDR-NBR         = ZEROS
                 ADD 1 TO WS-SUB
              ELSE
                 PERFORM 6270-MOVE-SUBL-FIELD
                 MOVE LENGTH VFP-REFUND-ORDR-NBR TO WS-FLD-LEN
                 MOVE VFP-REFUND-ORDR-NBR     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5550-FORMATSUB-RECORD-M.
      * FUNCTION:
      * FORMATS THE 'M' SUB RECORDS
      ******************************************************************
       5550-FORMATSUB-RECORD-M.

           IF VBB-M-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
              PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-M TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-CLE-INFO TO WS-FLD-LEN
              MOVE L-CLE-INFO                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-MHDR1         TO WS-FLD-LEN
              MOVE L-MHDR1                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-MHDR2         TO WS-FLD-LEN
              MOVE L-MHDR2                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


              MOVE 1 TO WS-PKT
              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UCI-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VCI-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5560-FORMAT-VCI-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /****************************************************************
      * 5560-FORMAT-VCI-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VCI PACKET AND FORMAT TO
      * OUTPUT
      *****************************************************************
       5560-FORMAT-VCI-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VCI-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
CR8899        PERFORM 6450-SKIP-A-LINE

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-OFF-ID  TO WS-FLD-LEN
              MOVE VCI-OFF-ID                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 06 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-WRK-DT                 TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 06 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-TECH-ID  TO WS-FLD-LEN
              MOVE VCI-TECH-ID                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 07 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-SEQ-NBR  TO WS-FLD-LEN
              MOVE VCI-SEQ-NBR                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-TRAN-AMT                 TO WS-FORMAT-AMT2
              MOVE LENGTH OF WS-FORMAT-AMT2     TO WS-FLD-LEN
              MOVE WS-FORMAT-AMT2               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VCI-PRIOR-FICHE-DT             TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VCI-TYPE-TRAN-CD
                                             TO WS-FLD-LEN
              MOVE VCI-TYPE-TRAN-CD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 04 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VCI-PRIOR-SUSP-RDF-TECH-ID  = SPACES
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE

                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-OFF-ID
                                                TO WS-FLD-LEN
                 MOVE VCI-PRIOR-SUSP-RDF-OFF-ID
                                                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 06 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE VCI-PRIOR-SUSP-RDF-WRK-DT
                                                      TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE

                 MOVE 06 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-TECH-ID
                                                TO WS-FLD-LEN
                 MOVE VCI-PRIOR-SUSP-RDF-TECH-ID
                                                       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 07 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF VCI-PRIOR-SUSP-RDF-SEQ-NBR
                                                TO WS-FLD-LEN
                 MOVE VCI-PRIOR-SUSP-RDF-SEQ-NBR
                                                       TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE VCI-PRIOR-SUSP-RDF-AMT
                                                   TO WS-FORMAT-AMT2
                 MOVE LENGTH OF WS-FORMAT-AMT2     TO WS-FLD-LEN
                 MOVE WS-FORMAT-AMT2               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 MOVE LENGTH OF L-PRI-SUS          TO WS-FLD-LEN
                 MOVE L-PRI-SUS                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                 MOVE 06 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              END-IF


           END-IF
           .

      /*****************************************************************
      * 5600-FORMATSUB-RECORD-N.
      * FUNCTION:
      * FORMATS THE 'N' SUB RECORDS
      ******************************************************************
       5600-FORMATSUB-RECORD-N.

           IF VBB-N-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-N TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-FEE-REC TO WS-FLD-LEN
              MOVE L-FEE-REC               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VFD-FEES-RECV-DT      TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VFD-LAST-TRANSFER-DT = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-LST-TRA TO WS-FLD-LEN
                 MOVE L-LST-TRA               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VFD-LAST-TRANSFER-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 MOVE 04 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              MOVE LENGTH OF L-NUM-TRN TO WS-FLD-LEN
              MOVE L-NUM-TRN               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              MOVE LENGTH OF VFD-NBR-OF-TRANSFER-CNT TO WS-FLD-LEN
              MOVE VFD-NBR-OF-TRANSFER-CNT TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VFD-PURCHASE-DT = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-PUR-DT       TO WS-FLD-LEN
                 MOVE L-PUR-DT                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VFD-PURCHASE-DT       TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF

              PERFORM 6450-SKIP-A-LINE

              IF VFD-PURCHASE-PRICE-AMT = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-PRIC         TO WS-FLD-LEN
                 MOVE L-PRIC                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VFD-PURCHASE-PRICE-AMT TO WS-FLD-LEN
                 MOVE VFD-PURCHASE-PRICE-AMT  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFD-DEALER-NBR  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-DLR-NUM TO WS-FLD-LEN
                 MOVE L-DLR-NUM                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VFD-DEALER-NBR TO WS-FLD-LEN
                 MOVE VFD-DEALER-NBR          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFD-SPECIAL-1-IND = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-SP-IND1 TO WS-FLD-LEN
                 MOVE L-SP-IND1                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VFD-SPECIAL-1-IND TO WS-FLD-LEN
                 MOVE VFD-SPECIAL-1-IND           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFD-CNO-DT      = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-CNO         TO WS-FLD-LEN
                 MOVE L-CNO                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VFD-CNO-DT            TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF


              IF VFD-REPO-DT     = ZEROS
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-REPO        TO WS-FLD-LEN
                 MOVE L-REPO                  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VFD-REPO-DT           TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFD-ENG-CHG-DT  = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-ENG-CHG TO WS-FLD-LEN
                 MOVE L-ENG-CHG               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VFD-ENG-CHG-DT        TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 MOVE 03 TO CTR-SPACES
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VFD-SPECIAL-2-IND = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-SP-IND2 TO WS-FLD-LEN
                 MOVE L-SP-IND2                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VFD-SPECIAL-2-IND TO WS-FLD-LEN
                 MOVE VFD-SPECIAL-2-IND           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF


              IF VFD-ADDL-DATA = SPACES
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-ADD          TO WS-FLD-LEN
                 MOVE L-ADD                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VFD-ADDL-DATA  TO WS-FLD-LEN
                 MOVE VFD-ADDL-DATA            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5650-FORMATSUB-RECORD-P.
      * FUNCTION:
      * FORMATS THE 'P' SUB RECORDS
      ******************************************************************
       5650-FORMATSUB-RECORD-P.

           IF VBB-P-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-P TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-PHDR1       TO WS-FLD-LEN
              MOVE L-PHDR1                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 1 TO  WS-PKT
              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-ULS-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VLS-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5660-FORMAT-VLS-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN
           END-IF
           .

      /****************************************************************
      * 5660-FORMAT-VLS-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VLS PACKET AND FORMAT TO
      * OUTPUT
      *****************************************************************
       5660-FORMAT-VLS-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VLS-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF L-EFF-DT TO WS-FLD-LEN
              MOVE L-EFF-DT                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VLS-LESSEE-EFF-DT             TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-CRE-DT TO WS-FLD-LEN
              MOVE L-CRE-DT                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VLS-CREATE-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VLS-LESSEE-REMOVAL-DT  = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-REM-DT TO WS-FLD-LEN
                 MOVE L-REM-DT                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VLS-LESSEE-REMOVAL-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-NAM            TO WS-FLD-LEN
              MOVE L-NAM                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VLS-LESSEE-NME(L-1)
                                           TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH                  TO WS-FLD-LEN
              MOVE VLS-LESSEE-NME(L-1)
                                           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF WS-SEP-COMMA     TO WS-FLD-LEN
              MOVE WS-SEP-COMMA               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              IF VLS-LESSEE-NME(L-2) = SPACES
                 IF VLS-LESSEE-ADDR(L-1) = SPACES
                    CONTINUE
                 ELSE
                    MOVE VLS-LESSEE-ADDR(L-1) TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                      TO WS-FLD-LEN
                    MOVE VLS-LESSEE-ADDR(L-1) TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VLS-LESSEE-ADDR(L-2) = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6450-SKIP-A-LINE
                       MOVE VLS-LESSEE-ADDR(L-2)
                                                TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH              TO WS-FLD-LEN
                       MOVE VLS-LESSEE-ADDR(L-2)
                                                TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                    IF VLS-LESSEE-ADDR(L-3) = SPACES
                       CONTINUE
                    ELSE
                       MOVE LENGTH OF WS-SEP-COMMA
                                               TO WS-FLD-LEN
                       MOVE WS-SEP-COMMA          TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       MOVE VLS-LESSEE-ADDR(L-3)
                                               TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH             TO WS-FLD-LEN
                       MOVE VLS-LESSEE-ADDR(L-3)
                                               TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                 END-IF
              ELSE
                 MOVE VLS-LESSEE-NME(L-2) TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                  TO WS-FLD-LEN
                 MOVE VLS-LESSEE-NME(L-2) TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
                 IF VLS-LESSEE-NME(L-3) = SPACES
                    IF VLS-LESSEE-ADDR(L-1) = SPACES
                       CONTINUE
                    ELSE
                       MOVE VLS-LESSEE-ADDR(L-1)
                                                 TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH               TO WS-FLD-LEN
                       MOVE VLS-LESSEE-ADDR(L-1)
                                                 TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       IF VLS-LESSEE-ADDR(L-2) = SPACES
                          CONTINUE
                       ELSE
                          MOVE LENGTH OF WS-SEP-COMMA
                                                  TO WS-FLD-LEN
                          MOVE WS-SEP-COMMA          TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                          MOVE VLS-LESSEE-ADDR(L-2)
                                                   TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH              TO WS-FLD-LEN
                          MOVE VLS-LESSEE-ADDR(L-2)
                                                   TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                    END-IF
                 ELSE
                    MOVE VLS-LESSEE-NME(L-3) TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH              TO WS-FLD-LEN
                    MOVE VLS-LESSEE-NME(L-3) TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VLS-LESSEE-ADDR(L-1) = SPACES
                       CONTINUE
                    ELSE
                       MOVE LENGTH OF WS-SEP-COMMA
                                               TO WS-FLD-LEN
                       MOVE WS-SEP-COMMA          TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       MOVE VLS-LESSEE-ADDR(L-1)
                                                    TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH                  TO WS-FLD-LEN
                       MOVE VLS-LESSEE-ADDR(L-1)
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                 END-IF
              END-IF


              IF PEACE-OFF-ADDR-YES
                 CONTINUE
              ELSE
                 IF VLS-CITY-NME  = SPACES
                    CONTINUE
                 ELSE
CR8899              PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-CITY        TO WS-FLD-LEN
                    MOVE L-CITY                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE VLS-CITY-NME  TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH               TO WS-FLD-LEN
                    MOVE VLS-CITY-NME  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 IF VLS-COUNTY-CD  = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-CNTY        TO WS-FLD-LEN
                    MOVE L-CNTY                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VLS-COUNTY-CD
                                              TO WS-FLD-LEN
                    MOVE VLS-COUNTY-CD             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                    MOVE LENGTH OF L-ZIP         TO WS-FLD-LEN
                    MOVE L-ZIP                   TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VLS-ZIP-CD  TO WS-FLD-LEN
                    MOVE VLS-ZIP-CD                TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 END-IF

                 IF VLS-STATE-CD  = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE LENGTH OF L-OS             TO WS-FLD-LEN
                    MOVE L-OS                       TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF VLS-STATE-CD
                                                 TO     WS-FLD-LEN
                    MOVE VLS-STATE-CD               TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-IF

              IF VLS-FICHE-DT  = ZEROS
                 CONTINUE
              ELSE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-FICHE          TO WS-FLD-LEN
                 MOVE L-FICHE                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VLS-FICHE-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
              END-IF

              IF VLS-COND-CD  = ZEROS
                 AND VLS-COND-DT  = ZEROS
                 CONTINUE
              ELSE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-RCC            TO WS-FLD-LEN
                 MOVE L-RCC                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VLS-COND-CD  TO WS-FLD-LEN
                 MOVE VLS-COND-CD              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-DATE           TO WS-FLD-LEN
                 MOVE L-DATE                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VLS-COND-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF


           END-IF
           .

      /*****************************************************************
      * 5700-FORMATSUB-RECORD-R.
      * FUNCTION:
      * FORMATS THE 'R' SUB RECORDS
      ******************************************************************
       5700-FORMATSUB-RECORD-R.

           IF VBB-R-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE

              PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE 0 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-URH-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VRH-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5710-SEARCH-VRH-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

            END-IF
            .

      /*****************************************************************
      * 5710-SEARCH-VRH-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VRH PACKET
      ******************************************************************
       5710-SEARCH-VRH-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VRH-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
              ADD +1 TO WS-PKT
CR8899        IF WS-PKT = +1
CR8899           CONTINUE
CR8899        ELSE
CR8899           PERFORM 6451-SKIP-A-LINE-2-TIMES
CR8899        END-IF

              MOVE LENGTH OF L-SUB            TO WS-FLD-LEN
              MOVE L-SUB                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-R TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD              TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-PROC           TO WS-FLD-LEN
              MOVE L-PROC                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VRH-PROC-YR-JLN-DT  TO WS-FORMAT-CCYYJJJ
              MOVE LENGTH OF WS-FORMAT-YYJJJ     TO WS-FLD-LEN
              MOVE WS-FORMAT-YYJJJ               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-OFLO           TO WS-FLD-LEN
              MOVE L-OFLO                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-OVRFLW-IND
                                           TO WS-FLD-LEN
              MOVE VRH-OVRFLW-IND             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              IF VRH-MULT-TRANSFER-IND  = SPACES
                 CONTINUE
              ELSE
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-MTI            TO WS-FLD-LEN
                 MOVE L-MTI                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VRH-MULT-TRANSFER-IND
                                              TO WS-FLD-LEN
                 MOVE VRH-MULT-TRANSFER-IND  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-DLT            TO WS-FLD-LEN
              MOVE L-DLT                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-LAST-TRANSFER-YMD
                                               TO WS-FLD-LEN
              MOVE VRH-LAST-TRANSFER-YMD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-DOI             TO WS-FLD-LEN
              MOVE L-DOI                       TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-OWNR-ISS-YMD
                                            TO WS-FLD-LEN
              MOVE VRH-OWNR-ISS-YMD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-DRI            TO WS-FLD-LEN
              MOVE L-DRI                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-REG-ISS-YMD
                                           TO WS-FLD-LEN
              MOVE VRH-REG-ISS-YMD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-HRC            TO WS-FLD-LEN
              MOVE L-HRC                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-HIST-RSN-CD
                                           TO WS-FLD-LEN
              MOVE VRH-HIST-RSN-CD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-HRD            TO WS-FLD-LEN
              MOVE L-HRD                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-HIST-RSN-CD-YMD
                                           TO WS-FLD-LEN
              MOVE VRH-HIST-RSN-CD-YMD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE LENGTH OF L-NAI            TO WS-FLD-LEN
              MOVE L-NAI                      TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VRH-NAME-ADDR-IND
                                           TO WS-FLD-LEN
              MOVE VRH-NAME-ADDR-IND  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


              IF VRH-REG-OWNR-NME(L-1) = SPACES
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-NAM            TO WS-FLD-LEN
                 MOVE L-NAM                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-REG-OWNR-NME(L-1) TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                  TO WS-FLD-LEN
                 MOVE VRH-REG-OWNR-NME(L-1) TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              END-IF

              IF VRH-REG-OWNR-NME(L-2) = SPACES
                 IF VRH-REG-OWNR-ADDR(L-1) = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF L-2NA            TO WS-FLD-LEN
                    MOVE L-2NA                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE VRH-REG-OWNR-ADDR(L-1)
                                                 TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH                  TO WS-FLD-LEN
                    MOVE VRH-REG-OWNR-ADDR(L-1)
                                                 TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VRH-REG-OWNR-ADDR(L-2) = SPACES
                       CONTINUE
                    ELSE
CR8899                 PERFORM 6450-SKIP-A-LINE
                       MOVE LENGTH OF L-3NA            TO WS-FLD-LEN
                       MOVE L-3NA                      TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       MOVE VRH-REG-OWNR-ADDR(L-2)
                                                    TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH              TO WS-FLD-LEN
                       MOVE VRH-REG-OWNR-ADDR(L-2)
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                    IF VRH-REG-OWNR-ADDR(L-3) = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       MOVE LENGTH OF L-4AD       TO WS-FLD-LEN
                       MOVE L-4AD                 TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       MOVE VRH-REG-OWNR-ADDR(L-3)
                                               TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH             TO WS-FLD-LEN
                       MOVE VRH-REG-OWNR-ADDR(L-3)
                                               TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                 END-IF
              ELSE
                 MOVE LENGTH OF L-2NA            TO WS-FLD-LEN
                 MOVE L-2NA                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-REG-OWNR-NME(L-2) TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH                  TO WS-FLD-LEN
                 MOVE VRH-REG-OWNR-NME(L-2) TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 IF VRH-REG-OWNR-NME(L-3) = SPACES
                    IF VRH-REG-OWNR-ADDR(L-1) = SPACES
                       CONTINUE
                    ELSE
CR8899                 PERFORM 6450-SKIP-A-LINE
                       MOVE LENGTH OF L-3NA            TO WS-FLD-LEN
                       MOVE L-3NA                      TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       MOVE VRH-REG-OWNR-ADDR(L-1)
                                                    TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH                  TO WS-FLD-LEN
                       MOVE VRH-REG-OWNR-ADDR(L-1)
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       IF VRH-REG-OWNR-ADDR(L-2) = SPACES
                          CONTINUE
                       ELSE
                          PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                          MOVE LENGTH OF L-4AD        TO WS-FLD-LEN
                          MOVE L-4AD                  TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          MOVE VRH-REG-OWNR-ADDR(L-2)
                                                   TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH              TO WS-FLD-LEN
                          MOVE VRH-REG-OWNR-ADDR(L-2)
                                                TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                    END-IF
                 ELSE
CR8899              PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-3NA            TO WS-FLD-LEN
                    MOVE L-3NA                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE VRH-REG-OWNR-NME(L-3)
                                                 TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH              TO WS-FLD-LEN
                    MOVE VRH-REG-OWNR-NME(L-3)
                                                 TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VRH-REG-OWNR-ADDR(L-1) = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                       MOVE LENGTH OF L-4AD            TO WS-FLD-LEN
                       MOVE L-4AD                      TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       MOVE VRH-REG-OWNR-ADDR(L-1)
                                                    TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH                  TO WS-FLD-LEN
                       MOVE VRH-REG-OWNR-ADDR(L-1)
                                                    TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                 END-IF
              END-IF


              IF VRH-REG-OWNR-CITY-NME  = SPACES
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-CITY           TO WS-FLD-LEN
                 MOVE L-CITY                     TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-REG-OWNR-CITY-NME
                                              TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRH-REG-OWNR-CITY-NME
                                              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF


              IF VRH-LEGAL-OWNR-NME  = SPACES
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-LONAM          TO WS-FLD-LEN
                 MOVE L-LONAM                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-LEGAL-OWNR-NME  TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRH-LEGAL-OWNR-NME  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF

              IF VRH-LEGAL-OWNR-ADDR  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-LOADR          TO WS-FLD-LEN
                 MOVE L-LOADR                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-LEGAL-OWNR-ADDR  TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRH-LEGAL-OWNR-ADDR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF


              IF VRH-LEGAL-OWNR-CITY-NME  = SPACES
                 CONTINUE
              ELSE
CR8899           PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-LOCTY          TO WS-FLD-LEN
                 MOVE L-LOCTY                    TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE VRH-LEGAL-OWNR-CITY-NME
                                              TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH              TO WS-FLD-LEN
                 MOVE VRH-LEGAL-OWNR-CITY-NME
                                              TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-IF


           END-IF
           .

      /*****************************************************************
      * 5750-FORMATSUB-RECORD-S.
      * FUNCTION:
      * FORMATS THE 'S' SUB RECORDS
      ******************************************************************
       5750-FORMATSUB-RECORD-S.

           IF VBB-S-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-S TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-SHDR1       TO WS-FLD-LEN
              MOVE L-SHDR1                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-SHDR2       TO WS-FLD-LEN
              MOVE L-SHDR2                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 1 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UMG-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VMG-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5760-SEARCH-VMG-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /*****************************************************************
      * 5760-SEARCH-VMG-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VMG PACKET
      ******************************************************************
       5760-SEARCH-VMG-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VMG-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
CR8899        PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF VMG-VEH-VSL-LIC-NBR
                                           TO WS-FLD-LEN
              MOVE VMG-VEH-VSL-LIC-NBR  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VMG-TYPE-TRAN-CD
                                           TO WS-FLD-LEN
              MOVE VMG-TYPE-TRAN-CD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VMG-TRAN-DT  TO WS-FORMAT-DT
              MOVE LENGTH OF WS-FRMAT-DAT-YMD
                                        TO WS-FLD-LEN
              MOVE WS-FRMAT-DAT-YMD        TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VMG-CARTRIDGE-NBR
                                        TO WS-FLD-LEN
              MOVE VMG-CARTRIDGE-NBR  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VMG-FRAME-NBR
                                        TO WS-FLD-LEN
              MOVE VMG-FRAME-NBR  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 07 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VMG-CONFIDENTIAL-IND
                                        TO WS-FLD-LEN
              MOVE VMG-CONFIDENTIAL-IND  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


           END-IF
           .

      /*****************************************************************
      * 5800-FORMATSUB-RECORD-T.
      * FUNCTION:
      * FORMATS THE 'T' SUB RECORDS
      ******************************************************************
       5800-FORMATSUB-RECORD-T.

           IF VBB-T-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-T TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-THDR1       TO WS-FLD-LEN
              MOVE L-THDR1                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-THDR2       TO WS-FLD-LEN
              MOVE L-THDR2                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-THDR3       TO WS-FLD-LEN
              MOVE L-THDR3                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-THDR4       TO WS-FLD-LEN
              MOVE L-THDR4                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 1 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UDC-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VDC-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5810-SEARCH-VDC-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /*****************************************************************
      * 5810-SEARCH-VDC-PKT.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VDC PACKET
      ******************************************************************
       5810-SEARCH-VDC-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VDC-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
CR8899        PERFORM 6450-SKIP-A-LINE

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              SET CCYYMMDD-FRMT TO TRUE
              MOVE VDC-CREATE-DT   TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 06 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-PRSN-OR-ENTITY-CD
                     TO WS-FLD-LEN
              MOVE VDC-PRSN-OR-ENTITY-CD
                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 10 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-REG-OWNR-NAME-LOCATION-CD
                     TO WS-FLD-LEN
              MOVE VDC-REG-OWNR-NAME-LOCATION-CD
                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 08 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-REG-OWNR-NAME-CONTINUED-CD
                     TO WS-FLD-LEN
              MOVE VDC-REG-OWNR-NAME-CONTINUED-CD
                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 04 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-DL-OR-ID-NBR
                     TO WS-FLD-LEN
              MOVE VDC-DL-OR-ID-NBR
                     TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-VERIF-IND
                                            TO WS-FLD-LEN
              MOVE VDC-VERIF-IND  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 07 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VDC-TYPE-TRAN-CD
                                            TO WS-FLD-LEN
              MOVE VDC-TYPE-TRAN-CD   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


           END-IF
           .

      /*****************************************************************
      * 5850-FORMATSUB-RECORD-U.
      * FUNCTION:
      * FORMATS THE 'U' SUB RECORDS
      ******************************************************************
       5850-FORMATSUB-RECORD-U.

           IF VBB-U-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-U TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              MOVE LENGTH OF L-CENT        TO WS-FLD-LEN
              MOVE L-CENT                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-UHDR1       TO WS-FLD-LEN
              MOVE L-UHDR1                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-UHDR2       TO WS-FLD-LEN
              MOVE L-UHDR2                 TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6450-SKIP-A-LINE

              MOVE 02 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              EVALUATE TRUE
                 WHEN REC-TYP-RETENTION
                  AND VBB-ELP-RTN-EXPR-CC > ZEROES
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-ELP-RTN-EXPR-CC
                                              TO WS-FLD-LEN
                     MOVE VBB-ELP-RTN-EXPR-CC TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN VBB-REG-EXPR-CC > ZEROES
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-REG-EXPR-CC
                                              TO WS-FLD-LEN
                     MOVE VBB-REG-EXPR-CC     TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN OTHER
                     MOVE LENGTH OF L-TXT-0000   TO WS-FLD-LEN
                     MOVE L-TXT-0000             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE

              MOVE 11 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              EVALUATE TRUE
                 WHEN REC-TYP-RETENTION
                     MOVE 4 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN VBB-VEH-1ST-SOLD-DT > ZEROS
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-VEH-1ST-SOLD-CC
                                                 TO WS-FLD-LEN
                     MOVE VBB-VEH-1ST-SOLD-CC    TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN VBB-DISABLED-PLACARD-DOB-DT > ZEROS
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-DISABLED-PLACARD-DOB-CC
                                                 TO WS-FLD-LEN
                     MOVE VBB-DISABLED-PLACARD-DOB-CC
                                                 TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN OTHER
                     MOVE LENGTH OF L-TXT-0000   TO WS-FLD-LEN
                     MOVE L-TXT-0000             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE

              MOVE 15 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              EVALUATE TRUE
                 WHEN REC-TYP-RETENTION
                     MOVE 4 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN VBB-YR-MDL-CC > ZEROS
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-YR-MDL-CC TO WS-FLD-LEN
                     MOVE VBB-YR-MDL-CC       TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN OTHER
                     MOVE LENGTH OF L-TXT-0000   TO WS-FLD-LEN
                     MOVE L-TXT-0000             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE

              MOVE 11 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              EVALUATE TRUE
                 WHEN REC-TYP-RETENTION
                     MOVE 4 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN VBB-TYPE-LIC-CD(1:1) = L-V
                     IF VBB-VSL-BUILT-CC > ZEROES
                        MOVE 1 TO CTR-SPACES
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                        MOVE LENGTH OF VBB-VSL-BUILT-CC TO WS-FLD-LEN
                        MOVE VBB-VSL-BUILT-CC        TO WS-MOVE-FLD
MWDCM3                  PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                        MOVE 1 TO CTR-SPACES
                        PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                     ELSE
                        MOVE LENGTH OF L-TXT-0000 TO WS-FLD-LEN
                        MOVE L-TXT-0000          TO WS-MOVE-FLD
                        PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                     END-IF
                 WHEN VBB-VEH-ASTRSK-CC > ZEROES
                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                     MOVE LENGTH OF VBB-VEH-ASTRSK-CC TO WS-FLD-LEN
                     MOVE VBB-VEH-ASTRSK-CC          TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT

                     MOVE 1 TO CTR-SPACES
                     PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 WHEN OTHER
                     MOVE LENGTH OF L-TXT-0000   TO WS-FLD-LEN
                     MOVE L-TXT-0000             TO WS-MOVE-FLD
                     PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              END-EVALUATE


           END-IF
           .

      /*****************************************************************
      * 5900-FORMATSUB-RECORD-V.
      * FUNCTION:
      * FORMATS THE 'V' SUB RECORDS
      ******************************************************************
       5900-FORMATSUB-RECORD-V.

           IF VBB-V-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
CR8899        PERFORM 6451-SKIP-A-LINE-2-TIMES

              MOVE LENGTH OF L-SUB         TO WS-FLD-LEN
              MOVE L-SUB                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET SUB-REC-V TO TRUE
              MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
              MOVE WS-SUB-RECORD           TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-VHDR1       TO WS-FLD-LEN
              MOVE L-VHDR1                 TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE

              MOVE LENGTH OF L-VHDR2       TO WS-FLD-LEN
              MOVE L-VHDR2                 TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-VHDR3       TO WS-FLD-LEN
              MOVE L-VHDR3                 TO  WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 1 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UHY-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VHY-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5910-SEARCH-VHY-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /*****************************************************************
      * 5910-SEARCH-VHY-PKT
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VHY PACKET
      ******************************************************************
       5910-SEARCH-VHY-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VHY-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE
CR8899        PERFORM 6450-SKIP-A-LINE

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              MOVE VHY-PROC-YR-JLN-DT
                                             TO WS-FORMAT-CCYYJJJ
              MOVE LENGTH OF WS-FORMAT-YYJJJ TO WS-FLD-LEN
              MOVE WS-FORMAT-YYJJJ              TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VHY-OVRFLW-IND
                                             TO WS-FLD-LEN
              MOVE VHY-OVRFLW-IND               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VHY-PRIOR-1ST-SOLD-ASTRSK-YR
                                                TO WS-FLD-LEN
              MOVE VHY-PRIOR-1ST-SOLD-ASTRSK-YR
                                                   TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VHY-PRIOR-VLF-CLASS-CD
                                                TO WS-FLD-LEN
              MOVE VHY-PRIOR-VLF-CLASS-CD
                                             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VHY-RE-CLASS-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VHY-PRIOR-EXPR-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE VHY-CURR-EXPR-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE

              MOVE 05 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF VHY-RE-CLASS-IND
                                             TO WS-FLD-LEN
              MOVE VHY-RE-CLASS-IND             TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT


           END-IF
           .

      /*****************************************************************
      * 5950-FORMATSUB-RECORD-W.
      * FUNCTION:
      * FORMATS THE 'W' SUB RECORDS
      ******************************************************************
       5950-FORMATSUB-RECORD-W.

           IF VBB-W-SUB-REC-CNT  = ZERO
              CONTINUE
           ELSE
              MOVE 1 TO WS-PKT

              SET SW-PKT-SRCH-MORE TO TRUE
              SET SMG-FUNC-READFIRST TO TRUE
              SET SMG-STRUCT-ADS TO TRUE

              IF SUSP-RDF-ERR-READ
                 MOVE L-UMP-PKT-ID TO SMG-PKT-ID
              ELSE
                 MOVE L-VMP-PKT-ID TO SMG-PKT-ID
              END-IF

              PERFORM 5952-FORMAT-VMP-PKT
                UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN

           END-IF
           .

      /*****************************************************************
      * 5952-FORMAT-VMP-PKT
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VMP PACKET AND FORMAT TO
      * OUTPUT
      ******************************************************************
       5952-FORMAT-VMP-PKT.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-VMP-PKTS TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              IF VMP-001-MULT-PURP-CD  = 001
                 IF FIRST-TIME-LOOP
CR8899              PERFORM 6451-SKIP-A-LINE-2-TIMES
                    MOVE LENGTH OF L-SUB            TO WS-FLD-LEN
                    COMPUTE WS-FLD-LEN = WS-FLD-LEN - 1
                    MOVE L-SUB                      TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    SET SUB-REC-W TO TRUE
                    MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
                    MOVE WS-SUB-RECORD              TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                    MOVE LENGTH OF L-WHDR1          TO WS-FLD-LEN
                    MOVE L-WHDR1                    TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-WHDR2          TO WS-FLD-LEN
                    MOVE L-WHDR2                    TO  WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    SET NOT-FIRST-TIME     TO TRUE
                 END-IF

                 PERFORM 6450-SKIP-A-LINE
                 PERFORM 5955-FORMAT-MPC-001-W

              ELSE

CR8899           PERFORM 6451-SKIP-A-LINE-2-TIMES
                 MOVE LENGTH OF L-SUB            TO WS-FLD-LEN
                 COMPUTE WS-FLD-LEN = WS-FLD-LEN - 1
                 MOVE L-SUB                      TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 SET SUB-REC-W TO TRUE
                 MOVE LENGTH OF WS-SUB-RECORD TO WS-FLD-LEN
                 MOVE WS-SUB-RECORD              TO  WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT

                 IF VMP-001-MULT-PURP-CD  = 002
                    MOVE LENGTH OF L-VLF-REF TO WS-FLD-LEN
                    MOVE L-VLF-REF                  TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 ELSE
                    MOVE LENGTH OF L-CTAX-REF TO WS-FLD-LEN
                    MOVE L-CTAX-REF                 TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF

                 PERFORM 5960-FORMAT-MPC-002-003-W

              END-IF

           END-IF
           .

      **********************************************************
      * 5955-FORMAT-MPC-001-W.                                 *
      * FORMATS FOR MPC 001                                    *
      **********************************************************
       5955-FORMAT-MPC-001-W.

           MOVE LENGTH OF VMP-001-MULT-PURP-CD
                                        TO WS-FLD-LEN
           MOVE VMP-001-MULT-PURP-CD  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE 03 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           SET CCYYMMDD-FRMT TO TRUE
           MOVE VMP-001-CREATE-DT
                                       TO WS-FORMAT-DT
           PERFORM 6310-MOVE-FORMATTED-DATE

           MOVE 02 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE VMP-001-ODOM-READING
                                     TO WS-ODOM-READ-QUAN
           MOVE LENGTH OF WS-ODOM-READ-QUAN TO WS-FLD-LEN
           MOVE WS-ODOM-READ-QUAN    TO WS-MOVE-FLD

           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE 02 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VMP-001-ODOM-DT  = ZEROS
              MOVE LENGTH OF VMP-001-ODOM-DT
                                           TO WS-FLD-LEN
              MOVE SPACES                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           ELSE
             SET CCYYMMDD-FRMT TO TRUE
             MOVE VMP-001-ODOM-DT  TO WS-FORMAT-DT
             PERFORM 6310-MOVE-FORMATTED-DATE
           END-IF

           MOVE 03 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF VMP-001-ODOM-IND
                                        TO WS-FLD-LEN
           MOVE VMP-001-ODOM-IND              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE 07 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF VMP-001-ODOM-CD
                                        TO WS-FLD-LEN
           MOVE VMP-001-ODOM-CD              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           MOVE 04 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           IF VMP-001-FICHE-DT  = ZEROS
              MOVE 10 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
           ELSE
              SET CCYYMMDD-FRMT TO TRUE
              MOVE VMP-001-FICHE-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
           END-IF

           MOVE 02 TO CTR-SPACES
           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF VMP-001-TYPE-TRAN-CD
                                        TO WS-FLD-LEN
           MOVE VMP-001-TYPE-TRAN-CD  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           .

      **********************************************************
      * 5960-FORMAT-MPC-002-003-W.                             *
      * FORMATS FOR MPC 002 AND 003                            *
      **********************************************************
       5960-FORMAT-MPC-002-003-W.

           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-MPC         TO WS-FLD-LEN
           MOVE L-MPC                   TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VMP-002-MULT-PURPOSE-CD
                                        TO WS-FLD-LEN
           MOVE VMP-002-MULT-PURPOSE-CD  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-CRE-DT TO WS-FLD-LEN
           MOVE L-CRE-DT                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE VMP-002-CREATE-DT
                                        TO WS-FORMAT-DT
           SET MMDDCCYY-FRMT TO TRUE
           PERFORM 6310-MOVE-FORMATTED-DATE
           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-CLA-NUM TO WS-FLD-LEN
           MOVE L-CLA-NUM               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VMP-002-CLAIM-SCHED-NBR
                                        TO WS-FLD-LEN
           MOVE VMP-002-CLAIM-SCHED-NBR  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-WAR-AMT TO WS-FLD-LEN
           MOVE L-WAR-AMT               TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF WS-WRNT-AMT    TO WS-FLD-LEN
           MOVE VMP-002-WRNT-AMT  TO WS-WRNT-AMT1
           MOVE WS-WRNT-AMT              TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-OFFICE TO WS-FLD-LEN
           MOVE L-OFFICE                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VMP-002-OFF-ID
                                        TO WS-FLD-LEN
           MOVE VMP-002-OFF-ID  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-WRK-DT TO WS-FLD-LEN
           MOVE L-WRK-DT                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           SET MMDDCCYY-FRMT TO TRUE
           MOVE VMP-002-WRK-DT  TO WS-FORMAT-DT
           PERFORM 6310-MOVE-FORMATTED-DATE

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-TEC-ID TO WS-FLD-LEN
           MOVE L-TEC-ID                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VMP-002-TECH-ID
                                        TO WS-FLD-LEN
           MOVE VMP-002-TECH-ID  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           MOVE LENGTH OF L-SEQ-NU TO WS-FLD-LEN
           MOVE L-SEQ-NU                TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE LENGTH OF VMP-002-SEQ-NBR
                                        TO WS-FLD-LEN
           MOVE VMP-002-SEQ-NBR  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           PERFORM 6400-MOVE-SPACE-TO-OUTPUT

           PERFORM 6450-SKIP-A-LINE

           MOVE LENGTH OF L-NAM         TO WS-FLD-LEN
           MOVE L-NAM                   TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           MOVE VMP-002-WRNT-NME  TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL
           MOVE WS-LENGTH TO WS-FLD-LEN
           MOVE VMP-002-WRNT-NME  TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 5965-FORMAT-NAME-ADDR-W

           PERFORM 6450-SKIP-A-LINE

           IF VBB-VRC-PRESENT(35)
              CONTINUE
           ELSE
              MOVE LENGTH OF L-CITY         TO WS-FLD-LEN
              MOVE L-CITY                   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VMP-002-WRNT-CITY-NME  TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH TO WS-FLD-LEN
              MOVE VMP-002-WRNT-CITY-NME  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-STATE        TO WS-FLD-LEN
              MOVE L-STATE                  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VMP-002-WRNT-STATE-CD
                                           TO WS-FLD-LEN
              MOVE VMP-002-WRNT-STATE-CD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

              MOVE 03 TO CTR-SPACES
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT

              MOVE LENGTH OF L-ZIP          TO WS-FLD-LEN
              MOVE L-ZIP                    TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VMP-002-WRNT-ZIP-CD
                                           TO WS-FLD-LEN
              MOVE VMP-002-WRNT-ZIP-CD  TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VMP-002-WRNT-NBR  = SPACES
              CONTINUE
           ELSE
              IF VMP-002-WRNT-DT  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-WAR-NUM TO WS-FLD-LEN
                 MOVE L-WAR-NUM                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VMP-002-WRNT-NBR
                                               TO WS-FLD-LEN
                 MOVE VMP-002-WRNT-NBR  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-WAR-DT       TO WS-FLD-LEN
                 MOVE L-WAR-DT                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 SET MMDDCCYY-FRMT TO TRUE
                 MOVE VMP-002-WRNT-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF VMP-002-UNDELIVERABLE-IND  = SPACES
              CONTINUE
           ELSE
              IF VMP-002-UNDELIVERABLE-DT  = SPACES
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-UND-IND TO WS-FLD-LEN
                 MOVE L-UND-IND                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VMP-002-UNDELIVERABLE-IND
                                               TO WS-FLD-LEN
                 MOVE VMP-002-UNDELIVERABLE-IND  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-UND-DT       TO WS-FLD-LEN
                 MOVE L-UND-DT                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 SET MMDDCCYY-FRMT TO TRUE
                 MOVE VMP-002-UNDELIVERABLE-DT  TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF VMP-002-STALE-DATED-IND  = SPACES
              CONTINUE
           ELSE
              IF VMP-002-STALE-DATED-DT  = ZEROS
                 CONTINUE
              ELSE
                 IF LAST-MOVE-NOT-SBA
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
                 MOVE LENGTH OF L-STD-IND TO WS-FLD-LEN
                 MOVE L-STD-IND                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VMP-002-STALE-DATED-IND
                                               TO WS-FLD-LEN
                 MOVE VMP-002-STALE-DATED-IND  TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-STD-DT       TO WS-FLD-LEN
                 MOVE L-STD-DT                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 SET MMDDCCYY-FRMT TO TRUE
                 MOVE VMP-002-STALE-DATED-DT
                                               TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF VMP-002-REMAIL-REISS-IND  = SPACES
              CONTINUE
           ELSE
              IF VMP-002-REMAIL-REISS-DT  = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-REM-IND TO WS-FLD-LEN
                 MOVE L-REM-IND                TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VMP-002-REMAIL-REISS-IND
                                               TO WS-FLD-LEN
                 MOVE VMP-002-REMAIL-REISS-IND
                                               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-RMA-DT       TO WS-FLD-LEN
                 MOVE L-RMA-DT                 TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 SET MMDDCCYY-FRMT TO TRUE
                 MOVE VMP-002-REMAIL-REISS-DT
                                               TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF VMP-002-STOP-PYMT-IND  = SPACES
              CONTINUE
           ELSE
              IF VMP-002-STOP-PYMT-DT  = ZEROS
                 CONTINUE
              ELSE
                 MOVE LENGTH OF L-STP-PAY-IND
                                               TO WS-FLD-LEN
                 MOVE L-STP-PAY-IND            TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF VMP-002-STOP-PYMT-IND
                                               TO WS-FLD-LEN
                 MOVE VMP-002-STOP-PYMT-IND
                                               TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                 MOVE LENGTH OF L-STP-PAY-DT
                                               TO WS-FLD-LEN
                 MOVE L-STP-PAY-DT             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 SET MMDDCCYY-FRMT TO TRUE
                 MOVE VMP-002-STOP-PYMT-DT
                                               TO WS-FORMAT-DT
                 PERFORM 6310-MOVE-FORMATTED-DATE
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF VMP-002-REVERT-IND  = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF L-REV-IND TO WS-FLD-LEN
              MOVE L-REV-IND                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF VMP-002-REVERT-IND
                                            TO WS-FLD-LEN
              MOVE VMP-002-REVERT-IND
                                            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VMP-002-FICHE-DT  = ZEROS
              CONTINUE
           ELSE
              MOVE LENGTH OF L-FIC-DT       TO WS-FLD-LEN
              MOVE L-FIC-DT                 TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              SET MMDDCCYY-FRMT TO TRUE
              MOVE VMP-002-FICHE-DT  TO WS-FORMAT-DT
              PERFORM 6310-MOVE-FORMATTED-DATE
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF VMP-002-INTEREST-AMT  = ZEROS
              CONTINUE
           ELSE
              MOVE LENGTH OF L-INT-AMT TO WS-FLD-LEN
              MOVE L-INT-AMT                TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE VMP-002-INTEREST-AMT          TO WS-INT-AMT1
              MOVE LENGTH OF WS-INT-AMT     TO WS-FLD-LEN
              MOVE WS-INT-AMT               TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT

           END-IF
           .

      **********************************************************
      * 5965-FORMAT-NAME-ADDR-W.                               *
      * FORMATS THE NAME AND ADDRESS                           *
      **********************************************************
       5965-FORMAT-NAME-ADDR-W.

           IF VMP-002-WRNT-LN-2-NME  = SPACES
              IF VMP-002-WRNT-LN-2-ADDR  = SPACES
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 MOVE VMP-002-WRNT-LN-2-ADDR
                                          TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH TO WS-FLD-LEN
                 MOVE VMP-002-WRNT-LN-2-ADDR
                                          TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 IF VMP-002-WRNT-LN-3-ADDR
                    = SPACES
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF WS-SEP-COMMA
                                          TO WS-FLD-LEN
                    MOVE WS-SEP-COMMA     TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                    MOVE VMP-002-WRNT-LN-3-ADDR
                                          TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VMP-002-WRNT-LN-3-ADDR
                                          TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VMP-002-WRNT-ADDR  = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6450-SKIP-A-LINE
                       MOVE VMP-002-WRNT-ADDR
                                           TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH TO WS-FLD-LEN
                       MOVE VMP-002-WRNT-ADDR
                                           TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    END-IF
                 END-IF
              END-IF
           ELSE
              MOVE LENGTH OF WS-SEP-COMMA  TO WS-FLD-LEN
              MOVE WS-SEP-COMMA            TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6400-MOVE-SPACE-TO-OUTPUT
              MOVE VMP-002-WRNT-LN-2-NME
                                           TO WS-TEST-FIELD
              PERFORM 6100-FIELD-LENGTH-CAL
              MOVE WS-LENGTH TO WS-FLD-LEN
              MOVE VMP-002-WRNT-LN-2-NME
                                           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              IF VMP-002-WRNT-LN-3-NME  = SPACES
                 IF VMP-002-WRNT-LN-2-ADDR
                    = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE VMP-002-WRNT-LN-2-ADDR
                                          TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VMP-002-WRNT-LN-2-ADDR
                                          TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    IF VMP-002-WRNT-LN-3-ADDR
                       = SPACES
                       CONTINUE
                    ELSE
                       PERFORM 6450-SKIP-A-LINE
                       MOVE VMP-002-WRNT-LN-3-ADDR
                                             TO WS-TEST-FIELD
                       PERFORM 6100-FIELD-LENGTH-CAL
                       MOVE WS-LENGTH TO WS-FLD-LEN
                       MOVE VMP-002-WRNT-LN-3-ADDR
                                             TO WS-MOVE-FLD
                       PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       IF VMP-002-WRNT-ADDR  = SPACES
                          CONTINUE
                       ELSE
                          MOVE LENGTH OF WS-SEP-COMMA
                                                TO WS-FLD-LEN
                          MOVE WS-SEP-COMMA     TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                          PERFORM 6400-MOVE-SPACE-TO-OUTPUT
                          MOVE VMP-002-WRNT-ADDR
                                                TO WS-TEST-FIELD
                          PERFORM 6100-FIELD-LENGTH-CAL
                          MOVE WS-LENGTH TO WS-FLD-LEN
                          MOVE VMP-002-WRNT-ADDR
                                                TO WS-MOVE-FLD
                          PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                       END-IF
                    END-IF
                 END-IF
              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 MOVE VMP-002-WRNT-LN-3-NME
                                           TO WS-TEST-FIELD
                 PERFORM 6100-FIELD-LENGTH-CAL
                 MOVE WS-LENGTH TO WS-FLD-LEN
                 MOVE VMP-002-WRNT-LN-3-NME
                                           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 IF VMP-002-WRNT-LN-2-ADDR  = SPACES
                    CONTINUE
                 ELSE
                    PERFORM 6450-SKIP-A-LINE
                    MOVE VMP-002-WRNT-LN-2-ADDR
                                        TO WS-TEST-FIELD
                    PERFORM 6100-FIELD-LENGTH-CAL
                    MOVE WS-LENGTH TO WS-FLD-LEN
                    MOVE VMP-002-WRNT-LN-2-ADDR
                                        TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 END-IF
              END-IF
           END-IF
           .

      /*****************************************************************
      * 5155-FORMAT-WRAPUP
      * FUNCTION:FORMAT INSURANCE INFORMATION MAIN LOGIC.EVALUATES
      * TYPE RECORD, SPECIAL COURT FLAG, ANI INFORMATION. CALCULATES
      * THE RECORDS TO BE SEARCHED FOR VIN REQUEST WITH OPTIONAL FIELD
      ******************************************************************
       5155-FORMAT-WRAPUP.

           IF MASTER-FILE-FORMAT AND IAC-MAIL-ADDR
              IF VBB-VRC-PRESENT(64)
                 CONTINUE
              ELSE
                 PERFORM 6450-SKIP-A-LINE
                 MOVE LENGTH OF L-NO-MAIL-ADDR TO WS-FLD-LEN
                 MOVE L-NO-MAIL-ADDR           TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF WS-FIL-CD      = L-V
              AND REC-TYP-OWNPLATE
              AND CUR-ON-OTH-VIN-MSG-NOT-WRTN
              PERFORM 6450-SKIP-A-LINE
              MOVE LENGTH OF VBB-KEY-VEH-VSL-LIC-NBR TO WS-FLD-LEN
              MOVE VBB-KEY-VEH-VSL-LIC-NBR   TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              MOVE LENGTH OF L-CUR-ON-OTH-VIN TO WS-FLD-LEN
              MOVE L-CUR-ON-OTH-VIN           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           IF WS-FIL-CD      = L-V
              AND ( INQUIRY-BY-MAKE
              OR INQUIRY-BY-YEAR
              OR INQUIRY-BY-BOTH)
              IF WS-GROUP = SPACES
                 MOVE 1 TO WS-STR
              ELSE
                 COMPUTE WS-STR = WS-GRP * 8 + 1
              END-IF
              IF VR-MASTR-READ
                 PERFORM 6030-CALCULATE-CUR-POSITION VARYING  WS-PTR
                            FROM WS-STR BY 1 UNTIL POINTER-SET
                              OR WS-PTR > WS-VIN-CTR
                 MOVE CTR-CURR-PTR    TO WS-PREV-CNT
              ELSE
                 IF SUSP-RDF-ERR-READ
                    MOVE WS-PREV-CNT  TO CTR-CURR-PTR
                 END-IF
              END-IF

              SET POINTER-NOT-SET TO TRUE
              COMPUTE CTR-TO-BE-SRCHD = WS-VIN-CTR - CTR-CURR-PTR

              IF WS-VIN-CTR  > 1
                 AND PRKY-KEY-CNT >= PRKY-CURR-PTR
                 IF CTR-TO-BE-SRCHD = ZEROS
                    CONTINUE
                 ELSE
                    MOVE LENGTH OF CTR-TO-BE-SRCHD TO WS-FLD-LEN
                    MOVE CTR-TO-BE-SRCHD           TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    MOVE LENGTH OF L-TO-BE-SRCHD   TO WS-FLD-LEN
                    MOVE L-TO-BE-SRCHD             TO WS-MOVE-FLD
                    PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                    PERFORM 6450-SKIP-A-LINE
                 END-IF
              END-IF

              IF WS-VIN-CTR  > 1
                 AND PRKY-KEY-CNT = PRKY-CURR-PTR
                 AND NEXT-IS-VINX-END
                 IF CTR-TO-BE-SRCHD = ZEROS
                    CONTINUE
                 ELSE
                    INITIALIZE SW-NEXT-LIC-SPACE
                    COMPUTE CTR-CURR-PTR = CTR-CURR-PTR + 1
                    PERFORM 6040-CHECK-IF-SEARCH-COMPLETE VARYING WS-PTR
                      FROM CTR-CURR-PTR BY 1 UNTIL WS-PTR > WS-VIN-CTR
                           OR ADDITIONAL-OPTION
                    IF ADDITIONAL-OPTION
                       CONTINUE
                    ELSE
                       SET SEARCH-COMPLETED TO TRUE
                    END-IF
                 END-IF
              END-IF

           END-IF

           IF WS-FIL-CD      = L-V
              AND INQUIRY-BY-VIN
              IF WS-VIN-CTR  > 1
                 AND (PRKY-KEY-CNT > PRKY-CURR-PTR
                 OR NEXT-LIC-SPACE
                 OR NEXT-IS-VIN-RESTR
                 OR NEXT-IS-STOP-ONLY)
                 MOVE WS-VIN-CTR TO WS-VIN-COUNT
                 MOVE LENGTH OF WS-VIN-COUNT    TO WS-FLD-LEN
                 MOVE WS-VIN-COUNT              TO WS-MOVE-FLD
                 PERFORM 6450-SKIP-A-LINE
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
                 MOVE LENGTH OF L-TOT-RECORDS   TO WS-FLD-LEN
                 MOVE L-TOT-RECORDS             TO WS-MOVE-FLD
                 PERFORM 6300-MOVE-FIELD-TO-OUTPUT
10002*           PERFORM 6450-SKIP-A-LINE
              END-IF
           END-IF

           IF  END-OF-VINX
           AND SUSP-RDF-ERR-READ
               SET END-OF-FORMAT    TO TRUE
               SET NEXT-IS-VINX-END TO TRUE
           END-IF
           .

      /*****************************************************************
      * 6000-GET-ADDR-VAR-PKTS-IN-TDS
      * FUNCTION:
      * CALLS STRUCTURE MANAGER TO GET FREQ PACKET FROM TDS.
      ******************************************************************
       6000-GET-ADDR-VAR-PKTS-IN-TDS.

           INITIALIZE WS-FREQ-DATA
           SET SW-PKT-SRCH-MORE TO TRUE
           SET SMG-FUNC-READFIRST TO TRUE
           SET SMG-STRUCT-TDS TO TRUE

           MOVE L-FREQ-PKT-ID TO SMG-PKT-ID

           PERFORM 6010-SEARCH-FREQ-PKT
             UNTIL SW-PKT-SRCH-EXIT OR ERROR-RTN
           .

      /*****************************************************************
      * 6010-SEARCH-FREQ-PKT
      * FUNCTION:
      * MOVES THE SYMBOLIC VALUE FROM A FREQ DATA PACKET TO WORKING
      * STORAGE FIELD.
      ******************************************************************
       6010-SEARCH-FREQ-PKT.


           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
              SET ADDRESS OF ARG-FREQ-PKT TO SMG-ADDR
              SET SMG-FUNC-READ TO TRUE

              EVALUATE  FREQ-NAME
                  WHEN L-TRANCODE
                     MOVE FREQ-VALUE         TO WS-TCODE
                  WHEN L-REQCODE
                     MOVE FREQ-VALUE         TO WS-REQ-CODE
                  WHEN L-OPERCODE
                     MOVE FREQ-VALUE         TO WS-OPER-CODE
                  WHEN L-INFOCODE
                     MOVE FREQ-VALUE         TO WS-INF-CD
                  WHEN L-FILECODE
                     MOVE FREQ-VALUE         TO WS-FIL-CD
                  WHEN L-LICPLATE
                     MOVE FREQ-VALUE         TO WS-LIC
                  WHEN L-VINNBR
                     MOVE FREQ-VALUE         TO WS-VIN
                  WHEN L-ANIINFO
                     MOVE FREQ-VALUE         TO WS-ANI-INFO
                  WHEN L-VINYEAR
                     MOVE FREQ-VALUE         TO WS-YEAR
                  WHEN L-VINMAKE
                     MOVE FREQ-VALUE         TO WS-MAKE
                  WHEN L-VINGROUP
                     MOVE FREQ-VALUE         TO WS-GROUP
              END-EVALUATE

           END-IF
           .

      /*****************************************************************
      * 6015-SEARCH-FLAG-PKT
      * FUNCTION:
      * MOVES THE USER ROLE FLAGS TO WORKING STORAGE.
      ******************************************************************
       6015-SEARCH-FLAG-PKT.

           INITIALIZE WS-EXP-SEC-MODULE
           MOVE 1 TO WS-SUB

           PERFORM UNTIL WS-SUB > FLGS-SYMBOLIC-CNT

              IF FLGS-SYMBOL (WS-SUB)   = L-R60-FLAG1
                 MOVE FLGS-VALUE (WS-SUB)   TO OCCXXSYF-FLAG1
              ELSE
                IF FLGS-SYMBOL (WS-SUB) = L-R60-FLAG2
                   MOVE FLGS-VALUE (WS-SUB) TO OCCXXSYF-FLAG2
                END-IF
              END-IF

              ADD 1 TO WS-SUB

           END-PERFORM
           .

      /*****************************************************************
      * 6020-STORE-VINX
      * FUNCTION:
      * CALLS STRUCTURE MANAGER TO GET VINX AND VVP DATA PACKET
      * AND MOVES DATA PACKET INTO WORKING STORAGE
      ******************************************************************
       6020-STORE-VINX.

           INITIALIZE  ARRAY-PKTS
           MOVE L-VINX-PKT-ID       TO ARRAY-PKT-ID (1)
           MOVE L-VVP-PKT-ID        TO ARRAY-PKT-ID (2)
           MOVE +1                  TO IDX-SMG

           PERFORM 6025-RETRIEVE-VINX-VVP-PKTS

      *    IF NO-ERROR
           IF CTR-VINX > ZERO
              MOVE VINX-FILE-KEY-CODE OF WS-VINX-PKT(L-1)
                                          TO WS-VALID-VIN-FILE-CD

              IF VINX-STAT-VLT-STOP OF WS-VINX-PKT(L-1)
              OR VINX-STAT-DOJ-STOP-STLN OF WS-VINX-PKT(L-1)
              OR VINX-STAT-DOJ-STOP-REFR OF WS-VINX-PKT(L-1)
              OR VINX-STAT-BAR-SMOG-CERT OF WS-VINX-PKT(L-1)
              OR VINX-STAT-OS-LIC-FLG-STOP OF WS-VINX-PKT(L-1)
                 SET LIC-HAS-STOP    TO TRUE
              ELSE
                 SET LIC-HAS-NO-STOP TO TRUE
              END-IF

              IF VINX-VEH-LIC-NBR OF WS-VINX-PKT(L-1) = SPACES
                 OR VINX-INVAL-KEY OF WS-VINX-PKT(L-1)
                 CONTINUE
              ELSE
                 IF VIN-FILE-CD-VALID
                 OR LIC-HAS-NO-STOP
                    SET RETURN-TO-TC          TO TRUE
                 ELSE
                    CONTINUE
                 END-IF
              END-IF
           END-IF

           IF NO-ERROR
              IF CTR-VINX = ZERO
                 IF FORMAT-ERR-MSG
                 OR PRKY-NOT-FOUND
                    CONTINUE
                 ELSE
                    SET RC-CALL-FAIL-WITH-MSG TO TRUE
                    SET ERROR-RTN             TO TRUE
                    SET RETURN-TO-TC          TO TRUE
                 END-IF
              END-IF

           END-IF
           .

      /*****************************************************************
      * 6025-RETRIEVE-VINX-VVP-PKTS.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VINX AND VVP PACKETS
      ******************************************************************
       6025-RETRIEVE-VINX-VVP-PKTS.

           INITIALIZE WS-STRUCT-MGR-PARMS
           SET SMG-STRUCT-ADS       TO TRUE
           SET SMG-FUNC-READFIRST   TO TRUE
           MOVE ARRAY-PKT-ID (IDX-SMG) TO SMG-PKT-ID

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
                SET ADDRESS OF ARG-VINX-PKT TO SMG-ADDR
                MOVE SMG-PKT-CNT            TO CTR-VINX
                MOVE ARG-VINX-PKT           TO WS-VINX-PKT
                ADD  +1                     TO IDX-SMG
                MOVE ARRAY-PKT-ID (IDX-SMG) TO SMG-PKT-ID
                PERFORM 6025A-RETRIEVE-VVP-PKTS
                    UNTIL NOT SMG-SUCCESSFUL
           END-IF
           .

      /*****************************************************************
      * 6025A-RETRIEVE-VVP-PKTS.
      * FUNCTION:
      * CALL STRUCTURE MANAGER TO RETRIEVE VINX AND VVP PACKETS
      ******************************************************************
       6025A-RETRIEVE-VVP-PKTS.

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL
               ADD 1 TO WS-VIN-CTR
               SET ADDRESS OF ARG-VVP-PKT  TO SMG-ADDR
               MOVE VVP-PACKET             TO WS-VIN-ENTRY (WS-VIN-CTR)
           END-IF

           SET SMG-FUNC-READ        TO TRUE
           .

      /*****************************************************************
      * 6030-CALCULATE-CUR-POSITION
      * FUNCTION:
      * CALCULATES THE CURRENT POSITION OF RECORD ON THE VIN MASTER
      ******************************************************************
       6030-CALCULATE-CUR-POSITION.

           IF CURRENT-LIC-SPACE
              IF INQUIRY-BY-MAKE
                 IF WS-MAKE-OF-VEH-CD (WS-PTR) = WS-MAKE
                    AND WS-VEH-LIC-NBR (WS-PTR) = SPACES
                    AND WS-PTR NOT = CTR-CURR-PTR
                    MOVE WS-PTR TO CTR-CURR-PTR
                    SET POINTER-SET TO TRUE
                 END-IF
              END-IF
              IF INQUIRY-BY-YEAR
                 IF WS-VEH-FR-SLD-YY (WS-PTR) =
                    VINX-VEH-FRST-SLD-YR OF WS-VINX-PKT (WS-SUB3)(3:2)
                    AND WS-VEH-LIC-NBR (WS-PTR) = SPACES
                    AND WS-PTR NOT = CTR-CURR-PTR
                    MOVE WS-PTR TO CTR-CURR-PTR
                    SET POINTER-SET TO TRUE
                 END-IF
              END-IF
              IF INQUIRY-BY-BOTH
                 IF WS-VEH-FR-SLD-YY (WS-PTR) = WS-YEAR
                    AND WS-MAKE-OF-VEH-CD (WS-PTR) = WS-MAKE
                    AND WS-VEH-LIC-NBR (WS-PTR) = SPACES
                    AND WS-PTR NOT = CTR-CURR-PTR
                    MOVE WS-PTR TO CTR-CURR-PTR
                    SET POINTER-SET TO TRUE
                 END-IF
              END-IF
           ELSE
              IF WS-VEH-LIC-NBR (WS-PTR) = WS-CURRENT-LICENSE
                 MOVE WS-PTR TO CTR-CURR-PTR
                 SET POINTER-SET TO TRUE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 6040-CHECK-IF-SEARCH-COMPLETE
      * FUNCTION:
      * CHECKS THE VIN MASTER IF THERE ARE MORE OPTIONS TO BE SEARCHED
      * SETS A FLAG IF MORE OPTIONS PRESENT
      ******************************************************************
        6040-CHECK-IF-SEARCH-COMPLETE.

           IF INQUIRY-BY-YEAR OR INQUIRY-BY-BOTH
              IF WS-YEAR-YY = 99
                 MOVE 00 TO WS-VEHYY-PLUS-ONE
              ELSE
                 COMPUTE WS-VEHYY-PLUS-ONE = WS-YEAR-YY + 1
              END-IF
              IF WS-YEAR-YY = 00
                 MOVE 99 TO WS-VEHYY-MINUS-ONE
              ELSE
                 COMPUTE WS-VEHYY-MINUS-ONE = WS-YEAR-YY - 1
              END-IF
           END-IF

           IF INQUIRY-BY-MAKE
              IF WS-MAKE-OF-VEH-CD (WS-PTR) = WS-MAKE
                 SET ADDITIONAL-OPTION TO TRUE
              END-IF
           END-IF
           IF INQUIRY-BY-YEAR
              IF WS-VEH-FR-SLD-YY (WS-PTR) = (WS-YEAR-YY OR
                 WS-VEHYY-PLUS-ONE OR
                 WS-VEHYY-MINUS-ONE)
                 SET ADDITIONAL-OPTION TO TRUE
              END-IF
           END-IF
           IF INQUIRY-BY-BOTH
              IF WS-VEH-FR-SLD-YY (WS-PTR) = (WS-YEAR-YY OR
                 WS-VEHYY-PLUS-ONE OR
                 WS-VEHYY-MINUS-ONE)
                 AND WS-MAKE-OF-VEH-CD (WS-PTR) = WS-MAKE
                 SET ADDITIONAL-OPTION TO TRUE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 6050-GET-ADS-DATA
      * FUNCTION:
      * FILL IN THE ARRAY OF PACKETS WITH THE REQUIRED PACKETS IDS
      ******************************************************************
       6050-GET-ADS-DATA.

           INITIALIZE  ARRAY-PKTS
           MOVE +1                  TO IDX-SMG
           MOVE L-VBB-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-VLO-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-VRO-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-VRC-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)

           IF MASTER-FILE-FORMAT
              ADD  +1               TO IDX-SMG
              MOVE L-VSA-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VNH-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VFP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VFD-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VYP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
           ELSE
              ADD  +1               TO IDX-SMG
              MOVE L-VSA-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VYP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VIV-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
           END-IF

           MOVE IDX-SMG             TO CTR-SMG-DATA-PKTS

           PERFORM 6057-RETRIEVE-ADS-PKTS
              VARYING IDX-SMG FROM +1 BY +1
                UNTIL IDX-SMG > CTR-SMG-DATA-PKTS
                   OR ERROR-RTN
           .

      /*****************************************************************
      * 6055-GET-ADS-DATA-SUSP
      * FUNCTION:
      * CALLS STRUCTURE MANAGER TO GET THE DATA PACKETS FROM ADS
      ******************************************************************
       6055-GET-ADS-DATA-SUSP.

           INITIALIZE  ARRAY-PKTS
           MOVE +1                  TO IDX-SMG
           MOVE L-UBB-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-ULO-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-URO-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)
           ADD  +1                  TO IDX-SMG
           MOVE L-URC-PKT-ID        TO ARRAY-PKT-ID (IDX-SMG)

           IF MASTER-FILE-FORMAT
              ADD  +1               TO IDX-SMG
              MOVE L-USA-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-UNH-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-UFP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-UFD-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VYP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
           ELSE
              ADD  +1               TO IDX-SMG
              MOVE L-USA-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VYP-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
              ADD  +1               TO IDX-SMG
              MOVE L-VIV-PKT-ID     TO ARRAY-PKT-ID (IDX-SMG)
           END-IF

           MOVE IDX-SMG             TO CTR-SMG-DATA-PKTS

           PERFORM 6057-RETRIEVE-ADS-PKTS
              VARYING IDX-SMG FROM +1 BY +1
                UNTIL IDX-SMG > CTR-SMG-DATA-PKTS
                   OR ERROR-RTN
           .

      /****************************************************************
      * 6057-RETRIEVE-ADS-PKTS.
      * FUNCTION:
      * - SETUP THE CALLING PARAMETERS TO RETRIEVE THE DATA PACKETS
      *   FROM THE APPLICATION DATA STRUCTURE BY CALLING
      *   THE STRUCTURE MANAGER.
      * - THE STRUCTURE MANAGER RETURNS THE ADDRESS OF EACH DATA PACKET
      *   FOUND. THE DATA LAYOUTS ARE IN THE LINKAGE SECTION AND WILL
      *   BE MAPPED TO THE ADDRESS OF THE DATA PACKET.
      *****************************************************************
       6057-RETRIEVE-ADS-PKTS.

           INITIALIZE WS-STRUCT-MGR-PARMS
           SET SMG-STRUCT-ADS       TO TRUE
           SET SMG-FUNC-READFIRST   TO TRUE
           MOVE ARRAY-PKT-ID (IDX-SMG) TO SMG-PKT-ID

           PERFORM 8000-CALL-STRUCT-MGR

           IF SMG-SUCCESSFUL

               EVALUATE SMG-PKT-ID

                   WHEN L-VBB-PKT-ID
                   WHEN L-UBB-PKT-ID
                      SET ADDRESS OF ARG-VBB-PKT TO SMG-ADDR
                      MOVE SMG-PKT-CNT TO CTR-VBB

                   WHEN L-VLO-PKT-ID
                   WHEN L-ULO-PKT-ID
                      SET ADDRESS OF ARG-VLO-PKT TO SMG-ADDR

                   WHEN L-VRO-PKT-ID
                   WHEN L-URO-PKT-ID
                      SET ADDRESS OF ARG-VRO-PKT TO SMG-ADDR

                   WHEN L-VRC-PKT-ID
                   WHEN L-URC-PKT-ID
                      MOVE SMG-PKT-CNT TO CTR-VRC

                   WHEN L-VSA-PKT-ID
                   WHEN L-USA-PKT-ID
                      SET ADDRESS OF ARG-VSA-PKT TO SMG-ADDR

                   WHEN L-VNH-PKT-ID
                   WHEN L-UNH-PKT-ID
                      SET ADDRESS OF ARG-VNH-PKT TO SMG-ADDR

                   WHEN L-VFP-PKT-ID
                   WHEN L-UFP-PKT-ID
                      SET ADDRESS OF ARG-VFP-PKT TO SMG-ADDR

                   WHEN L-VFD-PKT-ID
                   WHEN L-UFD-PKT-ID
                      SET ADDRESS OF ARG-VFD-PKT TO SMG-ADDR

                   WHEN L-VYP-PKT-ID
                      IF  CTR-VBB > 0 AND VBB-PSEUDO
                          CONTINUE
                      ELSE
                          SET ADDRESS OF ARG-VYP-PKT TO SMG-ADDR
                          MOVE SMG-PKT-CNT TO CTR-VYP
                      END-IF

                   WHEN L-VIV-PKT-ID
                      SET ADDRESS OF ARG-VIV-PKT TO SMG-ADDR

               END-EVALUATE

           END-IF
           .

      /*****************************************************************
      * 6060-SET-SWITCHES
      * FUNCTION:
      * SETS A SWITCH FOR THE CONDITIONS TO BE SEARCHED IN SEVERAL
      * PLACES OF CODE
      ******************************************************************
       6060-SET-SWITCHES.

           MOVE WS-INF-CD  TO  WS-TEMP-INFO-CODE

           IF VBB-VRC-PRESENT(35)
              IF SYF-R60-PRIV-REQ1-YES
                 SET PEACE-OFF-ADDR-NO TO TRUE
              ELSE
                 SET PEACE-OFF-ADDR-YES TO TRUE
              END-IF
           END-IF

           IF WS-FIL-CD = L-V
              CONTINUE
           ELSE
              IF VBB-VRC-PRESENT(2)
                 AND VBB-F-SUB-REC-CNT = ZEROS
                 SET SUB-PLATE-LIC     TO TRUE
                 SET RCC-02 TO TRUE
                 PERFORM 2999-SEARCH-VRC-PKT
                 MOVE VRC02-VEH-VSL-LIC-NBR
                                       TO WS-SUB-PLATE-LIC
              ELSE
                 SET NOT-SUB-PLATE-LIC TO TRUE
              END-IF
           END-IF

           IF VBB-VRC-PRESENT(51)
              SET RCC-51 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              IF VRC51-FILE-KEY-CD   = 12
                 SET SUS-DATA-FOUND TO TRUE
              END-IF
           END-IF

           IF VBB-VRC-PRESENT(52)
              SET RCC-52 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              IF VRC52-FILE-KEY-CD   = 12
                 SET SUS-DATA-FOUND TO TRUE
              END-IF
           END-IF

           IF VBB-VRC-PRESENT(53)
              SET RCC-53 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              IF VRC53-FILE-KEY-CD   = 12
                 SET SUS-DATA-FOUND TO TRUE
              END-IF
           END-IF

           IF VBB-VRC-PRESENT(54)
              SET RCC-54 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT
              IF VRC54-FILE-KEY-CD   = 12
                 SET SUS-DATA-FOUND TO TRUE
              END-IF
           END-IF

           IF IACB-EU-FA-ACC-AUTH = '1' OR '2' OR '3' OR '6'
              SET IAC-MAIL-ADDR   TO TRUE
           END-IF

           IF VBB-VRC-PRESENT(30)

              SET RCC-30 TO TRUE
              PERFORM 2999-SEARCH-VRC-PKT

              IF VRC30-REASON-CD  = '01' AND
                (SYF-R60-INHOUSE1-REQ-NO        AND
                 SYF-R60-INHOUSE2-REQ-NO)

                 SET SW-INHOUSE-E30-PRESENT TO TRUE
              END-IF

           END-IF
           .

      /*****************************************************************
      * 6100-FIELD-LENGTH-CAL.
      * FUNCTION:
      * CALCULATES THE LENGTH OF A VARIABLE FIELD
      ******************************************************************
       6100-FIELD-LENGTH-CAL.

           MOVE 0 TO WS-LENGTH
           INSPECT FUNCTION REVERSE (WS-TEST-FIELD)
                   TALLYING WS-LENGTH FOR LEADING SPACES
           COMPUTE WS-LENGTH = (LENGTH OF WS-TEST-FIELD) - (WS-LENGTH)
           .

      /*****************************************************************
      * 6110-LINE-LENGTH-CAL.
      * FUNCTION:
      * CALCULATES THE LENGTH OF A LINE
      ******************************************************************
       6110-LINE-LENGTH-CAL.

           IF WS-ACCU-LEN >= 72
              PERFORM 6450-SKIP-A-LINE
              MOVE WS-GRP-LEN           TO WS-ACCU-LEN
           END-IF
           .

      /*****************************************************************
      * 6150-MOVE-COMMA-TO-OUTPUT.
      * FUNCTION:
      * MOVES A COMMA TO OUTPUT
      ******************************************************************
       6150-MOVE-COMMA-TO-OUTPUT.

           MOVE 1       TO WS-FLD-LEN
           MOVE L-COMMA TO WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           MOVE 01      TO CTR-SPACES
           .

      /*****************************************************************
      * 6160-MOVE-BASIC-FLDS
      * FUNCTION:
      * MOVES BASIC FIELD TEXT TO OUTPUT
      ******************************************************************
       6160-MOVE-BASIC-FLDS.

           MOVE LENGTH OF TBL-BASIC-FLDS(WS-BASI) TO WS-FLD-LEN
           MOVE TBL-BASIC-FLDS(WS-BASI) TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO CTR-FLD
           .

      /*****************************************************************
      * 6200-MOVE-BASIC-FIELD.
      * FUNCTION:
      * THIS ROUTINE IS USED TO MOVE THE BASIC FIELD TEXT TO OUTPUT
      ******************************************************************
       6200-MOVE-BASIC-FIELD.

           MOVE LENGTH OF TBL-BAS-FLD(WS-BASI) TO WS-FLD-LEN
           MOVE TBL-BAS-FLD(WS-BASI) TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO WS-BASI
           ADD 1 TO CTR-FLD
           .

      /*****************************************************************
      * 6210-MOVE-RATING-FIELD.
      * FUNCTION:
      * THIS ROUTINE IS USED TO MOVE THE RATING INFORMATION TO
      * THE OUTPUT
      ******************************************************************
       6210-MOVE-RATING-FIELD.

           MOVE LENGTH OF TBL-INFO-FLD(WS-RATI) TO WS-FLD-LEN
           MOVE TBL-INFO-FLD(WS-RATI) TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO WS-RATI
           .

      /*****************************************************************
      * 6220-MOVE-BASICB-FIELD.
      * FUNCTION:
      * THIS ROUTINE IS USED TO MOVE THE B SUB-RECORD INFORMATION
      * TO THE OUTPUT
      ******************************************************************
       6220-MOVE-BASICB-FIELD.

           MOVE LENGTH OF TBL-SUBB-FLD(WS-BASB) TO WS-FLD-LEN
           MOVE TBL-SUBB-FLD(WS-BASB)          TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO WS-BASB
           ADD 1 TO CTR-FLD
           .

      /*****************************************************************
      * 6230-MOVE-BASICC-FIELD.
      * FUNCTION:
      * THIS ROUTINE IS USED TO MOVE THE C SUB-RECORD INFORMATION
      * TO THE OUTPUT
      ******************************************************************
       6230-MOVE-BASICC-FIELD.

           MOVE LENGTH OF TBL-SUBC-FLD(WS-BASC) TO WS-FLD-LEN
           MOVE TBL-SUBC-FLD(WS-BASC)          TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO WS-BASC
           ADD 1 TO CTR-FLD
           .

      /*****************************************************************
      * 6240-MOVE-BASICD-FIELD
      * FUNCTION:
      * MOVES THE D SUB-RECORD INFORMATION TO OUTPUT
      ******************************************************************
       6240-MOVE-BASICD-FIELD.

           MOVE LENGTH OF TBL-SUBD-FLD(WS-BASD) TO WS-FLD-LEN
           MOVE TBL-SUBD-FLD(WS-BASD)           TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1  TO WS-BASD
           ADD 1  TO CTR-FLD
           .

      /*****************************************************************
      * 6245-MOVE-LO-FIELD
      * FUNCTION:
      * MOVES THE D SUB-RECORD INFORMATION TO OUTPUT
      ******************************************************************
       6245-MOVE-LO-FIELD.

           MOVE LENGTH OF TBL-LO-FLD(WS-BASD)   TO WS-FLD-LEN
           MOVE TBL-LO-FLD(WS-BASD)             TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1  TO WS-BASD
           ADD 1  TO CTR-FLD
           .

      /****************************************************************
      * 6250-MOVE-TEXT-FIELD.
      * FUNCTION:
      * MOVES HEADER INFORMATION TO OUTPUT
      *****************************************************************
       6250-MOVE-TEXT-FIELD.

           MOVE LENGTH OF TBL-INFO-CD3-LTRLS(WS-SUB) TO WS-FLD-LEN
           MOVE TBL-INFO-CD3-LTRLS(WS-SUB)           TO
                              WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           ADD 1 TO WS-SUB
           ADD 1 TO CTR-FLD
           .

      /****************************************************************
      * 6260-MOVE-TEXT-FIELD.
      * FUNCTION:
      * MOVES HEADER INFORMATION TO OUTPUT
      *****************************************************************
       6260-MOVE-TEXT-FIELD.

           MOVE WS-MOVE-FLD                      TO
                              WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           .

      /*****************************************************************
      * 6270-MOVE-SUBL-FIELD.
      * FUNCTION:
      * THIS ROUTINE IS USED TO MOVE THE 'L' SUB-RECORD TEXT
      * INFORMATION TO THE OUTPUT
      ******************************************************************
       6270-MOVE-SUBL-FIELD.

           ADD 1  TO WS-SUB
           MOVE LENGTH OF TBL-SUBL-FLD(WS-SUB) TO WS-FLD-LEN
           MOVE TBL-SUBL-FLD(WS-SUB)           TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           .

      ******************************************************************
      * 6320-MOVE-FORMATTED-AMOUNT.
      * FUNCTION:
      * THIS ROUTINE IS USED FORMAT THE AMOUNT IN $$$$$.CC FORMAT   T
      ******************************************************************
       6320-MOVE-FORMATTED-AMOUNT.

           MOVE WS-FRMT-AMT-DOL TO WS-FRMTD-AMT-DOL
           MOVE WS-FRMT-AMT-CEN TO WS-FRMTD-AMT-CEN
           MOVE LENGTH OF WS-FRMATTED-AMT TO WS-FLD-LEN
           MOVE WS-FRMATTED-AMT TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           .

      /*****************************************************************
      * 6280-MOVE-ADDL-DATA-TO-OUT.
      * FUNCTION:
      * THIS ROUTINE IS USED MOVE THE ADDITIONAL FIELD TO OUTPUT
      ******************************************************************
       6280-MOVE-ADDL-DATA-TO-OUT.

           MOVE VRC-ADDITIONAL-DATA-UNFRMT
                                       TO WS-TEST-FIELD
           PERFORM 6100-FIELD-LENGTH-CAL

           IF WS-LENGTH > WS-MAX-LENGTH
              MOVE VRC-ADDITIONAL-DATA-UNFRMT
                                       TO WS-ADD-DATA
              EVALUATE TRUE
                 WHEN RCC-02
                    MOVE VRC02-FILE-CD
                                       TO WS-ADD-DATA (1:1)
                 WHEN RCC-07
                    MOVE VRC07-FILE-CD
                                       TO WS-ADD-DATA (1:1)
                 WHEN RCC-30
                    MOVE VRC-FILE-KEY-CD
                                       TO WS-ADD-DATA (1:1)
                 WHEN RCC-31
                    MOVE VRC31-FILE-CD
                                       TO WS-ADD-DATA (1:1)
              END-EVALUATE
CR8899        MOVE L-72                TO WS-FLD-LEN
              MOVE WS-ADD-DATA-LIN1    TO WS-MOVE-FLD
              MOVE WS-MOVE-FLD         TO
                   WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
              COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
              PERFORM 6450-SKIP-A-LINE
              MOVE SPACES              TO WS-MOVE-FLD
CR8899        MOVE LENGTH OF WS-ADD-DATA-LIN2
                                       TO WS-FLD-LEN
              MOVE WS-ADD-DATA-LIN2    TO WS-MOVE-FLD
              MOVE WS-MOVE-FLD            TO
                   WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
              COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
              MOVE SPACES                 TO WS-MOVE-FLD

           ELSE

              MOVE VRC-ADDITIONAL-DATA-UNFRMT
                                       TO WS-MOVE-FLD
              MOVE WS-LENGTH           TO WS-FLD-LEN
              EVALUATE TRUE
                 WHEN RCC-02
                    MOVE VRC02-FILE-CD
                                       TO WS-MOVE-FLD (1:1)
                 WHEN RCC-07
                    MOVE VRC07-FILE-CD
                                       TO WS-MOVE-FLD (1:1)
                 WHEN RCC-30
                    MOVE VRC-FILE-KEY-CD
                                       TO WS-MOVE-FLD (1:1)
                 WHEN RCC-31
                    MOVE VRC31-FILE-CD
                                       TO WS-MOVE-FLD (1:1)
              END-EVALUATE
              MOVE WS-MOVE-FLD            TO
                   WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
              COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
              MOVE SPACES                 TO WS-MOVE-FLD

           END-IF
           .

      /*****************************************************************
      * 6285-MOVE-ADDL-DATA-TO-OUT-E64
      * FUNCTION:
      * THIS ROUTINE IS USED MOVE THE E-64 ADDITIONAL DATA FIELDS
      * TO OUTPUT
      ******************************************************************
       6285-MOVE-ADDL-DATA-TO-OUT-E64.

           MOVE LENGTH OF VRC64-MAIL-LN-1-ADDR
                                               TO WS-FLD-LEN
           MOVE VRC64-MAIL-LN-1-ADDR           TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           PERFORM 6450-SKIP-A-LINE

           IF VRC64-MAIL-LN-2-ADDR   = SPACES
              CONTINUE
           ELSE
              MOVE LENGTH OF VRC64-MAIL-LN-2-ADDR
                                                  TO WS-FLD-LEN
              MOVE VRC64-MAIL-LN-2-ADDR           TO WS-MOVE-FLD
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
           END-IF

           MOVE L-20                             TO WS-FLD-LEN
           MOVE VRC64-ADDITIONAL-DATA  (L-55:L-20)
                                                 TO WS-MOVE-FLD
           PERFORM 6300-MOVE-FIELD-TO-OUTPUT
           .

      /*****************************************************************
      * 6300-MOVE-FIELD-TO-OUTPUT.
      * FUNCTION:
      * MOVES TEXT/VALUE TO OUTPUT
      ******************************************************************
       6300-MOVE-FIELD-TO-OUTPUT.

           MOVE WS-MOVE-FLD TO WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT  =  WS-STRT + WS-FLD-LEN
           MOVE SPACES      TO WS-MOVE-FLD

           SET LAST-MOVE-NOT-SBA       TO TRUE
           SET LAST-MOVE-NOT-SPACE     TO TRUE
           SET LAST-MOVE-NOT-END-BYTES TO TRUE
           .

      /*****************************************************************
      * 6310-MOVE-FORMATTED-DATE.
      * FUNCTION:
      * FORMATS THE DATE IN MM/DD/YY OR CCYY/MM/DD FORMAT.
      ******************************************************************
       6310-MOVE-FORMATTED-DATE.

           IF CCYYMMDD-FRMT
              MOVE WS-FRMAT-DAT-CC     TO WS-FRMT-DAT-CC
              MOVE WS-FRMAT-DAT-YY     TO WS-FRMT-DAT-YY
              MOVE WS-FRMAT-DAT-MM     TO WS-FRMT-DAT-MM
              MOVE WS-FRMAT-DAT-DD     TO WS-FRMT-DAT-DD
              MOVE LENGTH OF WS-FRMT-CCYYMMDD TO WS-FLD-LEN
              MOVE WS-FRMT-CCYYMMDD    TO
                   WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
              COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
              SET MMDDYY-FRMT          TO TRUE

           ELSE
              IF MMDDCCYY-FRMT
                 MOVE WS-FRMAT-DAT-MM  TO WS-FRMT-DT-MM
                 MOVE WS-FRMAT-DAT-DD  TO WS-FRMT-DT-DD
                 MOVE WS-FRMAT-DAT-CC  TO WS-FRMT-DT-CC
                 MOVE WS-FRMAT-DAT-YY  TO WS-FRMT-DT-YY
                 MOVE LENGTH OF WS-FRMT-MMDDCCYY TO WS-FLD-LEN
                 MOVE WS-FRMT-MMDDCCYY TO
                      WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
                 COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
                 SET MMDDYY-FRMT       TO TRUE
              ELSE

                 MOVE WS-FRMAT-DAT-MM  TO WS-FRMTD-DAT-MM
                 MOVE WS-FRMAT-DAT-DD  TO WS-FRMTD-DAT-DD
                 MOVE WS-FRMAT-DAT-YY  TO WS-FRMTD-DAT-YY
                 MOVE LENGTH OF WS-FRMATTED-DT TO WS-FLD-LEN
                 MOVE WS-FRMATTED-DT   TO
                      WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
                 COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
              END-IF

           END-IF
           .

      /*****************************************************************
      * 6330-FRMT-DATE.
      * FUNCTION:
      * FORMATS THE DATE IN MM/DD/CCYY
      ******************************************************************
       6330-FRMT-DATE.
           MOVE WS-FRMAT-DAT3-MM            TO WS-FRMAT-DAT4-MM
           MOVE WS-FRMAT-DAT3-DD            TO WS-FRMAT-DAT4-DD
           MOVE WS-FRMAT-DAT3-CCYY          TO WS-FRMAT-DAT4-CCYY
           MOVE WS-FRMAT-DATE4              TO
                WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           .

      /*****************************************************************
      * 6400-MOVE-SPACE-TO-OUTPUT.
      * FUNCTION:
      * MOVES SPACES TO OUTPUT TO ADVANCE THE POINTER
      ******************************************************************
       6400-MOVE-SPACE-TO-OUTPUT.

           MOVE CTR-SPACES       TO WS-FLD-LEN
           MOVE SPACES TO WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
           COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           MOVE 01               TO CTR-SPACES
           SET LAST-MOVE-SPACE   TO TRUE
           .

      /*****************************************************************
      * 6450-SKIP-A-LINE.
      * FUNCTION:
      * SKIPS A LINE AND CHECKS FOR A PAGE BREAK.
      ******************************************************************
       6450-SKIP-A-LINE.

           IF FORCE-PAGE-BREAK
              SET NO-PAGE-BREAK TO TRUE
           ELSE
              ADD  01 TO WS-SBA
              MOVE LENGTH OF TBL-SBA-CHR(WS-SBA) TO WS-FLD-LEN
              MOVE TBL-SBA-CHR(WS-SBA) TO
                                    WS-RESP-OUTPUT(WS-STRT:WS-FLD-LEN)
              COMPUTE WS-STRT = WS-STRT + WS-FLD-LEN
           END-IF
           ADD 01 TO CTR-LIN
           SET  LAST-MOVE-SBA  TO TRUE

           IF R67-FORMAT
             IF FIRST-PAGE
                IF CTR-LIN = 21
                   SET NOT-FIRST-PAGE TO TRUE
                   SET MORE-TO-FORMAT TO TRUE
                   MOVE ZEROS TO WS-SBA
                   MOVE ZEROS TO CTR-LIN
                   PERFORM 4500-FORMAT-END-BYTES
                END-IF
             ELSE
                IF CTR-LIN = 19
                   IF END-OF-FORMAT
                      CONTINUE
                   ELSE
                      SET MORE-TO-FORMAT TO TRUE
                   END-IF
                   MOVE ZEROS TO WS-SBA
                   MOVE ZEROS TO CTR-LIN
                   PERFORM 4500-FORMAT-END-BYTES
                END-IF
             END-IF
           ELSE
             IF CTR-LIN = 23
CR8899          IF END-OF-FORMAT
CR8899             CONTINUE
CR8899          ELSE
                   SET NOT-FIRST-PAGE TO TRUE
                   SET MORE-TO-FORMAT TO TRUE
                   MOVE ZEROS TO WS-SBA
                   MOVE ZEROS TO CTR-LIN
CR8899             PERFORM 4500-FORMAT-END-BYTES
CR8899          END-IF
             END-IF
           END-IF
           .

      /*****************************************************************
      * 6451-SKIP-A-LINE-2-TIMES.
      * FUNCTION:
      * SKIPS A LINE AND CHECKS FOR A PAGE BREAK.
      ******************************************************************
       6451-SKIP-A-LINE-2-TIMES.

           PERFORM 6450-SKIP-A-LINE
           IF CTR-LIN <= 2
              CONTINUE
           ELSE
              PERFORM 6450-SKIP-A-LINE
           END-IF
           .

      /*****************************************************************
      * 6505-CHECK-NEXT-LIC-SPACE
      * FUNCTION:
      * CHECKS THE NEXT LICENSE ON VINX DATA PACKET AND SETS A FLAG FOR
      * WRAPUP TO TELL NEXT LICENSE IS 'SPACE' OR 'STOP ONLY' OR 'END
      * OF VINX' OR 'LICENSE WITH VALID FILE CODE'.
      ******************************************************************
       6505-CHECK-NEXT-LIC-SPACE.

           IF VINX-VEH-LIC-NBR OF WS-VINX-PKT(WS-SUB2) = SPACES
              SET CURRENT-LIC-SPACE       TO TRUE
           ELSE
              SET CURRENT-LIC-NOT-SPACE   TO TRUE
              MOVE VINX-VEH-LIC-NBR OF WS-VINX-PKT(WS-SUB2)
                                          TO WS-CURRENT-LICENSE
           END-IF

           MOVE WS-SUB2   TO WS-SUB3

           ADD +1 TO WS-SUB2

           MOVE VINX-FILE-KEY-CODE OF WS-VINX-PKT(WS-SUB2)
                                          TO WS-VALID-VIN-FILE-CD

           IF WS-SUB2 > VINX-VIN-CTR OF WS-VINX-PKT
              SET NEXT-IS-VINX-END        TO TRUE
              SET END-OF-FORMAT           TO TRUE
           ELSE
              IF VINX-VEH-LIC-NBR OF WS-VINX-PKT(WS-SUB2) = SPACES
                 SET NEXT-LIC-SPACE       TO TRUE
              ELSE
                 IF VIN-FILE-CD-VALID
                    SET NEXT-IS-RESPONSE  TO TRUE
                 ELSE
                    SET NEXT-IS-STOP-ONLY TO TRUE
                 END-IF
              END-IF
              IF VINX-INVAL-KEY OF WS-VINX-PKT(WS-SUB2)
                 SET NEXT-IS-VIN-RESTR TO TRUE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 6510-CHECK-NEXT-VIN-REC
      * FUNCTION:
      * CHECKS THE NEXT LICENSE ON VINX DATA PACKET AND IF LICENSE IS
      * SPACES OR INVALID FILE CODE DO NOT GO BACK TO TC MODULE,
      * PERFORM 3080- PARAGAPH TO FORMAT STOP MESSAGES UNITL IT FINDS
      * LICENSE WITH A VALID FILE CODE
      ******************************************************************
       6510-CHECK-NEXT-VIN-REC.

           MOVE VINX-FILE-KEY-CODE OF WS-VINX-PKT(WS-SUB2)
                                          TO WS-VALID-VIN-FILE-CD

           IF WS-SUB2 > VINX-VIN-CTR OF WS-VINX-PKT
              SET END-OF-VINX             TO TRUE
           ELSE
              IF VINX-VEH-LIC-NBR OF WS-VINX-PKT(WS-SUB2) = SPACES
                 SET LICENSE-SPACES       TO TRUE
              ELSE
                 IF VIN-FILE-CD-VALID
                    SET LICENSE-NOT-SPACE TO TRUE
                 ELSE
                    SET LICENSE-STOP-ONLY TO TRUE
                 END-IF
              END-IF
              IF VINX-INVAL-KEY OF WS-VINX-PKT(WS-SUB2)
                 SET LICENSE-VIN-RESTR    TO TRUE
              END-IF
           END-IF

           IF LICENSE-SPACES OR LICENSE-STOP-ONLY
              OR LICENSE-VIN-RESTR
              MOVE SPACES              TO WS-RESP-OUTPUT
              SET FIRST-PAGE           TO TRUE
              SET MSG-NOT-WRITTEN      TO TRUE
              MOVE ZEROS               TO WS-SBA
              PERFORM 2100-FORMAT-BEG-BYTES
              PERFORM 3080-FRMT-VLT-STOP-MSGS
      *RETURN WITH ERROR IF MESSAGE NOT WRITTEN
              IF MSG-NOT-WRITTEN
                 SET ERROR-RTN            TO TRUE
                 SET RC-RF-FAILURE        TO TRUE
              END-IF
           END-IF
           .

      /*****************************************************************
      * 6520-END-OF-SEARCH-MESSAGE
      * FUNCTION:
      * FORMATS MESSAGE FOR VIN INQUIRY WITH OPTIONAL FIELDS.
      ******************************************************************
       6520-END-OF-SEARCH-MESSAGE.

           IF ADDITIONAL-OPTION
              OR SEARCH-COMPLETED
              SET FIRST-PAGE       TO TRUE
              PERFORM 2100-FORMAT-BEG-BYTES
              IF ADDITIONAL-OPTION
                 MOVE LENGTH OF L-ADDL-OPT-FIELD TO WS-FLD-LEN
                 MOVE L-ADDL-OPT-FIELD           TO WS-MOVE-FLD
              ELSE
                 MOVE LENGTH OF L-SRCH-COMPLETED TO WS-FLD-LEN
                 MOVE L-SRCH-COMPLETED           TO WS-MOVE-FLD
              END-IF
              PERFORM 6300-MOVE-FIELD-TO-OUTPUT
              PERFORM 6450-SKIP-A-LINE
              SET END-OF-FORMAT    TO TRUE
              SET NEXT-IS-VINX-END TO TRUE
              PERFORM 4500-FORMAT-END-BYTES
           END-IF
           .

      /*****************************************************************
      * 7000-WRITE-TSQ
      * FUNCTION:
      * WRITES THE OUTPUT TO TSQ. THIS ROUTINE IS PERFORMED ON EACH
      * PAGE BREAK AND AT THE END OF MESSAGE.
      ******************************************************************
       7000-WRITE-TSQ.

           MOVE ZEROS                  TO WS-SBA
           MOVE ZEROS                  TO CTR-LIN
           ADD  1                      TO CTR-WRITE-Q
           MOVE TRNM-REGION-ID         TO WS-TSQ-SYSID
           MOVE TRNM-TASK-NUMBER       TO WS-TSQ-TASKN
           COMPUTE WS-STRT = WS-STRT - 1
           MOVE WS-STRT                TO WS-TSQ-LEN

           MOVE WS-TSQ-NAME             TO DA-KEY
           MOVE WS-TSQ-LEN              TO DA-DATA-LEN
           SET  DA-ADD-FNC              TO TRUE
           SET  DA-DATA-POINTER         TO ADDRESS OF WS-RESPONSE-OUTPUT
C8668      CALL L-DAO-MODULE USING WS-DA-PARMS
C8668                              ARG-TRFX-PKT
C8668      IF  RC-CALL-OKAY
C8668         CONTINUE
C8668      ELSE
C8668         SET EM-RF-TSQ-WRITE-FAIL(1)  TO TRUE
C8668         MOVE WS-SQL-CODE             TO ERHN-ERR-VARIABLE(1 1)
C8668         PERFORM 8910-SET-ALERT
C8668      END-IF
           .

      /*********************************************************
      * 7500-CALL-CODE-TBL-DA.
      * FUNCTION:
      *  THIS PARAGRAPH CALLS CODE TABLE DATA ACCESS MODULE.
      *--------------------------------------------------------*
       7500-CALL-CODE-TBL-DA.

           SET  WS-CODE-TABLE-ID       TO TRUE
           MOVE WS-TABLE-ID            TO DA-FILE-ID
           MOVE WS-KEY                 TO DA-KEY

           CALL L-CD-TBL-READER  USING WS-DA-PARMS
                                        ARG-TRFX-PKT
           .

      /****************************************************************
      * 8000-CALL-STRUCT-MGR.
      * FUNCTION:
      * - THIS PARAGRAPH CALLS THE STRUCTURE MANAGER.
      *****************************************************************
       8000-CALL-STRUCT-MGR.

           CALL L-STRUCTURE-MANAGER   USING WS-STRUCT-MGR-PARMS

           EVALUATE TRUE

              WHEN SMG-SUCCESSFUL
                 CONTINUE

              WHEN SMG-PKT-NOT-FOUND AND
                  (SMG-PKT-ID = L-IACB-PKT-ID OR
                   SMG-PKT-ID = L-VBB-PKT-ID  OR
                   SMG-PKT-ID = L-VRO-PKT-ID  OR
                   SMG-PKT-ID = L-VLO-PKT-ID  OR
                   SMG-PKT-ID = L-VRC-PKT-ID  OR
                   SMG-PKT-ID = L-VNR-PKT-ID  OR
                   SMG-PKT-ID = L-VLS-PKT-ID  OR
                   SMG-PKT-ID = L-VCI-PKT-ID  OR
                   SMG-PKT-ID = L-VMP-PKT-ID  OR
                   SMG-PKT-ID = L-VPO-PKT-ID  OR
                   SMG-PKT-ID = L-VPC-PKT-ID  OR
                   SMG-PKT-ID = L-VRH-PKT-ID  OR
                   SMG-PKT-ID = L-VMG-PKT-ID  OR
                   SMG-PKT-ID = L-VDC-PKT-ID  OR
                   SMG-PKT-ID = L-VHY-PKT-ID  OR
                   SMG-PKT-ID = L-VSA-PKT-ID  OR
                   SMG-PKT-ID = L-VNH-PKT-ID  OR
                   SMG-PKT-ID = L-VFP-PKT-ID  OR
                   SMG-PKT-ID = L-VFD-PKT-ID  OR
                   SMG-PKT-ID = L-VINX-PKT-ID OR
                   SMG-PKT-ID = L-VVP-PKT-ID  OR
                   SMG-PKT-ID = L-URC-PKT-ID  OR
                   SMG-PKT-ID = L-UNR-PKT-ID  OR
                   SMG-PKT-ID = L-ULS-PKT-ID  OR
                   SMG-PKT-ID = L-UCI-PKT-ID  OR
                   SMG-PKT-ID = L-UMP-PKT-ID  OR
                   SMG-PKT-ID = L-UPO-PKT-ID  OR
                   SMG-PKT-ID = L-UPC-PKT-ID  OR
                   SMG-PKT-ID = L-URH-PKT-ID  OR
                   SMG-PKT-ID = L-UMG-PKT-ID  OR
                   SMG-PKT-ID = L-UDC-PKT-ID  OR
                   SMG-PKT-ID = L-UHY-PKT-ID  OR
                   SMG-PKT-ID = L-USA-PKT-ID  OR
                   SMG-PKT-ID = L-UNH-PKT-ID  OR
                   SMG-PKT-ID = L-UFP-PKT-ID  OR
                   SMG-PKT-ID = L-UFD-PKT-ID  OR
                   SMG-PKT-ID = L-VYP-PKT-ID  OR
                   SMG-PKT-ID = L-VIV-PKT-ID)
                     SET SW-PKT-SRCH-EXIT TO TRUE

              WHEN SMG-NO-MORE AND
                  (SMG-PKT-ID = L-FREQ-PKT-ID OR
                   SMG-PKT-ID = L-VRC-PKT-ID  OR
                   SMG-PKT-ID = L-VNR-PKT-ID  OR
                   SMG-PKT-ID = L-VLS-PKT-ID  OR
                   SMG-PKT-ID = L-VCI-PKT-ID  OR
                   SMG-PKT-ID = L-VMP-PKT-ID  OR
                   SMG-PKT-ID = L-VPO-PKT-ID  OR
                   SMG-PKT-ID = L-VPC-PKT-ID  OR
                   SMG-PKT-ID = L-VRH-PKT-ID  OR
                   SMG-PKT-ID = L-VMG-PKT-ID  OR
                   SMG-PKT-ID = L-VDC-PKT-ID  OR
                   SMG-PKT-ID = L-VHY-PKT-ID  OR
                   SMG-PKT-ID = L-URC-PKT-ID  OR
                   SMG-PKT-ID = L-UNR-PKT-ID  OR
                   SMG-PKT-ID = L-ULS-PKT-ID  OR
                   SMG-PKT-ID = L-UCI-PKT-ID  OR
                   SMG-PKT-ID = L-UMP-PKT-ID  OR
                   SMG-PKT-ID = L-UPO-PKT-ID  OR
                   SMG-PKT-ID = L-UPC-PKT-ID  OR
                   SMG-PKT-ID = L-URH-PKT-ID  OR
                   SMG-PKT-ID = L-UMG-PKT-ID  OR
                   SMG-PKT-ID = L-UDC-PKT-ID  OR
                   SMG-PKT-ID = L-UHY-PKT-ID  OR
                   SMG-PKT-ID = L-VVP-PKT-ID)
                     SET SW-PKT-SRCH-EXIT TO TRUE

              WHEN OTHER
                 SET ERROR-RTN               TO TRUE
                 SET ERHN-ALERT-ONLY (1)     TO TRUE
                 SET EM-STRUCT-MGR-ERROR (1) TO TRUE
                 MOVE L-THIS-PROGRAM       TO ERHN-PGM-NAME
                 MOVE SMG-RETURN-CODE      TO ERHN-ERR-VARIABLE (1 1)
                 MOVE SMG-FUNCTION-CODE    TO ERHN-ERR-VARIABLE (1 2)
                 MOVE SMG-PKT-ID           TO ERHN-ERR-VARIABLE (1 3)

           END-EVALUATE
           .

C8668 /****************************************************************
C8668 * 8910-SET-ALERT.
C8668 * FUNCTION:
C8668 * - THIS PARAGRAPH SETS THE ERROR HANDLER FOR STRUCTURE MANAGER
C8668 *   ERRORS MESSAGES SET IN THE MODULE
C8668 *****************************************************************
C8668  8910-SET-ALERT.
C8668
C8668      SET ERROR-RTN               TO TRUE
C8668      SET RC-RF-FAILURE           TO TRUE
C8668      SET ERHN-ALERT-ONLY (1)     TO TRUE
C8668      MOVE L-THIS-PROGRAM         TO ERHN-PGM-NAME
C8668      .


        END PROGRAM VRPCCF03.
